within ;
package HumMod
  extends PhysiolibraryOld.Icons.GolemLib;
  package CardioVascular "Blood and Cardio-Vascular System"
    extends PhysiolibraryOld.Icons.CardioVascularLib;
    package VascularCompartments "Blood Cardio-Vascular Distribution"
      package heart "Heart Ventricle Components"
        model Systole
          //Real iconPoint[20, 2](each final unit = "mm");
          //Real iconActualPoint[2, 2](each final unit = "mm");
          PhysiolibraryOld.PressureFlow.NegativePressureFlow outflow
            annotation (Placement(transformation(extent={{80,20},{120,60}}),
                iconTransformation(extent={{80,20},{120,60}})));
          PhysiolibraryOld.Interfaces.RealInput_ contractility
            "heart muscle contractility [xNormal]"
            annotation (extent=[70,90; 90,110], rotation=-90);
          parameter Real n_Systole
            "parametrization of end diastolic volume curve";
          parameter Real Abasic_Systole
            "parametrization of end systolic volume curve";
          parameter Real additionalPressure_Systolic
            "parametrization of end systolic volume curve";
          PhysiolibraryOld.Interfaces.RealOutput ESV(final quantity="Volume",
              final unit="ml") annotation (Placement(transformation(extent={{-74,
                    -74},{-34,-34}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=180,
                origin={-100,80})));
          PhysiolibraryOld.Interfaces.RealInput_ externalPressure(final
              quantity="Pressure", final unit="mmHg")
            "pressure around ventricle" annotation (Placement(transformation(
                  extent={{-110,-70},{-90,-50}}), iconTransformation(extent={{-110,
                    -70},{-90,-50}})));
          PhysiolibraryOld.Interfaces.RealOutput_ P(final quantity="Pressure",
              final unit="mmHg") annotation (Placement(transformation(extent={{
                    -74,-74},{-34,-34}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=270,
                origin={-60,-60})));
        equation
          outflow.q = 0;
          P = outflow.pressure;
          ESV = ((outflow.pressure + additionalPressure_Systolic - externalPressure) / (contractility * Abasic_Systole)) ^ (1 / n_Systole);
          // drawing icon
          /*for i in 1:size(iconPoint, 1) loop
                                                                                                        iconPoint[i, 1] = (i - 1) / size(iconPoint, 1) * 180 - 90;
                                                                                                        (iconPoint[i, 1] + 90) * 200 / 180 = (((iconPoint[i, 2] + 40) * 200 / 130 + additionalPressure_Systolic - externalPressure) / (contractility * Abasic_Systole)) ^ (1 / n_Systole);
                                                                                                      end for;
                                                                                                      iconActualPoint[1, 1] = ESV * 180 / 200 - 90 - 2;
                                                                                                      iconActualPoint[1, 2] = outflow.pressure * 130 / 200 - 40 - 2;
                                                                                                      iconActualPoint[2, 1] = iconActualPoint[1, 1] + 4;
                                                                                                      iconActualPoint[2, 2] = iconActualPoint[1, 2] + 4;      */
          annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Rectangle(extent=  {{-100, 100}, {100, -60}}, lineColor=  {255, 0, 0}, fillPattern=  FillPattern.HorizontalCylinder, fillColor=  {255, 255, 255}), Text(extent=  {{-100, -60}, {100, -100}}, lineColor=  {0, 0, 255}, textString=  "%name"), Line(points=  DynamicSelect({{-100, 0}, {100, 0}}, iconPoint), color=  {0, 0, 255}, smooth=  Smooth.None), Ellipse(extent=  DynamicSelect({{0, 0}, {0, 0}}, iconActualPoint), lineColor=  {0, 0, 0}, fillColor=  {255, 0, 0}, fillPattern=  FillPattern.Solid)}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
        end Systole;

        model VentricleVolumeAndPumping2
          "Multiple PressureFlow connector with pressures from multiple inputs"
          extends PhysiolibraryOld.Interfaces.BaseModel;
          extends PhysiolibraryOld.Utilities.DynamicState;
          PhysiolibraryOld.Interfaces.RealInput_ BloodFlow(final quantity=
                "Flow", final unit="ml/min") "heart cardiac output" annotation (
             Placement(transformation(extent={{-140,-20},{-100,20}}, rotation=0),
                iconTransformation(
                extent={{-20,-20},{20,20}},
                rotation=90,
                origin={80,-100})));
          PhysiolibraryOld.PressureFlow.PositivePressureFlow q_in annotation (
              Placement(transformation(extent={{100,-20},{140,20}}, rotation=0),
                iconTransformation(extent={{-110,-10},{-90,10}})));
          parameter Real initialVolume(final quantity = "Volume", final unit = "ml");
          PhysiolibraryOld.PressureFlow.NegativePressureFlow q_out annotation (
              extent=[-10,-110; 10,-90], Placement(transformation(extent={{90,-10},
                    {110,10}}), iconTransformation(extent={{90,-10},{110,10}})));
          Real delta(final quantity = "Flow", final unit = "ml/min");
          PhysiolibraryOld.Interfaces.RealInput_ VentricleSteadyStateVolume(
              final quantity="Volume", final unit="ml")
            "heart ventricle steady state volume" annotation (Placement(
                transformation(extent={{-140,-20},{-100,20}}, rotation=0),
                iconTransformation(
                extent={{-20,-20},{20,20}},
                rotation=90,
                origin={-80,-100})));
          parameter Real K(final unit = "1/min") = 1;
          parameter Real V0(final quantity = "Volume", final unit = "ml") = 0;
          parameter Real BasicCompliance(final quantity = "Compliance", final unit = "ml/mmHg");
          PhysiolibraryOld.Interfaces.RealOutput_ Volume(
            start=initialVolume,
            final quantity="Volume",
            final unit="ml") annotation (Placement(transformation(extent={{84,-70},
                    {124,-30}}), iconTransformation(extent={{84,-70},{124,-30}})));
          //  Real Compliance(final quantity="Compliance", final unit="ml/mmHg");
          //  Real StressedVol(final quantity="Volume", final unit="ml");
          //  Real Pressure(final quantity="Pressure", final unit="mmHg");
          //initial equation
          //  Volume = initialVolume;
          //der(Volume) = 0;
        equation
          delta = (VentricleSteadyStateVolume - Volume) * K;
          /*  if STEADY then
                                                                                                                                                                                                  der(Volume) = 0;
                                                                                                                                                                                                else
                                                                                                                                                                                                  der(Volume) = delta / Library.SecPerMin;
                                                                                                                                                                                                end if;
                                                                                                                                                                                              */
          q_in.q + q_out.q = delta;
          if STEADY then
            q_in.q = BloodFlow;
          else
            q_in.q = if delta < 0 then BloodFlow else BloodFlow + delta;
          end if;
          //increase (delta>0) average ventricle volume means flow delta from q_in (veins)
          //decrease (delta<0) average ventricle volume means flow delta to q_to (atrys)
          // StressedVol  =  max( Volume - V0,  0.0);
          // Compliance  =  BasicCompliance / VentricleDiastole_Stiffness;
          // Pressure  =  ( StressedVol / Compliance)  + ExternalPressure;
          stateValue = Volume;
          changePerMin = delta;
          annotation(Documentation(info = "<HTML>
                   <p>
                   Model has a vector of continuous Real input signals as pressures for
                   vector of pressure-flow connectors.
                   </p>
                   </HTML>
                   "), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Rectangle(extent=  {{-40, -24}, {42, 22}}, lineColor=  {0, 0, 127}, fillColor=  {255, 255, 255}, fillPattern=  FillPattern.Solid), Polygon(points=  {{-30, 12}, {34, -2}, {-30, -18}, {-30, 12}}, lineColor=  {0, 0, 127}, fillColor=  {0, 0, 127}, fillPattern=  FillPattern.Solid)}), DymolaStoredErrors);
        end VentricleVolumeAndPumping2;

        model Ventricle3
          extends
            HumMod.CardioVascular.VascularCompartments.Interfaces.IVentricle;
          parameter String stateName;
          PhysiolibraryOld.Blocks.Constant basicContractility(k=
                contractilityBasic)
            annotation (Placement(transformation(extent={{60,2},{68,10}})));
          HumMod.Nerves.BetaReceptorsActivityFactor betaReceptorsActivityFactor annotation(Placement(transformation(extent = {{64, -20}, {84, 0}})));
          Modelica.Blocks.Math.Add Vol_SteadyState(k1 = 0.5, k2 = 0.5) annotation(Placement(transformation(extent = {{10, -10}, {-10, 10}}, rotation = 270, origin = {-34, 18})));
          Diastole3 diastole(stiffnes = stiffnes, n_Diastole = n_Diastole, Abasic_Diastole = Abasic_Diastole) annotation(Placement(transformation(extent = {{-76, -44}, {-56, -24}})));
          Systole systole(n_Systole = n_Systole, Abasic_Systole = Abasic_Systole, additionalPressure_Systolic = additionalPressure_Systolic) annotation(Placement(transformation(extent = {{56, -44}, {76, -24}})));
          Modelica.Blocks.Math.Feedback StrokeVolume annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 0, origin = {-8, -6})));
          VentricleVolumeAndPumping2 ventricle(initialVolume = initialVol, K = K, BasicCompliance = BasicCompliance, stateName = stateName) annotation(Placement(transformation(extent = {{-8, 66}, {12, 86}})));
          Modelica.Blocks.Math.Product BloodFlow annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 90, origin = {16, 40})));
        equation
          connect(basicContractility.y, betaReceptorsActivityFactor.yBase) annotation(Line(points = {{68.40000000000001, 6}, {74, 6}, {74, -3}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(busConnector.BetaPool_Effect, betaReceptorsActivityFactor.BetaPool_Effect) annotation(Line(points = {{22, 2}, {22, -4}, {64.2, -4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
          connect(busConnector.BetaBlocade_Effect, betaReceptorsActivityFactor.BetaBlockade_Effect) annotation(Line(points = {{22, 2}, {22, -10}, {64.2, -10}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
          connect(busConnector.GangliaGeneral_NA, betaReceptorsActivityFactor.GangliaGeneral_NA) annotation(Line(points = {{22, 2}, {22, -16}, {64.2, -16}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
          connect(diastole.externalPressure, busConnector.Pericardium_Pressure) annotation(Line(points = {{-56, -40}, {22, -40}, {22, 2}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
          connect(busConnector.Pericardium_Pressure, systole.externalPressure) annotation(Line(points = {{22, 2}, {22, -40}, {56, -40}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
          connect(betaReceptorsActivityFactor.y, systole.contractility) annotation(Line(points = {{74, -17}, {74, -24}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(diastole.EDV, StrokeVolume.u1) annotation(Line(points = {{-56, -26}, {-40, -26}, {-40, -6}, {-16, -6}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(Vol_SteadyState.u2, diastole.EDV) annotation(Line(points = {{-40, 6}, {-40, -26}, {-56, -26}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(systole.outflow, q_out) annotation(Line(points = {{76, -30}, {86, -30}, {86, 100}, {-20, 100}}, color = {0, 0, 0}, smooth = Smooth.None));
          connect(q_in, diastole.inflow) annotation(Line(points = {{20, 80}, {-82, 80}, {-82, -30}, {-76, -30}}, color = {0, 0, 0}, smooth = Smooth.None));
          connect(systole.ESV, Vol_SteadyState.u1) annotation(Line(points = {{56, -26}, {-28, -26}, {-28, 6}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(systole.ESV, StrokeVolume.u2) annotation(Line(points = {{56, -26}, {-8, -26}, {-8, -14}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(Vol_SteadyState.y, ventricle.VentricleSteadyStateVolume) annotation(Line(points = {{-34, 29}, {-34, 58}, {-6, 58}, {-6, 66}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(q_in, ventricle.q_in) annotation(Line(points = {{20, 80}, {-54, 80}, {-54, 76}, {-8, 76}}, color = {0, 0, 0}, smooth = Smooth.None));
          connect(ventricle.q_out, q_out) annotation(Line(points = {{12, 76}, {56, 76}, {56, 100}, {-20, 100}}, color = {0, 0, 0}, smooth = Smooth.None));
          connect(StrokeVolume.y, BloodFlow.u1) annotation(Line(points = {{1, -6}, {10, -6}, {10, 28}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(BloodFlow.y, ventricle.BloodFlow) annotation(Line(points = {{16, 51}, {16, 58}, {10, 58}, {10, 66}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(ventricle.Volume, Vol) annotation(Line(points = {{12.4, 71}, {14.7, 71}, {14.7, 93}, {17, 93}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(BloodFlow.u2, busConnector.HeartVentricleRate) annotation(Line(points = {{22, 28}, {22, 2}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
          connect(BloodFlow.y, CO) annotation(Line(points = {{16, 51}, {16, 59}, {77, 59}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(diastole.HR, busConnector.HeartVentricleRate) annotation(Line(points = {{-56, -33.2}, {22, -33.2}, {22, 2}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
          annotation(Documentation(info = "<HTML>
                   <PRE>
                   Heart ventricle.
                    
                   like
                   QHP 2008 / VascularCompartments/LeftVentricle/*
                    
                   Created : 16-May-05
                   Last Modified : 05-Aug-08
                   Author : Tom Coleman
                   Copyright : 2008-2008
                   By : University of Mississippi Medical Center
                   Solver : DES 2008
                   Schema : 2008.0
                    
                   The pressure-volume characteristics of both ventricles in diastole
                   and systole will be described using a power function.
                    
                     P = A * (V ^ n)
                    
                   P = Pressure
                   V = Volume
                   A = Scale Factor
                   n = curvature
                    
                   The function is invertable.
                    
                     V = (P/A) ^ (1/n)
                    
                   Some typical values
                    
                                                    Right                 Left
                                              ---------------------- ------------------------
                   Nominal Vol                     87.5                  87.5
                   Nominal TMP                      3.0                   6.0
                   Compliance                      29.2                  14.6
                   Pericardial P                   -3.0                  -3.0
                    
                   DIASTOLE
                     EDP                            1.0                   5.0
                     EDV                          125.0                 125.0
                     TMP                            4.0                   8.0
                     n                              2.0                   2.0
                     V^n                        15625.0               15625.0
                     A                              0.00026               0.00051
                    
                   SYSTOLE
                     ESP                           22.0                 120.0
                     ESV                           50.0                  50.0
                     TMP                           25.0                 123.0
                     n                              0.5                   0.5
                     V^n                            7.07                  7.07
                     A                              3.53                 17.39
                   </PRE>
                   </HTML>
                   ", revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>january 2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr>
                   </table>
                   </html>"), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-82, 30}, {76, 16}}, lineColor=  {0, 0, 0}, textString=  "contractilityBasic = %contractilityBasic")}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Text(extent=  {{-32, 62}, {-8, 60}}, lineColor=  {0, 0, 0}, textString=  "Volume_SteadyState"), Text(extent=  {{8, 62}, {32, 60}}, lineColor=  {0, 0, 0}, textString=  "Blood_Inflow")}), DymolaStoredErrors);
        end Ventricle3;

        model Diastole3
          // Real iconPoint[20, 2](each final unit = "mm");
          // Real iconActualPoint[2, 2](each final unit = "mm");
          PhysiolibraryOld.PressureFlow.PositivePressureFlow inflow annotation (
             Placement(transformation(extent={{-122,-24},{-82,16}}),
                iconTransformation(extent={{-120,20},{-80,60}})));
          PhysiolibraryOld.Interfaces.RealInput_ externalPressure(final
              quantity="Pressure", final unit="mmHg")
            "pericardium pressure around ventricle" annotation (Placement(
                transformation(extent={{94,-58},{114,-38}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=180,
                origin={100,-60})));
          parameter Real stiffnes
            "parametrization of end diastolic volume curve";
          parameter Real n_Diastole
            "parametrization of end systolic volume curve";
          parameter Real Abasic_Diastole
            "parametrization of end diastolic volume curve";
          PhysiolibraryOld.Interfaces.RealOutput EDV(final quantity="Volume",
              final unit="ml") annotation (Placement(transformation(extent={{-74,
                    -74},{-34,-34}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=0,
                origin={100,80})));
          PhysiolibraryOld.Interfaces.RealOutput_ P(final quantity="Pressure",
              final unit="mmHg") annotation (Placement(transformation(extent={{
                    -74,-74},{-34,-34}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=270,
                origin={60,-60})));
          PhysiolibraryOld.Interfaces.RealOutput_ Stiffness annotation (
              Placement(transformation(extent={{-74,-74},{-34,-34}}),
                iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=90,
                origin={-68,100})));
          PhysiolibraryOld.Interfaces.RealInput_ HR(final quantity="Frequency",
              final unit="1/min") "heart rate" annotation (Placement(
                transformation(extent={{94,-58},{114,-38}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=180,
                origin={100,8})));
          Real HR_effect;
          Real a;
          Real b;
        equation
          inflow.q = 0;
          P = inflow.pressure;
          //linearna zavislost na HR - vid. mathematica/Efect_EDVonHR.nb
          HR_effect = a * HR + b;
          1 = a * 75 + b;
          0.52 = a * 200 + b;
          EDV = ((inflow.pressure - externalPressure) / (stiffnes * Abasic_Diastole)) ^ (1 / n_Diastole) * HR_effect;
          Stiffness = stiffnes;
          // drawing icon
          /*for i in 1:size(iconPoint, 1) loop
                                                                                                          iconPoint[i, 1] = (i - 1) / size(iconPoint, 1) * 180 - 90;
                                                                                                          (iconPoint[i, 1] + 90) * 200 / 180 = (((iconPoint[i, 2] + 40) * 200 / 130 - externalPressure) / (stiffnes * Abasic_Diastole)) ^ (1 / n_Diastole);
                                                                                                        end for;
                                                                                                        iconActualPoint[1, 1] = EDV * 180 / 200 - 90 - 2;
                                                                                                        iconActualPoint[1, 2] = inflow.pressure * 130 / 200 - 40 - 2;
                                                                                                        iconActualPoint[2, 1] = iconActualPoint[1, 1] + 4;
                                                                                                        iconActualPoint[2, 2] = iconActualPoint[1, 2] + 4;        */
          annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Rectangle(extent=  {{-100, 100}, {100, -60}}, lineColor=  {255, 0, 0}, fillPattern=  FillPattern.HorizontalCylinder, fillColor=  {255, 255, 255}), Text(extent=  {{-100, -60}, {100, -100}}, lineColor=  {0, 0, 255}, textString=  "%name"), Line(points=  DynamicSelect({{-100, 0}, {100, 0}}, iconPoint), color=  {0, 0, 255}, smooth=  Smooth.None), Ellipse(extent=  DynamicSelect({{0, 0}, {0, 0}}, iconActualPoint), lineColor=  {0, 0, 0}, fillColor=  {255, 0, 0}, fillPattern=  FillPattern.Solid)}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Documentation(info = "<html>
                     <p>The relationship heart rate(HR)-end diastolic volume(EDV) is represented by linear function -0.00247654 HR + 1.18574.</p>
                     <p>The coeficients was choosen to solve normal state and critical zero state: (Solve[{a*75 + b == 1, a*HR + b == 0, diastoleTime[HR] == 0}, {a, b}]).</p>
                     <p>It means the next ventricle filling model:</p>
                     <p>cardiac cycle time (T) = (60/HR) [s]</p>
                     <p>systolic contraction time (Ts) = (0.3*T^0.5) [s]</p>
                     <p>diastolic filling time (Tdf) = T - Ts - 0.18*Ts [s]</p>
                     <p>steady-state filling curve:</p>
                     <p><img src=\"C:/Users/oto/Desktop/HumMod/mathematicaGUI/Effect_EDVonHR.png\"/></p>
                     <p>axes x .. filling time = Tdf [s]</p>
                     <p>axes y .. entered volume part = stroke volume (SV)/normal_SV [x 100 &percnt;]</p>
                     <p><br/>EDV = SV + pre(ESV) = effect(HR) * ((EDV_without_HR_effect - pre(ESV)) + pre(ESV)</p>
                     </html>"));
        end Diastole3;
      end heart;

      model SystemicVeinsElacticBloodCompartment
        // extends QHP.Library.Interfaces.BaseModel;
        extends PhysiolibraryOld.Icons.BloodElasticCompartment;
        PhysiolibraryOld.PressureFlow.PositivePressureFlow referencePoint
          annotation (extent=[-10,-110; 10,-90], Placement(transformation(
                extent={{-110,-10},{-90,10}}), iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=0,
              origin={0,0})));
        PhysiolibraryOld.Interfaces.RealInput_ ExternalPressure(final quantity=
              "Pressure", final unit="mmHg")
          "external pressure around the compartment"
          annotation (extent=[-10,90; 10,110], rotation=-90);
        PhysiolibraryOld.Interfaces.RealInput_ Compliance(final quantity=
              "Compliance", final unit="ml/mmHg")
          "elasticity of the stressed walls"
          annotation (extent=[50,90; 70,110], rotation=-90);
        Modelica.Blocks.Interfaces.RealOutput Pressure(final quantity = "Pressure", final unit = "mmHg")
          "blod pressure in compartment"                                                                                                annotation(Placement(transformation(extent = {{30, -110}, {50, -90}}, rotation = -90)));
        Modelica.Blocks.Interfaces.RealOutput Vol(final quantity = "Volume", final unit = "ml")
          "blood volume in compartment"                                                                                       annotation(Placement(transformation(extent = {{-50, -110}, {-30, -90}}, rotation = -90), iconTransformation(extent = {{-10, -10}, {10, 10}}, rotation = 270, origin = {-40, -100})));
        PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
            Placement(transformation(extent={{-88,72},{-68,92}}),
              iconTransformation(extent={{88,51},{108,71}})));
        HumMod.CardioVascular.VascularCompartments.VascularElasticBloodCompartment
                                                                                   systemicVeins(initialVol = initialSystemisVeinsVol, stateName = "SystemicVeins.Vol")
          "systemic veins"                                                                                                     annotation(Placement(transformation(extent = {{-14, -10}, {6, 10}})));
        PhysiolibraryOld.Factors.CurveValue V0_A2_Effect(data={{0.0,1.05,0.0},{
              1.3,1.0,-0.1},{3.0,0.85,0.0}})
          annotation (Placement(transformation(extent={{-30,7},{-10,27}})));
        PhysiolibraryOld.Utilities.ConstantFromFile const4(
          units="ml",
          k=1700,
          varName="SystemicVeins.V0Basic",
          varValue=1700.0,
          initType=PhysiolibraryOld.Utilities.Init.NoInit)
          annotation (Placement(transformation(extent={{-32,48},{-23,39}})));
        HumMod.Nerves.AplhaReceptorsActivityFactor AplhaReceptors(NEURALK = 0.333, HUMORALK = 0.5, data = {{0.0, 1.2, 0.0}, {1.0, 1.0, -0.3}, {3.0, 0.6, 0.0}}) annotation(Placement(transformation(extent = {{-30, 20}, {-10, 40}})));
        Modelica.Blocks.Interfaces.RealOutput V0(final quantity = "Volume", final unit = "ml")
          "maximal zero pressure blood volume in compartment"                                                                                      annotation(Placement(transformation(extent = {{-4.5, -4.5}, {4.5, 4.5}}, rotation = 180, origin = {-27.5, 5.5}), iconTransformation(extent = {{-10, -10}, {10, 10}}, rotation = 90, origin = {-68, 100})));
        parameter Real initialSystemisVeinsVol(final quantity = "Volume", final unit = "ml") = 2329.57;
        // = 2200;// = 2980;
        Modelica.Blocks.Interfaces.RealOutput NormalizedVolume(final quantity = "NormalizedVolume", final unit = "1")
          "maximal zero pressure blood volume in compartment"                                                                                                     annotation(Placement(transformation(extent = {{-4.5, -4.5}, {4.5, 4.5}}, rotation = 0, origin = {22.5, 9.5}), iconTransformation(extent = {{-10, -10}, {10, 10}}, rotation = 180, origin = {-100, 56})));
      equation
        connect(V0_A2_Effect.y, systemicVeins.V0) annotation(Line(points = {{-20, 15}, {-20, 12}, {-10, 12}, {-10, 10}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(AplhaReceptors.y, V0_A2_Effect.yBase) annotation(Line(points = {{-20, 23}, {-20, 19}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(AplhaReceptors.yBase, const4.y) annotation(Line(points = {{-20, 37}, {-20, 43.5}, {-22.55, 43.5}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(systemicVeins.referencePoint, referencePoint) annotation(Line(points = {{-4, 0}, {-100, 0}}, color = {0, 0, 0}, smooth = Smooth.None));
        connect(systemicVeins.Vol, Vol) annotation(Line(points = {{-8, -10}, {-8, -67}, {-40, -67}, {-40, -100}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(systemicVeins.Pressure, Pressure) annotation(Line(points = {{0, -10}, {0, -67}, {40, -67}, {40, -100}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(systemicVeins.ExternalPressure, ExternalPressure) annotation(Line(points = {{-4, 10}, {-4, 67}, {0, 67}, {0, 100}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(systemicVeins.Compliance, Compliance) annotation(Line(points = {{2, 10}, {2, 50}, {60, 50}, {60, 100}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.A2Pool_Log10Conc, V0_A2_Effect.u) annotation(Line(points = {{-78, 82}, {-78, 17}, {-29.8, 17}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.GangliaGeneral_NA, AplhaReceptors.GangliaGeneral_NA) annotation(Line(points = {{-78, 82}, {-78, 24}, {-29.8, 24}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.AlphaPool_Effect, AplhaReceptors.AlphaPool_Effect) annotation(Line(points = {{-78, 82}, {-78, 36}, {-29.8, 36}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.AlphaBlocade_Effect, AplhaReceptors.AlphaBlockade_Effect) annotation(Line(points = {{-78, 82}, {-78, 30}, {-29.8, 30}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(V0_A2_Effect.y, V0) annotation(Line(points = {{-20, 15}, {-20, 5.5}, {-27.5, 5.5}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(systemicVeins.NormalizedVolume, NormalizedVolume) annotation(Line(points = {{6, 6}, {12, 6}, {12, 9.5}, {22.5, 9.5}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Documentation(info = "<HTML>
                     <PRE>
                       Elastic blood flow compartment. 
                      
                     like 
                     QHP 2008 / VascularCompartments/SystemicArtys.DES
                      
                     Created : 21-Oct-04
                     Last Modified : 13-Aug-08
                     Author : Tom Coleman
                     Copyright : 2008-2008
                     By : University of Mississippi Medical Center
                     Solver : DES 2008
                     Schema : 2008.0
                     </PRE>
                     </HTML>
                     ", revisions = "<html>
                     <table>
                     <tr>
                     <td>Author:</td>
                     <td>Marek Matejak</td>
                     </tr>
                     <tr>
                     <td>Design:</td>
                     <td>Zuzana Rubaninska</td>
                     </tr>
                     <tr>
                     <td>Copyright:</td>
                     <td>In public domains</td>
                     </tr>
                     <tr>
                     <td>By:</td>
                     <td>Charles University, Prague</td>
                     </tr>
                     <tr>
                     <td>Date of:</td>
                     <td>january 2009</td>
                     </tr>
                     <tr>
                     <td>References:</td>
                     <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                     </tr>
                     </table>
                     </html>"), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}, grid = {2, 2}), graphics), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}, grid = {2, 2}), graphics));
      end SystemicVeinsElacticBloodCompartment;

      model SequesteredBlood
        extends Interfaces.ISequesteredBlood;
        parameter Real initialVol(final quantity = "Volume", final unit = "ml")
          "initial compartment blood volume";
        parameter Real[:, 3] data;
        PhysiolibraryOld.PressureFlow.PressureControledCompartment
          pressureControledCompartment(initialVolume=initialVol)
          annotation (Placement(transformation(extent={{-16,-10},{4,10}})));
        PhysiolibraryOld.Curves.Curve curve(
          x=data[:, 1],
          y=data[:, 2],
          slope=data[:, 3])
          annotation (Placement(transformation(extent={{-60,50},{-40,70}})));
        Modelica.Blocks.Math.Add add annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 270, origin = {-6, 40})));
      equation
        connect(pressureControledCompartment.Volume, curve.u) annotation(Line(points = {{-6, -10}, {-6, -18}, {-70, -18}, {-70, 60}, {-60, 60}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(pressureControledCompartment.Volume, Vol) annotation(Line(points = {{-6, -10}, {-6, -60}, {-40, -60}, {-40, -100}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(referencePoint, pressureControledCompartment.y) annotation(Line(points = {{-100, 0}, {-16, 0}}, color = {0, 0, 0}, smooth = Smooth.None));
        connect(add.y, pressureControledCompartment.pressure) annotation(Line(points = {{-6, 29}, {-6, 10}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(curve.val, add.u2) annotation(Line(points = {{-39.8, 60}, {-12, 60}, {-12, 52}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(ExternalPressure, add.u1) annotation(Line(points = {{-90, 100}, {-90, 52}, {1.77636e-015, 52}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(add.y, Pressure) annotation(Line(points = {{-6, 29}, {-6, 20}, {40, 20}, {40, -100}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Documentation(info = "<HTML>
                   <PRE>
                     Elastic blood flow compartment. 
                    
                   like 
                   QHP 2008 / VascularCompartments/SystemicArtys.DES
                    
                   Created : 21-Oct-04
                   Last Modified : 13-Aug-08
                   Author : Tom Coleman
                   Copyright : 2008-2008
                   By : University of Mississippi Medical Center
                   Solver : DES 2008
                   Schema : 2008.0
                   </PRE>
                   </HTML>
                   ", revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Design:</td>
                   <td>Zuzana Rubaninska</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>january 2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr>
                   </table>
                   </html>"), Icon(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-100, -16}, {100, -32}}, lineColor=  {0, 0, 255}, textString=  "(initial %initialVol ml)")}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
      end SequesteredBlood;

      model VascularElasticBloodCompartment
        extends PhysiolibraryOld.Utilities.DynamicState;
        extends
          HumMod.CardioVascular.VascularCompartments.Interfaces.IVascularElasticBloodCompartment;
        Real StressedVolume(final quantity = "Volume", final unit = "ml");
        Modelica.Blocks.Interfaces.RealOutput NormalizedVolume(final quantity = "NormalizedVolume", final unit = "1")
          "actual volume divided by standard compartement volume"                                                                                                     annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 270, origin = {-40, -100}), iconTransformation(extent = {{-10, -10}, {10, 10}}, rotation = 0, origin = {100, 60})));
        //initial equation
        //  Vol = initialVol;
        // der(Vol) = 0;
      equation
        StressedVolume = max(Vol - V0, 0);
        Pressure = StressedVolume / Compliance + ExternalPressure;
        referencePoint.pressure = Pressure;
        NormalizedVolume = if initialVol == 0 then 0 else Vol / initialVol;
        stateValue = Vol;
        changePerMin = referencePoint.q;
        annotation(preferredView = text, Documentation(info = "<HTML>
                   <PRE>
                     Elastic blood flow compartment. 
                    
                   like 
                   QHP 2008 / VascularCompartments/SystemicArtys.DES
                    
                   Created : 21-Oct-04
                   Last Modified : 13-Aug-08
                   Author : Tom Coleman
                   Copyright : 2008-2008
                   By : University of Mississippi Medical Center
                   Solver : DES 2008
                   Schema : 2008.0
                   </PRE>
                   </HTML>
                   ", revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Design:</td>
                   <td>Zuzana Rubaninska</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>january 2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr>
                   </table>
                   </html>"), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-100, -16}, {100, -32}}, lineColor=  {0, 0, 255}, textString=  "(initial %initialVol ml)")}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
      end VascularElasticBloodCompartment;

      model LungBloodFlow
        PhysiolibraryOld.Interfaces.RealInput_ CardiacOutput
          annotation (Placement(transformation(extent={{-120,40},{-80,80}})));
        parameter Real BasicRLShuntPercentage(final unit = "%") = 2
          "basic percentage of total blood flow not exposed to lung air";
        //
        //  parameter Real BasicRLShunt(final unit="ml/min") =  110; // 220.0;
        parameter Real RightHemithorax_Pressure(final unit = "mmHg") = -4;
        parameter Real LeftHemithorax_Pressure(final unit = "mmHg") = -4;
        Real PressureGradientRightLeft(final unit = "mmHg")
          "difference between right and left hemithorax pressure";
        Real Thorax_RightLungFlowFract(final unit = "1")
          "fraction of blood flow to right lung";
        Real Thorax_LeftLungFlowFract(final unit = "1")
          "fraction of blood flow to left lung";
        Real RightHemithorax_LungInflation(final unit = "1")
          "dammage effect of right hemithorax inflation";
        Real LeftHemithorax_LungInflation(final unit = "1")
          "dammage effect of left hemithorax inflation";
        Real Total(final unit = "ml/min") "cardiac output";
        Real RightLeftShunt(final unit = "ml/min")
          "blood flow not exposed to lung air without dammage effect";
        Real Alveolar(final unit = "ml/min")
          "blood flow exposed to lung air without dammage effect";
        //  Real RightLungTotal(final unit="ml/min") "right lung blood flow exposed to lung air without dammage effect";
        //  Real RightLungVentilated(final unit="ml/min") "right lung blood flow exposed to lung air";
        //  Real RightLungShunt(final unit="ml/min");
        //  Real LeftLungTotal(final unit="ml/min");
        //  Real LeftLungVentilated(final unit="ml/min");
        //  Real LeftLungShunt(final unit="ml/min");
        //  Real AlveolarShunt(final unit="ml/min");
        //  Real TotalShunt(final unit="ml/min");
        parameter Real[:, 3] PressureOnInflation = {{-4.0, 1.0, 0}, {4.0, 0.0, 0}};
        parameter Real[:, 3] PressureGradientOnFlowDist = {{-25, 0.0, 0}, {0, 0.5, 0.03}, {25, 1.0, 0}};
        PhysiolibraryOld.Interfaces.RealOutput_ AlveolarVentilated(final unit=
              "ml/min") annotation (Placement(transformation(extent={{80,40},{
                  120,80}}), iconTransformation(extent={{80,40},{120,80}})));
        PhysiolibraryOld.Curves.Curve Thorax_PressureGradientOnFlowDist(
          x=PressureGradientOnFlowDist[:, 1],
          y=PressureGradientOnFlowDist[:, 2],
          slope=PressureGradientOnFlowDist[:, 3])
          annotation (Placement(transformation(extent={{-40,52},{-20,72}})));
        PhysiolibraryOld.Curves.Curve Thorax_PressureOnInflationR(
          x=PressureOnInflation[:, 1],
          y=PressureOnInflation[:, 2],
          slope=PressureOnInflation[:, 3])
          annotation (Placement(transformation(extent={{52,46},{72,66}})));
        PhysiolibraryOld.Curves.Curve Thorax_PressureOnInflationL(
          x=PressureOnInflation[:, 1],
          y=PressureOnInflation[:, 2],
          slope=PressureOnInflation[:, 3])
          annotation (Placement(transformation(extent={{-2,-24},{18,-4}})));
      equation
        PressureGradientRightLeft = RightHemithorax_Pressure - LeftHemithorax_Pressure;
        //division between left and rigth lung blood flow by hemithorax pressure
        Thorax_PressureGradientOnFlowDist.u = PressureGradientRightLeft;
        Thorax_LeftLungFlowFract = Thorax_PressureGradientOnFlowDist.val;
        Thorax_RightLungFlowFract = 1.0 - Thorax_LeftLungFlowFract;
        //damage effect of hemithorax pressure
        Thorax_PressureOnInflationR.u = RightHemithorax_Pressure;
        RightHemithorax_LungInflation = Thorax_PressureOnInflationR.val;
        Thorax_PressureOnInflationL.u = LeftHemithorax_Pressure;
        LeftHemithorax_LungInflation = Thorax_PressureOnInflationL.val;
        Total = CardiacOutput;
        RightLeftShunt = BasicRLShuntPercentage / 100.0 * Total;
        //min(BasicRLShunt,Total);
        Alveolar = Total - RightLeftShunt;
        //       RightLungTotal  =  Alveolar * Thorax_RightLungFlowFract;
        //       RightLungVentilated  =  RightLungTotal * RightHemithorax_LungInflation;
        //       RightLungShunt  =  RightLungTotal - RightLungVentilated;
        //       LeftLungTotal  =  Alveolar * Thorax_LeftLungFlowFract;
        //       LeftLungVentilated  =  LeftLungTotal * LeftHemithorax_LungInflation;
        //       LeftLungShunt  =  LeftLungTotal - LeftLungVentilated;
        //       AlveolarVentilated  =  RightLungVentilated + LeftLungVentilated;
        //       AlveolarShunt  =  RightLungShunt + LeftLungShunt;
        //       TotalShunt  =  RightLeftShunt + AlveolarShunt;
        AlveolarVentilated = Alveolar * (Thorax_RightLungFlowFract * RightHemithorax_LungInflation + Thorax_LeftLungFlowFract * LeftHemithorax_LungInflation);
        annotation(Diagram(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics), Documentation(revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>january 2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr>
                   </table>
                   </html>", info = "<html>
                   <p>Calculation of blood flow fraction through ventilated alveoli.</p>
                   </html>"), Icon(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics={  Bitmap(extent=  {{-100, 100}, {100, -100}}, fileName=  "modelica://HumMod/icons/plicniZkrat.png"), Text(extent=  {{-102, -92}, {112, -114}}, lineColor=  {0, 0, 255}, textString=  "%name")}));
      end LungBloodFlow;

      package Interfaces "Abstract Interfaces"
        partial model IVascularElasticBloodCompartment
          //extends QHP.Library.Interfaces.BaseModel;
          extends PhysiolibraryOld.Icons.BloodElasticCompartment;
          PhysiolibraryOld.PressureFlow.PositivePressureFlow referencePoint
            annotation (extent=[-10,-110; 10,-90], Placement(transformation(
                  extent={{-110,-10},{-90,10}}), iconTransformation(extent={{-10,
                    -10},{10,10}})));
          PhysiolibraryOld.Interfaces.RealInput_ V0(final quantity="Volume",
              final unit="ml") "maximal nonstressed volume"
            annotation (extent=[-70,90; -50,110], rotation=-90);
          PhysiolibraryOld.Interfaces.RealInput_ ExternalPressure(final
              quantity="Pressure", final unit="mmHg")
            "external pressure around the compartment"
            annotation (extent=[-10,90; 10,110], rotation=-90);
          PhysiolibraryOld.Interfaces.RealInput_ Compliance(final quantity=
                "Compliance", final unit="ml/mmHg")
            "elasticity of the stressed walls"
            annotation (extent=[50,90; 70,110], rotation=-90);
          Modelica.Blocks.Interfaces.RealOutput Pressure(final quantity = "Pressure", final unit = "mmHg")
            "blod pressure in compartment"                                                                                                annotation(Placement(transformation(extent = {{30, -110}, {50, -90}}, rotation = -90)));
          // Real Vol "blood volume in compartment";
          parameter Real initialVol = 0;
          Modelica.Blocks.Interfaces.RealOutput Vol(start = initialVol, final quantity = "Volume", final unit = "ml")
            "blood volume in compartment"                                                                                                     annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 270, origin = {-40, -100})));
          // parameter Real initialVol = 0;
          annotation(preferredView = text, Documentation(info = "<HTML>
                   <PRE>
                     Elastic blood flow compartment. 
                    
                   like 
                   QHP 2008 / VascularCompartments/SystemicArtys.DES
                    
                   Created : 21-Oct-04
                   Last Modified : 13-Aug-08
                   Author : Tom Coleman
                   Copyright : 2008-2008
                   By : University of Mississippi Medical Center
                   Solver : DES 2008
                   Schema : 2008.0
                   </PRE>
                   </HTML>
                   ", revisions = "<html>
                   <ul>
                   <li><i>  </i>
                          </li>
                   <li><i> january 2009 </i><br> 
                          by Marek Matejak in Modelica initially implemented (consulted with Jiri Kofranek), Charles University, Prague<br>
                          orginaly described by Tom Coleman in QHP 2008 beta 3, University of Mississippi Medical Center
                          </li>
                   </ul>
                   </html>"), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Diagram(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics));
        end IVascularElasticBloodCompartment;

        model ISequesteredBlood
          // extends QHP.Library.Interfaces.BaseModel;
          extends PhysiolibraryOld.Icons.BloodSequesteredCompartment;
          PhysiolibraryOld.PressureFlow.PositivePressureFlow referencePoint
            annotation (extent=[-10,-110; 10,-90], Placement(transformation(
                  extent={{-110,-10},{-90,10}}), iconTransformation(extent={{-10,
                    -10},{10,10}})));
          PhysiolibraryOld.Interfaces.RealInput_ ExternalPressure(final
              quantity="Pressure", final unit="mmHg")
            "external pressure around the compartment"
            annotation (extent=[-100,90; -80,110], rotation=-90);
          Modelica.Blocks.Interfaces.RealOutput Pressure(final quantity = "Pressure", final unit = "mmHg")
            "blod pressure in compartment"                                                                                                annotation(Placement(transformation(extent = {{30, -110}, {50, -90}}, rotation = -90)));
          Modelica.Blocks.Interfaces.RealOutput Vol(final quantity = "Volume", final unit = "ml")
            "blood volume in compartment"                                                                                       annotation(Placement(transformation(extent = {{-50, -110}, {-30, -90}}, rotation = -90)));
          annotation(Documentation(info = "<HTML>
                   <PRE>
                     Elastic blood flow compartment. 
                    
                   like 
                   QHP 2008 / VascularCompartments/SystemicArtys.DES
                    
                   Created : 21-Oct-04
                   Last Modified : 13-Aug-08
                   Author : Tom Coleman
                   Copyright : 2008-2008
                   By : University of Mississippi Medical Center
                   Solver : DES 2008
                   Schema : 2008.0
                   </PRE>
                   </HTML>
                   ", revisions = "<html>
                   <ul>
                   <li><i>  </i>
                          </li>
                   <li><i> january 2009 </i><br> 
                          by Marek Matejak in Modelica initially implemented (consulted with Jiri Kofranek), Charles University, Prague<br>
                          orginaly described by Tom Coleman in QHP 2008 beta 3, University of Mississippi Medical Center
                          </li>
                   </ul>
                   </html>"), Icon(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
        end ISequesteredBlood;

        partial model IVentricle
          parameter Real initialVol(final quantity = "Volume", final unit = "ml") = 90;
          parameter Real initialESV(final quantity = "Volume", final unit = "ml") = 50;
          parameter Real stiffnes = 1
            "parametrization of end diastolic volume curve";
          parameter Real n_Diastole = 2
            "parametrization of end systolic volume curve";
          parameter Real n_Systole = 0.5
            "parametrization of end diastolic volume curve";
          parameter Real Abasic_Diastole = 0.00051
            "parametrization of end diastolic volume curve";
          parameter Real Abasic_Systole = 17.39
            "parametrization of end systolic volume curve";
          parameter Real additionalPressure_Systolic = 24
            "parametrization of end systolic volume curve";
          parameter Real contractilityBasic = 1
            "parametrization of end systolic volume curve";
          parameter Real K(final quantity = "TimeCoefficient", final unit = "1/min") = 1
            "time adaptation coeficient of average ventricle blood volume";
          parameter Real BasicCompliance(final quantity = "Compliance", final unit = "ml/mmHg") = 1;
          parameter Real MaxContractionCompliance(final quantity = "Compliance", final unit = "ml/mmHg") = 1;
          parameter Real Cond1 = 1;
          parameter Real Cond2 = 1;
          PhysiolibraryOld.PressureFlow.PositivePressureFlow q_in annotation (
              extent=[-10,-110; 10,-90], Placement(transformation(extent={{10,
                    70},{30,90}}), iconTransformation(extent={{10,70},{30,90}})));
          PhysiolibraryOld.PressureFlow.NegativePressureFlow q_out annotation (
              extent=[-10,-110; 10,-90], Placement(transformation(extent={{-30,
                    90},{-10,110}}), iconTransformation(extent={{-30,90},{-10,
                    110}})));
          PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
              Placement(transformation(extent={{12,-8},{32,12}}),
                iconTransformation(extent={{-10,-64},{10,-44}})));
          PhysiolibraryOld.Interfaces.RealOutput_ Vol(final quantity="Volume",
              final unit="ml") annotation (Placement(transformation(extent={{14,
                    90},{20,96}}), iconTransformation(
                extent={{-20,-20},{20,20}},
                rotation=270,
                origin={40,-40})));
          PhysiolibraryOld.Interfaces.RealOutput_ CO(final quantity="Flow",
              final unit="ml/min") annotation (Placement(transformation(extent=
                    {{74,56},{80,62}}), iconTransformation(
                extent={{-20,-20},{20,20}},
                rotation=180,
                origin={-68,-20})));
          annotation(Documentation(info = "<HTML>
                   <PRE>
                   Heart ventricle.
                    
                   like
                   QHP 2008 / VascularCompartments/LeftVentricle/*
                    
                   Created : 16-May-05
                   Last Modified : 05-Aug-08
                   Author : Tom Coleman
                   Copyright : 2008-2008
                   By : University of Mississippi Medical Center
                   Solver : DES 2008
                   Schema : 2008.0
                    
                   The pressure-volume characteristics of both ventricles in diastole
                   and systole will be described using a power function.
                    
                     P = A * (V ^ n)
                    
                   P = Pressure
                   V = Volume
                   A = Scale Factor
                   n = curvature
                    
                   The function is invertable.
                    
                     V = (P/A) ^ (1/n)
                    
                   Some typical values
                    
                                                    Right                 Left
                                              ---------------------- ------------------------
                   Nominal Vol                     87.5                  87.5
                   Nominal TMP                      3.0                   6.0
                   Compliance                      29.2                  14.6
                   Pericardial P                   -3.0                  -3.0
                    
                   DIASTOLE
                     EDP                            1.0                   5.0
                     EDV                          125.0                 125.0
                     TMP                            4.0                   8.0
                     n                              2.0                   2.0
                     V^n                        15625.0               15625.0
                     A                              0.00026               0.00051
                    
                   SYSTOLE
                     ESP                           22.0                 120.0
                     ESV                           50.0                  50.0
                     TMP                           25.0                 123.0
                     n                              0.5                   0.5
                     V^n                            7.07                  7.07
                     A                              3.53                 17.39
                   </PRE>
                   </HTML>
                   ", revisions = "<html>
                   <ul>
                   <li><i>  </i>
                          </li>
                   <li><i> january 2009 </i><br> 
                          by Marek Matejak in Modelica initially implemented (consulted with Jiri Kofranek), Charles University, Prague<br>
                          orginaly described by Tom Coleman in QHP 2008 beta 3, University of Mississippi Medical Center
                          </li>
                   </ul>
                   </html>"), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-100, -126}, {100, -92}}, textString=  "%name", lineColor=  {0, 0, 255}), Bitmap(extent=  {{-100, 100}, {100, -100}}, fileName=  "icons/komoraSrdce.png")}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), DymolaStoredErrors);
        end IVentricle;
      end Interfaces;

      model PulmonaryCirculation
        extends PhysiolibraryOld.PressureFlow.ResistorBase;
        extends PhysiolibraryOld.Icons.PulmonaryCirculation;
        VascularElasticBloodCompartment pulmCapys(initialVol = 200.141, stateName = "PulmCapys.Vol")
          "pulmonary capilaries"                                                                                            annotation(Placement(transformation(extent = {{-22, -10}, {-2, 10}})));
        VascularElasticBloodCompartment pulmArty(initialVol = 200.488, stateName = "PulmArty.Vol") annotation(Placement(transformation(extent = {{-86, -10}, {-66, 10}})));
        VascularElasticBloodCompartment pulmVeins(initialVol = 210.463, stateName = "PulmVeins.Vol")
          "pulmonary veins"                                                                                            annotation(Placement(transformation(extent = {{38, -10}, {58, 10}})));
        PhysiolibraryOld.PressureFlow.ResistorWithCondParam pulmArtyConductance(
            cond=1350)
          annotation (Placement(transformation(extent={{-61,-11},{-39,11}})));
        PhysiolibraryOld.Blocks.VolumeConstant ArtysV0(k=110)
          annotation (Placement(transformation(extent={{-94,16},{-86,24}})));
        PhysiolibraryOld.Blocks.ComplianceConstant ArtysCompliance(k=5.3)
          annotation (Placement(transformation(extent={{-54,16},{-62,24}})));
        PhysiolibraryOld.Blocks.Constant CapysV0(k=140)
          annotation (Placement(transformation(extent={{-28,16},{-20,24}})));
        PhysiolibraryOld.Blocks.ComplianceConstant CapysCompliance(k=4.6)
          annotation (Placement(transformation(extent={{4,16},{-4,24}})));
        PhysiolibraryOld.PressureFlow.ResistorWithCondParam
          pulmCapysConductance(cond=1800)
          annotation (Placement(transformation(extent={{2,-11},{24,11}})));
        PhysiolibraryOld.Blocks.Constant VeinsV0(k=150)
          annotation (Placement(transformation(extent={{30,16},{38,24}})));
        PhysiolibraryOld.Blocks.ComplianceConstant VeinsCompliance(k=6)
          annotation (Placement(transformation(extent={{66,14},{58,22}})));
        PhysiolibraryOld.PressureFlow.ResistorWithCondParam
          pulmVeinsConductance(cond=5400)
          annotation (Placement(transformation(extent={{62,-11},{84,11}})));
        PhysiolibraryOld.Interfaces.BusConnector busConnector
          "signals of organ bood flow resistence" annotation (Placement(
              transformation(extent={{18,66},{38,86}}), iconTransformation(
                extent={{-108,42},{-92,58}})));
        LungBloodFlow lungBloodFlow annotation(Placement(transformation(extent = {{-26, 74}, {-6, 94}})));
        PhysiolibraryOld.PressureFlow.FlowMeasure flowMeasure
          annotation (Placement(transformation(extent={{-42,-10},{-22,10}})));
        Modelica.Blocks.Math.Sum sum1(nin = 3) annotation(Placement(transformation(extent = {{-28, 28}, {-20, 36}})));
        Modelica.Blocks.Math.Sum sum2(nin = 2) annotation(Placement(transformation(extent = {{50, -38}, {42, -30}})));
      equation
        connect(pulmArty.referencePoint, pulmArtyConductance.q_in) annotation(Line(points = {{-76, 0}, {-61, 0}}, color = {0, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(pulmArty.ExternalPressure, busConnector.Thorax_AvePressure) annotation(Line(points = {{-76, 10}, {-76, 14}, {28, 14}, {28, 76}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(pulmCapys.ExternalPressure, busConnector.Thorax_AvePressure) annotation(Line(points = {{-12, 10}, {-12, 14}, {28, 14}, {28, 76}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(pulmVeins.ExternalPressure, busConnector.Thorax_AvePressure) annotation(Line(points = {{48, 10}, {48, 14}, {28, 14}, {28, 76}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(pulmArty.V0, ArtysV0.y) annotation(Line(points = {{-82, 10}, {-82, 20}, {-85.59999999999999, 20}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(pulmArty.Compliance, ArtysCompliance.y) annotation(Line(points = {{-70, 10}, {-70, 20}, {-62.4, 20}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(CapysV0.y, pulmCapys.V0) annotation(Line(points = {{-19.6, 20}, {-18, 20}, {-18, 10}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(CapysCompliance.y, pulmCapys.Compliance) annotation(Line(points = {{-4.4, 20}, {-6, 20}, {-6, 10}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(pulmCapys.referencePoint, pulmCapysConductance.q_in) annotation(Line(points = {{-12, 0}, {2, 0}}, color = {0, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(pulmCapysConductance.q_out, pulmVeins.referencePoint) annotation(Line(points = {{24, 0}, {48, 0}}, color = {0, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(pulmVeins.V0, VeinsV0.y) annotation(Line(points = {{42, 10}, {42, 20}, {38.4, 20}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(VeinsCompliance.y, pulmVeins.Compliance) annotation(Line(points = {{57.6, 18}, {54, 18}, {54, 10}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(pulmVeins.referencePoint, pulmVeinsConductance.q_in) annotation(Line(points = {{48, 0}, {62, 0}}, color = {0, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(lungBloodFlow.AlveolarVentilated, busConnector.AlveolarVentilated_BloodFlow) annotation(Line(points = {{-6, 90}, {28, 90}, {28, 76}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(pulmArtyConductance.q_out, flowMeasure.q_in) annotation(Line(points = {{-39, 0}, {-38, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(flowMeasure.q_out, pulmCapys.referencePoint) annotation(Line(points = {{-26, 0}, {-12, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(flowMeasure.actualFlow, lungBloodFlow.CardiacOutput) annotation(Line(points = {{-32, 5.4}, {-32, 90}, {-26, 90}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(ArtysV0.y, sum1.u[1]) annotation(Line(points={{-85.6,20},{-82,
                20},{-82,32},{-28,32},{-28,31.4667},{-28.8,31.4667}},                                                                                         color = {0, 0, 127}, smooth = Smooth.None));
        connect(CapysV0.y, sum1.u[2]) annotation(Line(points = {{-19.6, 20}, {-18, 20}, {-18, 26}, {-80, 26}, {-80, 32}, {-28.8, 32}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(VeinsV0.y, sum1.u[3]) annotation(Line(points={{38.4,20},{42,20},
                {42,26},{-78,26},{-78,32.5333},{-28.8,32.5333}},                                                                              color = {0, 0, 127}, smooth = Smooth.None));
        connect(pulmCapys.Vol, sum2.u[1]) annotation(Line(points = {{-16, -10}, {-16, -42}, {54, -42}, {54, -34.4}, {50.8, -34.4}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(pulmVeins.Vol, sum2.u[2]) annotation(Line(points = {{44, -10}, {44, -20}, {54, -20}, {54, -33.6}, {50.8, -33.6}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(pulmCapys.Pressure, busConnector.PulmCapys_Pressure) annotation(Line(points = {{-8, -10}, {-8, -20}, {28, -20}, {28, 76}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, -6}, {6, -6}}));
        connect(sum1.y, busConnector.PulmonaryCirculation_V0) annotation(Line(points = {{-19.6, 32}, {28, 32}, {28, 76}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(pulmArty.Vol, busConnector.PulmonaryCirculation_DeoxygenatedBloodVolume) annotation(Line(points = {{-80, -10}, {-80, -28}, {28, -28}, {28, 76}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, -16}, {6, -16}}));
        connect(busConnector.PulmonaryCirculation_OxygenatedBloodVolume, sum2.y) annotation(Line(points = {{28, 76}, {28, -34}, {41.6, -34}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(q_in, pulmArty.referencePoint) annotation(Line(points = {{-100, 0}, {-76, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(pulmVeinsConductance.q_out, q_out) annotation(Line(points = {{84, 0}, {100, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-108, -48}, {106, -70}}, lineColor=  {0, 0, 255}, textString=  "%name")}), Documentation(revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Design:</td>
                   <td>Zuzana Rubaninska</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>january 2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr>
                   </table>
                   </html>", info = "<html>
                   <p>Blood volume (and pressures) distribution between </p>
                   <p><ul>
                   <li>pulmonary arteries, </li>
                   <li>pulmonary veins and </li>
                   <li>pulmonary capilaries.</li>
                   </ul></p>
                   <p>Blood flow through ventilated alveoli.</p>
                   </html>"));
      end PulmonaryCirculation;

      model Heart
        extends PhysiolibraryOld.Icons.Heart;
        VascularElasticBloodCompartment RightAtrium(initialVol = 51.6454, stateName = "RightAtrium.Vol")
          "right atrium"                                                                                                annotation(Placement(transformation(extent = {{-75, -1}, {-55, 19}})));
        PhysiolibraryOld.Blocks.ComplianceConstant RightAtriumCompliance(k=12.5)
          annotation (Placement(transformation(extent={{-44,16},{-53,25}})));
        PhysiolibraryOld.Blocks.VolumeConstant RightAtriumV0(k=0)
          annotation (Placement(transformation(extent={{-84,20},{-76,28}})));
        heart.Ventricle3 rightVentricle(stiffnes = 1.0, n_Diastole = 2.0, n_Systole = 0.5, Abasic_Diastole = 0.00026, Abasic_Systole = 3.53, contractilityBasic = 1, K = 1, additionalPressure_Systolic = 9, BasicCompliance = 29.2, Cond1 = 60000000, Cond2 = 60000000, MaxContractionCompliance = 2, initialVol = 87.5, stateName = "RightVentricle.Vol") annotation(Placement(transformation(extent = {{-6, -46}, {-50, -2}})));
        VascularElasticBloodCompartment LeftAtrium(initialVol = 50.5035, stateName = "LeftAtrium.Vol")
          "left atrium"                                                                                              annotation(Placement(transformation(extent = {{46, -8}, {66, 12}})));
        PhysiolibraryOld.Blocks.VolumeConstant LeftAtriumV0(k=0)
          annotation (Placement(transformation(extent={{38,12},{46,20}})));
        PhysiolibraryOld.Blocks.ComplianceConstant LeftAtriumCompliance(k=6.25)
          annotation (Placement(transformation(extent={{76,14},{68,22}})));
        heart.Ventricle3 leftVentricle(stiffnes = 1, n_Diastole = 2, n_Systole = 0.5, Abasic_Diastole = 0.00051, Abasic_Systole = 17.39, additionalPressure_Systolic = 24, contractilityBasic = 1, K = 1, BasicCompliance = 14.6, MaxContractionCompliance = 0.4, Cond1 = 60000000, Cond2 = 60000000, initialVol = 87.5, stateName = "LeftVentricle.Vol") annotation(Placement(transformation(extent = {{12, -46}, {56, -2}})));
        PhysiolibraryOld.Interfaces.BusConnector busConnector
          "signals of organ bood flow resistence" annotation (Placement(
              transformation(extent={{-4,32},{16,52}}), iconTransformation(
                extent={{-108,-38},{-92,-22}})));
        PhysiolibraryOld.PressureFlow.PositivePressureFlow rightAtrium
          "blood inflow to right atrium" annotation (Placement(transformation(
                extent={{-102,-24},{-82,-4}}), iconTransformation(extent={{-66,
                  30},{-46,50}})));
        PhysiolibraryOld.PressureFlow.NegativePressureFlow fromRightVentricle
          "blood outflow to pulmonary circulation" annotation (Placement(
              transformation(extent={{-20,-12},{0,8}}), iconTransformation(
                extent={{-48,-38},{-28,-18}})));
        PhysiolibraryOld.PressureFlow.NegativePressureFlow fromLeftVentricle
          "blood outflow to aorta" annotation (Placement(transformation(extent=
                  {{6,-12},{26,8}}), iconTransformation(extent={{14,-38},{34,-18}})));
        PhysiolibraryOld.PressureFlow.PositivePressureFlow leftAtrium
          "blood inflow to left atrium" annotation (Placement(transformation(
                extent={{78,-24},{98,-4}}), iconTransformation(extent={{34,32},
                  {54,52}})));
        Modelica.Blocks.Math.Sum sum1(nin = 2) annotation(Placement(transformation(extent = {{-30, 52}, {-22, 60}})));
        Modelica.Blocks.Math.Sum sum3(nin = 2) annotation(Placement(transformation(extent = {{-56, -94}, {-48, -86}})));
        Modelica.Blocks.Math.Sum sum2(nin = 2) annotation(Placement(transformation(extent = {{-4, -4}, {4, 4}}, rotation = 180, origin = {70, -90})));
        Modelica.Blocks.Math.Feedback rightAtrium_TMP annotation(Placement(transformation(extent = {{-70, 34}, {-54, 50}})));
        Modelica.Blocks.Math.Feedback leftAtrium_TMP annotation(Placement(transformation(extent = {{64, 34}, {48, 50}})));
        Nerves.SA_Node SA_node annotation(Placement(transformation(extent = {{-18, 76}, {2, 96}})));
        Hormones.ANP atriopeptin annotation(Placement(transformation(extent = {{40, 70}, {60, 90}})));
      equation
        connect(RightAtrium.V0, RightAtriumV0.y) annotation(Line(points = {{-71, 19}, {-71, 24}, {-75.59999999999999, 24}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(RightAtrium.Compliance, RightAtriumCompliance.y) annotation(Line(points = {{-59, 19}, {-59, 20.5}, {-53.45, 20.5}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(RightAtrium.referencePoint, rightVentricle.q_in) annotation(Line(points = {{-65, 9}, {-66, 8}, {-32, 8}, {-32, -6.4}, {-32.4, -6.4}}, color = {0, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(busConnector.Pericardium_Pressure, RightAtrium.ExternalPressure) annotation(Line(points = {{6, 42}, {6, 26}, {-65, 26}, {-65, 19}}, color = {0, 0, 255}, thickness = 0.1, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{110, 10}, {110, 10}}));
        connect(busConnector, rightVentricle.busConnector) annotation(Line(points = {{6, 42}, {6, -37}, {-28, -37}, {-28, -35.88}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(LeftAtrium.V0, LeftAtriumV0.y) annotation(Line(points = {{50, 12}, {50, 16}, {46.4, 16}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(LeftAtrium.Compliance, LeftAtriumCompliance.y) annotation(Line(points = {{62, 12}, {62, 18}, {67.59999999999999, 18}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(LeftAtrium.referencePoint, leftVentricle.q_in) annotation(Line(points = {{56, 2}, {44, 2}, {44, -6.4}, {38.4, -6.4}}, color = {0, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(busConnector, leftVentricle.busConnector) annotation(Line(points = {{6, 42}, {6, -37}, {34, -37}, {34, -35.88}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.Pericardium_Pressure, LeftAtrium.ExternalPressure) annotation(Line(points = {{6, 42}, {6, 26}, {56, 26}, {56, 12}}, color = {0, 0, 255}, thickness = 0.1, smooth = Smooth.None));
        connect(rightAtrium, RightAtrium.referencePoint) annotation(Line(points = {{-92, -14}, {-92, 9}, {-65, 9}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(rightVentricle.q_out, fromRightVentricle) annotation(Line(points = {{-23.6, -2}, {-10, -2}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(leftVentricle.q_out, fromLeftVentricle) annotation(Line(points = {{29.6, -2}, {16, -2}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(LeftAtrium.referencePoint, leftAtrium) annotation(Line(points = {{56, 2}, {88, 2}, {88, -14}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(busConnector.CardiacOutput, leftVentricle.CO) annotation(Line(points = {{6, 42}, {6, -28}, {19.04, -28}, {19.04, -28.4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, -10}, {-6, -10}}));
        connect(RightAtrium.Pressure, busConnector.RightAtrium_Pressure) annotation(Line(points = {{-61, -1}, {-61, -68}, {6, -68}, {6, 42}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, -5}, {6, -5}}));
        connect(RightAtriumV0.y, sum1.u[1]) annotation(Line(points = {{-75.59999999999999, 24}, {-70, 24}, {-70, 30}, {-36, 30}, {-36, 56}, {-30.8, 55.6}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(LeftAtriumV0.y, sum1.u[2]) annotation(Line(points = {{46.4, 16}, {50, 16}, {50, 38}, {-36, 38}, {-36, 56.4}, {-30.8, 56.4}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(RightAtrium.Vol, sum3.u[1]) annotation(Line(points = {{-69, -1}, {-69, -90.40000000000001}, {-56.8, -90.40000000000001}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(rightVentricle.Vol, sum3.u[2]) annotation(Line(points = {{-36.8, -32.8}, {-34, -32.8}, {-34, -34}, {-68, -34}, {-68, -89.59999999999999}, {-56.8, -89.59999999999999}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(LeftAtrium.Vol, sum2.u[1]) annotation(Line(points = {{52, -8}, {52, -30}, {78, -30}, {78, -89.59999999999999}, {74.8, -89.59999999999999}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(leftVentricle.Vol, sum2.u[2]) annotation(Line(points = {{42.8, -32.8}, {42.8, -32}, {76, -32}, {76, -90.40000000000001}, {74.8, -90.40000000000001}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(LeftAtrium.Pressure, busConnector.LeftAtrium_Pressure) annotation(Line(points = {{60, -8}, {60, -68}, {6, -68}, {6, 42}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(sum3.y, busConnector.Heart_DeoxygenatedBloodVolume) annotation(Line(points = {{-47.6, -90}, {6, -90}, {6, 42}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(busConnector.Heart_OxygenatedBloodVolume, sum2.y) annotation(Line(points = {{6, 42}, {6, -90}, {65.59999999999999, -90}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(sum1.y, busConnector.Heart_V0) annotation(Line(points = {{-21.6, 56}, {6, 56}, {6, 42}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(RightAtrium.Pressure, rightAtrium_TMP.u1) annotation(Line(points = {{-61, -1}, {-61, -12}, {-86, -12}, {-86, 42}, {-68.40000000000001, 42}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(rightAtrium_TMP.u2, busConnector.Pericardium_Pressure) annotation(Line(points = {{-62, 35.6}, {-62, 32}, {6, 32}, {6, 42}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(LeftAtrium.Pressure, leftAtrium_TMP.u1) annotation(Line(points = {{60, -8}, {60, -12}, {80, -12}, {80, 42}, {62.4, 42}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.Pericardium_Pressure, leftAtrium_TMP.u2) annotation(Line(points = {{6, 42}, {6, 32}, {56, 32}, {56, 35.6}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(rightAtrium_TMP.y, busConnector.rightAtrium_TMP) annotation(Line(points = {{-54.8, 42}, {-24, 42}, {-24, 42}, {6, 42}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(leftAtrium_TMP.y, busConnector.leftAtrium_TMP) annotation(Line(points = {{48.8, 42}, {6, 42}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(SA_node.Rate, busConnector.HeartVentricleRate) annotation(Line(points = {{1.8, 86}, {6, 86}, {6, 42}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(busConnector.BetaPool_Effect, SA_node.BetaPool_Effect) annotation(Line(points = {{6, 42}, {-52, 42}, {-52, 92}, {-18, 92}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.BetaBlocade_Effect, SA_node.BetaBlockade_Effect) annotation(Line(points = {{6, 42}, {-52, 42}, {-52, 88}, {-18, 88}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.VagusNerve_NA_Hz, SA_node.VagusNerve_NA_Hz) annotation(Line(points = {{6, 42}, {-52, 42}, {-52, 80}, {-18, 80}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.GangliaGeneral_NA, SA_node.GangliaGeneral_NA) annotation(Line(points = {{6, 42}, {-52, 42}, {-52, 84}, {-18, 84}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector, atriopeptin.busConnector) annotation(Line(points = {{6, 42}, {34, 42}, {34, 74}, {42, 74}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-164, -60}, {156, -88}}, lineColor=  {0, 0, 255}, textString=  "%name")}), Documentation(info = "<html>
                   <p>Calculates hearth pumping (left and right atria and ventricles, as wel as coronary circulation). By pressure-flow connectors communicate with pulmonary and systemic circulation.</p>
                   <p>Blood volume (and pressure) distributions between </p>
                   <p><ul>
                   <li>right/left atrium and</li>
                   <li>right/left ventricle.</li>
                   </ul></p>
                   <p>Generate average blood flow throught ventricles.</p>
                   <p>On the contrary of Tom Coleman models: coronary circulation outflows to right atrium, average blood volume in the hearth are calculated more simple (with the same results in steady state).</p>
                   </html>", revisions = "<html>
                   <table cellspacing=\"2\" cellpadding=\"0\" border=\"0\"><tr>
                   <td><p>Author:</p></td>
                   <td><p>Marek Matejak, Jiri Kofranek</p></td>
                   </tr>
                   <tr>
                   <td><p>Design:</p></td>
                   <td><p>Zuzana Rubaninska</p></td>
                   </tr>
                   <tr>
                   <td><p>Copyright:</p></td>
                   <td><p>In public domains</p></td>
                   </tr>
                   <tr>
                   <td><p>By:</p></td>
                   <td><p>Charles University, Prague</p></td>
                   </tr>
                   <tr>
                   <td><p>Date of:</p></td>
                   <td><p>january 2009, August 2010</p></td>
                   </tr>
                   <tr>
                   <td><p>References:</p></td>
                   <td><p>Tom Coleman: QHP 2008 beta 3,, HumMod 2010, University of Mississippi Medical Center</p></td>
                   </tr>
                   </table>
                   </html>"));
      end Heart;

      model SystemicCirculationFullDynamic
        extends PhysiolibraryOld.PressureFlow.ResistorBase2;
        extends PhysiolibraryOld.Icons.SystemicCirculation;
        /*
                                                                                                                                                          Library.PressureFlow.NegativePressureFlow fromSystemicVeins annotation (
                                                                                                                                                              Placement(transformation(extent={{-110,-10},{-90,10}}),iconTransformation(
                                                                                                                                                                  extent={{-112,44},{-92,64}})));
                                                                                                                                                          Library.PressureFlow.PositivePressureFlow systemicArteries 
                                                                                                                                                            annotation (Placement(transformation(extent={{88,-10},{108,10}}),
                                                                                                                                                                iconTransformation(extent={{90,46},{110,66}})));
                                                                                                                                                        */
        VascularElasticBloodCompartment systemicArtys(initialVol = 1000.36, stateName = "SystemicArtys.Vol") annotation(Placement(transformation(extent = {{65, -10}, {86, 11}})));
        PhysiolibraryOld.Blocks.Constant V0_artys(k=850)
          annotation (Placement(transformation(extent={{98,18},{88,28}})));
        PhysiolibraryOld.Blocks.ComplianceConstant SystemicVeinsCompliance(k=
              88.59999999999999)
          annotation (Placement(transformation(extent={{-27,10},{-35,18}})));
        OrganFlow.PeripheralFlow peripheral annotation(Placement(transformation(extent = {{-2, -14}, {26, 14}})));
        PhysiolibraryOld.PressureFlow.InputPump volumeCorrections
          annotation (Placement(transformation(extent={{-28,24},{-42,38}})));
        OrganFlow.SystemicVeins veins(BaseConductance = 856)
          "scaled to coronary vessels reorganisation"                                                    annotation(Placement(transformation(extent = {{-72, -8}, {-56, 8}})));
        SystemicVeinsElacticBloodCompartment systemicVeinsElacticBloodCompartment annotation(Placement(transformation(extent = {{-54, -10}, {-34, 10}})));
        PhysiolibraryOld.Blocks.PressureConstant SystemicArtysExternalPressure(
            k=0)
          annotation (Placement(transformation(extent={{86,14},{79,21}})));
        PhysiolibraryOld.Blocks.PressureConstant SystemicVeinsExternalPressure(
            k=0)
          annotation (Placement(transformation(extent={{-36,16},{-43,23}})));
        PhysiolibraryOld.Interfaces.BusConnector busConnector
          "signals of organ bood flow resistence" annotation (Placement(
              transformation(extent={{36,40},{56,60}}), iconTransformation(
                extent={{-110,32},{-94,48}})));
        PhysiolibraryOld.Blocks.ComplianceConstant SystemicArtysCompliance(k=
              1.55)
          annotation (Placement(transformation(extent={{96,8},{89,15}})));
        OrganFlow.CollapsingVeins collapsedVeins annotation(Placement(transformation(extent = {{-10, 10.5}, {10, -10.5}}, rotation = 180, origin = {-84.5, 0})));
        PhysiolibraryOld.PressureFlow.GravityHydrostaticDifference
          gravityHydrostaticDifference annotation (Placement(transformation(
              extent={{-10,-10},{10,10}},
              rotation=0,
              origin={61,35})));
        PhysiolibraryOld.PressureFlow.PressureMeasure pressureMeasure
          annotation (Placement(transformation(
              extent={{8.5,-8.5},{-8.5,8.5}},
              rotation=0,
              origin={78.5,45.5})));
        Modelica.Blocks.Math.Gain G(k = 9.81) annotation(Placement(transformation(extent = {{4, -4}, {-4, 4}}, rotation = 90, origin = {34, 26})));
        OrganFlow.LeftHeart leftCororaryCirculation(BasicLargeVeselsConductance = 50 * 0.9367710946995053, BasicSmallVeselsConductance = 2.2 * 0.9367710946995053)
          "scaled to normal pressure gradient 94 mmHg"                                                                                                     annotation(Placement(transformation(extent = {{-10, 76}, {10, 96}})));
        OrganFlow.RightHeart rightCororaryCirculation(BasicLargeVeselsConductance = 10 * 0.9367710946995053, BasicSmallVeselsConductance = 0.4 * 0.9367710946995053)
          "scaled to normal pressure gradient 94 mmHg"                                                                                                     annotation(Placement(transformation(extent = {{-42, 62}, {-22, 82}})));
        OrganFlow.SplanchnicCirculation splanchnicCirculation annotation(Placement(transformation(extent = {{-8, -44}, {30, -6}})));
        PhysiolibraryOld.PressureFlow.ResistorWithCondParam legsArtys(cond=40)
          annotation (Placement(transformation(extent={{80,-86},{64,-70}})));
        PhysiolibraryOld.Blocks.PressureConstant const8(k=0)
          annotation (Placement(transformation(extent={{93,-68},{86,-61}})));
        PhysiolibraryOld.PressureFlow.GravityHydrostaticDifference
          hydrostaticDifference annotation (Placement(transformation(
              extent={{-10,-10},{10,10}},
              rotation=0,
              origin={54,-72})));
        SequesteredBlood sequesteredBlood(data = {{0, 0, 10 ^ (-10)}, {50, 97, 1.0}, {200, 150, 0.5}}, initialVol = 50.0044, pressureControledCompartment(stateName = "BVSeqArtys.Vol")) annotation(Placement(transformation(extent = {{80, -88}, {100, -68}})));
        SequesteredBlood sequesteredBlood1(data = {{0, -100, 2.0}, {150, 11, 0.11}, {600, 50, 0.15}}, initialVol = 120.691, pressureControledCompartment(stateName = "BVSeqVeins.Vol")) annotation(Placement(transformation(extent = {{-62, -82}, {-44, -64}})));
        PhysiolibraryOld.PressureFlow.ResistorWithCondParam legsVeins(cond=100)
          annotation (Placement(transformation(extent={{-42,-80},{-28,-66}})));
        PhysiolibraryOld.PressureFlow.GravityHydrostaticDifferenceWithPumpEffect
          hydrostaticDifference1
          annotation (Placement(transformation(extent={{-5,-78},{-25,-58}})));
        PhysiolibraryOld.Blocks.PressureConstant const12(k=0)
          annotation (Placement(transformation(extent={{-52,-60},{-59,-53}})));
      equation
        connect(systemicArtys.Compliance, SystemicArtysCompliance.y) annotation(Line(points = {{81.8, 11}, {81.8, 11.5}, {88.65000000000001, 11.5}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(systemicArtys.V0, V0_artys.y) annotation(Line(points = {{69.2, 11}, {69.2, 23}, {87.5, 23}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector, peripheral.busConnector) annotation(Line(points = {{46, 50}, {46, 2.66}, {21.66, 2.66}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(veins.busConnector, busConnector) annotation(Line(points = {{-58.48, 1.52}, {-60, 1.52}, {-60, 50}, {46, 50}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(SystemicVeinsCompliance.y, systemicVeinsElacticBloodCompartment.Compliance) annotation(Line(points = {{-35.4, 14}, {-38.2, 14}, {-38.2, 10}, {-38, 10}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector, systemicVeinsElacticBloodCompartment.busConnector) annotation(Line(points = {{46, 50}, {-26, 50}, {-26, 6.1}, {-34.2, 6.1}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(systemicVeinsElacticBloodCompartment.referencePoint, volumeCorrections.q_out) annotation(Line(points = {{-44, 0}, {-46, 0}, {-46, 31.7}, {-42, 31.7}}, color = {0, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(systemicArtys.ExternalPressure, SystemicArtysExternalPressure.y) annotation(Line(points = {{75.5, 11}, {75.5, 17.5}, {78.65000000000001, 17.5}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(systemicVeinsElacticBloodCompartment.ExternalPressure, SystemicVeinsExternalPressure.y) annotation(Line(points = {{-44, 10}, {-44, 19.5}, {-43.35, 19.5}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.BloodVolume_change, volumeCorrections.desiredFlow) annotation(Line(points = {{46, 50}, {-35, 50}, {-35, 35.2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(systemicArtys.Compliance, SystemicArtysCompliance.y) annotation(Line(points = {{81.8, 11}, {81.8, 11.5}, {88.65000000000001, 11.5}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(collapsedVeins.ExternalPressure, busConnector.Thorax_AvePressure) annotation(Line(points = {{-90.5, 2.1}, {-90, 2.1}, {-90, 50}, {46, 50}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(pressureMeasure.actualPressure, busConnector.CarotidSinus_Pressure) annotation(Line(points = {{74.08, 43.8}, {46, 43.8}, {46, 50}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(gravityHydrostaticDifference.height, busConnector.CarotidSinusHeight) annotation(Line(points = {{54.9, 34.5}, {46, 32}, {46, 50}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(gravityHydrostaticDifference.q_down, systemicArtys.referencePoint) annotation(Line(points = {{68, 29.4}, {68, 0.5}, {75.5, 0.5}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(systemicArtys.Pressure, busConnector.SystemicArtys_Pressure) annotation(Line(points = {{79.7, -10}, {80, -10}, {80, -28}, {46, -28}, {46, 50}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, -3}, {3, -3}}));
        connect(gravityHydrostaticDifference.q_up, pressureMeasure.q_in) annotation(Line(points = {{68.2, 39.8}, {80, 39.8}, {80, 42.1}, {80.2, 42.1}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(pressureMeasure.actualPressure, busConnector.CarotidSinusArteryPressure) annotation(Line(points = {{74.08, 43.8}, {46, 43.8}, {46, 50}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(systemicVeinsElacticBloodCompartment.Pressure, busConnector.SystemicVeins_Pressure) annotation(Line(points = {{-40, -10}, {-40, -28}, {46, -28}, {46, 50}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(systemicVeinsElacticBloodCompartment.V0, busConnector.SystemicVeins_V0) annotation(Line(points = {{-50.8, 10}, {-50.8, 50}, {46, 50}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(V0_artys.y, busConnector.SystemicArtys_V0) annotation(Line(points = {{87.5, 23}, {70, 23}, {70, 22}, {46, 22}, {46, 50}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(q_in, systemicArtys.referencePoint) annotation(Line(points = {{100, 0}, {99.75, 0}, {99.75, 0.5}, {75.5, 0.5}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(collapsedVeins.q_out, q_out) annotation(Line(points = {{-94.5, 1.22465e-015}, {-96.25, 1.22465e-015}, {-96.25, 0}, {-100, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(busConnector.Gravity_Gz, G.u) annotation(Line(points = {{46, 50}, {46, 38}, {34, 38}, {34, 30.8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(G.y, gravityHydrostaticDifference.G) annotation(Line(points = {{34, 21.6}, {34, 16}, {62.5, 16}, {62.5, 26.5}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(rightCororaryCirculation.busConnector, busConnector) annotation(Line(points = {{-25.1, 73.90000000000001}, {46, 73.90000000000001}, {46, 50}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(leftCororaryCirculation.busConnector, busConnector) annotation(Line(points = {{6.9, 87.90000000000001}, {46, 87.90000000000001}, {46, 50}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(leftCororaryCirculation.BloodFlow, busConnector.leftHeart_BloodFlow) annotation(Line(points = {{7, 84}, {46, 84}, {46, 50}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(rightCororaryCirculation.BloodFlow, busConnector.rightHeart_BloodFlow) annotation(Line(points = {{-25, 70}, {22, 70}, {22, 50}, {46, 50}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(leftCororaryCirculation.BloodFlow, busConnector.LeftHeart_BloodFlow) annotation(Line(points = {{7, 84}, {46, 84}, {46, 50}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(rightCororaryCirculation.BloodFlow, busConnector.RightHeart_BloodFlow) annotation(Line(points = {{-25, 70}, {22, 70}, {22, 50}, {46, 50}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(splanchnicCirculation.busConnector, busConnector) annotation(Line(points = {{-8, -15.5}, {-8, 50}, {46, 50}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(splanchnicCirculation.q_in, systemicArtys.referencePoint) annotation(Line(points = {{30, -25}, {62, -25}, {62, 0.5}, {75.5, 0.5}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(splanchnicCirculation.q_out, systemicVeinsElacticBloodCompartment.referencePoint) annotation(Line(points = {{-8, -25}, {-22, -25}, {-22, 0}, {-44, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(peripheral.q_in, systemicArtys.referencePoint) annotation(Line(points = {{26, 1.77636e-015}, {52, 1.77636e-015}, {52, 0.5}, {75.5, 0.5}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(peripheral.q_out, systemicVeinsElacticBloodCompartment.referencePoint) annotation(Line(points = {{-2, 1.77636e-015}, {-24, 1.77636e-015}, {-24, 0}, {-44, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(rightCororaryCirculation.q_out, q_out) annotation(Line(points = {{-42, 72}, {-60, 72}, {-60, 86}, {-100, 86}, {-100, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(leftCororaryCirculation.q_out, q_out) annotation(Line(points = {{-10, 86}, {-100, 86}, {-100, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(leftCororaryCirculation.q_in, q_in) annotation(Line(points = {{10, 86}, {100, 86}, {100, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(systemicVeinsElacticBloodCompartment.referencePoint, veins.q_in) annotation(Line(points = {{-44, 0}, {-56, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(veins.q_out, collapsedVeins.q_in) annotation(Line(points = {{-72, 0}, {-73.25, 0}, {-73.25, -1.22465e-015}, {-74.5, -1.22465e-015}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(rightCororaryCirculation.q_in, q_in) annotation(Line(points = {{-22, 72}, {36, 72}, {36, 86}, {100, 86}, {100, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(legsArtys.q_in, sequesteredBlood.referencePoint) annotation(Line(points = {{80, -78}, {90, -78}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(sequesteredBlood.ExternalPressure, const8.y) annotation(Line(points = {{81, -68}, {81, -64.5}, {85.65000000000001, -64.5}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(legsArtys.q_out, hydrostaticDifference.q_down) annotation(Line(points = {{64, -78}, {63.5, -78}, {63.5, -77.59999999999999}, {61, -77.59999999999999}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(hydrostaticDifference.q_up, systemicArtys.referencePoint) annotation(Line(points = {{61.2, -67.2}, {62, -56}, {62, 0}, {75.5, 0}, {75.5, 0.5}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(sequesteredBlood1.ExternalPressure, const12.y) annotation(Line(points = {{-61.1, -64}, {-61.1, -56.5}, {-59.35, -56.5}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(sequesteredBlood1.referencePoint, legsVeins.q_in) annotation(Line(points = {{-53, -73}, {-42, -73}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(legsVeins.q_out, hydrostaticDifference1.q_down) annotation(Line(points = {{-28, -73}, {-28, -73.40000000000001}, {-22, -73.40000000000001}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(hydrostaticDifference1.q_up, systemicVeinsElacticBloodCompartment.referencePoint) annotation(Line(points = {{-22.2, -63.2}, {-22.2, 0}, {-44, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(hydrostaticDifference1.height, busConnector.LowerTorsoVeinHeight) annotation(Line(points = {{-8.9, -68.3}, {46, -68.3}, {46, 50}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(hydrostaticDifference1.pumpEffect, busConnector.Exercise_MusclePump_Effect) annotation(Line(points = {{-13.5, -58.5}, {46, -58.5}, {46, 50}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(hydrostaticDifference.height, busConnector.LowerTorsoArtyHeight) annotation(Line(points = {{47.9, -72.5}, {46, -72.5}, {46, 50}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(sequesteredBlood1.Vol, busConnector.LegVeins_DeoxygenatedBloodVolume) annotation(Line(points = {{-56.6, -82}, {-58, -82}, {-58, -90}, {46, -90}, {46, 50}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(sequesteredBlood.Vol, busConnector.LegArtys_OxygenatedBloodVolume) annotation(Line(points = {{86, -88}, {86, -90}, {46, -90}, {46, 50}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(G.y, hydrostaticDifference1.G) annotation(Line(points = {{34, 21.6}, {34, -90}, {-16.5, -90}, {-16.5, -76.5}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(G.y, hydrostaticDifference.G) annotation(Line(points = {{34, 21.6}, {34, -90}, {55.5, -90}, {55.5, -80.5}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(systemicArtys.Vol, busConnector.SystemicArtys_OxygenatedBloodVolume) annotation(Line(points = {{71.3, -10}, {72, -10}, {72, -28}, {46, -28}, {46, 50}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(systemicVeinsElacticBloodCompartment.Vol, busConnector.SystemicVeins_DeoxygenatedBloodVolume) annotation(Line(points = {{-48, -10}, {-48, -28}, {46, -28}, {46, 50}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{42, 46}, {74, 46}}, lineColor=  {0, 0, 255}, textString=  "Carotid Artery Pressure")}), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-100, -10}, {100, -34}}, lineColor=  {0, 0, 255}, textString=  "%name"), Text(extent=  {{-104, -54}, {110, -76}}, lineColor=  {0, 0, 255}, textString=  "%name")}), Documentation(revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Design:</td>
                   <td>Zuzana Rubaninska</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>january 2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr>
                   </table>
                   </html>", info = "<html>
                   <p>Blood volume (and pressure) distributions between </p>
                   <p><ul>
                   <li>systemic arteries, </li>
                   <li>systemic veins and</li>
                   <li>portal (splanchnic) vein.</li>
                   </ul></p>
                   <p>Blood flow throught: </p>
                   <p><ul>
                   <li>GIT, hepatic artery, liver</li>
                   <li>Kidney</li>
                   <li>CNS</li>
                   <li>Skeletal muscle</li>
                   <li>Respiratory muscle</li>
                   <li>Skin</li>
                   <li>Bones</li>
                   <li>Adipose tissue</li>
                   <li>Other tissue</li>
                   </ul></p>
                   </html>"));
      end SystemicCirculationFullDynamic;
      annotation(Documentation(revisions = "<html>
                   </html>"));
    end VascularCompartments;

    package OrganFlow "Tissue vessels hydraulic conductance (=1/resistance)"
      package ConductanceFactors
        "Multiplication factors on conductance (=1/resistance)"
        model HeartInfraction
          extends PhysiolibraryOld.Interfaces.BaseFactorIcon;
          parameter Real DamagedArea_percent = 0;
          PhysiolibraryOld.Blocks.Constant Constant0(k=DamagedArea_percent)
            annotation (Placement(transformation(extent={{-94,-12},{-74,8}})));
          PhysiolibraryOld.Blocks.Constant Constant1(k=1)
            annotation (Placement(transformation(extent={{-60,6},{-40,26}})));
          PhysiolibraryOld.Blocks.Constant Constant2(k=100) annotation (
              Placement(transformation(extent={{-94,-38},{-74,-18}})));
          Modelica.Blocks.Math.Division division annotation(Placement(transformation(extent = {{-60, -24}, {-40, -4}})));
          Modelica.Blocks.Math.Feedback feedback annotation(Placement(transformation(extent = {{-32, 6}, {-12, 26}})));
          Modelica.Blocks.Math.Product product annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 270, origin = {0, -30})));
        equation
          connect(product.y, y) annotation(Line(points = {{-2.02067e-015, -41}, {-2.02067e-015, -52.5}, {0, -52.5}, {0, -60}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(product.u1, yBase) annotation(Line(points = {{6, -18}, {6, -18}, {6, 80}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(feedback.y, product.u2) annotation(Line(points = {{-13, 16}, {-6, 16}, {-6, -18}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(Constant0.y, division.u1) annotation(Line(points = {{-73, -2}, {-68, -2}, {-68, -8}, {-62, -8}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(Constant2.y, division.u2) annotation(Line(points = {{-73, -28}, {-68, -28}, {-68, -20}, {-62, -20}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(Constant1.y, feedback.u1) annotation(Line(points = {{-39, 16}, {-30, 16}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(division.y, feedback.u2) annotation(Line(points = {{-39, -14}, {-22, -14}, {-22, 8}}, color = {0, 0, 127}, smooth = Smooth.None));
        end HeartInfraction;

        model MetabolicVasolidation2
          extends PhysiolibraryOld.Interfaces.BaseFactorIcon5;
          PhysiolibraryOld.Interfaces.RealInput_ O2Need annotation (Placement(
                transformation(extent={{-110,60},{-82,88}}), iconTransformation(
                  extent={{-108,-10},{-88,10}})));
          parameter Real[:, 3] data = {{50, 1.0, 0}, {1000, 3.5, 0.003}, {3000, 5.5, 0}};
          parameter Real OnTau = 0.2;
          parameter Real OffTau = 1;
          parameter Real initialEffectValue = 1;
          parameter String stateName;
          PhysiolibraryOld.Curves.Curve SteadyState(
            x=data[:, 1],
            y=data[:, 2],
            slope=data[:, 3])
            annotation (Placement(transformation(extent={{-72,64},{-52,84}})));
          PhysiolibraryOld.Blocks.Integrator effect(
            y_start=initialEffectValue,
            k=1/PhysiolibraryOld.SecPerMin,
            stateName=stateName) annotation (Placement(transformation(
                extent={{-10,-10},{10,10}},
                rotation=270,
                origin={-20,-14})));
          Modelica.Blocks.Math.Feedback feedback annotation(Placement(transformation(extent = {{-8, -12}, {12, -32}}, rotation = 270, origin = {8, 64})));
          Modelica.Blocks.Math.Product product annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 270, origin = {0, -46})));
          Modelica.Blocks.Math.Product product1 annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 270, origin = {-20, 16})));
          Modelica.Blocks.Logical.Switch switch1(u2(start = false)) annotation(Placement(transformation(extent = {{-54, 24}, {-34, 44}})));
          Modelica.Blocks.Logical.GreaterThreshold greaterThreshold annotation(Placement(transformation(extent = {{-72, 30}, {-64, 38}})));
          PhysiolibraryOld.Blocks.Inv OnK annotation (Placement(transformation(
                extent={{-10,-10},{10,10}},
                rotation=90,
                origin={-86,8})));
          PhysiolibraryOld.Blocks.Inv OffK annotation (Placement(transformation(
                extent={{-10,-10},{10,10}},
                rotation=90,
                origin={-60,8})));
          PhysiolibraryOld.Blocks.Constant Constant0(k=OnTau) annotation (
              Placement(transformation(
                extent={{-10,-10},{10,10}},
                rotation=90,
                origin={-86,-22})));
          PhysiolibraryOld.Blocks.Constant Constant1(k=OffTau) annotation (
              Placement(transformation(
                extent={{-10,-10},{10,10}},
                rotation=90,
                origin={-60,-22})));
        equation
          connect(SteadyState.val, feedback.u1) annotation(Line(points = {{-51.8, 74}, {-14, 74}, {-14, 70}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(effect.y, feedback.u2) annotation(Line(points = {{-20, -25}, {-20, -28}, {-2, -28}, {-2, 62}, {-6, 62}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(SteadyState.u, O2Need) annotation(Line(points = {{-72, 74}, {-96, 74}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(product.u2, effect.y) annotation(Line(points = {{-6, -34}, {-6, -28}, {-20, -28}, {-20, -25}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(product.u1, yBase) annotation(Line(points = {{6, -34}, {6, 80}, {6, 80}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(product.y, y) annotation(Line(points = {{-2.02067e-015, -57}, {-2.02067e-015, -61.5}, {0, -61.5}, {0, -60}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(product1.y, effect.u) annotation(Line(points = {{-20, 5}, {-20, 3.25}, {-20, 3.25}, {-20, 1.5}, {-20, -2}, {-20, -2}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(product1.u1, feedback.y) annotation(Line(points = {{-14, 28}, {-14, 34.25}, {-14, 34.25}, {-14, 40.5}, {-14, 53}, {-14, 53}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(switch1.y, product1.u2) annotation(Line(points = {{-33, 34}, {-26, 34}, {-26, 28}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(greaterThreshold.u, feedback.y) annotation(Line(points = {{-72.8, 34}, {-76, 34}, {-76, 50}, {-14, 50}, {-14, 53}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(greaterThreshold.y, switch1.u2) annotation(Line(points = {{-63.6, 34}, {-56, 34}}, color = {255, 0, 255}, smooth = Smooth.None));
          connect(OnK.y, switch1.u1) annotation(Line(points = {{-86, 19}, {-86, 42}, {-56, 42}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(OffK.y, switch1.u3) annotation(Line(points = {{-60, 19}, {-60, 26}, {-56, 26}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(Constant1.y, OffK.u) annotation(Line(points = {{-60, -11}, {-60, -4}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(Constant0.y, OnK.u) annotation(Line(points = {{-86, -11}, {-86, -4}}, color = {0, 0, 127}, smooth = Smooth.None));
          annotation(Icon(graphics), Diagram(graphics));
        end MetabolicVasolidation2;
      end ConductanceFactors;

      model CollapsingVeins
        extends PhysiolibraryOld.PressureFlow.Resistor;
        PhysiolibraryOld.Interfaces.RealInput_ ExternalPressure annotation (
            Placement(transformation(extent={{40,0},{80,40}}),
              iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=270,
              origin={60,20})));
        parameter Real PR1LL(final quantity = "Pressure", final unit = "mmHg") = 0
          "start-collapsing sucking pressure, when external pressure is zero";
      equation
        q_in.pressure = if q_out.pressure > PR1LL + ExternalPressure then q_out.pressure else PR1LL + ExternalPressure;
        annotation(Icon(graphics={  Rectangle(extent=  {{-100, 38}, {100, -40}}, lineColor=  {255, 255, 255}, fillColor=  {255, 255, 255},
                  fillPattern=                                                                                                    FillPattern.Solid), Text(extent=  {{-64, 10}, {56, -16}}, lineColor=  {0, 0, 255}, textString=  "%name"), Bitmap(extent=  {{-100, 100}, {100, -100}}, fileName=  "icons/kolaps.png")}));
      end CollapsingVeins;

      partial model Base
        extends PhysiolibraryOld.PressureFlow.ResistorBase;
        PhysiolibraryOld.Interfaces.BusConnector busConnector
          "signals of organ bood flow resistence" annotation (Placement(
              transformation(extent={{-100,80},{-80,100}}), iconTransformation(
                extent={{60,10},{78,28}})));
        PhysiolibraryOld.Interfaces.RealOutput_ BloodFlow annotation (Placement(
              transformation(extent={{-92,8},{-82,18}}), iconTransformation(
                extent={{60,-30},{80,-10}})));
        PhysiolibraryOld.PressureFlow.FlowMeasure flowMeasure annotation (
            Placement(transformation(
              extent={{-10,-10},{10,10}},
              rotation=0,
              origin={-88,0})));
      equation
        connect(q_in, flowMeasure.q_in) annotation(Line(points = {{-100, 0}, {-94, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(flowMeasure.actualFlow, BloodFlow) annotation(Line(points = {{-88, 5.4}, {-88, 14}, {-87, 14}, {-87, 13}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Documentation(info = "<HTML>
                   <PRE>
                   Blood flow variable resistor abstract model.
                   </PRE>
                   </HTML>
                   ", revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>2009</td>
                   </tr>
                   </table>
                   </html>"), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics={  Polygon(points=  {{14, 9}, {-14, 1}, {14, -9}, {14, -1}, {14, 9}}, lineColor=  {135, 135, 135}, smooth=  Smooth.None, fillColor=  {175, 175, 175},
                  fillPattern=                                                                                                    FillPattern.Solid, origin=  {34, -61}, rotation=  180), Rectangle(extent=  {{-34, -60}, {20, -62}}, lineColor=  {135, 135, 135},
                  fillPattern=                                                                                                    FillPattern.Solid, fillColor=  {175, 175, 175}), Bitmap(extent=  {{-178, 110}, {158, -104}}, fileName=  "icons/perfusion.png")}));
      end Base;

      partial model BaseBadDirection
        extends PhysiolibraryOld.PressureFlow.ResistorBase2;
        PhysiolibraryOld.Interfaces.BusConnector busConnector
          "signals of organ bood flow resistence" annotation (Placement(
              transformation(extent={{-100,80},{-80,100}}), iconTransformation(
                extent={{60,10},{78,28}})));
        PhysiolibraryOld.Interfaces.RealOutput_ BloodFlow(start=1000)
          annotation (Placement(transformation(extent={{84,6},{96,18}}),
              iconTransformation(extent={{60,-30},{80,-10}})));
        PhysiolibraryOld.PressureFlow.FlowMeasure flowMeasure annotation (
            Placement(transformation(
              extent={{10,-10},{-10,10}},
              rotation=0,
              origin={88,0})));
      equation
        connect(flowMeasure.actualFlow, BloodFlow) annotation(Line(points = {{88, 5.4}, {88, 12}, {90, 12}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(flowMeasure.q_in, q_in) annotation(Line(points = {{94, 0}, {100, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        annotation(Documentation(info = "<HTML>
                     <PRE>
                     Blood flow variable resistor abstract model.
                     </PRE>
                     </HTML>
                     ", revisions = "<html>
                     <table>
                     <tr>
                     <td>Author:</td>
                     <td>Marek Matejak</td>
                     </tr>
                     <tr>
                     <td>Copyright:</td>
                     <td>In public domains</td>
                     </tr>
                     <tr>
                     <td>By:</td>
                     <td>Charles University, Prague</td>
                     </tr>
                     <tr>
                     <td>Date of:</td>
                     <td>2009</td>
                     </tr>
                     </table>
                     </html>"), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(graphics={  Text(extent=  {{-70, -20}, {70, 20}}, textString=  "%name", lineColor=  {0, 0, 255}), Polygon(points=  {{-18, -52}, {-46, -60}, {-18, -70}, {-18, -62}, {-18, -52}}, lineColor=  {135, 135, 135}, smooth=  Smooth.None, fillColor=  {175, 175, 175},
                  fillPattern=                                                                                                    FillPattern.Solid), Rectangle(extent=  {{-18, -60}, {36, -62}}, lineColor=  {135, 135, 135},
                  fillPattern=                                                                                                    FillPattern.Solid, fillColor=  {175, 175, 175}), Bitmap(extent=  {{-162, 100}, {174, -114}}, fileName=  "icons/perfusion2.png")}));
      end BaseBadDirection;

      model SystemicVeins
        //extends QHP.Blood.OrganFlow.BaseBadDirection;
        extends PhysiolibraryOld.PressureFlow.ResistorBase2;
        PhysiolibraryOld.PressureFlow.ResistorWithCond systemicVeinsConductance
          annotation (Placement(transformation(extent={{0,-10},{-20,10}})));
        PhysiolibraryOld.Factors.SimpleMultiply ViscosityEffect
          annotation (Placement(transformation(extent={{-20,0},{0,20}})));
        PhysiolibraryOld.Factors.SimpleMultiply ExerciseEffect
          annotation (Placement(transformation(extent={{-20,7},{0,27}})));
        PhysiolibraryOld.Factors.SimpleMultiply CollapseEffect
          annotation (Placement(transformation(extent={{-20,14},{0,34}})));
        PhysiolibraryOld.Blocks.CondConstant const12(k=BaseConductance)
          annotation (Placement(transformation(extent={{-27,45},{-15,57}})));
        parameter Real BaseConductance(final quantity = "Conductance", final unit = "ml/(min.mmHg)") = 692;
        PhysiolibraryOld.PressureFlow.FlowMeasure flowMeasure annotation (
            Placement(transformation(
              extent={{10,-10},{-10,10}},
              rotation=0,
              origin={80,0})));
        PhysiolibraryOld.Interfaces.RealOutput_ BloodFlow annotation (Placement(
              transformation(extent={{76,6},{88,18}}), iconTransformation(
                extent={{60,-30},{80,-10}})));
        PhysiolibraryOld.Interfaces.BusConnector busConnector
          "signals of organ bood flow resistence" annotation (Placement(
              transformation(extent={{-96,77},{-76,97}}), iconTransformation(
                extent={{60,10},{78,28}})));
      equation
        connect(systemicVeinsConductance.cond, ViscosityEffect.y) annotation(Line(points = {{-10, 4}, {-10, 8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(ViscosityEffect.yBase, ExerciseEffect.y) annotation(Line(points = {{-10, 12}, {-10, 15}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(ExerciseEffect.yBase, CollapseEffect.y) annotation(Line(points = {{-10, 19}, {-10, 19.5}, {-10.2, 19.5}, {-10.2, 20}, {-10, 20}, {-10, 22}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.Viscosity_ConductanceEffect, ViscosityEffect.u) annotation(Line(points = {{-86, 87}, {-86, 10}, {-19.8, 10}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.Exercise_MusclePump_Effect, ExerciseEffect.u) annotation(Line(points = {{-86, 87}, {-86, 17}, {-19.8, 17}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.BloodVol_CollapsedEffect, CollapseEffect.u) annotation(Line(points = {{-86, 87}, {-86, 24}, {-19.8, 24}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(const12.y, CollapseEffect.yBase) annotation(Line(points = {{-14.4, 51}, {-10, 51}, {-10, 26}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(flowMeasure.actualFlow, BloodFlow) annotation(Line(points = {{80, 5.4}, {80, 12}, {82, 12}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(flowMeasure.q_in, q_in) annotation(Line(points = {{86, 0}, {100, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(flowMeasure.q_out, systemicVeinsConductance.q_in) annotation(Line(points = {{74, 0}, {0, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(systemicVeinsConductance.q_out, q_out) annotation(Line(points = {{-20, 0}, {-100, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}, grid = {1, 1}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}, grid = {1, 1}), graphics={  Text(extent=  {{-70, -30}, {70, 30}}, lineColor=  {0, 0, 0}, textString=  "%BaseConductance ml/min/mmHg"), Text(extent=  {{-101, -58}, {99, -30}}, lineColor=  {0, 0, 255}, textString=  "%name")}));
      end SystemicVeins;

      model GITract
        extends HumMod.CardioVascular.OrganFlow.BaseBadDirection;
        extends PhysiolibraryOld.Icons.GITract;
        PhysiolibraryOld.Factors.CurveValue A2Effect(data={{0.0,1.05,0},{1.3,
              1.0,-0.08},{3.5,0.5,0}})
          annotation (Placement(transformation(extent={{0,22},{20,42}})));
        PhysiolibraryOld.Factors.CurveValue ADHEffect(data={{0.8,1.0,0},{3.0,
              0.1,0}})
          annotation (Placement(transformation(extent={{0,-2},{20,18}})));
        PhysiolibraryOld.Blocks.CondConstant BasicConductance(k=11.2)
          annotation (Placement(transformation(extent={{-6,74},{6,86}})));
        PhysiolibraryOld.Factors.SimpleMultiply Anesthesia
          annotation (Placement(transformation(extent={{0,50},{20,70}})));
        PhysiolibraryOld.Factors.SimpleMultiply Viscosity
          annotation (Placement(transformation(extent={{0,58},{20,78}})));
        PhysiolibraryOld.Factors.SplineDelayFactorByDayWithFailture Vasculature(
          Tau=30,
          data={{41,1.2,0},{51,1.0,-0.03},{61,0.8,0}},
          stateName="GITract-Vasculature.Effect")
          annotation (Placement(transformation(extent={{0,40},{20,60}})));
        HumMod.Nerves.AplhaReceptorsActivityFactor AplhaReceptors(data = {{0.0, 1.3, 0}, {1.0, 1.0, -0.3}, {5.0, 0.1, 0}}) annotation(Placement(transformation(extent = {{0, 10}, {20, 30}})));
        PhysiolibraryOld.PressureFlow.ResistorWithCond GITract
          annotation (Placement(transformation(extent={{20,-10},{0,10}})));
        PhysiolibraryOld.Factors.CurveValue PO2OnConductance(data={{10,2.0,0},{
              30,1.0,0}})
          annotation (Placement(transformation(extent={{0,30},{20,50}})));
      equation
        connect(Vasculature.y, PO2OnConductance.yBase) annotation(Line(points = {{10, 44.8}, {10, 42}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Viscosity.y, Anesthesia.yBase) annotation(Line(points = {{10, 66}, {10, 62}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Vasculature.yBase, Anesthesia.y) annotation(Line(points = {{10, 55}, {10, 58}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(ADHEffect.y, GITract.cond) annotation(Line(points = {{10, 6}, {10, 4}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(PO2OnConductance.y, A2Effect.yBase) annotation(Line(points = {{10, 38}, {10, 34}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(BasicConductance.y, Viscosity.yBase) annotation(Line(points = {{6.6, 80}, {10, 80}, {10, 70}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.AlphaBlocade_Effect, AplhaReceptors.AlphaBlockade_Effect) annotation(Line(points = {{-90, 90}, {-52, 90}, {-52, 20}, {0.2, 20}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.AlphaPool_Effect, AplhaReceptors.AlphaPool_Effect) annotation(Line(points = {{-90, 90}, {-52, 90}, {-52, 26}, {0.2, 26}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.GangliaGeneral_NA, AplhaReceptors.GangliaGeneral_NA) annotation(Line(points = {{-90, 90}, {-52, 90}, {-52, 14}, {0.2, 14}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.ADHPool_Log10Conc, ADHEffect.u) annotation(Line(points = {{-90, 90}, {-52, 90}, {-52, 8}, {0.2, 8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.A2Pool_Log10Conc, A2Effect.u) annotation(Line(points = {{-90, 90}, {-52, 90}, {-52, 32}, {0.2, 32}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.GITract_PO2, PO2OnConductance.u) annotation(Line(points = {{-90, 90}, {-52, 90}, {-52, 40}, {0.2, 40}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.GITract_Function_Failed, Vasculature.Failed) annotation(Line(points = {{-90, 90}, {-52, 90}, {-52, 54}, {0.2, 54}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.GITract_PO2, Vasculature.u) annotation(Line(points = {{-90, 90}, {-52, 90}, {-52, 40}, {-4, 40}, {-4, 48}, {0.2, 48}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.Anesthesia_VascularConductance, Anesthesia.u) annotation(Line(points = {{-90, 90}, {-52, 90}, {-52, 60}, {0.2, 60}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.Viscosity_ConductanceEffect, Viscosity.u) annotation(Line(points = {{-90, 90}, {-52, 90}, {-52, 68}, {0.2, 68}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(AplhaReceptors.yBase, A2Effect.y) annotation(Line(points = {{10, 27}, {10, 30}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(AplhaReceptors.y, ADHEffect.yBase) annotation(Line(points = {{10, 13}, {10, 10}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(GITract.q_in, flowMeasure.q_out) annotation(Line(points = {{20, 0}, {82, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(GITract.q_out, q_out) annotation(Line(points = {{0, 0}, {-100, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        annotation(Documentation(info = "<HTML>
                   <PRE>
                   Blood resistance in gastro interstitial tract.
                    
                   QHP 2008 / GITract-Flow
                    
                   Created : 23-May-05
                   Last Modified : 31-Mar-08
                   Author : Tom Coleman
                   Copyright : 2005-2008
                   By : University of Mississippi Medical Center
                   Solver : DES 2005
                   Schema : 2005.0
                   </PRE>
                   </HTML>
                   ", revisions = "<html>
                   <ul>
                   <li><i>  </i>
                          </li>
                   <li><i> january 2009 </i><br> 
                          by Marek Matejak in Modelica initially implemented (consulted with Jiri Kofranek), Charles University, Prague<br>
                          orginaly described by Tom Coleman in QHP 2008 beta 3, University of Mississippi Medical Center
                          </li>
                   </ul>
                   </html>"), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-120, -106}, {80, -86}}, lineColor=  {0, 0, 255}, textString=  "%name")}));
      end GITract;

      model Bone
        extends HumMod.CardioVascular.OrganFlow.BaseBadDirection;
        extends PhysiolibraryOld.Icons.Bone;
        PhysiolibraryOld.Factors.CurveValue A2Effect_Bone(data={{0.0,1.05,0},{
              1.3,1.0,-0.08},{3.5,0.5,0}})
          annotation (Placement(transformation(extent={{-12,28},{8,48}})));
        PhysiolibraryOld.Factors.CurveValue ADHEffect_Bone(data={{0.8,1.0,0},{
              3.0,0.1,0}})
          annotation (Placement(transformation(extent={{-12,20},{8,40}})));
        PhysiolibraryOld.Blocks.CondConstant BasicConductance(k=3.62859)
          "scaled to new coronary circulation"
          annotation (Placement(transformation(extent={{-16,72},{-4,84}})));
        HumMod.Nerves.AplhaReceptorsActivityFactor AplhaReceptors_Bone(data = {{0.0, 1.3, 0}, {1.0, 1.0, -0.3}, {5.0, 0.1, 0}}) annotation(Placement(transformation(extent = {{-12, 6}, {8, 26}})));
        PhysiolibraryOld.Factors.SimpleMultiply Viscosity_Bone
          annotation (Placement(transformation(extent={{-12,58},{8,78}})));
        PhysiolibraryOld.Factors.SimpleMultiply Anesthesia_Bone
          annotation (Placement(transformation(extent={{-12,50},{8,70}})));
        PhysiolibraryOld.Factors.SplineDelayFactorByDayWithFailture
          Vasculature_Bone(
          data={{41,1.2,0},{51,1.0,-0.03},{61,0.8,0}},
          Tau=30,
          stateName="Bone-Vasculature.Effect")
          annotation (Placement(transformation(extent={{-12,39},{8,59}})));
        PhysiolibraryOld.PressureFlow.ResistorWithCond bone
          annotation (Placement(transformation(extent={{8,-10},{-12,10}})));
      equation
        connect(Anesthesia_Bone.yBase, Viscosity_Bone.y) annotation(Line(points = {{-2, 62}, {-2, 66}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Anesthesia_Bone.y, Vasculature_Bone.yBase) annotation(Line(points = {{-2, 58}, {-2, 54}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Vasculature_Bone.y, A2Effect_Bone.yBase) annotation(Line(points = {{-2, 43.8}, {-2, 40}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(BasicConductance.y, Viscosity_Bone.yBase) annotation(Line(points = {{-3.4, 78}, {-2, 78}, {-2, 70}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.Viscosity_ConductanceEffect, Viscosity_Bone.u) annotation(Line(points = {{-90, 90}, {-75, 90}, {-75, 68}, {-11.8, 68}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.Anesthesia_VascularConductance, Anesthesia_Bone.u) annotation(Line(points = {{-90, 90}, {-75, 90}, {-75, 60}, {-11.8, 60}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.Bone_Function_Failed, Vasculature_Bone.Failed) annotation(Line(points = {{-90, 90}, {-75, 90}, {-75, 53}, {-11.8, 53}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.Bone_PO2, Vasculature_Bone.u) annotation(Line(points = {{-90, 90}, {-75, 90}, {-75, 47}, {-11.8, 47}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.A2Pool_Log10Conc, A2Effect_Bone.u) annotation(Line(points = {{-90, 90}, {-75, 90}, {-75, 38}, {-11.8, 38}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.GangliaGeneral_NA, AplhaReceptors_Bone.GangliaGeneral_NA) annotation(Line(points = {{-90, 90}, {-75, 90}, {-75, 10}, {-11.8, 10}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.AlphaBlocade_Effect, AplhaReceptors_Bone.AlphaBlockade_Effect) annotation(Line(points = {{-90, 90}, {-75, 90}, {-75, 15.7}, {-12, 16}, {-11.8, 16}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.AlphaPool_Effect, AplhaReceptors_Bone.AlphaPool_Effect) annotation(Line(points = {{-90, 90}, {-75, 90}, {-75, 22}, {-11.8, 22}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.ADHPool_Log10Conc, ADHEffect_Bone.u) annotation(Line(points = {{-90, 90}, {-75, 90}, {-75, 30}, {-11.8, 30}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(A2Effect_Bone.y, ADHEffect_Bone.yBase) annotation(Line(points = {{-2, 36}, {-2, 32}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(ADHEffect_Bone.y, AplhaReceptors_Bone.yBase) annotation(Line(points = {{-2, 28}, {-2, 23}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(AplhaReceptors_Bone.y, bone.cond) annotation(Line(points = {{-2, 9}, {-2, 4}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(flowMeasure.q_out, bone.q_in) annotation(Line(points = {{82, 0}, {8, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(bone.q_out, q_out) annotation(Line(points = {{-12, 0}, {-56, 0}, {-56, 0}, {-100, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        annotation(Documentation(info = "<HTML>
                   <PRE>
                   Blood resistance in bones.
                    
                   QHP 2008 / Bone-Flow
                    
                   Created : 23-May-05
                   Last Modified : 19-Dec-05
                   Author : Tom Coleman
                   Copyright Status : In Public Domain
                   Solver : QHP 2008
                   Schema : 2008.0
                   </PRE>
                   </HTML>
                   ", revisions = "<html>
                   <ul>
                   <li><i>  </i>
                          </li>
                   <li><i> january 2009 </i><br> 
                          by Marek Matejak in Modelica initially implemented (consulted with Jiri Kofranek), Charles University, Prague<br>
                          orginaly described by Tom Coleman in QHP 2008 beta 3, University of Mississippi Medical Center
                          </li>
                   </ul>
                   </html>"), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}, initialScale = 0.1, grid = {1, 1}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}, initialScale = 0.1, grid = {1, 1}), graphics={  Text(extent=  {{-100, -90}, {100, -70}}, lineColor=  {0, 0, 255}, textString=  "%name")}));
      end Bone;

      model Brain
        extends HumMod.CardioVascular.OrganFlow.BaseBadDirection;
        extends PhysiolibraryOld.Icons.Brain;
        PhysiolibraryOld.Factors.SplineDelayFactorByDayWithFailture
          Vasculature_Brain(
          Tau=30,
          data={{27,1.2,0},{37,1.0,-0.03},{47,0.8,0}},
          stateName="Brain-Vasculature.Effect")
          annotation (Placement(transformation(extent={{-52,16},{-72,36}})));
        PhysiolibraryOld.Factors.SimpleMultiply Viscosity_Brain
          annotation (Placement(transformation(extent={{-52,28},{-72,48}})));
        PhysiolibraryOld.Factors.CurveValue PO2OnTension(data={{22,0.0,0},{36,
              1.0,0.02},{60,1.2,0}})
          annotation (Placement(transformation(extent={{22,24},{2,44}})));
        PhysiolibraryOld.Factors.CurveValue PCO2OnTension(data={{20,1.8,0},{45,
              1.0,-0.05},{75,0.0,0}})
          annotation (Placement(transformation(extent={{22,16},{2,36}})));
        PhysiolibraryOld.Factors.CurveValue TensionEffect(data={{0.0,2.2,0},{
              1.0,1.0,-0.5},{2.0,0.6,0}})
          annotation (Placement(transformation(extent={{-52,4},{-72,24}})));
        PhysiolibraryOld.PressureFlow.ResistorWithCond brain
          annotation (Placement(transformation(extent={{-52,-10},{-72,10}})));
        PhysiolibraryOld.Blocks.CondConstant BasicConductance(k=9.1)
          annotation (Placement(transformation(extent={{-76,42},{-64,54}})));
      equation
        connect(Viscosity_Brain.y, Vasculature_Brain.yBase) annotation(Line(points = {{-62, 36}, {-62, 31}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(BasicConductance.y, Viscosity_Brain.yBase) annotation(Line(points = {{-63.4, 48}, {-62, 48}, {-62, 40}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(PO2OnTension.y, PCO2OnTension.yBase) annotation(Line(points = {{12, 32}, {12, 28}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Vasculature_Brain.y, TensionEffect.yBase) annotation(Line(points = {{-62, 20.8}, {-62, 16}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(TensionEffect.y, brain.cond) annotation(Line(points = {{-62, 12}, {-62, 4}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(TensionEffect.u, PCO2OnTension.y) annotation(Line(points = {{-52.2, 14}, {12, 14}, {12, 24}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(PO2OnTension.u, busConnector.Brain_PO2) annotation(Line(points = {{21.8, 34}, {72, 34}, {72, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(PCO2OnTension.u, busConnector.Brain_PCO2) annotation(Line(points = {{21.8, 26}, {72, 26}, {72, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(Vasculature_Brain.Failed, busConnector.Brain_Function_Failed) annotation(Line(points = {{-52.2, 30}, {-8, 30}, {-8, 90}, {-90, 90}}, color = {255, 0, 255}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(PO2OnTension.yBase, busConnector.Anesthesia_VascularConductance) annotation(Line(points = {{12, 36}, {12, 46}, {72, 46}, {72, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 13}, {6, 13}}));
        connect(Vasculature_Brain.u, busConnector.Brain_PO2) annotation(Line(points = {{-52.2, 24}, {-8, 24}, {-8, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(Viscosity_Brain.u, busConnector.Viscosity_ConductanceEffect) annotation(Line(points = {{-52.2, 38}, {-8, 38}, {-8, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(flowMeasure.q_out, brain.q_in) annotation(Line(points = {{82, 0}, {-52, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(brain.q_out, q_out) annotation(Line(points = {{-72, 0}, {-100, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        annotation(Documentation(info = "<HTML>
                   <PRE>
                   Blood resistance in brain.
                    
                   QHP 2008 / Brain-Flow
                    
                   Created : 23-May-05
                   Last Modified : 20-Dec-05
                   Author : Tom Coleman
                   Copyright Status : In Public Domain
                   Solver : QHP 2008
                   Schema : 2008.0
                   </PRE>
                   </HTML>
                   ", revisions = "<html>
                   <ul>
                   <li><i>  </i>
                          </li>
                   <li><i> january 2009 </i><br> 
                          by Marek Matejak in Modelica initially implemented (consulted with Jiri Kofranek), Charles University, Prague<br>
                          orginaly described by Tom Coleman in QHP 2008 beta 3, University of Mississippi Medical Center
                          </li>
                   </ul>
                   </html>"), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(graphics={  Text(extent=  {{-100, -100}, {100, -80}}, lineColor=  {0, 0, 255}, textString=  "%name")}), Diagram(graphics));
      end Brain;

      model Fat
        extends HumMod.CardioVascular.OrganFlow.BaseBadDirection;
        extends PhysiolibraryOld.Icons.Fat;
        PhysiolibraryOld.Factors.CurveValue A2Effect_Fat(data={{0.0,1.05,0},{
              1.3,1.0,-0.08},{3.5,0.5,0}})
          annotation (Placement(transformation(extent={{0,28},{20,48}})));
        PhysiolibraryOld.Factors.CurveValue ADHEffect_Fat(data={{0.8,1.0,0},{
              3.0,0.1,0}})
          annotation (Placement(transformation(extent={{0,2},{20,22}})));
        PhysiolibraryOld.PressureFlow.ResistorWithCond fat
          annotation (Placement(transformation(extent={{20,-10},{0,10}})));
        PhysiolibraryOld.Blocks.CondConstant BasicConductance(k=2.7)
          annotation (Placement(transformation(extent={{-4,70},{8,82}})));
        HumMod.Nerves.AplhaReceptorsActivityFactor AplhaReceptors_Fat(data = {{0.0, 1.3, 0}, {1.0, 1.0, -0.3}, {5.0, 0.1, 0}}) annotation(Placement(transformation(extent = {{0, 16}, {20, 36}})));
        PhysiolibraryOld.Factors.SimpleMultiply Viscosity_Fat
          annotation (Placement(transformation(extent={{0,56},{20,76}})));
        PhysiolibraryOld.Factors.SimpleMultiply Anesthesia_Fat
          annotation (Placement(transformation(extent={{0,48},{20,68}})));
        PhysiolibraryOld.Factors.SplineDelayFactorByDayWithFailture
          Vasculature_Fat(
          data={{41,1.2,0},{51,1.0,-0.03},{61,0.8,0}},
          Tau=30,
          stateName="Fat-Vasculature.Effect")
          annotation (Placement(transformation(extent={{0,38},{20,58}})));
      equation
        connect(Anesthesia_Fat.yBase, Viscosity_Fat.y) annotation(Line(points = {{10, 60}, {10, 64}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Anesthesia_Fat.y, Vasculature_Fat.yBase) annotation(Line(points = {{10, 56}, {10, 53}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Vasculature_Fat.y, A2Effect_Fat.yBase) annotation(Line(points = {{10, 42.8}, {10, 40}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Viscosity_Fat.yBase, BasicConductance.y) annotation(Line(points = {{10, 68}, {10, 76}, {8.6, 76}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(fat.cond, ADHEffect_Fat.y) annotation(Line(points = {{10, 4}, {10, 10}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.Viscosity_ConductanceEffect, Viscosity_Fat.u) annotation(Line(points = {{-90, 90}, {-56, 90}, {-56, 66}, {0.2, 66}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.Anesthesia_VascularConductance, Anesthesia_Fat.u) annotation(Line(points = {{-90, 90}, {-56, 90}, {-56, 58}, {0.2, 58}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.Fat_Function_Failed, Vasculature_Fat.Failed) annotation(Line(points = {{-90, 90}, {-56, 90}, {-56, 52}, {0.2, 52}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.Fat_PO2, Vasculature_Fat.u) annotation(Line(points = {{-90, 90}, {-56, 90}, {-56, 46}, {0.2, 46}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.A2Pool_Log10Conc, A2Effect_Fat.u) annotation(Line(points = {{-90, 90}, {-56, 90}, {-56, 38}, {0.2, 38}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.GangliaGeneral_NA, AplhaReceptors_Fat.GangliaGeneral_NA) annotation(Line(points = {{-90, 90}, {-56, 90}, {-56, 20}, {0.2, 20}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.AlphaPool_Effect, AplhaReceptors_Fat.AlphaPool_Effect) annotation(Line(points = {{-90, 90}, {-56, 90}, {-56, 32}, {0.2, 32}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.AlphaBlocade_Effect, AplhaReceptors_Fat.AlphaBlockade_Effect) annotation(Line(points = {{-90, 90}, {-56, 90}, {-56, 26}, {0.2, 26}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.ADHPool_Log10Conc, ADHEffect_Fat.u) annotation(Line(points = {{-90, 90}, {-56, 90}, {-56, 12}, {0.2, 12}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(AplhaReceptors_Fat.yBase, A2Effect_Fat.y) annotation(Line(points = {{10, 33}, {10, 36}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(AplhaReceptors_Fat.y, ADHEffect_Fat.yBase) annotation(Line(points = {{10, 19}, {10, 14}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(flowMeasure.q_out, fat.q_in) annotation(Line(points = {{82, 0}, {20, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(fat.q_out, q_out) annotation(Line(points = {{0, 0}, {-100, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        annotation(Documentation(info = "<HTML>
                   <PRE>
                   Blood resistance in adipose tissue.
                    
                   QHP 2008 / Fat-Flow
                    
                   Created : 23-May-05
                   Last Modified : 19-Dec-05
                   Author : Tom Coleman
                   Copyright Status : In Public Domain
                   Solver : QHP 2008
                   Schema : 2008.0
                   </PRE>
                   </HTML>
                   ", revisions = "<html>
                   <ul>
                   <li><i>  </i>
                          </li>
                   <li><i> january 2009 </i><br> 
                          by Marek Matejak in Modelica initially implemented (consulted with Jiri Kofranek), Charles University, Prague<br>
                          orginaly described by Tom Coleman in QHP 2008 beta 3, University of Mississippi Medical Center
                          </li>
                   </ul>
                   </html>"), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(graphics={  Text(extent=  {{-100, -100}, {100, -80}}, lineColor=  {0, 0, 255}, textString=  "%name")}));
      end Fat;

      model Kidney
        extends HumMod.CardioVascular.OrganFlow.Base;
        extends PhysiolibraryOld.Icons.Kidney;
        PhysiolibraryOld.Factors.SimpleMultiply
          NephronCountEffect_AfferentArtery
          annotation (Placement(transformation(extent={{-10,34},{10,54}})));
        PhysiolibraryOld.Blocks.CondConstant Afferent_BasicConductance(k=34)
          annotation (Placement(transformation(extent={{-14,48},{-2,60}})));
        VariableResistorWithMyogenicResponse AfferentArtery(PressureChangeOnMyogenicCondEffect = {{-20.0, 1.2, 0.0}, {0.0, 1.0, -0.02}, {20.0, 0.8, 0.0}}, pressureChange(start = 0)) annotation(Placement(transformation(extent = {{-12, -12}, {12, 12}})));
        PhysiolibraryOld.Factors.CurveValue A2Effect2(data={{0.0,1.2,0.0},{1.3,
              1.0,-0.4},{3.0,0.6,0.0}})
          annotation (Placement(transformation(extent={{62,18},{82,38}})));
        PhysiolibraryOld.Blocks.CondConstant Efferent_BasicConductance(k=23)
          annotation (Placement(transformation(extent={{58,48},{70,60}})));
        PhysiolibraryOld.Factors.SimpleMultiply
          NephronCountEffect_KidneyEfferentArtery
          annotation (Placement(transformation(extent={{62,34},{82,54}})));
        PhysiolibraryOld.PressureFlow.ResistorWithCond EfferentArtery
          annotation (Placement(transformation(extent={{60,-12},{84,12}})));
        PhysiolibraryOld.PressureFlow.ResistorWithCondParam ArcuateArtery(cond=
              600)
          annotation (Placement(transformation(extent={{-54,-8},{-38,8}})));
        HumMod.Nerves.AplhaReceptorsActivityFactor AplhaReceptors_KidneyAfferentArtery(data = {{1.5, 1.0, 0.0}, {7.0, 0.9, 0.0}}) annotation(Placement(transformation(extent = {{-10, 14}, {10, 34}})));
        HumMod.Nerves.AplhaReceptorsActivityFactor AplhaReceptors_KidneyEfferentArtery(data = {{1.5, 1.0, 0.0}, {7.0, 0.9, 0.0}}) annotation(Placement(transformation(extent = {{62, 6}, {82, 26}})));
        PhysiolibraryOld.Factors.SimpleMultiply Anesthesia_KidneyEfferentArtery
          annotation (Placement(transformation(extent={{62,26},{82,46}})));
        PhysiolibraryOld.PressureFlow.PressureMeasure pressureMeasure
          annotation (Placement(transformation(
              extent={{-10,-10},{10,10}},
              rotation=0,
              origin={16,8})));
        Modelica.Blocks.Math.Product KidneyPlasmaFlow annotation(Placement(transformation(extent = {{-5, -5}, {5, 5}}, rotation = 90, origin = {-67, 71})));
        PhysiolibraryOld.PressureFlow.PressureMeasure pressureMeasure1
          annotation (Placement(transformation(
              extent={{10,-10},{-10,10}},
              rotation=0,
              origin={-24,8})));
        Modelica.Blocks.Math.Gain IFP(k = 0.042) annotation(Placement(transformation(extent = {{-50, -76}, {-58, -68}})));
        PhysiolibraryOld.Factors.DelayedToSpline TGFEffect(
          data={{0.0,1.2,0.0},{1.3,1.0,-0.4},{3.0,0.6,0.0}},
          Tau=1,
          initialValue=1.01309,
          adaptationSignalName="TGF-Vascular.Signal")
          "Macula Densa TGF vascular signal delay and effect to afferent arteriole"
          annotation (Placement(transformation(extent={{-10,26},{10,46}})));
        PhysiolibraryOld.Factors.CurveValue FurosemideEffect(data={{0.0,1.0,0.0},
              {1.3,0.2,0.0}})
          "furosemide outflow on Macula Densa Na sensibility"
          annotation (Placement(transformation(extent={{22,-52},{42,-32}})));
        PhysiolibraryOld.Factors.CurveValue NaEffect_MaculaDensa(data={{0,0.0,
              0.0},{48,1.0,0.03},{100,3.0,0.0}})
          annotation (Placement(transformation(extent={{22,-48},{42,-28}})));
        PhysiolibraryOld.Factors.CurveValue ANP_Effect(data={{0.0,1.2,0.0},{1.3,
              1.0,-0.3},{2.7,0.8,0.0}})
          annotation (Placement(transformation(extent={{22,-56},{42,-36}})));
        PhysiolibraryOld.Factors.CurveValue A2Effect3(data={{0.0,0.0,0.0},{0.2,
              0.6,0.05},{1.3,1.0,0.1},{3.0,8.0,0.0}})
          annotation (Placement(transformation(extent={{22,-60},{42,-40}})));
        PhysiolibraryOld.Blocks.Constant MedulaDensa_BaseTGFSignal(k=1)
          annotation (Placement(transformation(extent={{22,-34},{30,-26}})));
        VasaRecta vasaRecta annotation(Placement(transformation(extent = {{-22, -82}, {-2, -62}})));
      equation
        connect(Afferent_BasicConductance.y, NephronCountEffect_AfferentArtery.yBase) annotation(Line(points = {{-1.4, 54}, {0, 54}, {0, 46}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.Kidney_NephronCount_Total_xNormal, NephronCountEffect_AfferentArtery.u) annotation(Line(points = {{-90, 90}, {-90, 44}, {-9.800000000000001, 44}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.AlphaPool_Effect, AplhaReceptors_KidneyAfferentArtery.AlphaPool_Effect) annotation(Line(points = {{-90, 90}, {-90, 30}, {-9.800000000000001, 30}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.AlphaBlocade_Effect, AplhaReceptors_KidneyAfferentArtery.AlphaBlockade_Effect) annotation(Line(points = {{-90, 90}, {-90, 24}, {-9.800000000000001, 24}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.GangliaGeneral_NA, AplhaReceptors_KidneyAfferentArtery.GangliaGeneral_NA) annotation(Line(points = {{-90, 90}, {-90, 18}, {-9.800000000000001, 18}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.A2Pool_Log10Conc, A2Effect2.u) annotation(Line(points = {{-90, 90}, {22, 90}, {22, 28}, {62.2, 28}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.AlphaPool_Effect, AplhaReceptors_KidneyEfferentArtery.AlphaPool_Effect) annotation(Line(points = {{-90, 90}, {22, 90}, {22, 22}, {62.2, 22}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.GangliaGeneral_NA, AplhaReceptors_KidneyEfferentArtery.GangliaGeneral_NA) annotation(Line(points = {{-90, 90}, {22, 90}, {22, 10}, {62.2, 10}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.AlphaBlocade_Effect, AplhaReceptors_KidneyEfferentArtery.AlphaBlockade_Effect) annotation(Line(points = {{-90, 90}, {22, 90}, {22, 16}, {62.2, 16}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.Kidney_NephronCount_Total_xNormal, NephronCountEffect_KidneyEfferentArtery.u) annotation(Line(points = {{-90, 90}, {22, 90}, {22, 44}, {62.2, 44}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.Anesthesia_VascularConductance, Anesthesia_KidneyEfferentArtery.u) annotation(Line(points = {{-90, 90}, {22, 90}, {22, 36}, {62.2, 36}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(Efferent_BasicConductance.y, NephronCountEffect_KidneyEfferentArtery.yBase) annotation(Line(points = {{70.59999999999999, 54}, {72, 54}, {72, 46}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(A2Effect2.y, AplhaReceptors_KidneyEfferentArtery.yBase) annotation(Line(points = {{72, 26}, {72, 23}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(NephronCountEffect_KidneyEfferentArtery.y, Anesthesia_KidneyEfferentArtery.yBase) annotation(Line(points = {{72, 42}, {72, 38}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Anesthesia_KidneyEfferentArtery.y, A2Effect2.yBase) annotation(Line(points = {{72, 34}, {72, 30}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(AplhaReceptors_KidneyEfferentArtery.y, EfferentArtery.cond) annotation(Line(points = {{72, 9}, {72, 4.8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(AplhaReceptors_KidneyAfferentArtery.y, AfferentArtery.cond) annotation(Line(points = {{0, 17}, {0, 4.8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(pressureMeasure.q_in, AfferentArtery.q_out) annotation(Line(points = {{14, 4}, {14, 0}, {12, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(pressureMeasure.actualPressure, busConnector.GlomerulusBloodPressure) annotation(Line(points = {{21.2, 6}, {21.2, -16}, {-90, -16}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, -3}, {6, -3}}));
        connect(busConnector.BloodVol_PVCrit, KidneyPlasmaFlow.u2) annotation(Line(points = {{-90, 90}, {-54, 90}, {-54, 60}, {-64, 60}, {-64, 65}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{6, -3}, {6, -3}}));
        connect(KidneyPlasmaFlow.y, busConnector.KidneyPlasmaFlow) annotation(Line(points = {{-67, 76.5}, {-67, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, 3}, {3, 3}}));
        connect(ArcuateArtery.q_out, AfferentArtery.q_in) annotation(Line(points = {{-38, 0}, {-12, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(EfferentArtery.q_in, AfferentArtery.q_out) annotation(Line(points = {{60, 0}, {12, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(EfferentArtery.q_out, q_out) annotation(Line(points = {{84, 0}, {100, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(AfferentArtery.q_in, pressureMeasure1.q_in) annotation(Line(points = {{-12, 0}, {-22, 0}, {-22, 4}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(IFP.u, pressureMeasure1.actualPressure) annotation(Line(points = {{-49.2, -72}, {-32, -72}, {-32, 6}, {-29.2, 6}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(ANP_Effect.y, A2Effect3.yBase) annotation(Line(points = {{32, -48}, {32, -48}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(FurosemideEffect.y, ANP_Effect.yBase) annotation(Line(points = {{32, -44}, {32, -44}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(NaEffect_MaculaDensa.y, FurosemideEffect.yBase) annotation(Line(points = {{32, -40}, {32, -40}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(MedulaDensa_BaseTGFSignal.y, NaEffect_MaculaDensa.yBase) annotation(Line(points = {{30.4, -30}, {32, -30}, {32, -36}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(A2Effect3.y, TGFEffect.u) annotation(Line(points = {{32, -52}, {32, -54}, {-18, -54}, {-18, 36}, {-9.800000000000001, 36}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(NephronCountEffect_AfferentArtery.y, TGFEffect.yBase) annotation(Line(points = {{0, 42}, {0, 38}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(TGFEffect.y, AplhaReceptors_KidneyAfferentArtery.yBase) annotation(Line(points = {{0, 34}, {0, 31}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.FurosemidePool_Loss, FurosemideEffect.u) annotation(Line(points = {{-90, 90}, {-90, -42}, {22.2, -42}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.ANPPool_Log10Conc, ANP_Effect.u) annotation(Line(points = {{-90, 90}, {-90, -46}, {22.2, -46}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.A2Pool_Log10Conc, A2Effect3.u) annotation(Line(points = {{-90, 90}, {-90, -50}, {22.2, -50}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(flowMeasure.actualFlow, KidneyPlasmaFlow.u1) annotation(Line(points = {{-88, 5.4}, {-88, 50}, {-70, 50}, {-70, 65}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(flowMeasure.q_out, ArcuateArtery.q_in) annotation(Line(points = {{-82, 0}, {-54, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(busConnector, vasaRecta.busConnector) annotation(Line(points = {{-90, 90}, {-90, -64}, {-20, -64}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(pressureMeasure1.actualPressure, vasaRecta.ArcuateArtery_Pressure) annotation(Line(points = {{-29.2, 6}, {-32, 6}, {-32, -72}, {-20, -72}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.NephronIFP_Pressure, IFP.y) annotation(Line(points = {{-90, 90}, {-90, -72}, {-58.4, -72}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.MD_Na, NaEffect_MaculaDensa.u) annotation(Line(points = {{-90, 90}, {-90, -38}, {22.2, -38}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        annotation(Documentation(info = "<HTML>
                   <PRE>
                   Blood resistance in kidneys.
                    
                   QHP 2008 / Kidney-Flow
                    
                   Created : 09-Apr-05
                   Last Modified : 09-Apr-05
                   Author : Tom Coleman
                   Copyright Status : In Public Domain
                   Solver : QHP 2008
                   Schema : 2008.0
                   </PRE>
                   </HTML>
                   ", revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr>
                   </table>
                   </html>"), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Rectangle(extent=  {{14, -24}, {50, -62}}, lineColor=  {127, 0, 0}), Text(extent={{
                    14,-62},{50,-56}},                                                                                                    lineColor=  {0, 0, 255}, textString=  "Macula Densa")}), Icon(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-100, -100}, {100, -80}}, lineColor=  {0, 0, 255}, textString=  "%name")}), Diagram(graphics));
      end Kidney;

      model VariableResistorWithMyogenicResponse
        extends PhysiolibraryOld.PressureFlow.Resistor;
        //(q_in(pressure(start=95.5)),q_out(pressure(start=61.5)));
        extends PhysiolibraryOld.Utilities.DynamicState(
                                                     stateName = "Kidney-MyogenicDelay.PressureChange");
        PhysiolibraryOld.Interfaces.RealInput_ cond(final quantity=
              "Conductance", final unit="ml/(min.mmHg)") annotation (Placement(
              transformation(extent={{-100,92},{-80,112}}), iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=270,
              origin={0,40})));
        Real myogenicEffect;
        Real pressureChange;
        //(start=0.161874);
        //  Real pressureChangeSteadyState;
        // Real adaptedPressure; //(start=77.9546);
        //  Real interlobarPressure;
        parameter Real K_PressureChange(final unit = "1/min") = 2.0;
        parameter Real Tau_PressureAdoption(final unit = "hod") = 4.0;
        parameter Real[:, 3] PressureChangeOnMyogenicCondEffect;
        PhysiolibraryOld.Curves.Curve PressureChangeOnCondEffect(
          x=PressureChangeOnMyogenicCondEffect[:, 1],
          y=PressureChangeOnMyogenicCondEffect[:, 2],
          slope=PressureChangeOnMyogenicCondEffect[:, 3])
          annotation (Placement(transformation(extent={{14,26},{34,46}})));
        AfferentArteryMyogenicReceptors kidneyMyogenic annotation(Placement(transformation(extent = {{-46, 50}, {-26, 70}})));
        //initial equation
        // adaptedPressure = interlobarPressure;
        //der(adaptedPressure) = 0;
        // der(pressureChange) = 0;
      equation
        q_in.q = myogenicEffect * cond * (q_in.pressure - q_out.pressure);
        kidneyMyogenic.InterlobarPressure = (q_in.pressure + q_out.pressure) / 2;
        //stredny tlak v arteriole
        // der(adaptedPressure) = (1/(60*Tau_PressureAdoption)) * (interlobarPressure-adaptedPressure); //receptory sa adaptuju na tlak (polcas adaptacie nastane za 2hod a 45min)
        // pressureChangeSteadyState = interlobarPressure-adaptedPressure;  //zmena tlaku sa taktiez adaptuje - neviem preco? => potom to vizera, ze stimulacia receptorov je postupny proces (polcas nabudenia stimulacie je 20 sekund)
        stateValue = pressureChange;
        changePerMin = K_PressureChange * (kidneyMyogenic.PressureChange_SteadyState - pressureChange);
        PressureChangeOnCondEffect.u = pressureChange;
        //zmena tlaku aktivuje receptory
        myogenicEffect = PressureChangeOnCondEffect.val;
        //stimulacia receptorov ma vplyv na vodivost (odpor) krvi aferentnej arterie
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(graphics={  Text(extent=  {{-110, -68}, {106, -32}}, textString=  "%name", lineColor=  {0, 0, 255}), Text(extent=  {{-68, -20}, {66, 12}}, lineColor=  {0, 0, 0}, textString=  "blood flow"), Rectangle(extent=  {{-70, 30}, {70, -30}}, lineColor=  {0, 0, 255}, fillColor=  {215, 215, 215},
                  fillPattern=                                                                                                    FillPattern.Sphere), Text(extent=  {{-54, 20}, {52, -18}}, lineColor=  {0, 0, 0},
                  fillPattern=                                                                                                    FillPattern.Sphere, fillColor=  {215, 215, 215}, textString=  "Myogenic")}), Documentation(info = "<html> <pre>Receptory sa adaptuju na priemerny tlak v arteriole - polcas adaptacie nastane za 2hod a 45min. 
                           Zmena tlaku sa taktiez adaptuje - neviem preco? =&GT; potom to vizera, ze stimulacia receptorov je postupny proces (polcas nabudenia stimulacie je 20 sekund). 
                           Zmena tlaku aktivuje receptory, ktorych stimulacia ma vplyv na vasokonstrikciu danej arterioly.</pre> </html>"));
      end VariableResistorWithMyogenicResponse;

      model OtherTissue
        extends HumMod.CardioVascular.OrganFlow.BaseBadDirection;
        extends PhysiolibraryOld.Icons.OtherTissue;
        PhysiolibraryOld.Blocks.CondConstant BasicConductance(k=4.2)
          annotation (Placement(transformation(extent={{20,80},{32,92}})));
        PhysiolibraryOld.PressureFlow.ResistorWithCond OtherTissue
          annotation (Placement(transformation(extent={{46,-12},{22,12}})));
        PhysiolibraryOld.Factors.CurveValue A2Effect_OtherTissue(data={{0.0,
              1.05,0},{1.3,1.0,-0.08},{3.5,0.5,0}})
          annotation (Placement(transformation(extent={{24,28},{44,48}})));
        PhysiolibraryOld.Factors.CurveValue ADHEffect_OtherTissue(data={{0.8,
              1.0,0},{3.0,0.1,0}})
          annotation (Placement(transformation(extent={{24,2},{44,22}})));
        PhysiolibraryOld.Factors.SimpleMultiply Anesthesia_OtherTissue
          annotation (Placement(transformation(extent={{24,56},{44,76}})));
        PhysiolibraryOld.Factors.SimpleMultiply Viscosity_OtherTissue
          annotation (Placement(transformation(extent={{24,64},{44,84}})));
        PhysiolibraryOld.Factors.SplineDelayFactorByDayWithFailture
          Vasculature_OtherTissue(
          Tau=30,
          data={{41,1.2,0},{51,1.0,-0.03},{61,0.8,0}},
          stateName="OtherTissue-Vasculature.Effect")
          annotation (Placement(transformation(extent={{24,46},{44,66}})));
        HumMod.Nerves.AplhaReceptorsActivityFactor AplhaReceptors_OtherTissue(data = {{0.0, 1.3, 0}, {1.0, 1.0, -0.3}, {5.0, 0.1, 0}}) annotation(Placement(transformation(extent = {{24, 16}, {44, 36}})));
        PhysiolibraryOld.Factors.CurveValue PO2OnConductance_OtherTissue(data={
              {10,2.0,0},{30,1.0,0}})
          annotation (Placement(transformation(extent={{24,36},{44,56}})));
      equation
        connect(Vasculature_OtherTissue.y, PO2OnConductance_OtherTissue.yBase) annotation(Line(points = {{34, 50.8}, {34, 48}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Viscosity_OtherTissue.y, Anesthesia_OtherTissue.yBase) annotation(Line(points = {{34, 72}, {34, 68}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Vasculature_OtherTissue.yBase, Anesthesia_OtherTissue.y) annotation(Line(points = {{34, 61}, {34, 64}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(PO2OnConductance_OtherTissue.y, A2Effect_OtherTissue.yBase) annotation(Line(points = {{34, 44}, {34, 40}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(BasicConductance.y, Viscosity_OtherTissue.yBase) annotation(Line(points = {{32.6, 86}, {34, 86}, {34, 76}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(ADHEffect_OtherTissue.y, OtherTissue.cond) annotation(Line(points = {{34, 10}, {34, 4.8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.Viscosity_ConductanceEffect, Viscosity_OtherTissue.u) annotation(Line(points = {{-90, 90}, {-40, 90}, {-40, 74}, {24.2, 74}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.Anesthesia_VascularConductance, Anesthesia_OtherTissue.u) annotation(Line(points = {{-90, 90}, {-40, 90}, {-40, 66}, {24.2, 66}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.OtherTissue_Function_Failed, Vasculature_OtherTissue.Failed) annotation(Line(points = {{-90, 90}, {-40, 90}, {-40, 60}, {24.2, 60}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.OtherTissue_PO2, Vasculature_OtherTissue.u) annotation(Line(points = {{-90, 90}, {-40, 90}, {-40, 46}, {22, 46}, {22, 54}, {24.2, 54}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.OtherTissue_PO2, PO2OnConductance_OtherTissue.u) annotation(Line(points = {{-90, 90}, {-40, 90}, {-40, 46}, {24.2, 46}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.A2Pool_Log10Conc, A2Effect_OtherTissue.u) annotation(Line(points = {{-90, 90}, {-40, 90}, {-40, 38}, {24.2, 38}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.AlphaPool_Effect, AplhaReceptors_OtherTissue.AlphaPool_Effect) annotation(Line(points = {{-90, 90}, {-40, 90}, {-40, 32}, {24.2, 32}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.GangliaGeneral_NA, AplhaReceptors_OtherTissue.GangliaGeneral_NA) annotation(Line(points = {{-90, 90}, {-40, 90}, {-40, 20}, {24.2, 20}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.AlphaBlocade_Effect, AplhaReceptors_OtherTissue.AlphaBlockade_Effect) annotation(Line(points = {{-90, 90}, {-40, 90}, {-40, 26}, {24.2, 26}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.ADHPool_Log10Conc, ADHEffect_OtherTissue.u) annotation(Line(points = {{-90, 90}, {-40, 90}, {-40, 12}, {24.2, 12}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(AplhaReceptors_OtherTissue.yBase, A2Effect_OtherTissue.y) annotation(Line(points = {{34, 33}, {34, 36}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(AplhaReceptors_OtherTissue.y, ADHEffect_OtherTissue.yBase) annotation(Line(points = {{34, 19}, {34, 14}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(flowMeasure.q_out, OtherTissue.q_in) annotation(Line(points = {{82, 0}, {46, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(OtherTissue.q_out, q_out) annotation(Line(points = {{22, 0}, {-100, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        annotation(Documentation(info = "<HTML>
                   <PRE>
                   Blood resistance in other tissue.
                    
                    
                   QHP 2008 / OtherTissue-Flow
                    
                   Created : 31-Mar-05
                   Last Modified : 12-Dec-05
                   Author : Tom Coleman
                   Copyright Status : In Public Domain
                   Solver : QHP 2008
                   Schema : 2008.0
                   </PRE>
                   </HTML>
                   ", revisions = "<html>
                   <ul>
                   <li><i>  </i>
                          </li>
                   <li><i> january 2009 </i><br> 
                          by Marek Matejak in Modelica initially implemented (consulted with Jiri Kofranek), Charles University, Prague<br>
                          orginaly described by Tom Coleman in QHP 2008 beta 3, University of Mississippi Medical Center
                          </li>
                   </ul>
                   </html>"), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(graphics={  Text(extent=  {{-100, -100}, {100, -80}}, lineColor=  {0, 0, 255}, textString=  "%name")}));
      end OtherTissue;

      model SkeletalMuscle
        extends HumMod.CardioVascular.OrganFlow.BaseBadDirection;
        extends PhysiolibraryOld.Icons.SkeletalMuscle;
        PhysiolibraryOld.Factors.CurveValue A2Effect(data={{0.0,1.05,0},{1.3,
              1.0,-0.08},{3.5,0.5,0}})
          annotation (Placement(transformation(extent={{-42,-36},{-62,-16}})));
        PhysiolibraryOld.Blocks.CondConstant BasicConductance(k=7.2)
          annotation (Placement(transformation(extent={{-68,30},{-56,42}})));
        PhysiolibraryOld.Factors.CurveValue ADHEffect(data={{0.8,1.0,0},{3.0,
              0.1,0}})
          annotation (Placement(transformation(extent={{-42,-60},{-62,-40}})));
        PhysiolibraryOld.Factors.SimpleMultiply Viscosity
          annotation (Placement(transformation(extent={{-42,16},{-62,36}})));
        PhysiolibraryOld.Factors.SimpleMultiply Anesthesia
          annotation (Placement(transformation(extent={{-42,8},{-62,28}})));
        PhysiolibraryOld.PressureFlow.ResistorWithCond SkeletalMuscle
          annotation (Placement(transformation(extent={{-38,-74},{-66,-46}})));
        HumMod.Nerves.AplhaReceptorsActivityFactor aplhaReceptorsActivityFactor(data = {{0.0, 1.3, 0}, {1.0, 1.0, -0.2}, {4.0, 0.5, 0}}) annotation(Placement(transformation(extent = {{-42, -48}, {-62, -28}})));
        PhysiolibraryOld.Factors.SplineDelayFactorByDayWithFailture
          Vasculature_skeletalMuscle(
          data={{41,1.2,0},{51,1.0,-0.03},{61,0.8,0}},
          Tau=30,
          stateName="SkeletalMuscle-Vasculature.Effect")
          annotation (Placement(transformation(extent={{-42,-2},{-62,18}})));
        PhysiolibraryOld.Factors.CurveValue PO2Effect(data={{0,4.0,0},{25,2.5,-0.2},
              {35,1.0,0}})
          annotation (Placement(transformation(extent={{-42,-12},{-62,8}})));
        PhysiolibraryOld.Factors.CurveValue IntensityEffect(data={{0,0.0,0.007},
              {300,1.0,0.0}})
          annotation (Placement(transformation(extent={{24,44},{4,64}})));
        PhysiolibraryOld.Factors.CurveValue RateEffect(data={{0,0.0,0.04},{60,
              1.0,0.0}})
          annotation (Placement(transformation(extent={{24,36},{4,56}})));
        PhysiolibraryOld.Factors.SimpleMultiply MusclePumping_SkeletalMuscle
          annotation (Placement(transformation(extent={{-42,-28},{-62,-8}})));
        PhysiolibraryOld.Blocks.Constant BaseMusclePumpEffect(k=1)
          annotation (Placement(transformation(extent={{8,60},{12,64}})));
        ConductanceFactors.MetabolicVasolidation2 metabolicVasolidation(data = {{50, 1.0, 0}, {1000, 3.5, 0.003}, {3000, 5.5, 0}}, OnTau = 0.2, OffTau = 1, stateName = "SkeletalMuscle-MetabolicVasodilation.Effect") annotation(Placement(transformation(extent = {{-42, -20}, {-62, 0}})));
        PhysiolibraryOld.Blocks.Add add(k=1)
          annotation (Placement(transformation(extent={{-4,-22},{-12,-14}})));
      equation
        connect(Viscosity.y, Anesthesia.yBase) annotation(Line(points = {{-52, 24}, {-52, 20}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Vasculature_skeletalMuscle.yBase, Anesthesia.y) annotation(Line(points = {{-52, 13}, {-52, 16}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Vasculature_skeletalMuscle.y, PO2Effect.yBase) annotation(Line(points = {{-52, 2.8}, {-52, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(MusclePumping_SkeletalMuscle.y, A2Effect.yBase) annotation(Line(points = {{-52, -20}, {-52, -24}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Viscosity.yBase, BasicConductance.y) annotation(Line(points = {{-52, 28}, {-52, 36}, {-55.4, 36}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(SkeletalMuscle.cond, ADHEffect.y) annotation(Line(points = {{-52, -54.4}, {-52, -52}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(BaseMusclePumpEffect.y, IntensityEffect.yBase) annotation(Line(points = {{12.2, 62}, {14, 62}, {14, 56}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(IntensityEffect.y, RateEffect.yBase) annotation(Line(points = {{14, 52}, {14, 48}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Viscosity.u, busConnector.Viscosity_ConductanceEffect) annotation(Line(points = {{-42.2, 26}, {0, 26}, {0, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(Anesthesia.u, busConnector.Anesthesia_VascularConductance) annotation(Line(points = {{-42.2, 18}, {0, 18}, {0, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(Vasculature_skeletalMuscle.Failed, busConnector.SkeletalMuscle_Function_Failed) annotation(Line(points = {{-42.2, 12}, {0, 12}, {0, 90}, {-90, 90}}, color = {255, 0, 255}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(metabolicVasolidation.O2Need, busConnector.SkeletalMuscle_O2Need) annotation(Line(points = {{-42.2, -10}, {0, -10}, {0, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(A2Effect.u, busConnector.A2Pool_Log10Conc) annotation(Line(points = {{-42.2, -26}, {0, -26}, {0, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(aplhaReceptorsActivityFactor.AlphaPool_Effect, busConnector.AlphaPool_Effect) annotation(Line(points = {{-42.2, -32}, {0, -32}, {0, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(aplhaReceptorsActivityFactor.AlphaBlockade_Effect, busConnector.AlphaBlocade_Effect) annotation(Line(points = {{-42.2, -38}, {0, -38}, {0, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(aplhaReceptorsActivityFactor.GangliaGeneral_NA, busConnector.GangliaGeneral_NA) annotation(Line(points = {{-42.2, -44}, {0, -44}, {0, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(ADHEffect.u, busConnector.ADHPool_Log10Conc) annotation(Line(points = {{-42.2, -50}, {0, -50}, {0, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(IntensityEffect.u, busConnector.Exercise_Metabolism_MotionWatts) annotation(Line(points = {{23.8, 54}, {82, 54}, {82, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(RateEffect.u, busConnector.Exercise_Metabolism_ContractionRate) annotation(Line(points = {{23.8, 46}, {82, 46}, {82, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(metabolicVasolidation.yBase, PO2Effect.y) annotation(Line(points = {{-52, -8}, {-52, -4}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(metabolicVasolidation.y, MusclePumping_SkeletalMuscle.yBase) annotation(Line(points = {{-52, -12}, {-52, -16}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(A2Effect.y, aplhaReceptorsActivityFactor.yBase) annotation(Line(points = {{-52, -28}, {-52, -31}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(ADHEffect.yBase, aplhaReceptorsActivityFactor.y) annotation(Line(points = {{-52, -48}, {-52, -45}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(MusclePumping_SkeletalMuscle.u, add.y) annotation(Line(points = {{-42.2, -18}, {-12.4, -18}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(add.u, RateEffect.y) annotation(Line(points = {{-3.2, -18}, {14, -18}, {14, 44}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(flowMeasure.q_out, SkeletalMuscle.q_in) annotation(Line(points = {{82, 0}, {28, 0}, {28, -60}, {-38, -60}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(SkeletalMuscle.q_out, q_out) annotation(Line(points = {{-66, -60}, {-82, -60}, {-82, 0}, {-100, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(Vasculature_skeletalMuscle.u, busConnector.SkeletalMuscle_PO2) annotation(Line(points = {{-42.2, 6}, {0, 6}, {0, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(PO2Effect.u, busConnector.SkeletalMuscle_PO2) annotation(Line(points = {{-42.2, -2}, {0, -2}, {0, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        annotation(Documentation(info = "<HTML>
                   <PRE>
                   Blood resistance in skeletal muscle.
                    
                   QHP 2008 / SkeletalMuscle-Flow
                    
                   Created : 23-May-05
                   Last Modified : 04-Aug-08
                   Author : Tom Coleman
                   Copyright : 2008-2008
                   By : University of Mississippi Medical Center
                   Solver : DES 2008
                   Schema : 2008.0
                   </PRE>
                   </HTML>
                   ", revisions = "<html>
                   <ul>
                   <li><i>  </i>
                          </li>
                   <li><i> january 2009 </i><br> 
                          by Marek Matejak in Modelica initially implemented (consulted with Jiri Kofranek), Charles University, Prague<br>
                          orginaly described by Tom Coleman in QHP 2008 beta 3, University of Mississippi Medical Center
                          </li>
                   </ul>
                   </html>"), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(graphics={  Text(extent=  {{-100, -100}, {100, -80}}, lineColor=  {0, 0, 255}, textString=  "%name")}));
      end SkeletalMuscle;

      model RespiratoryMuscle
        extends HumMod.CardioVascular.OrganFlow.BaseBadDirection;
        extends PhysiolibraryOld.Icons.RespiratoryMuscle;
        PhysiolibraryOld.Factors.CurveValue A2Effect(data={{0.0,1.05,0},{1.3,
              1.0,-0.08},{3.5,0.5,0}})
          annotation (Placement(transformation(extent={{-6,10},{-26,30}})));
        PhysiolibraryOld.Blocks.CondConstant BasicConductance(k=1.1)
          annotation (Placement(transformation(extent={{-32,70},{-20,82}})));
        PhysiolibraryOld.Factors.CurveValue ADHEffect(data={{0.8,1.0,0},{3.0,
              0.1,0}})
          annotation (Placement(transformation(extent={{-6,-14},{-26,6}})));
        PhysiolibraryOld.Factors.SimpleMultiply Viscosity
          annotation (Placement(transformation(extent={{-6,54},{-26,74}})));
        PhysiolibraryOld.Factors.SimpleMultiply Anesthesia
          annotation (Placement(transformation(extent={{-6,46},{-26,66}})));
        PhysiolibraryOld.PressureFlow.ResistorWithCond respiratorylMuscle
          annotation (Placement(transformation(extent={{-2,-30},{-30,-2}})));
        HumMod.Nerves.AplhaReceptorsActivityFactor aplhaReceptorsActivityFactor(data = {{0.0, 1.3, 0}, {1.0, 1.0, -0.3}, {5.0, 0.1, 0}}) annotation(Placement(transformation(extent = {{-6, -2}, {-26, 18}})));
        PhysiolibraryOld.Factors.SplineDelayFactorByDayWithFailture Vasculature(
          Tau=30,
          data={{41,1.2,0},{51,1.0,-0.03},{61,0.8,0}},
          stateName="RespiratoryMuscle-Vasculature.Effect")
          annotation (Placement(transformation(extent={{-6,36},{-26,56}})));
        PhysiolibraryOld.Factors.CurveValue PO2Effect(data={{10,2.0,0},{30,1.0,
              0}})
          annotation (Placement(transformation(extent={{-6,26},{-26,46}})));
        PhysiolibraryOld.Factors.CurveValue MetabolismEffect(data={{6,1.0,0},{
              12,1.3,0.08},{400,24.0,0}})
          annotation (Placement(transformation(extent={{-6,18},{-26,38}})));
      equation
        connect(Viscosity.y, Anesthesia.yBase) annotation(Line(points = {{-16, 62}, {-16, 58}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Vasculature.yBase, Anesthesia.y) annotation(Line(points = {{-16, 51}, {-16, 54}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Vasculature.y, PO2Effect.yBase) annotation(Line(points = {{-16, 40.8}, {-16, 38}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Viscosity.yBase, BasicConductance.y) annotation(Line(points = {{-16, 66}, {-16, 76}, {-19.4, 76}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(respiratorylMuscle.cond, ADHEffect.y) annotation(Line(points = {{-16, -10.4}, {-16, -6}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Viscosity.u, busConnector.Viscosity_ConductanceEffect) annotation(Line(points = {{-6.2, 64}, {62, 64}, {62, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(Anesthesia.u, busConnector.Anesthesia_VascularConductance) annotation(Line(points = {{-6.2, 56}, {62, 56}, {62, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(Vasculature.Failed, busConnector.RespiratoryMuscle_Function_Failed) annotation(Line(points = {{-6.2, 50}, {62, 50}, {62, 90}, {-90, 90}}, color = {255, 0, 255}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(Vasculature.u, busConnector.RespiratoryMuscle_PO2) annotation(Line(points = {{-6.2, 44}, {62, 44}, {62, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(PO2Effect.u, busConnector.RespiratoryMuscle_PO2) annotation(Line(points = {{-6.2, 36}, {62, 36}, {62, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(A2Effect.u, busConnector.A2Pool_Log10Conc) annotation(Line(points = {{-6.2, 20}, {62, 20}, {62, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(aplhaReceptorsActivityFactor.AlphaPool_Effect, busConnector.AlphaPool_Effect) annotation(Line(points = {{-6.2, 14}, {62, 14}, {62, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(aplhaReceptorsActivityFactor.AlphaBlockade_Effect, busConnector.AlphaBlocade_Effect) annotation(Line(points = {{-6.2, 8}, {62, 8}, {62, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(aplhaReceptorsActivityFactor.GangliaGeneral_NA, busConnector.GangliaGeneral_NA) annotation(Line(points = {{-6.2, 2}, {62, 2}, {62, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(ADHEffect.u, busConnector.ADHPool_Log10Conc) annotation(Line(points = {{-6.2, -4}, {62, -4}, {62, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(PO2Effect.y, MetabolismEffect.yBase) annotation(Line(points = {{-16, 34}, {-16, 30}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(MetabolismEffect.u, busConnector.RespiratoryMuscle_O2Need) annotation(Line(points = {{-6.2, 28}, {62, 28}, {62, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(MetabolismEffect.y, A2Effect.yBase) annotation(Line(points = {{-16, 26}, {-16, 22}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(aplhaReceptorsActivityFactor.yBase, A2Effect.y) annotation(Line(points = {{-16, 15}, {-16, 18}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(aplhaReceptorsActivityFactor.y, ADHEffect.yBase) annotation(Line(points = {{-16, 1}, {-16, -2}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(flowMeasure.q_out, respiratorylMuscle.q_in) annotation(Line(points = {{82, 0}, {68, 0}, {68, -16}, {-2, -16}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(respiratorylMuscle.q_out, q_out) annotation(Line(points = {{-30, -16}, {-64, -16}, {-64, 0}, {-100, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        annotation(Documentation(info = "<HTML>
                   <PRE>
                   Blood resistance in respiratory musclet.
                    
                   QHP 2008 / RespiratoryMuscle-Flow
                    
                   Created : 23-May-05
                   Last Modified : 19-Dec-05
                   Author : Tom Coleman
                   Copyright Status : In Public Domain
                   Solver : QHP 2008
                   Schema : 2008.0
                   </PRE>
                   </HTML>
                   ", revisions = "<html>
                   <ul>
                   <li><i>  </i>
                          </li>
                   <li><i> january 2009 </i><br> 
                          by Marek Matejak in Modelica initially implemented (consulted with Jiri Kofranek), Charles University, Prague<br>
                          orginaly described by Tom Coleman in QHP 2008 beta 3, University of Mississippi Medical Center
                          </li>
                   </ul>
                   </html>"), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(graphics={  Text(extent=  {{-102, -100}, {98, -80}}, lineColor=  {0, 0, 255}, textString=  "%name")}));
      end RespiratoryMuscle;

      model Heart
        extends HumMod.CardioVascular.OrganFlow.BaseBadDirection;
        parameter Real BasicLargeVeselsConductance(final quantity = "Conductance", final unit = "ml/(min.mmHg)");
        parameter Real BasicSmallVeselsConductance(final quantity = "Conductance", final unit = "ml/(min.mmHg)");
        PhysiolibraryOld.Factors.CurveValue PO2Effect(data={{12,2.0,0},{17,1.0,
              -0.04},{30,0.8,0}}, u(start=20))
          annotation (Placement(transformation(extent={{60,20},{80,40}})));
        PhysiolibraryOld.Factors.CurveValue ADHEffect2(data={{0.8,1.0,0},{3.0,
              0.1,0}})
          annotation (Placement(transformation(extent={{60,58},{80,78}})));
        PhysiolibraryOld.Factors.CurveValue MetabolismEffect(data={{30,1.0,0},{
              100,3.0,0}})
          annotation (Placement(transformation(extent={{60,10},{80,30}})));
        PhysiolibraryOld.Factors.SimpleMultiply Anesthesia
          annotation (Placement(transformation(extent={{60,66},{80,86}})));
        PhysiolibraryOld.Blocks.CondConstant LargeVesselBasicConductance(k=
              BasicLargeVeselsConductance)
          annotation (Placement(transformation(extent={{-6,18},{-18,30}})));
        PhysiolibraryOld.Factors.SimpleMultiply Viscosity1
          annotation (Placement(transformation(extent={{-30,4},{-10,24}})));
        PhysiolibraryOld.Blocks.CondConstant SmallVesselBasicConductance(k=
              BasicSmallVeselsConductance)
          annotation (Placement(transformation(extent={{90,86},{78,98}})));
        HumMod.Nerves.AplhaReceptorsActivityFactor aplhaReceptorsActivityFactor(data = {{0.0, 1.3, 0}, {1.0, 1.0, -0.16}, {4.0, 0.8, 0}}) annotation(Placement(transformation(extent = {{60, 46}, {80, 66}})));
        ConductanceFactors.HeartInfraction Infraction annotation(Placement(transformation(extent = {{60, 2}, {80, 22}})));
        PhysiolibraryOld.Factors.SplineDelayFactorByDayWithFailture Vasculature(
          data={{41,1.2,0},{51,1.0,-0.03},{61,0.8,0}},
          Tau=30,
          u(start=20),
          integrator(y_start=1.2))
          annotation (Placement(transformation(extent={{60,30},{80,50}})));
        PhysiolibraryOld.Factors.SimpleMultiply Viscosity
          annotation (Placement(transformation(extent={{60,74},{80,94}})));
        PhysiolibraryOld.PressureFlow.ResistorWith2Cond vessels
          annotation (Placement(transformation(extent={{44,-26},{-8,0}})));
      equation
        connect(LargeVesselBasicConductance.y, Viscosity1.yBase) annotation(Line(points = {{-18.6, 24}, {-20, 24}, {-20, 16}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Viscosity.y, Anesthesia.yBase) annotation(Line(points = {{70, 82}, {70, 78}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.Anesthesia_VascularConductance, Anesthesia.u) annotation(Line(points = {{-90, 90}, {6, 90}, {6, 76}, {60.2, 76}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.Viscosity_ConductanceEffect, Viscosity.u) annotation(Line(points = {{-90, 90}, {6, 90}, {6, 84}, {60.2, 84}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.ADHPool_Log10Conc, ADHEffect2.u) annotation(Line(points = {{-90, 90}, {6, 90}, {6, 68}, {60.2, 68}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.AlphaPool_Effect, aplhaReceptorsActivityFactor.AlphaPool_Effect) annotation(Line(points = {{-90, 90}, {6, 90}, {6, 62}, {60.2, 62}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.AlphaBlocade_Effect, aplhaReceptorsActivityFactor.AlphaBlockade_Effect) annotation(Line(points = {{-90, 90}, {6, 90}, {6, 56}, {60.2, 56}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.GangliaGeneral_NA, aplhaReceptorsActivityFactor.GangliaGeneral_NA) annotation(Line(points = {{-90, 90}, {6, 90}, {6, 50}, {60.2, 50}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.Viscosity_ConductanceEffect, Viscosity1.u) annotation(Line(points = {{-90, 90}, {-74, 90}, {-74, 14}, {-29.8, 14}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(Viscosity.yBase, SmallVesselBasicConductance.y) annotation(Line(points = {{70, 86}, {70, 92}, {77.40000000000001, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Anesthesia.y, ADHEffect2.yBase) annotation(Line(points = {{70, 74}, {70, 70}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(ADHEffect2.y, aplhaReceptorsActivityFactor.yBase) annotation(Line(points = {{70, 66}, {70, 63}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(aplhaReceptorsActivityFactor.y, Vasculature.yBase) annotation(Line(points = {{70, 49}, {70, 45}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Vasculature.y, PO2Effect.yBase) annotation(Line(points = {{70, 34.8}, {70, 32}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(PO2Effect.y, MetabolismEffect.yBase) annotation(Line(points = {{70, 28}, {70, 22}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(MetabolismEffect.y, Infraction.yBase) annotation(Line(points = {{70, 18}, {70, 14}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(vessels.q_in, flowMeasure.q_out) annotation(Line(points = {{44, -13}, {64, -13}, {64, 0}, {82, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(Infraction.y, vessels.cond2) annotation(Line(points = {{70, 10}, {70, 6}, {31, 6}, {31, -7.8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Viscosity1.y, vessels.cond1) annotation(Line(points = {{-20, 12}, {-20, 6}, {5, 6}, {5, -7.8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(vessels.q_out, q_out) annotation(Line(points = {{-8, -13}, {-54, -13}, {-54, 0}, {-100, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        annotation(Documentation(info = "<HTML>
                   <PRE>
                   Blood resistance in left heart.
                    
                   QHP 2008 / LeftHeart-Flow
                    
                   Created : 23-May-05
                   Last Modified : 23-May-05
                   Author : Tom Coleman
                   Copyright Status : In Public Domain
                   Solver : QHP 2008
                   Schema : 2008.0
                   </PRE>
                   </HTML>
                   ", revisions = "<html>
                   <ul>
                   <li><i>  </i>
                          </li>
                   <li><i> january 2009 </i><br> 
                          by Marek Matejak in Modelica initially implemented (consulted with Jiri Kofranek), Charles University, Prague<br>
                          orginaly described by Tom Coleman in QHP 2008 beta 3, University of Mississippi Medical Center
                          </li>
                   </ul>
                   </html>"), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(graphics={  Text(extent=  {{-100, -100}, {100, -80}}, lineColor=  {0, 0, 255}, textString=  "%name")}), Diagram(graphics));
      end Heart;

      model PeripheralFlow
        import QHP = HumMod;
        extends HumMod.CardioVascular.OrganFlow.BaseBadDirection;
        //extends Library.PressureFlow.ResistorBase;
        HumMod.CardioVascular.OrganFlow.Bone bone annotation(Placement(transformation(extent = {{-38, 64}, {-12, 90}})));
        HumMod.CardioVascular.OrganFlow.Brain brain annotation(Placement(transformation(extent = {{18, 46}, {44, 72}})));
        HumMod.CardioVascular.OrganFlow.Fat fat annotation(Placement(transformation(extent = {{-38, 26}, {-12, 52}})));
        HumMod.CardioVascular.OrganFlow.Kidney kidney annotation(Placement(transformation(extent = {{44, 8}, {18, 34}})));
        HumMod.CardioVascular.OrganFlow.Skin skin annotation(Placement(transformation(extent = {{22, -34}, {46, -10}})));
        HumMod.CardioVascular.OrganFlow.OtherTissue otherTissue annotation(Placement(transformation(extent = {{-36, -98}, {-10, -72}})));
        HumMod.CardioVascular.OrganFlow.SkeletalMuscle skeletalMuscle annotation(Placement(transformation(extent = {{-34, -54}, {-8, -28}})));
        HumMod.CardioVascular.OrganFlow.RespiratoryMuscle respiratoryMuscle annotation(Placement(transformation(extent = {{20, -78}, {46, -52}})));
        PhysiolibraryOld.Interfaces.BusConnector busConnector
          "signals of organ bood flow resistence" annotation (Placement(
              transformation(extent={{-100,80},{-80,100}}), iconTransformation(
                extent={{60,10},{78,28}})));
      equation
        connect(bone.q_in, flowMeasure.q_out) annotation(Line(points = {{-12, 77}, {68, 77}, {68, 0}, {82, 0}}, color = {0, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(brain.q_in, flowMeasure.q_out) annotation(Line(points = {{44, 59}, {68, 59}, {68, 0}, {82, 0}}, color = {0, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(fat.q_in, flowMeasure.q_out) annotation(Line(points = {{-12, 39}, {68, 39}, {68, 0}, {82, 0}}, color = {0, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(skin.q_in, flowMeasure.q_out) annotation(Line(points = {{46, -22}, {68, -22}, {68, 0}, {82, 0}}, color = {0, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(otherTissue.q_in, flowMeasure.q_out) annotation(Line(points = {{-10, -85}, {68, -85}, {68, 0}, {82, 0}}, color = {0, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(skeletalMuscle.q_in, flowMeasure.q_out) annotation(Line(points = {{-8, -41}, {68, -41}, {68, 0}, {82, 0}}, color = {0, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(respiratoryMuscle.q_in, flowMeasure.q_out) annotation(Line(points = {{46, -65}, {68, -65}, {68, 0}, {82, 0}}, color = {0, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(respiratoryMuscle.q_out, q_out) annotation(Line(points = {{20, -65}, {-84, -65}, {-84, 0}, {-100, 0}}, color = {0, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(skeletalMuscle.q_out, q_out) annotation(Line(points = {{-34, -41}, {-84, -41}, {-84, 0}, {-100, 0}}, color = {0, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(otherTissue.q_out, q_out) annotation(Line(points = {{-36, -85}, {-84, -85}, {-84, 0}, {-100, 0}}, color = {0, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(skin.q_out, q_out) annotation(Line(points = {{22, -22}, {-84, -22}, {-84, 0}, {-100, 0}}, color = {0, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(fat.q_out, q_out) annotation(Line(points = {{-38, 39}, {-84, 39}, {-84, 0}, {-100, 0}}, color = {0, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(brain.q_out, q_out) annotation(Line(points = {{18, 59}, {-84, 59}, {-84, 0}, {-100, 0}}, color = {0, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(bone.q_out, q_out) annotation(Line(points = {{-38, 77}, {-84, 77}, {-84, 0}, {-100, 0}}, color = {0, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(busConnector, otherTissue.busConnector) annotation(Line(points = {{-90, 90}, {52, 90}, {52, -82.53}, {-14.03, -82.53}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector, skin.busConnector) annotation(Line(points = {{-90, 90}, {52, 90}, {52, -19.72}, {42.28, -19.72}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector, kidney.busConnector) annotation(Line(points = {{-90, 90}, {14, 90}, {14, 23.47}, {22.03, 23.47}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector, fat.busConnector) annotation(Line(points = {{-90, 90}, {52, 90}, {52, 41.47}, {-16.03, 41.47}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector, brain.busConnector) annotation(Line(points = {{-90, 90}, {52, 90}, {52, 61.47}, {39.97, 61.47}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector, bone.busConnector) annotation(Line(points = {{-90, 90}, {52, 90}, {52, 79.47}, {-16.03, 79.47}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector, skeletalMuscle.busConnector) annotation(Line(points = {{-90, 90}, {52, 90}, {52, -38.53}, {-12.03, -38.53}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector, respiratoryMuscle.busConnector) annotation(Line(points = {{-90, 90}, {52, 90}, {52, -62.53}, {41.97, -62.53}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(bone.BloodFlow, busConnector.bone_BloodFlow) annotation(Line(points = {{-15.9, 74.40000000000001}, {52, 74.40000000000001}, {52, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(brain.BloodFlow, busConnector.brain_BloodFlow) annotation(Line(points = {{40.1, 56.4}, {52, 56.4}, {52, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(fat.BloodFlow, busConnector.fat_BloodFlow) annotation(Line(points = {{-15.9, 36.4}, {52, 36.4}, {52, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(kidney.BloodFlow, busConnector.kidney_BloodFlow) annotation(Line(points = {{21.9, 18.4}, {14, 18.4}, {14, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(skin.BloodFlow, busConnector.skin_BloodFlow) annotation(Line(points = {{42.4, -24.4}, {52, -24.4}, {52, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(skeletalMuscle.BloodFlow, busConnector.skeletalMuscle_BloodFlow) annotation(Line(points = {{-11.9, -43.6}, {52, -43.6}, {52, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(respiratoryMuscle.BloodFlow, busConnector.respiratoryMuscle_BloodFlow) annotation(Line(points = {{42.1, -67.59999999999999}, {52, -67.59999999999999}, {52, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(otherTissue.BloodFlow, busConnector.otherTissue_BloodFlow) annotation(Line(points = {{-13.9, -87.59999999999999}, {52, -87.59999999999999}, {52, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(bone.BloodFlow, busConnector.Bone_BloodFlow) annotation(Line(points = {{-15.9, 74.40000000000001}, {52, 74.40000000000001}, {52, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(brain.BloodFlow, busConnector.Brain_BloodFlow) annotation(Line(points = {{40.1, 56.4}, {52, 56.4}, {52, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(fat.BloodFlow, busConnector.Fat_BloodFlow) annotation(Line(points = {{-15.9, 36.4}, {52, 36.4}, {52, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(kidney.BloodFlow, busConnector.Kidney_BloodFlow) annotation(Line(points = {{21.9, 18.4}, {14, 18.4}, {14, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(skin.BloodFlow, busConnector.Skin_BloodFlow) annotation(Line(points = {{42.4, -24.4}, {52, -24.4}, {52, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(skeletalMuscle.BloodFlow, busConnector.SkeletalMuscle_BloodFlow) annotation(Line(points = {{-11.9, -43.6}, {52, -43.6}, {52, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(respiratoryMuscle.BloodFlow, busConnector.RespiratoryMuscle_BloodFlow) annotation(Line(points = {{42.1, -67.59999999999999}, {52, -67.59999999999999}, {52, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(otherTissue.BloodFlow, busConnector.OtherTissue_BloodFlow) annotation(Line(points = {{-13.9, -87.59999999999999}, {52, -87.59999999999999}, {52, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(kidney.q_out, q_out) annotation(Line(points = {{18, 21}, {-84, 21}, {-84, 0}, {-100, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(kidney.q_in, flowMeasure.q_out) annotation(Line(points = {{44, 21}, {68, 21}, {68, 0}, {82, 0}}, color = {0, 0, 0}, smooth = Smooth.None, thickness = 1));
        annotation(Documentation(info = "<HTML>
                   <PRE>
                   Blood resistance in peripheral organs except hepatic artery, gastro interstitional tract, vena porte, liver and liver veins.
                   </PRE>
                   </HTML>
                   ", revisions = "<html>
                   <ul>
                   <li><i>  </i>
                          </li>
                   <li><i> january 2009 </i><br> 
                          by Marek Matejak in Modelica initially implemented (consulted with Jiri Kofranek), Charles University, Prague<br>
                          orginaly described by Tom Coleman in QHP 2008 beta 3, University of Mississippi Medical Center
                          </li>
                   </ul>
                   </html>"), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(graphics={  Text(extent=  {{-120, -108}, {80, -80}}, lineColor=  {0, 0, 255}, textString=  "%name"), Bitmap(extent=  {{-66, 98}, {38, -80}}, fileName=  "icons/krevniReciste.png")}), Diagram(graphics));
      end PeripheralFlow;

      model VasaRecta
        PhysiolibraryOld.PressureFlow.ResistorWithCond resistorWithCond
          annotation (Placement(transformation(extent={{2,0},{22,20}})));
        PhysiolibraryOld.Factors.CurveValue OsmOnConductance(data={{600,1.4,0},
              {1100,1.0,-0.0005999999999999999},{2000,0.8,0}})
          annotation (Placement(transformation(extent={{2,38},{22,58}})));
        PhysiolibraryOld.Factors.CurveValue A2OnConductance(data={{0.0,1.3,0},{
              1.3,1.0,-0.6},{2.0,0.5,0}})
          annotation (Placement(transformation(extent={{2,26},{22,46}})));
        PhysiolibraryOld.Factors.CurveValue SympsOnConductance(data={{0.0,1.1,0},
              {1.0,1.0,-0.13},{1.4,0.6,0}})
          annotation (Placement(transformation(extent={{2,18},{22,38}})));
        PhysiolibraryOld.Blocks.CondConstant condConstant(k=0.27)
          annotation (Placement(transformation(extent={{-4,62},{8,74}})));
        PhysiolibraryOld.Interfaces.BusConnector busConnector
          "signals of organ bood flow resistence" annotation (Placement(
              transformation(extent={{-96,64},{-74,86}}), iconTransformation(
                extent={{-100,60},{-60,100}})));
        PhysiolibraryOld.PressureFlow.FlowMeasure flowMeasure
          annotation (Placement(transformation(extent={{32,20},{52,0}})));
        PhysiolibraryOld.PressureFlow.InputPump inputPump
          annotation (Placement(transformation(extent={{-54,-48},{-34,-28}})));
        Modelica.Blocks.Math.Add Osm annotation(Placement(transformation(extent = {{-14, 44}, {-6, 52}})));
        PhysiolibraryOld.Interfaces.RealInput_ ArcuateArtery_Pressure
          annotation (Placement(transformation(extent={{-80,20},{-68,32}}),
              iconTransformation(extent={{-100,-20},{-60,20}})));
        PhysiolibraryOld.Factors.CurveValue NephroneADHOnConductance(data={{0.0,
              1.4,0},{0.3,1.0,-0.4},{1.0,0.9,0}})
          annotation (Placement(transformation(extent={{2,46},{22,66}})));
        PhysiolibraryOld.PressureFlow.InputPressurePump arcuateArtery
          annotation (Placement(transformation(extent={{-74,0},{-54,20}})));
        PhysiolibraryOld.PressureFlow.OutputPressurePump veins
          annotation (Placement(transformation(extent={{54,0},{74,20}})));
      equation
        connect(SympsOnConductance.y, resistorWithCond.cond) annotation(Line(points = {{12, 26}, {12, 14}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(A2OnConductance.y, SympsOnConductance.yBase) annotation(Line(points = {{12, 34}, {12, 30}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(OsmOnConductance.y, A2OnConductance.yBase) annotation(Line(points = {{12, 46}, {12, 38}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.A2Pool_Log10Conc, A2OnConductance.u) annotation(Line(points = {{-85, 75}, {-60, 75}, {-60, 36}, {2.2, 36}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.Kidney_Alpha_NA, SympsOnConductance.u) annotation(Line(points = {{-85, 75}, {-60, 75}, {-60, 28}, {2.2, 28}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(resistorWithCond.q_out, flowMeasure.q_in) annotation(Line(points = {{22, 10}, {36, 10}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(flowMeasure.actualFlow, busConnector.VasaRecta_Outflow) annotation(Line(points = {{42, 4.6}, {42, -10}, {84, -10}, {84, 75}, {-85, 75}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, -12}, {6, -12}}));
        connect(inputPump.q_out, flowMeasure.q_in) annotation(Line(points = {{-34, -37}, {26, -37}, {26, 10}, {36, 10}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(Osm.y, OsmOnConductance.u) annotation(Line(points = {{-5.6, 48}, {2.2, 48}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.MedullaNa_Osmolarity, Osm.u1) annotation(Line(points = {{-85, 75}, {-60, 75}, {-60, 50.4}, {-14.8, 50.4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.MedullaUrea_Osmolarity, Osm.u2) annotation(Line(points = {{-85, 75}, {-60, 75}, {-60, 45.6}, {-14.8, 45.6}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.CD_H2O_Reab, inputPump.desiredFlow) annotation(Line(points = {{-85, 75}, {-76, 75}, {-76, -22}, {-44, -22}, {-44, -32}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(NephroneADHOnConductance.y, OsmOnConductance.yBase) annotation(Line(points = {{12, 54}, {12, 50}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(condConstant.y, NephroneADHOnConductance.yBase) annotation(Line(points = {{8.6, 68}, {12, 68}, {12, 58}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.NephronADH, NephroneADHOnConductance.u) annotation(Line(points = {{-85, 75}, {-60, 75}, {-60, 56}, {2.2, 56}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(arcuateArtery.p_out, resistorWithCond.q_in) annotation(Line(points = {{-56, 10}, {2, 10}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(ArcuateArtery_Pressure, arcuateArtery.desiredPressure) annotation(Line(points = {{-74, 26}, {-64, 26}, {-64, 16}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(veins.desiredPressure, busConnector.SystemicVeins_Pressure) annotation(Line(points = {{64, 16}, {64, 75}, {-85, 75}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(flowMeasure.q_out, veins.p_in) annotation(Line(points = {{48, 10}, {56, 10}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Documentation(revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>2010</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr>
                   </table>
                   </html>"));
      end VasaRecta;

      model LeftHeart
        extends Heart(Vasculature(stateName = "LeftHeart-Vasculature.Effect"));
        extends PhysiolibraryOld.Icons.LeftHeart;
      equation
        connect(busConnector.LeftHeart_Function_Failed, Vasculature.Failed) annotation(Line(points = {{-90, 90}, {6, 90}, {6, 44}, {60.2, 44}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.LeftHeart_PO2, PO2Effect.u) annotation(Line(points = {{-90, 90}, {6, 90}, {6, 30}, {60.2, 30}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.LeftHeart_O2Need, MetabolismEffect.u) annotation(Line(points = {{-90, 90}, {6, 90}, {6, 20}, {60.2, 20}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.LeftHeart_PO2, Vasculature.u) annotation(Line(points = {{-90, 90}, {6, 90}, {6, 38}, {60.2, 38}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        annotation(Diagram(graphics));
      end LeftHeart;

      model RightHeart
        extends Heart(Vasculature(stateName = "RightHeart-Vasculature.Effect"));
        extends PhysiolibraryOld.Icons.RightHeart;
      equation
        connect(busConnector.RightHeart_PO2, Vasculature.u) annotation(Line(points = {{-90, 90}, {6, 90}, {6, 38}, {60.2, 38}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.RightHeart_PO2, PO2Effect.u) annotation(Line(points = {{-90, 90}, {6, 90}, {6, 30}, {60.2, 30}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.RightHeart_O2Need, MetabolismEffect.u) annotation(Line(points = {{-90, 90}, {6, 90}, {6, 20}, {60.2, 20}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.RightHeart_Function_Failed, Vasculature.Failed) annotation(Line(points = {{-90, 90}, {6, 90}, {6, 44}, {60.2, 44}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        annotation(Diagram(graphics));
      end RightHeart;

      model SplanchnicCirculation
        extends PhysiolibraryOld.PressureFlow.ResistorBase2;
        PhysiolibraryOld.Interfaces.BusConnector busConnector
          "signals of organ bood flow resistence" annotation (Placement(
              transformation(extent={{56,-56},{76,-36}}), iconTransformation(
                extent={{-108,42},{-92,58}})));
        VascularCompartments.VascularElasticBloodCompartment portalVein(initialVol = 1009.99, stateName = "SplanchnicVeins.Vol") annotation(Placement(transformation(extent = {{-16, -10}, {5, 11}})));
        OrganFlow.GITract GITract annotation(Placement(transformation(extent = {{34, -12}, {58, 12}})));
        PhysiolibraryOld.Blocks.PressureConstant ExternalPressure(k=0)
          annotation (Placement(transformation(extent={{4,22},{-4,30}})));
        PhysiolibraryOld.Blocks.ComplianceConstant Compliance(k=62.5)
          annotation (Placement(transformation(extent={{12,10},{4,18}})));
        PhysiolibraryOld.Blocks.Constant V0(k=500)
          annotation (Placement(transformation(extent={{-27,11},{-19,19}})));
        Liver liver annotation(Placement(transformation(extent = {{-32, 34}, {-56, 58}})));
      equation
        connect(GITract.busConnector, busConnector) annotation(Line(points = {{54.28, 2.28}, {66, 2.28}, {66, -46}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(portalVein.ExternalPressure, ExternalPressure.y) annotation(Line(points = {{-5.5, 11}, {-5.5, 26}, {-4.4, 26}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(portalVein.Compliance, Compliance.y) annotation(Line(points = {{0.8, 11}, {0.8, 14}, {3.6, 14}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(portalVein.V0, V0.y) annotation(Line(points = {{-11.8, 11}, {-11.8, 15}, {-18.6, 15}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(GITract.BloodFlow, busConnector.GITract_BloodFlow) annotation(Line(points = {{54.4, -2.4}, {66, -2.4}, {66, -46}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(portalVein.Pressure, busConnector.SplanchnicVeins_Pressure) annotation(Line(points = {{-1.3, -10}, {-1.3, -46}, {66, -46}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, -3}, {3, -3}}));
        connect(V0.y, busConnector.PortalVein_V0) annotation(Line(points = {{-18.6, 15}, {-14, 15}, {-14, -46}, {66, -46}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(portalVein.Vol, busConnector.SplanchnicCirculation_DeoxygenatedBloodVolume) annotation(Line(points = {{-9.699999999999999, -10}, {-9.699999999999999, -46}, {66, -46}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(portalVein.referencePoint, liver.portalVein) annotation(Line(points = {{-5.5, 0.5}, {-46.64, 0.5}, {-46.64, 40.24}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(busConnector, liver.busConnector) annotation(Line(points = {{66, -46}, {66, 48.28}, {-52.28, 48.28}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(GITract.q_out, portalVein.referencePoint) annotation(Line(points = {{34, 0}, {14.25, 0}, {14.25, 0.5}, {-5.5, 0.5}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(GITract.q_in, q_in) annotation(Line(points = {{58, 0}, {100, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(liver.q_in, q_in) annotation(Line(points = {{-32, 46}, {82, 46}, {82, 0}, {100, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(liver.q_out, q_out) annotation(Line(points = {{-56, 46}, {-82, 46}, {-82, 0}, {-100, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Bitmap(extent=  {{-100, 100}, {100, -100}}, fileName=  "icons/perfusion2.png"), Text(extent=  {{-108, -48}, {106, -70}}, lineColor=  {0, 0, 255}, textString=  "%name"), Bitmap(extent=  {{-34, 46}, {34, -48}}, fileName=  "icons/traviciTrakt03.png")}), Documentation(revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Design:</td>
                   <td>Zuzana Rubaninska</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>january 2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr>
                   </table>
                   </html>", info = "<html>
                   <p>Blood volume (and pressures) distribution between </p>
                   <p><ul>
                   <li>pulmonary arteries, </li>
                   <li>pulmonary veins and </li>
                   <li>pulmonary capilaries.</li>
                   </ul></p>
                   <p>Blood flow through ventilated alveoli.</p>
                   </html>"));
      end SplanchnicCirculation;

      model Liver
        extends Base;
        extends PhysiolibraryOld.Icons.Liver;
        PhysiolibraryOld.PressureFlow.PositivePressureFlow portalVein
          annotation (extent=[-10,-110; 10,-90], Placement(transformation(
                extent={{-14,-10},{6,10}}), iconTransformation(extent={{12,-58},
                  {32,-38}})));
        PhysiolibraryOld.PressureFlow.ResistorWithCondParam
          splachnicVeinsConductance(cond=1250)
          "corrected to flow 1250ml/min in pressure gradient 1 mmHg"
          annotation (Placement(transformation(extent={{34,-8},{50,8}})));
        PhysiolibraryOld.PressureFlow.FlowMeasure flowMeasure1 annotation (
            Placement(transformation(
              extent={{10,10},{-10,-10}},
              rotation=180,
              origin={74,0})));
        PhysiolibraryOld.PressureFlow.FlowMeasure flowMeasure2 annotation (
            Placement(transformation(
              extent={{10,10},{-10,-10}},
              rotation=180,
              origin={14,0})));
        PhysiolibraryOld.PressureFlow.ResistorWithCondParam
          HepaticArtyConductance(cond=2.8)
          annotation (Placement(transformation(extent={{-20,36},{0,56}})));
        PhysiolibraryOld.PressureFlow.FlowMeasure flowMeasure3 annotation (
            Placement(transformation(
              extent={{10,10},{-10,-10}},
              rotation=180,
              origin={-32,46})));
      equation
        connect(flowMeasure1.actualFlow, busConnector.Liver_BloodFlow) annotation(Line(points = {{74, 5.4}, {74, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(flowMeasure2.actualFlow, busConnector.PortalVein_BloodFlow) annotation(Line(points = {{14, 5.4}, {14, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(flowMeasure3.actualFlow, busConnector.HepaticArty_BloodFlow) annotation(Line(points = {{-32, 51.4}, {-32, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(portalVein, flowMeasure2.q_in) annotation(Line(points = {{-4, 0}, {8, 0}, {8, 7.34788e-016}, {8, 7.34788e-016}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(flowMeasure.q_out, flowMeasure3.q_in) annotation(Line(points = {{-82, 0}, {-76, 0}, {-76, 46}, {-38, 46}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(flowMeasure3.q_out, HepaticArtyConductance.q_in) annotation(Line(points = {{-26, 46}, {-20, 46}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(splachnicVeinsConductance.q_out, flowMeasure1.q_in) annotation(Line(points = {{50, 0}, {59, 0}, {59, 7.34788e-016}, {68, 7.34788e-016}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(flowMeasure1.q_out, q_out) annotation(Line(points = {{80, -7.34788e-016}, {90, -7.34788e-016}, {90, 0}, {100, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(flowMeasure2.q_out, splachnicVeinsConductance.q_in) annotation(Line(points = {{20, -7.34788e-016}, {28, -7.34788e-016}, {28, 0}, {34, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(HepaticArtyConductance.q_out, splachnicVeinsConductance.q_in) annotation(Line(points = {{0, 46}, {28, 46}, {28, 0}, {34, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Diagram(graphics));
      end Liver;

      model AfferentArteryMyogenicReceptors
        extends PhysiolibraryOld.Utilities.DynamicState(
                                                     stateName = "Kidney-Myogenic.AdaptedPressure");
        parameter Real Tau = 4;
        parameter Real K = 1 / (60.0 * Tau);
        Real AdaptedPressure(unit = "mmHg");
        PhysiolibraryOld.Interfaces.RealInput InterlobarPressure(unit="mmHg")
          annotation (Placement(transformation(extent={{-100,20},{-60,60}}),
              iconTransformation(extent={{-100,20},{-60,60}})));
        PhysiolibraryOld.Interfaces.RealOutput PressureChange_SteadyState(unit=
              "mmHg") annotation (Placement(transformation(extent={{80,-60},{
                  120,-20}}), iconTransformation(extent={{80,-60},{120,-20}})));
      equation
        stateValue = AdaptedPressure;
        changePerMin = K * (InterlobarPressure - AdaptedPressure);
        PressureChange_SteadyState = InterlobarPressure - AdaptedPressure;
        annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
      end AfferentArteryMyogenicReceptors;

      model Skin
        extends HumMod.CardioVascular.OrganFlow.BaseBadDirection;
        extends PhysiolibraryOld.Icons.Skin;
        PhysiolibraryOld.PressureFlow.ResistorWithCond skin
          annotation (Placement(transformation(extent={{80,-26},{56,-2}})));
        PhysiolibraryOld.Factors.CurveValue A2Effect_Skin(data={{0.0,1.05,0},{
              1.3,1.0,-0.08},{3.5,0.5,0}})
          annotation (Placement(transformation(extent={{58,30},{78,50}})));
        PhysiolibraryOld.Factors.CurveValue ADHEffect_Skin(data={{0.8,1.0,0},{
              3.0,0.1,0}})
          annotation (Placement(transformation(extent={{58,16},{78,36}})));
        PhysiolibraryOld.Blocks.CondConstant BasicConductance(k=1.6)
          annotation (Placement(transformation(extent={{54,72},{66,84}})));
        PhysiolibraryOld.Factors.SimpleMultiply Viscosity_Skin
          annotation (Placement(transformation(extent={{58,58},{78,78}})));
        PhysiolibraryOld.Factors.SimpleMultiply Anesthesia_Skin
          annotation (Placement(transformation(extent={{58,50},{78,70}})));
        PhysiolibraryOld.Factors.SplineDelayFactorByDayWithFailture
          Vasculature_Skin(
          Tau=30,
          data={{41,1.2,0},{51,1.0,-0.03},{61,0.8,0}},
          stateName="Skin-Vasculature.Effect")
          annotation (Placement(transformation(extent={{58,40},{78,60}})));
        PhysiolibraryOld.Factors.SimpleMultiply TermoregulationEffect
          annotation (Placement(transformation(extent={{58,-2},{78,18}})));
      equation
        connect(Anesthesia_Skin.yBase, Viscosity_Skin.y) annotation(Line(points = {{68, 62}, {68, 66}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Anesthesia_Skin.y, Vasculature_Skin.yBase) annotation(Line(points = {{68, 58}, {68, 55}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Vasculature_Skin.y, A2Effect_Skin.yBase) annotation(Line(points = {{68, 44.8}, {68, 42}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(BasicConductance.y, Viscosity_Skin.yBase) annotation(Line(points = {{66.59999999999999, 78}, {68, 78}, {68, 70}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.Viscosity_ConductanceEffect, Viscosity_Skin.u) annotation(Line(points = {{-90, 90}, {-12, 90}, {-12, 68}, {58.2, 68}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.Anesthesia_VascularConductance, Anesthesia_Skin.u) annotation(Line(points = {{-90, 90}, {-12, 90}, {-12, 60}, {58.2, 60}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.Skin_Function_Failed, Vasculature_Skin.Failed) annotation(Line(points = {{-90, 90}, {-12, 90}, {-12, 54}, {58.2, 54}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.Skin_PO2, Vasculature_Skin.u) annotation(Line(points = {{-90, 90}, {-12, 90}, {-12, 48}, {58.2, 48}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.A2Pool_Log10Conc, A2Effect_Skin.u) annotation(Line(points = {{-90, 90}, {-12, 90}, {-12, 40}, {58.2, 40}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.ADHPool_Log10Conc, ADHEffect_Skin.u) annotation(Line(points = {{-90, 90}, {-12, 90}, {-12, 26}, {58.2, 26}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(skin.q_out, q_out) annotation(Line(points = {{56, -14}, {-24, -14}, {-24, 0}, {-100, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(skin.q_in, flowMeasure.q_out) annotation(Line(points = {{80, -14}, {80, 0}, {82, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(ADHEffect_Skin.y, busConnector.skin_conductanceWithoutTermoregulationEffect) annotation(Line(points = {{68, 24}, {-90, 24}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(busConnector.skinFlow_termoregulationEffect, TermoregulationEffect.u) annotation(Line(points = {{-90, 90}, {-88, 90}, {-88, 8}, {58.2, 8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(ADHEffect_Skin.y, TermoregulationEffect.yBase) annotation(Line(points = {{68, 24}, {68, 10}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(TermoregulationEffect.y, skin.cond) annotation(Line(points = {{68, 6}, {68, -9.199999999999999}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(A2Effect_Skin.y, ADHEffect_Skin.yBase) annotation(Line(points = {{68, 38}, {68, 28}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Documentation(info = "<HTML>
                   <PRE>
                   Blood resistance in skin.
                    
                   QHP 2008 / Skin-Flow
                    
                   Created : 23-May-05
                   Last Modified : 01-Jul-06
                   Author : Tom Coleman
                   Copyright Status : In Public Domain
                   Solver : QHP 2008
                   Schema : 2008.0
                   </PRE>
                   </HTML>
                   ", revisions = "<html>
                   <ul>
                   <li><i>  </i>
                          </li>
                   <li><i> january 2009 </i><br> 
                          by Marek Matejak in Modelica initially implemented (consulted with Jiri Kofranek), Charles University, Prague<br>
                          orginaly described by Tom Coleman in QHP 2008 beta 3, University of Mississippi Medical Center
                          </li>
                   </ul>
                   </html>"), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(graphics={  Text(extent=  {{-100, -100}, {100, -80}}, lineColor=  {0, 0, 255}, textString=  "%name")}));
      end Skin;
    end OrganFlow;

    package BlooodVolume "Red Cells and Blood Properties"
      model RedCells2
        extends PhysiolibraryOld.Icons.RedCells;
        PhysiolibraryOld.PressureFlow.OutputPump RBCClearance
          annotation (Placement(transformation(extent={{48,-10},{68,10}})));
        PhysiolibraryOld.PressureFlow.VolumeCompartement RBCVolume(
            initialVolume=2373.2, stateName="RBCVol.Vol")
          annotation (Placement(transformation(extent={{-4,-20},{16,0}})));
        PhysiolibraryOld.PressureFlow.InputPump transfusion
          annotation (Placement(transformation(extent={{-48,26},{-28,46}})));
        PhysiolibraryOld.PressureFlow.OutputPump hemorrhage
          annotation (Placement(transformation(extent={{48,26},{68,46}})));
        PhysiolibraryOld.Factors.SplineDelayByDay EPOEffect(
          Tau=3,
          data={{0.0,0.0,0},{1.3,1.0,1.0},{4.0,4.0,0}},
          stateName="[EPO]Delay.Effect")
          annotation (Placement(transformation(extent={{-78,4},{-56,26}})));
        PhysiolibraryOld.Blocks.FlowConstant RBCBaseSecretionRate(k=0.013889)
          annotation (Placement(transformation(extent={{-80,20},{-70,30}})));
        PhysiolibraryOld.PressureFlow.InputPump RBCProduction
          annotation (Placement(transformation(extent={{-78,-12},{-56,10}})));
        PhysiolibraryOld.Interfaces.BusConnector busConnector
          annotation (Placement(transformation(extent={{-98,48},{-78,68}})));
        Modelica.Blocks.Math.Gain gain(k = 1 / 120 * 1 / 1440) annotation(Placement(transformation(extent={{36,6},{
                  44,14}})));
        Modelica.Blocks.Math.Gain H2O(k = 1 - 0.34) annotation(Placement(transformation(extent = {{36, -44}, {44, -36}})));
      equation
        connect(busConnector.Transfusion_RBCRate, transfusion.desiredFlow) annotation(Line(points = {{-88, 58}, {-38, 58}, {-38, 42}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.Hemorrhage_RBCRate, hemorrhage.desiredFlow) annotation(Line(points = {{-88, 58}, {58, 58}, {58, 42}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(RBCBaseSecretionRate.y, EPOEffect.yBase) annotation(Line(points = {{-69.5, 25}, {-67, 25}, {-67, 17.2}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(EPOEffect.u, busConnector.EPOPool_Log10Conc) annotation(Line(points = {{-77.78, 15}, {-86.90000000000001, 15}, {-86.90000000000001, 58}, {-88, 58}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(RBCProduction.desiredFlow, EPOEffect.y) annotation(Line(points = {{-67, 5.6}, {-67, 12.8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(RBCProduction.q_out, RBCVolume.con) annotation(Line(points = {{-56, 0.1}, {-4.6, 0.1}, {-4.6, -10}, {-4, -10}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(transfusion.q_out, RBCVolume.con) annotation(Line(points = {{-28, 37}, {-4, 37}, {-4, -10}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(RBCVolume.con, hemorrhage.q_in) annotation(Line(points = {{-4, -10}, {-4, 36}, {48, 36}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(RBCVolume.con, RBCClearance.q_in) annotation(Line(points = {{-4, -10}, {-4, 0}, {48, 0}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(RBCVolume.Volume, gain.u) annotation(Line(points={{7.2,-20},{22,
                -20},{22,10},{35.2,10}},                                                                          color = {0, 0, 127}, smooth = Smooth.None));
        connect(gain.y, RBCClearance.desiredFlow) annotation(Line(points={{44.4,10},
                {58,10},{58,6}},                                                                            color = {0, 0, 127}, smooth = Smooth.None));
        connect(RBCVolume.Volume, busConnector.RBCVol_Vol) annotation(Line(points = {{7.2, -20}, {7.2, -28}, {100, -28}, {100, 58}, {-88, 58}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, -5}, {6, -5}}));
        connect(RBCVolume.Volume, H2O.u) annotation(Line(points = {{7.2, -20}, {8, -20}, {8, -40}, {35.2, -40}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(H2O.y, busConnector.RBCH2O_Vol) annotation(Line(points = {{44.4, -40}, {100, -40}, {100, 58}, {-88, 58}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        annotation(Diagram(coordinateSystem(preserveAspectRatio=false,  extent={{-100,
                  -100},{100,100}}),                                                                          graphics), Icon(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-136, -46}, {148, -68}}, lineColor=  {0, 0, 255}, textString=  "%name")}), Documentation(revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr>
                   </table>
                   </html>"));
      end RedCells2;

      model BloodPropertiesBase
        extends PhysiolibraryOld.Icons.Blood;
        Modelica.Blocks.Math.Add BloodVolume annotation(Placement(transformation(extent = {{14, -70}, {22, -62}})));
        Modelica.Blocks.Math.Min CollapsedEffect annotation(Placement(transformation(extent = {{50, -84}, {58, -76}})));
        Modelica.Blocks.Math.Division division annotation(Placement(transformation(extent = {{38, -78}, {46, -70}})));
        PhysiolibraryOld.Blocks.Constant const(k=1)
          annotation (Placement(transformation(extent={{38,-94},{46,-86}})));
        Modelica.Blocks.Math.Division HtcFract annotation(Placement(transformation(extent = {{32, -46}, {40, -38}})));
        PhysiolibraryOld.Curves.Curve HtcOnVisc(
          x={0,0.44,0.8},
          y={0.5,1,5},
          slope={0.8,3,30})
          annotation (Placement(transformation(extent={{46,-52},{66,-32}})));
        Modelica.Blocks.Math.Division division1 annotation(Placement(transformation(extent = {{78, -40}, {86, -32}})));
        PhysiolibraryOld.Blocks.Constant const1(k=1)
          annotation (Placement(transformation(extent={{64,-30},{72,-22}})));
        PhysiolibraryOld.Blocks.Constant const2(k=1)
          annotation (Placement(transformation(extent={{28,-14},{36,-6}})));
        Modelica.Blocks.Math.Feedback PVCrit annotation(Placement(transformation(extent = {{38, -14}, {46, -6}})));
        PhysiolibraryOld.Blocks.Constant Constant4(k=8.4)
          annotation (Placement(transformation(extent={{-6,8},{-14,16}})));
        PhysiolibraryOld.Blocks.Constant Constant1(k=0.44)
          annotation (Placement(transformation(extent={{-66,-8},{-58,0}})));
        PhysiolibraryOld.Factors.SimpleMultiply hematocritEffect
          annotation (Placement(transformation(extent={{-30,-10},{-10,10}})));
        Modelica.Blocks.Math.Division division2 annotation(Placement(transformation(extent = {{-50, -4}, {-42, 4}})));
        PhysiolibraryOld.Blocks.Constant Constant5(k=5.4)
          annotation (Placement(transformation(extent={{26,90},{18,98}})));
        PhysiolibraryOld.Blocks.Constant Constant6(k=0.005)
          annotation (Placement(transformation(extent={{26,82},{18,90}})));
        PhysiolibraryOld.Blocks.Constant Constant7(k=0.005)
          annotation (Placement(transformation(extent={{26,74},{18,82}})));
        PhysiolibraryOld.Interfaces.BusConnector busConnector
          annotation (Placement(transformation(extent={{-104,58},{-84,78}})));
        Modelica.Blocks.Math.Division division3(y(unit = "mmol/l")) annotation(Placement(transformation(extent = {{-4, -4}, {4, 4}}, rotation = 0, origin = {10, 2})));
        Modelica.Blocks.Math.Feedback feedback annotation(Placement(transformation(extent = {{-20, 32}, {-40, 52}})));
        Modelica.Blocks.Math.Add BloodVolume1 annotation(Placement(transformation(extent = {{-46, 24}, {-38, 32}})));
        Modelica.Blocks.Math.Product product annotation(Placement(transformation(extent = {{66, 2}, {74, 10}})));
        Modelica.Blocks.Math.Sum V0(nin = 5) annotation(Placement(transformation(extent = {{-30, -90}, {-22, -82}})));
        Modelica.Blocks.Math.Sum VeinsVol(nin = 4)
          "volume of deoxygenated blood"                                          annotation(Placement(transformation(extent = {{-26, -54}, {-18, -46}})));
        Modelica.Blocks.Math.Sum ArtysVol(nin = 3) "volume of oxygenated blood"
                                                                                annotation(Placement(transformation(extent = {{-26, -34}, {-18, -26}})));
      equation
        connect(busConnector.PlasmaVol_Vol, BloodVolume.u2) annotation(Line(points = {{-94, 68}, {-94, -68.40000000000001}, {13.2, -68.40000000000001}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.RBCVol_Vol, BloodVolume.u1) annotation(Line(points = {{-94, 68}, {-94, -63.6}, {13.2, -63.6}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(division.y, CollapsedEffect.u1) annotation(Line(points = {{46.4, -74}, {47.8, -74}, {47.8, -77.59999999999999}, {49.2, -77.59999999999999}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.Vesseles_V0, division.u2) annotation(Line(points = {{-94, 68}, {-94, -74}, {37.2, -74}, {37.2, -76.40000000000001}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(BloodVolume.y, division.u1) annotation(Line(points = {{22.4, -66}, {28, -66}, {28, -71.59999999999999}, {37.2, -71.59999999999999}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(const.y, CollapsedEffect.u2) annotation(Line(points = {{46.4, -90}, {48, -90}, {48, -82.40000000000001}, {49.2, -82.40000000000001}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(CollapsedEffect.y, busConnector.BloodVol_CollapsedEffect) annotation(Line(points = {{58.4, -80}, {90, -80}, {90, 68}, {-94, 68}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(HtcFract.u2, BloodVolume.y) annotation(Line(points = {{31.2, -44.4}, {28, -44.4}, {28, -66}, {22.4, -66}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(HtcFract.u1, busConnector.RBCVol_Vol) annotation(Line(points = {{31.2, -39.6}, {-94, -39.6}, {-94, 68}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(HtcFract.y, HtcOnVisc.u) annotation(Line(points = {{40.4, -42}, {46, -42}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(const1.y, division1.u1) annotation(Line(points = {{72.40000000000001, -26}, {74, -26}, {74, -33.6}, {77.2, -33.6}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(HtcOnVisc.val, division1.u2) annotation(Line(points = {{66.2, -42}, {75.5, -42}, {75.5, -38.4}, {77.2, -38.4}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(division1.y, busConnector.Viscosity_ConductanceEffect) annotation(Line(points = {{86.40000000000001, -36}, {90, -36}, {90, 68}, {-94, 68}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(HtcFract.y, busConnector.BloodVol_Hct) annotation(Line(points = {{40.4, -42}, {42, -42}, {42, -20}, {-94, -20}, {-94, 68}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(const2.y, PVCrit.u1) annotation(Line(points = {{36.4, -10}, {38.8, -10}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(HtcFract.y, PVCrit.u2) annotation(Line(points = {{40.4, -42}, {42, -42}, {42, -13.2}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(PVCrit.y, busConnector.BloodVol_PVCrit) annotation(Line(points = {{45.6, -10}, {90, -10}, {90, 68}, {-94, 68}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(Constant4.y, hematocritEffect.yBase) annotation(Line(points = {{-14.4, 12}, {-20, 12}, {-20, 2}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(hematocritEffect.y, busConnector.ctHb) annotation(Line(points = {{-20, -2}, {-20, -10}, {-94, -10}, {-94, 68}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(division2.y, hematocritEffect.u) annotation(Line(points = {{-41.6, 0}, {-29.8, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Constant1.y, division2.u2) annotation(Line(points = {{-57.6, -4}, {-55.2, -4}, {-55.2, -2.4}, {-50.8, -2.4}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(HtcFract.y, division2.u1) annotation(Line(points = {{40.4, -42}, {42, -42}, {42, -20}, {-72, -20}, {-72, 2.4}, {-50.8, 2.4}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.cDPG, Constant5.y) annotation(Line(points = {{-94, 68}, {-4, 68}, {-4, 94}, {17.6, 94}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.FMetHb, Constant6.y) annotation(Line(points = {{-94, 68}, {-4, 68}, {-4, 86}, {17.6, 86}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.FHbF, Constant7.y) annotation(Line(points = {{-94, 68}, {-4, 68}, {-4, 78}, {17.6, 78}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(Constant4.y, division3.u1) annotation(Line(points = {{-14.4, 12}, {-20, 12}, {-20, 4}, {5.2, 4}, {5.2, 4.4}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(HtcFract.y, division3.u2) annotation(Line(points = {{40.4, -42}, {42, -42}, {42, -20}, {-2, -20}, {-2, -0.4}, {5.2, -0.4}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(division3.y, busConnector.ctHb_ery) annotation(Line(points = {{14.4, 2}, {20, 2}, {20, 68}, {-94, 68}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(BloodVolume.y, feedback.u1) annotation(Line(points = {{22.4, -66}, {28, -66}, {28, 42}, {-22, 42}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.ArtysVol, BloodVolume1.u1) annotation(Line(points = {{-94, 68}, {-94, 30}, {-46.8, 30}, {-46.8, 30.4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.VeinsVol, BloodVolume1.u2) annotation(Line(points = {{-94, 68}, {-94, 26}, {-46.8, 26}, {-46.8, 25.6}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(BloodVolume1.y, feedback.u2) annotation(Line(points = {{-37.6, 28}, {-30, 28}, {-30, 34}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(PVCrit.y, product.u2) annotation(Line(points = {{45.6, -10}, {54, -10}, {54, 3.6}, {65.2, 3.6}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.PortalVein_BloodFlow, product.u1) annotation(Line(points = {{-94, 68}, {54, 68}, {54, 8.4}, {65.2, 8.4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(product.y, busConnector.PortalVein_PlasmaFlow) annotation(Line(points = {{74.40000000000001, 6}, {90, 6}, {90, 68}, {-94, 68}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(V0.y, busConnector.Vesseles_V0) annotation(Line(points = {{-21.6, -86}, {2, -86}, {2, -78}, {-94, -78}, {-94, 68}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(busConnector.PulmonaryCirculation_V0, V0.u[1]) annotation(Line(points = {{-94, 68}, {-94, -82}, {-32, -82}, {-32, -86.64}, {-30.8, -86.64}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 6}, {-6, 6}}));
        connect(busConnector.Heart_V0, V0.u[2]) annotation(Line(points = {{-94, 68}, {-94, -86.31999999999999}, {-30.8, -86.31999999999999}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 2}, {-6, 2}}));
        connect(busConnector.SystemicArtys_V0, V0.u[3]) annotation(Line(points = {{-94, 68}, {-94, -90}, {-32, -90}, {-32, -86}, {-30.8, -86}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, -2}, {-6, -2}}));
        connect(busConnector.PortalVein_V0, V0.u[4]) annotation(Line(points = {{-94, 68}, {-94, -94}, {-32, -94}, {-32, -86}, {-30.8, -85.68000000000001}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, -6}, {-6, -6}}));
        connect(busConnector.SystemicVeins_V0, V0.u[5]) annotation(Line(points = {{-94, 68}, {-94, -98}, {-32, -98}, {-32, -86}, {-30.8, -85.36}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, -10}, {-6, -10}}));
        connect(VeinsVol.y, busConnector.VeinsVol) annotation(Line(points = {{-17.6, -50}, {2, -50}, {2, -42}, {-94, -42}, {-94, 68}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(busConnector.PulmonaryCirculation_DeoxygenatedBloodVolume, VeinsVol.u[1]) annotation(Line(points = {{-94, 68}, {-94, -46}, {-28, -46}, {-28, -50.6}, {-26.8, -50.6}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 6}, {-6, 6}}));
        connect(busConnector.Heart_DeoxygenatedBloodVolume, VeinsVol.u[2]) annotation(Line(points = {{-94, 68}, {-94, -50.2}, {-26.8, -50.2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 2}, {-6, 2}}));
        connect(busConnector.SplanchnicCirculation_DeoxygenatedBloodVolume, VeinsVol.u[3]) annotation(Line(points = {{-94, 68}, {-94, -54}, {-28, -54}, {-28, -49.8}, {-26.8, -49.8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, -2}, {-6, -2}}));
        connect(busConnector.SystemicVeins_DeoxygenatedBloodVolume, VeinsVol.u[4]) annotation(Line(points = {{-94, 68}, {-94, -58}, {-28, -58}, {-28, -49.4}, {-26.8, -49.4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, -6}, {-6, -6}}));
        connect(ArtysVol.y, busConnector.ArtysVol) annotation(Line(points = {{-17.6, -30}, {2, -30}, {2, -22}, {-94, -22}, {-94, 68}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(busConnector.PulmonaryCirculation_OxygenatedBloodVolume, ArtysVol.u[1]) annotation(Line(points={{-94,68},
                {-94,-26},{-28,-26},{-28,-30.5333},{-26.8,-30.5333}},                                                                                                    color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 6}, {-6, 6}}));
        connect(busConnector.Heart_OxygenatedBloodVolume, ArtysVol.u[2]) annotation(Line(points = {{-94, 68}, {-94, -30}, {-26.8, -30}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 2}, {-6, 2}}));
        connect(busConnector.SystemicArtys_OxygenatedBloodVolume, ArtysVol.u[3]) annotation(Line(points={{-94,68},
                {-94,-34},{-28,-34},{-28,-29.4667},{-26.8,-29.4667}},                                                                                                    color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, -2}, {-6, -2}}));
        connect(feedback.y, busConnector.BloodVolume_change) annotation(Line(points = {{-39, 42}, {-66, 42}, {-66, 68}, {-94, 68}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(BloodVolume.y, busConnector.BloodVolume) annotation(Line(points = {{22.4, -66}, {90, -66}, {90, 68}, {-94, 68}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-142, -108}, {142, -130}}, lineColor=  {0, 0, 255}, textString=  "%name")}), Documentation(info = "<html>
                   <p>BloodVolume .. whole blood volume</p>
                   <p>BloodVol_Hct .. haematocrit</p>
                   <p>BloodVol_PVCrit .. 1-BloodVol_Hct, plamacrit</p>
                   <p>ctHb_ery .. concentration of heme group in erythrocytes = 4 * MCHC (mean corpuscular hemoglobin concentration)</p>
                   <p>ctHb .. concentration of heme group in whole blood</p>
                   <p>FHbF .. featal Hb fraction from all Hb</p>
                   <p>FMetHb .. metha-Hb fraction from all Hb</p>
                   <p>cDPG .. concentration of 2,3-diphosphoglycerate in erythrocytes</p>
                   <p>Viscosity_ConductanceEffect .. multiply coeficient of blood resistance through vesseles</p>
                   <p>BloodVol_CollapsedEffect .. effect of small blood volume on systemic veins collasping</p>
                   <p>Vesseles_V0 .. volume of no-pressure generating blood in all vessels.</p>
                   <p>ArtysVol .. volume of all oxigenated blood</p>
                   <p>VeinsVol .. volume of all deoxigenated blood</p>
                   </html>", revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr>
                   </table>
                   </html>"));
      end BloodPropertiesBase;
    end BlooodVolume;

    model CVS_Dynamic
      extends PhysiolibraryOld.Icons.CardioVascular;
      //  extends HumMod.Library.Utilities.DynamicState(stateName="BloodVol.Vol", initType=Library.Utilities.Init.NoInit);
      VascularCompartments.Heart heart annotation(Placement(transformation(extent = {{0, -6}, {26, 20}})));
      VascularCompartments.PulmonaryCirculation pulmonaryCirculation annotation(Placement(transformation(extent = {{0, 46}, {28, 74}})));
      VascularCompartments.SystemicCirculationFullDynamic systemicCirculation annotation(Placement(transformation(extent = {{-2, -68}, {32, -34}})));
      PhysiolibraryOld.Interfaces.BusConnector busConnector
        "signals of organ bood flow resistence" annotation (Placement(
            transformation(extent={{-38,-8},{-16,14}}), iconTransformation(
              extent={{-100,60},{-60,100}})));
      BlooodVolume.RedCells2 redCells annotation(Placement(transformation(extent = {{-34, 26}, {-54, 46}})));
      BlooodVolume.BloodPropertiesBase bloodProperties annotation(Placement(transformation(extent = {{-36, -34}, {-56, -14}})));
      /*initial equation 
                                                                                                                    if STEADY then
                                                                                                                       bloodProperties.feedback.y = 0;
                                                                                                                    end if;
                                                                                                                  */
    equation
      connect(busConnector, pulmonaryCirculation.busConnector) annotation(Line(points = {{-27, 3}, {-26, 3}, {-26, 67}, {0, 67}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(busConnector, systemicCirculation.busConnector) annotation(Line(points = {{-27, 3}, {-26, 3}, {-26, -44.2}, {-2.34, -44.2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(busConnector, redCells.busConnector) annotation(Line(points = {{-27, 3}, {-26, 3}, {-26, 41.8}, {-35.2, 41.8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(busConnector, bloodProperties.busConnector) annotation(Line(points = {{-27, 3}, {-26, 3}, {-26, -17.2}, {-36.6, -17.2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(busConnector, heart.busConnector) annotation(Line(points = {{-27, 3}, {-25.5, 3}, {-25.5, 3.1}, {0, 3.1}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(heart.fromLeftVentricle, systemicCirculation.q_in) annotation(Line(points = {{16.12, 3.36}, {16.12, 18}, {32, 18}, {32, -51}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(systemicCirculation.q_out, heart.rightAtrium) annotation(Line(points = {{-2, -51}, {-4, -51}, {-4, 12.2}, {5.72, 12.2}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(pulmonaryCirculation.q_in, heart.fromRightVentricle) annotation(Line(points = {{0, 60}, {-4, 60}, {-4, 18}, {8.06, 18}, {8.06, 3.36}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(pulmonaryCirculation.q_out, heart.leftAtrium) annotation(Line(points = {{28, 60}, {36, 60}, {36, 12.46}, {18.72, 12.46}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
      //  stateValue = bloodProperties.BloodVolume1.y;
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Documentation(info = "<html>
                   <p><h4><font color=\"#008000\">Cardiovascular system</font></h4></p>
                   <p><font style=\"color: #008000; \">Connect heart with pulmonary and systemic part. This connection contains pressures and blood flows before and after heart.</font></p>
                   <p><font style=\"color: #008000; \">Output signal variables about blood volume between lungs capilaries and systemic tissue capilaries are used in gass transport submodels like O2 or CO2.</font></p>
                   <p><font style=\"color: #008000; \">Output signal Vesseles_V0 is used for systemic veins collapsing in massive blood lost.</font></p>
                   <p><font style=\"color: #008000; \">The blood properties convert known variables values to another meanings (haematocrit, viscosity, ..).</font></p>
                   <p><font style=\"color: #008000; \">Red cells contains volume, loss and gains all red blood cells.</font></p>
                   </html>", revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Design:</td>
                   <td>Zuzana Rubaninska</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr>
                   </table>
                   </html>"), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent = {{-116, -96}, {126, -130}}, lineColor = {0, 0, 255}, textString = "%name")}));
    end CVS_Dynamic;
    annotation(Documentation(revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr>
                   </table>
                   </html>"), Icon(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics));
  end CardioVascular;

  package Water "Body Water"
    extends PhysiolibraryOld.Icons.WaterLib;
    package Hydrostatics
      "Hydrostatic pressure difference in upper, midle and lower torso"
      type Posture = enumeration(
          Lying,
          Sitting,
          Standing,
          Tilting,
          SteadyState);
      model TorsoHydrostatics
        extends PhysiolibraryOld.Interfaces.BaseModel;
        parameter Real Alpha = 0.1667
          "torso: capilary pressure coeficient between artery and vein pressure";
        parameter Real Gravity_Gz = 1 "gravity constant / 10";
        parameter Real TorsoCM(final quantity = "Height", final unit = "cm")
          "torso: center of gravity - height";
        parameter Real artyFractGz[Posture]
          "torso: arty hydrostatic effects for posturing";
        parameter Real veinFractGz[Posture]
          "torso: vein hydrostatic effects for posturing";
        Real ArtyFractGz;
        Real VeinFractGz;
        Real TorsoArtyGradient(final quantity = "Pressure", final unit = "mmHg");
        Real TorsoVeinGradient(final quantity = "Pressure", final unit = "mmHg");
        Real Arty(final quantity = "Pressure", final unit = "mmHg");
        Real Vein(final quantity = "Pressure", final unit = "mmHg");
        PhysiolibraryOld.Interfaces.RealInput Pump_Effect(final unit="1")
          "xNormal" annotation (Placement(transformation(extent={{-120,-100},{-80,
                  -60}}), iconTransformation(extent={{-120,-100},{-80,-60}})));
        PhysiolibraryOld.Interfaces.RealInput fromPressure(final quantity=
              "Pressure", final unit="mmHg")
          "torso: systemic arteries pressure" annotation (Placement(
              transformation(extent={{-120,0},{-80,40}}), iconTransformation(
                extent={{-120,0},{-80,40}})));
        PhysiolibraryOld.Interfaces.RealInput toPressure(final quantity=
              "Pressure", final unit="mmHg") "torso: systemic veins pressure"
          annotation (Placement(transformation(extent={{-120,-40},{-80,0}}),
              iconTransformation(extent={{-120,-40},{-80,0}})));
        PostureInput Status_Posture "Lying, Sitting, Standing or Tilting" annotation(Placement(transformation(extent = {{-120, 60}, {-80, 100}}), iconTransformation(extent = {{-120, 60}, {-80, 100}})));
        PhysiolibraryOld.Interfaces.RealOutput_ Capy(final quantity="Pressure",
            final unit="mmHg") "torso: average capilaries pressure" annotation (
           Placement(transformation(extent={{80,-20},{120,20}}),
              iconTransformation(extent={{80,-20},{120,20}})));
      equation
        ArtyFractGz = artyFractGz[Status_Posture];
        VeinFractGz = veinFractGz[Status_Posture];
        //in legs veins are valves
        TorsoArtyGradient = TorsoCM * Gravity_Gz * ArtyFractGz;
        //Hydrostatic pressure: P=ro.g.h
        //cm *  0.01 m/cm * 9.81 m/s * 1060 kg/m3 * 1/133.322 mmHg/Pa
        //= height[cm] * 0.77996129671022036873134216408395 [mmHg]
        //Blood density = 1060 kg/m3: Cutnell, John & Johnson, Kenneth. Physics, Fourth Edition. Wiley, 1998: 308.
        //bloodDensity = 1060 kg/m3
        //gravityAcceleration = 9.81 m/s2
        //Pa2mmHg = 1/133.322 mmHg/Pa
        //cm2m = 0.01 m/cm
        //averageHydrostaticHeight = TorsoCM * postureCoef[Status_Posture]
        //hydrostaticPressure = averageHydrostaticHeight * cm2m * bloodDensity * gravityAcceleration * Pa2mmHg
        //                    = 0.77996 * averageHydrostaticHeight
        TorsoVeinGradient = TorsoCM * Gravity_Gz * VeinFractGz;
        Arty = max(fromPressure + TorsoArtyGradient, 0);
        Vein = max(toPressure + TorsoVeinGradient * Pump_Effect, 0);
        //only lower torso has LegMusclePump_Effect
        Capy = max(Alpha * Arty + (1.0 - Alpha) * Vein, 0);
        annotation(Documentation(info = "<HTML>
                   <PRE>
                   QHP 2008 / Hydrostatics
                    
                   Created : 18-Jun-05
                   Last Modified : 18-Jun-05
                   Author : Tom Coleman
                   Copyright Status : In Public Domain
                   Solver : QHP 2008
                   Schema : 2008.0
                   </PRE>
                   </HTML>
                   ", revisions = "<html>
                   <ul>
                   <li><i>  </i>
                          </li>
                   <li><i> january 2009 </i><br> 
                          by Marek Matejak in Modelica initially implemented (consulted with Jiri Kofranek), Charles University, Prague<br>
                          orginaly described by Tom Coleman in QHP 2008 beta 3, University of Mississippi Medical Center
                          </li>
                   </ul>
                   </html>"), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
      end TorsoHydrostatics;

      model Hydrostatics
        extends PhysiolibraryOld.Icons.Hydrostatics;
        parameter Real TiltTable_Degrees(final quantity = "Angle", final unit = "Deg") = 0;
        TorsoHydrostatics UpperTorsoHydrostatics(TorsoCM = -10, artyFractGz = {0, 1, 1, sin(Modelica.SIunits.Conversions.from_deg(TiltTable_Degrees)), 1.76947}, veinFractGz = {0, 1, 1, sin(Modelica.SIunits.Conversions.from_deg(TiltTable_Degrees)), 1.76947}) annotation(Placement(transformation(extent = {{-12, 34}, {16, 62}})));
        TorsoHydrostatics LowerTorsoHydrostatics(TorsoCM = 50.0, artyFractGz = {0, 0.7, 1, sin(Modelica.SIunits.Conversions.from_deg(TiltTable_Degrees)), 0.0190301}, veinFractGz = {0.2, 0.7, 1, 0.2 + sin(Modelica.SIunits.Conversions.from_deg(TiltTable_Degrees)), 0.0190301}) annotation(Placement(transformation(extent = {{-12, -42}, {16, -14}})));
        TorsoHydrostatics MiddleTorsoHydrostatics(TorsoCM = 4, artyFractGz = {0, 1, 1, sin(Modelica.SIunits.Conversions.from_deg(TiltTable_Degrees)), -0.00024891}, veinFractGz = {0, 1, 1, sin(Modelica.SIunits.Conversions.from_deg(TiltTable_Degrees)), -0.00024891}) annotation(Placement(transformation(extent = {{-12, -4}, {16, 24}})));
        PhysiolibraryOld.Blocks.Constant PumpEffect(k=1)
          annotation (Placement(transformation(extent={{-40,32},{-36,36}})));
        PhysiolibraryOld.Interfaces.RealInput SystemicArtys_Pressure(final
            quantity="Pressure", final unit="mmHg") annotation (Placement(
              transformation(extent={{-44,56},{-40,60}}), iconTransformation(
                extent={{-100,-30},{-80,-10}})));
        PhysiolibraryOld.Interfaces.RealInput RightAtrium_Pressure(final
            quantity="Pressure", final unit="mmHg") annotation (Placement(
              transformation(extent={{-34,66},{-30,70}}), iconTransformation(
                extent={{-100,10},{-80,30}})));
        PhysiolibraryOld.Interfaces.RealInput LegMusclePump_Effect(final
            quantity="Flow", final unit="ml/min") annotation (Placement(
              transformation(extent={{-46,-42},{-38,-34}}), iconTransformation(
                extent={{-100,-90},{-80,-70}})));
        PhysiolibraryOld.Interfaces.RealInput_ Status_Posture
          "Lying, Sitting, Standing or Tilting" annotation (Placement(
              transformation(extent={{-90,22},{-86,26}}), iconTransformation(
                extent={{-100,70},{-80,90}})));
        PhysiolibraryOld.Interfaces.RealOutput RegionalPressure_UpperCapy(
            final quantity="Pressure", final unit="mmHg") annotation (Placement(
              transformation(extent={{42,44},{50,52}}), iconTransformation(
                extent={{90,20},{110,40}})));
        PhysiolibraryOld.Interfaces.RealOutput RegionalPressure_MiddleCapy(
            final quantity="Pressure", final unit="mmHg") annotation (Placement(
              transformation(extent={{42,6},{50,14}}), iconTransformation(
                extent={{90,-20},{110,0}})));
        PhysiolibraryOld.Interfaces.RealOutput RegionalPressure_LowerCapy(
            final quantity="Pressure", final unit="mmHg") annotation (Placement(
              transformation(extent={{42,-32},{50,-24}}), iconTransformation(
                extent={{90,-60},{110,-40}})));
        Real2Posture real2Posture annotation(Placement(transformation(extent = {{-72, 20}, {-64, 28}})));
      equation
        connect(RightAtrium_Pressure, LowerTorsoHydrostatics.toPressure) annotation(Line(points = {{-32, 68}, {-28, 68}, {-28, -30.8}, {-12, -30.8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(RightAtrium_Pressure, MiddleTorsoHydrostatics.toPressure) annotation(Line(points = {{-32, 68}, {-28, 68}, {-28, 7.2}, {-12, 7.2}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(RightAtrium_Pressure, UpperTorsoHydrostatics.toPressure) annotation(Line(points = {{-32, 68}, {-28, 68}, {-28, 45.2}, {-12, 45.2}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(PumpEffect.y, UpperTorsoHydrostatics.Pump_Effect) annotation(Line(points = {{-35.8, 34}, {-26, 34}, {-26, 36.8}, {-12, 36.8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(MiddleTorsoHydrostatics.Pump_Effect, PumpEffect.y) annotation(Line(points = {{-12, -1.2}, {-26, -1.2}, {-26, 34}, {-35.8, 34}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(SystemicArtys_Pressure, LowerTorsoHydrostatics.fromPressure) annotation(Line(points = {{-42, 58}, {-30, 58}, {-30, -25.2}, {-12, -25.2}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(SystemicArtys_Pressure, MiddleTorsoHydrostatics.fromPressure) annotation(Line(points = {{-42, 58}, {-30, 58}, {-30, 12.8}, {-12, 12.8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(SystemicArtys_Pressure, UpperTorsoHydrostatics.fromPressure) annotation(Line(points = {{-42, 58}, {-30, 58}, {-30, 50.8}, {-12, 50.8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(LegMusclePump_Effect, LowerTorsoHydrostatics.Pump_Effect) annotation(Line(points = {{-42, -38}, {-32, -38}, {-32, -39.2}, {-12, -39.2}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(UpperTorsoHydrostatics.Capy, RegionalPressure_UpperCapy) annotation(Line(points = {{16, 48}, {46, 48}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(MiddleTorsoHydrostatics.Capy, RegionalPressure_MiddleCapy) annotation(Line(points = {{16, 10}, {31, 10}, {31, 10}, {46, 10}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(LowerTorsoHydrostatics.Capy, RegionalPressure_LowerCapy) annotation(Line(points = {{16, -28}, {46, -28}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(UpperTorsoHydrostatics.Status_Posture, real2Posture.y) annotation(Line(points = {{-12, 59.2}, {-32, 59.2}, {-32, 24}, {-63.2, 24}}, color = {0, 127, 127}, smooth = Smooth.None));
        connect(real2Posture.y, MiddleTorsoHydrostatics.Status_Posture) annotation(Line(points = {{-63.2, 24}, {-32, 24}, {-32, 21.2}, {-12, 21.2}}, color = {0, 127, 127}, smooth = Smooth.None));
        connect(LowerTorsoHydrostatics.Status_Posture, real2Posture.y) annotation(Line(points = {{-12, -16.8}, {-32, -16.8}, {-32, 24}, {-63.2, 24}}, color = {0, 127, 127}, smooth = Smooth.None));
        connect(real2Posture.u, Status_Posture) annotation(Line(points = {{-72.8, 24}, {-88, 24}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent = {{-100, 122}, {100, 102}}, lineColor = {0, 0, 255}, textString = "%name"), Rectangle(extent = {{-100, 100}, {100, -100}}, lineColor = {0, 0, 0})}));
      end Hydrostatics;

      connector PostureInput = input Posture "'input Posture' as connector" annotation(defaultComponentName = "u", Icon(graphics={  Polygon(points=  {{-100, 100}, {100, 0}, {-100, -100}, {-100, 100}}, lineColor=  {0, 127, 127}, fillColor=  {0, 127, 127},
                fillPattern=                                                                                                    FillPattern.Solid), Text(extent=  {{100, -50}, {700, 50}}, lineColor=  {0, 127, 127}, textString=  "%name")}, coordinateSystem(extent = {{-100, -100}, {100, 100}}, preserveAspectRatio = true, initialScale = 0.2)), Diagram(coordinateSystem(preserveAspectRatio = true, initialScale = 0.2, extent = {{-100, -100}, {100, 100}}, grid = {1, 1}), graphics={  Polygon(points=  {{0, 50}, {100, 0}, {0, -50}, {0, 50}}, lineColor=  {0, 127, 127}, fillColor=  {0, 127, 127},
                fillPattern=                                                                                                    FillPattern.Solid), Text(extent=  {{-10, 85}, {-10, 60}}, lineColor=  {0, 127, 127}, textString=  "%name")}), Documentation(info = "<html>
                                                                                                                                                                           <p>
                                                                                                                                                                           Connector with one input signal of type Posture.
                                                                                                                                                                           </p>
                                                                                                                                                                           </html>"));
      connector PostureOutput = output Posture "'input Posture' as connector" annotation(defaultComponentName = "u", Icon(graphics={  Polygon(points=  {{-100, 100}, {100, 0}, {-100, -100}, {-100, 100}}, lineColor=  {0, 127, 127}, fillColor=  {255, 255, 255},
                fillPattern=                                                                                                    FillPattern.Solid), Text(extent=  {{100, -50}, {700, 50}}, lineColor=  {0, 127, 127}, textString=  "%name")}, coordinateSystem(extent = {{-100, -100}, {100, 100}}, preserveAspectRatio = true, initialScale = 0.2)), Diagram(coordinateSystem(preserveAspectRatio = true, initialScale = 0.2, extent = {{-100, -100}, {100, 100}}, grid = {1, 1}), graphics={  Polygon(points=  {{0, 50}, {100, 0}, {0, -50}, {0, 50}}, lineColor=  {0, 127, 127}, fillColor=  {0, 127, 127},
                fillPattern=                                                                                                    FillPattern.Solid), Text(extent=  {{-10, 85}, {-10, 60}}, lineColor=  {0, 127, 127}, textString=  "%name")}), Documentation(info = "<html>
                                                                                                                                                                           <p>
                                                                                                                                                                           Connector with one input signal of type Posture.
                                                                                                                                                                           </p>
                                                                                                                                                                           </html>"));
      model Real2Posture "Convert Real to type Posture"
        extends PhysiolibraryOld.Interfaces.ConversionIcon;
        PostureOutput y "Connector of Real output signal" annotation(Placement(transformation(extent = {{60, -20}, {80, 0}}, rotation = 0), iconTransformation(extent = {{100, -20}, {140, 20}})));
        PhysiolibraryOld.Interfaces.RealInput_ u annotation (Placement(
              transformation(extent={{-130,-20},{-90,20}}), iconTransformation(
                extent={{-140,-20},{-100,20}})));
        Integer tmp;
      equation
        /*#if MODELICA_STANDARD
                                                                                                                                                              //sprvne m by 
                                                                                                                                                              Integer(y) = integer(u);
                                                                                                                                                              #endif MODELICA_STANDARD*/
        //#if not MODELICA_STANDARD
        tmp = integer(u);
        y = if tmp <= 0 then Posture.Lying elseif tmp == 1 then Posture.Sitting
         elseif tmp == 2 then Posture.Standing
         elseif tmp == 3 then Posture.Tilting else Posture.SteadyState;
        //  y = integer(u);
        //#endif not MODELICA_STANDARD
        annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}, grid = {2, 2}, initialScale = 0.04), graphics), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}, grid = {2, 2}, initialScale = 0.04), graphics), Documentation(info = "<html>
                   <p>
                   The Real output y is a constant signal:
                   </p>
                   </html>"));
      end Real2Posture;
    end Hydrostatics;

    package Osmoles "Intracellular vs. Extracellular Water"
      model OsmBody
        //extends QHP.Library.Interfaces.BaseModel;
        PhysiolibraryOld.Interfaces.RealInput OsmECFV_Electrolytes(final unit=
              "mOsm") annotation (Placement(transformation(extent={{-120,50},{-80,
                  90}}), iconTransformation(extent={{-100,88},{-76,112}})));
        PhysiolibraryOld.Interfaces.RealInput OsmCell_Electrolytes(final unit=
              "mOsm") annotation (Placement(transformation(extent={{-120,-10},{
                  -80,30}}), iconTransformation(extent={{-100,48},{-76,72}})));
        PhysiolibraryOld.Interfaces.RealInput UreaECF(final unit="mOsm")
          annotation (Placement(transformation(extent={{-120,20},{-80,60}}),
              iconTransformation(extent={{-100,8},{-76,32}})));
        PhysiolibraryOld.Interfaces.RealInput UreaICF(final unit="mOsm")
          annotation (Placement(transformation(extent={{-120,-40},{-80,0}}),
              iconTransformation(extent={{-100,-32},{-76,-8}})));
        PhysiolibraryOld.Interfaces.RealInput BodyH2O_Vol(final unit="ml")
          "all water in body" annotation (Placement(transformation(extent={{-120,
                  -110},{-80,-70}}), iconTransformation(extent={{-100,-112},{-76,
                  -88}})));
        PhysiolibraryOld.Interfaces.RealOutput ECFV(final unit="ml")
          "extracellular water" annotation (Placement(transformation(extent={{
                  60,-80},{100,-40}}), iconTransformation(extent={{92,8},{116,
                  32}})));
        PhysiolibraryOld.Interfaces.RealOutput ICFV(final unit="ml")
          "intracellular water" annotation (Placement(transformation(extent={{
                  60,60},{100,100}}), iconTransformation(extent={{92,68},{116,
                  92}})));
        parameter Real Dissociation = 0.89;
        Real OsmECFV_NonElectrolytes;
        Real OsmCell_NonElectrolytes;
        Real Electrolytes;
        Real NonElectrolytes;
        Real Total;
        Real ECFVActiveElectrolytes;
        Real ICFVActiveElectrolytes;
        Real ActiveElectrolytes;
        Real ECFVActiveOsmoles;
        Real ICFVActiveOsmoles;
        Real ActiveOsmoles(start = 11683.1341496947);
        //  Real Osm_conc_CellWall;
        //Real Osm_conc_Osmoreceptors;
        PhysiolibraryOld.Interfaces.RealOutput OsmBody_Osm_conc_CellWalls(
            final unit="mOsm/ml") annotation (Placement(transformation(extent={
                  {60,-20},{100,20}}), iconTransformation(extent={{92,-52},{116,
                  -28}})));
        PhysiolibraryOld.Interfaces.RealOutput Osmoreceptors(start=0.25331,
            final unit="mOsm/ml") annotation (Placement(transformation(extent={
                  {60,-54},{100,-14}}), iconTransformation(extent={{92,-92},{
                  116,-68}})));
        PhysiolibraryOld.Interfaces.RealInput GlucoseECF(final unit="mOsm")
          annotation (Placement(transformation(extent={{-120,-40},{-80,0}}),
              iconTransformation(extent={{-100,-72},{-76,-48}})));
      equation
        OsmECFV_NonElectrolytes = UreaECF + GlucoseECF + 340.0;
        OsmCell_NonElectrolytes = UreaICF + 354.0;
        Electrolytes = OsmECFV_Electrolytes + OsmCell_Electrolytes;
        NonElectrolytes = OsmECFV_NonElectrolytes + OsmCell_NonElectrolytes;
        Total = Electrolytes + NonElectrolytes;
        ECFVActiveElectrolytes = Dissociation * OsmECFV_Electrolytes;
        ICFVActiveElectrolytes = Dissociation * OsmCell_Electrolytes;
        ActiveElectrolytes = ECFVActiveElectrolytes + ICFVActiveElectrolytes;
        ECFVActiveOsmoles = ECFVActiveElectrolytes + OsmECFV_NonElectrolytes;
        ICFVActiveOsmoles = ICFVActiveElectrolytes + OsmCell_NonElectrolytes;
        ActiveOsmoles = ECFVActiveOsmoles + ICFVActiveOsmoles;
        OsmBody_Osm_conc_CellWalls = ActiveOsmoles / BodyH2O_Vol;
        Osmoreceptors = ActiveElectrolytes / BodyH2O_Vol;
        //, simplified=0.25331);
        ICFV = ICFVActiveOsmoles / ActiveOsmoles * BodyH2O_Vol;
        ECFV = BodyH2O_Vol - ICFV;
        annotation(Documentation(info = "<html>
                   <pre>QHP 2008 / OsmBody
                    
                   Created : 31-May-05
                   Last Modified : 24-Mar-08
                   Author : Tom Coleman
                   Copyright : 2005-2008
                   By : University of Mississippi Medical Center
                   Solver : DES 2005
                   Schema : 2005.0 </pre>
                   <p><br/><br/>Intracellular water calculation from cells osmotic pressure.</p>
                   </html>", revisions = "<html>
                   <ul>
                   <li><i>  </i>
                          </li>
                   <li><i> january 2009 </i><br> 
                          by Marek Matejak in Modelica initially implemented (consulted with Jiri Kofranek), Charles University, Prague<br>
                          orginaly described by Tom Coleman in QHP 2008 beta 3, University of Mississippi Medical Center
                          </li>
                   </ul>
                   </html>"), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
      end OsmBody;
    end Osmoles;

    package WaterCompartments "Body Water Distribution"
      model Outtake
        PhysiolibraryOld.VolumeFlow.PositiveVolumeFlow H2OLoss annotation (
            Placement(transformation(extent={{-120,-20},{-80,20}}),
              iconTransformation(extent={{-110,-10},{-90,10}})));
        //parameter Real H2OTarget(final quantity="Flow",final unit="ml/min") = 0;
        parameter Real H2OMassEffect[:, 3] = {{0.0, 0.0, 0.0}, {50.0, 1.0, 0.0}};
        PhysiolibraryOld.VolumeFlow.OutputPump outputPump
          annotation (Placement(transformation(extent={{20,-20},{60,20}})));
        PhysiolibraryOld.Curves.Curve curve(
          x=H2OMassEffect[:, 1],
          y=H2OMassEffect[:, 2],
          slope=H2OMassEffect[:, 3])
          annotation (Placement(transformation(extent={{-60,24},{-40,44}})));
        Modelica.Blocks.Math.Product product annotation(Placement(transformation(extent = {{-8, 30}, {12, 50}})));
        PhysiolibraryOld.VolumeFlow.VolumeMeasure volumeMeasure
          annotation (Placement(transformation(extent={{-86,-6},{-66,14}})));
        PhysiolibraryOld.Interfaces.RealOutput_ outflow annotation (Placement(
              transformation(extent={{80,-60},{120,-20}}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=0,
              origin={100,-40})));
        PhysiolibraryOld.Interfaces.RealInput_ H2OTarget(quantity="Flow", unit=
              "ml/min") annotation (Placement(transformation(extent={{-100,60},
                  {-60,100}}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=270,
              origin={0,40})));
      equation
        connect(curve.val, product.u2) annotation(Line(points = {{-40, 34}, {-10, 34}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(product.y, outputPump.desiredFlow) annotation(Line(points = {{13, 40}, {40, 40}, {40, 12}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(H2OLoss, volumeMeasure.q_in) annotation(Line(points = {{-100, 0}, {-76, 0}}, color = {0, 0, 0}, smooth = Smooth.None));
        connect(volumeMeasure.q_in, outputPump.q_in) annotation(Line(points = {{-76, 0}, {20, 0}}, color = {0, 0, 0}, smooth = Smooth.None));
        connect(volumeMeasure.actualVolume, curve.u) annotation(Line(points = {{-76, 8}, {-76, 34}, {-60, 34}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(product.y, outflow) annotation(Line(points = {{13, 40}, {84, 40}, {84, -40}, {100, -40}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(H2OTarget, product.u1) annotation(Line(points = {{-80, 80}, {-24, 80}, {-24, 46}, {-10, 46}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Rectangle(extent = {{-100, 40}, {100, -40}}, lineColor = {0, 0, 255},
                  fillPattern =                                                                                                   FillPattern.Solid, fillColor = {255, 255, 255}), Text(extent = {{-90, -40}, {100, 40}}, lineColor = {0, 0, 255}, fillColor = {255, 255, 255},
                  fillPattern =                                                                                                   FillPattern.Solid, textString = "%name")}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
      end Outtake;

      package Kidney "Kidney Water Excretion"
        model CD_H2OChannels
          extends PhysiolibraryOld.Utilities.DynamicState(
                                                       stateName = "CD_H2OChannels.Inactive");
          extends PhysiolibraryOld.Interfaces.BaseModel;
          parameter Real initialActive(final unit = "1") = 1;
          parameter Real InactivateK(final unit = "1/m1") = 0.000125;
          parameter Real ReactivateK(final unit = "1/m1") = 0.0004;
          PhysiolibraryOld.PressureFlow.PositivePressureFlow CD_H2O_Reab
            annotation (Placement(transformation(extent={{-20,80},{20,120}}),
                iconTransformation(extent={{-20,80},{20,120}})));
          Real Inactive(start = 2 - initialActive, final unit = "1");
          PhysiolibraryOld.Interfaces.RealOutput_ Active(final unit="1")
            annotation (Placement(transformation(extent={{96,46},{136,86}}),
                iconTransformation(extent={{96,46},{136,86}})));
          PhysiolibraryOld.PressureFlow.NegativePressureFlow q_out annotation (
              Placement(transformation(extent={{-20,-120},{20,-80}}),
                iconTransformation(extent={{-20,-120},{20,-80}})));
        equation
          q_out.q + CD_H2O_Reab.q = 0;
          q_out.pressure = CD_H2O_Reab.pressure;
          //  der(Inactive) = (InactivateK * CD_H2O_Reab.q - ReactivateK * Inactive) / Library.SecPerMin;
          Active = 2 - Inactive;
          stateValue = Inactive;
          changePerMin = InactivateK * CD_H2O_Reab.q - ReactivateK * Inactive;
          annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-100, -22}, {100, -38}}, lineColor=  {0, 0, 255}, textString=  "(initial %initialActive)")}));
        end CD_H2OChannels;

        model DistalTubule
          PhysiolibraryOld.PressureFlow.PositivePressureFlow Inflow annotation (
             Placement(transformation(extent={{-120,-18},{-80,22}}),
                iconTransformation(extent={{-120,-20},{-80,20}})));
          PhysiolibraryOld.PressureFlow.NegativePressureFlow Outflow
            annotation (Placement(transformation(extent={{80,-20},{120,20}})));
          PhysiolibraryOld.PressureFlow.NegativePressureFlow Reabsorbtion
            annotation (Placement(transformation(extent={{-20,-58},{20,-18}}),
                iconTransformation(extent={{-20,-58},{20,-18}})));
          PhysiolibraryOld.Interfaces.RealInput_ DesiredFlow(final quantity=
                "Flow", final unit="ml/min") annotation (Placement(
                transformation(extent={{-20,20},{20,60}}), iconTransformation(
                extent={{-20,-20},{20,20}},
                rotation=-90,
                origin={60,40})));
        equation
          Outflow.q + Inflow.q + Reabsorbtion.q = 0;
          Inflow.pressure = Outflow.pressure;
          Outflow.q = -DesiredFlow;
          annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Rectangle(extent=  {{-100, 40}, {100, -40}}, lineColor=  {127, 127, 0}, fillColor=  {255, 255, 170},
                    fillPattern=                                                                                                    FillPattern.HorizontalCylinder), Line(points=  {{-70, 14}, {-70, -18}, {-52, -12}, {-36, -14}, {-18, -20}, {-2, -28}, {6, -36}, {8, -40}, {6, -22}, {0, -12}, {-8, -6}, {-22, 2}, {-40, 8}, {-58, 12}, {-70, 14}}, color=  {0, 0, 255}, smooth=  Smooth.None), Text(extent=  {{12, -42}, {166, -72}}, lineColor=  {0, 0, 255}, textString=  "%name"), Polygon(points=  {{20, 14}, {20, -14}, {82, -2}, {20, 14}}, lineColor=  {0, 0, 255}, smooth=  Smooth.None, fillColor=  {0, 0, 255},
                    fillPattern=                                                                                                    FillPattern.Solid)}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
        end DistalTubule;

        model Glomerulus4
          PhysiolibraryOld.Semipermeable.ColloidHydraulicPressure0
            colloidHydraulicPressure
            annotation (Placement(transformation(extent={{-30,18},{-38,26}})));
          PhysiolibraryOld.Semipermeable.ColloidOsmolarity colloidOsmolarity(
              q_out(o(start=0.08500000000000001)), q_in(q(start=-569.708)))
            annotation (Placement(transformation(extent={{42,18},{34,26}})));
          //  q_in(q( start=-569.708)),
          PhysiolibraryOld.PressureFlow.ResistorWithCond Kf annotation (
              Placement(transformation(
                extent={{-10,-10},{10,10}},
                rotation=270,
                origin={-4,-54})));
          PhysiolibraryOld.Factors.SimpleMultiply NephronCountEffect
            annotation (Placement(transformation(extent={{24,-54},{4,-34}})));
          PhysiolibraryOld.Blocks.Constant const(k=20)
            annotation (Placement(transformation(extent={{24,-40},{18,-34}})));
          PhysiolibraryOld.Semipermeable.ColloidHydraulicPressure
            colloidHydraulicPressure1(q_in(q(start=132.696))) annotation (
              Placement(transformation(
                extent={{-4,-4},{4,4}},
                rotation=270,
                origin={-4,-2})));
          PhysiolibraryOld.PressureFlow.PositivePressureFlow fromAffHydraulic
            annotation (Placement(transformation(extent={{-76,16},{-56,36}}),
                iconTransformation(extent={{-120,-20},{-80,20}})));
          PhysiolibraryOld.PressureFlow.NegativePressureFlow Filtration
            annotation (Placement(transformation(extent={{-14,-86},{6,-66}}),
                iconTransformation(extent={{-20,-58},{20,-18}})));
          PhysiolibraryOld.PressureFlow.NegativePressureFlow toEffHydraulic
            annotation (Placement(transformation(extent={{64,8},{84,28}}),
                iconTransformation(extent={{80,-20},{120,20}})));
          PhysiolibraryOld.Interfaces.RealInput_ Protein_massFlow(final
              quantity="Flow", final unit="g/min") annotation (Placement(
                transformation(extent={{20,30},{30,40}}), iconTransformation(
                extent={{-30,-20},{10,20}},
                rotation=-90,
                origin={-60,40})));
          PhysiolibraryOld.Interfaces.RealInput_ NephronCount_xNormal(final
              unit="1") annotation (Placement(transformation(extent={{42,-46},{
                    38,-42}}), iconTransformation(
                extent={{20,-20},{-20,20}},
                rotation=90,
                origin={60,50})));
        equation
          connect(colloidOsmolarity.q_out, colloidHydraulicPressure.q_in) annotation(Line(points = {{34, 22}, {-30, 22}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
          connect(colloidOsmolarity.P, colloidHydraulicPressure.hydraulicPressure) annotation(Line(points = {{40.4, 17.2}, {40.4, 16}, {8, 16}, {8, 40}, {-35.6, 40}, {-35.6, 26.8}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(NephronCountEffect.y, Kf.cond) annotation(Line(points = {{14, -46}, {14, -54}, {0, -54}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(NephronCountEffect.yBase, const.y) annotation(Line(points = {{14, -42}, {14, -38}, {17.7, -38}, {17.7, -37}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(NephronCountEffect.u, NephronCount_xNormal) annotation(Line(points = {{23.8, -44}, {40, -44}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(Kf.q_out, Filtration) annotation(Line(points = {{-4, -64}, {-4, -70}, {-4, -70}, {-4, -76}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(Kf.q_in, colloidHydraulicPressure1.q_out) annotation(Line(points = {{-4, -44}, {-4, -34.5}, {-4, -34.5}, {-4, -25}, {-4, -6}, {-4, -6}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(colloidHydraulicPressure1.q_in, colloidHydraulicPressure.q_in) annotation(Line(points = {{-4, 2}, {-4, 22}, {-30, 22}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
          connect(colloidOsmolarity.P, colloidHydraulicPressure1.hydraulicPressure) annotation(Line(points = {{40.4, 17.2}, {40.4, 16}, {8, 16}, {8, -3.6}, {0.8, -3.6}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(fromAffHydraulic, colloidHydraulicPressure.withoutCOP) annotation(Line(points = {{-66, 26}, {-38, 26}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(colloidOsmolarity.q_in, toEffHydraulic) annotation(Line(points = {{42, 18}, {74, 18}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(colloidOsmolarity.proteinMassFlow, Protein_massFlow) annotation(Line(points = {{36.08, 26.64}, {36.08, 35}, {25, 35}}, color = {0, 0, 127}, smooth = Smooth.None));
          annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Rectangle(extent=  {{-100, 40}, {100, -40}}, lineColor=  {127, 0, 0},
                    fillPattern=                                                                                                    FillPattern.HorizontalCylinder, fillColor=  {255, 255, 255}), Line(points=  {{-70, 14}, {-70, -18}, {-52, -12}, {-36, -14}, {-18, -20}, {-2, -28}, {6, -36}, {8, -40}, {6, -22}, {0, -12}, {-8, -6}, {-22, 2}, {-40, 8}, {-58, 12}, {-70, 14}}, color=  {0, 0, 255}, smooth=  Smooth.None), Text(extent=  {{12, -42}, {166, -72}}, lineColor=  {0, 0, 255}, textString=  "%name")}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Text(extent=  {{-78, 40}, {-52, 28}}, lineColor=  {0, 127, 0}, fillColor=  {255, 255, 255}, fillPattern=  FillPattern.Solid, textString=  "(plasma flow)"), Text(extent=  {{58, 32}, {94, 22}}, lineColor=  {0, 127, 0}, fillColor=  {255, 255, 255}, fillPattern=  FillPattern.Solid, textString=  "(hydraulic pressure)"), Text(extent=  {{14, 48}, {48, 42}}, lineColor=  {0, 127, 0}, fillColor=  {255, 255, 255}, fillPattern=  FillPattern.Solid, textString=  "(COP_Eff)"), Text(extent=  {{2, -58}, {30, -56}}, lineColor=  {0, 0, 255}, textString=  "ultrafiltration coefficient")}));
        end Glomerulus4;

        model Nephron
          import QHP = HumMod;
          //extends Library.BaseModel;
          PhysiolibraryOld.PressureFlow.NegativePressureFlow
            EfferentArtery_Water_Hydraulic "outgoing plasma from kidneys"
            annotation (Placement(transformation(extent={{-56,84},{-36,104}}),
                iconTransformation(extent={{22,90},{42,110}})));
          PhysiolibraryOld.PressureFlow.NegativePressureFlow urine
            "H2O excretion" annotation (Placement(transformation(extent={{82,-8},
                    {104,12}}), iconTransformation(extent={{36,-80},{56,-60}})));
          PhysiolibraryOld.PressureFlow.ResistorWithCondParam
            ProximalTubule_Conductance(cond=7, q_in(pressure(start=18.9565)))
            annotation (Placement(transformation(
                extent={{-8,-8},{12,12}},
                rotation=90,
                origin={-48,62})));
          PhysiolibraryOld.PressureFlow.Reabsorbtion LoopOfHenle
            annotation (Placement(transformation(extent={{-6,-52},{12,-34}})));
          PhysiolibraryOld.PressureFlow.Reabsorbtion ProximalTubule annotation (
             Placement(transformation(
                extent={{-11,11},{9,-9}},
                rotation=-90,
                origin={-23,61})));
          Modelica.Blocks.Math.Gain gain(k = 0.37) annotation(Placement(transformation(extent = {{-3, -3}, {3, 3}}, rotation = 180, origin = {23, -47})));
          PhysiolibraryOld.Factors.SimpleMultiply ADHEffect
            annotation (Placement(transformation(extent={{64,50},{44,70}})));
          PhysiolibraryOld.PressureFlow.ReabsorbtionWithMinimalOutflow
            CollectingDuct
            annotation (Placement(transformation(extent={{40,-8},{60,12}})));
          Modelica.Blocks.Math.Gain gain1(k = 0.5) annotation(Placement(transformation(extent = {{72, 36}, {68, 40}})));
          Modelica.Blocks.Math.Sum sum1(nin = 4) annotation(Placement(transformation(extent = {{3, -3}, {-5, 5}}, rotation = 90, origin = {67, 29})));
          PhysiolibraryOld.Factors.SimpleMultiply MedullaNaEffect
            annotation (Placement(transformation(extent={{76,8},{56,28}})));
          QHP.Water.WaterCompartments.Kidney.Glomerulus4 glomerulus annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 90, origin = {-78, 76})));
          PhysiolibraryOld.PressureFlow.PositivePressureFlow
            AfferentArtery_Water_Hydraulic "ingoing plasma to kidney"
            annotation (Placement(transformation(extent={{-88,34},{-68,54}}),
                iconTransformation(extent={{-20,92},{0,112}})));
          CD_H2OChannels H2OChannels(initialActive = 0.969492) annotation(Placement(transformation(extent = {{40, -58}, {60, -38}})));
          QHP.Water.WaterCompartments.Kidney.DistalTubule distalTubule annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 270, origin = {36, 62})));
          PhysiolibraryOld.Blocks.Inv inv1 annotation (Placement(transformation(
                extent={{2,-2},{-2,2}},
                rotation=0,
                origin={68,66})));
          PhysiolibraryOld.Blocks.Inv inv2 annotation (Placement(transformation(
                extent={{-5,-5},{3,3}},
                rotation=180,
                origin={83,17})));
          PhysiolibraryOld.PressureFlow.FlowMeasure flowMeasure annotation (
              Placement(transformation(
                extent={{10,-10},{-10,10}},
                rotation=90,
                origin={-60,62})));
          PhysiolibraryOld.PressureFlow.FlowMeasure flowMeasure1
            annotation (Placement(transformation(extent={{74,12},{94,-8}})));
          PhysiolibraryOld.Factors.CurveValue NephronADHOnPerm(data={{0.0,0.3,0},
                {2.0,1.0,0.5},{10.0,3.0,0}}) annotation (Placement(
                transformation(
                extent={{10,-10},{-10,10}},
                rotation=270,
                origin={72,-24})));
          PhysiolibraryOld.Factors.CurveValue PermOnOutflow(data={{0.3,0.0,0},{
                1.0,0.93,0.1},{3.0,1.0,0}}) annotation (Placement(
                transformation(
                extent={{10,-10},{-10,10}},
                rotation=270,
                origin={66,-10})));
          PhysiolibraryOld.Blocks.Constant Constant(k=1)
            annotation (Placement(transformation(extent={{76,-12},{72,-8}})));
          PhysiolibraryOld.Blocks.Constant Constant1(k=1)
            annotation (Placement(transformation(extent={{62,78},{68,84}})));
          PhysiolibraryOld.Factors.CurveValue NephronADHEffect(data={{0.0,0.06,
                0},{2.0,0.11,0.02},{10.0,0.16,0}}) annotation (Placement(
                transformation(
                extent={{10,-10},{-10,10}},
                rotation=0,
                origin={70,74})));
          PhysiolibraryOld.PressureFlow.FlowMeasure flowMeasure2 annotation (
              Placement(transformation(
                extent={{-10,10},{10,-10}},
                rotation=180,
                origin={32,-64})));
          PhysiolibraryOld.PressureFlow.FlowMeasure flowMeasure3 annotation (
              Placement(transformation(
                extent={{-10,10},{10,-10}},
                rotation=90,
                origin={18,-14})));
          PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
              Placement(transformation(extent={{-104,88},{-84,108}}),
                iconTransformation(extent={{-70,66},{-50,86}})));
          Modelica.Blocks.Math.Product ProteinsFlow annotation(Placement(transformation(extent = {{-40, 2}, {-32, 10}})));
          Modelica.Blocks.Math.Division conc annotation(Placement(transformation(extent = {{-54, -10}, {-46, -2}})));
        equation
          connect(ProximalTubule.Reabsorbtion, EfferentArtery_Water_Hydraulic) annotation(Line(points = {{-12, 62}, {-4, 62}, {-4, 94}, {-46, 94}}, color = {0, 0, 0}, smooth = Smooth.None, thickness = 1));
          connect(LoopOfHenle.Reabsorbtion, EfferentArtery_Water_Hydraulic) annotation(Line(points = {{3, -52}, {3, -64}, {-92, -64}, {-92, 94}, {-46, 94}}, color = {0, 0, 0}, smooth = Smooth.None, thickness = 1));
          connect(gain1.y, sum1.u[1]) annotation(Line(points = {{67.8, 38}, {66.59999999999999, 38}, {66.59999999999999, 32.8}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(MedullaNaEffect.yBase, sum1.y) annotation(Line(points = {{66, 20}, {66, 23.6}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(distalTubule.Reabsorbtion, EfferentArtery_Water_Hydraulic) annotation(Line(points = {{32.2, 62}, {-4, 62}, {-4, 94}, {-46, 94}}, color = {0, 0, 0}, smooth = Smooth.None, thickness = 1));
          connect(CollectingDuct.Inflow, distalTubule.Outflow) annotation(Line(points = {{40, 2}, {36, 2}, {36, 52}}, color = {0, 0, 0}, smooth = Smooth.None, thickness = 1));
          connect(distalTubule.DesiredFlow, ADHEffect.y) annotation(Line(points = {{40, 56}, {54, 56}, {54, 58}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(inv1.y, ADHEffect.u) annotation(Line(points = {{65.8, 66}, {66, 66}, {66, 60}, {63.8, 60}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(inv2.y, MedullaNaEffect.u) annotation(Line(points = {{79.59999999999999, 18}, {75.8, 18}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(ProximalTubule_Conductance.q_out, ProximalTubule.Inflow) annotation(Line(points = {{-50, 74}, {-50, 76}, {-22, 76}, {-22, 72}}, color = {0, 0, 0}, smooth = Smooth.None, thickness = 1));
          connect(flowMeasure.q_out, ProximalTubule_Conductance.q_in) annotation(Line(points = {{-60, 56}, {-60, 52}, {-50, 52}, {-50, 54}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(ProximalTubule.Outflow, LoopOfHenle.Inflow) annotation(Line(points = {{-22, 52}, {-22, -42}, {-6, -42}, {-6, -43}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(glomerulus.NephronCount_xNormal, busConnector.Kidney_NephronCount_Total_xNormal) annotation(Line(points = {{-83, 82}, {-94, 82}, {-94, 98}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(AfferentArtery_Water_Hydraulic, glomerulus.fromAffHydraulic) annotation(Line(points = {{-78, 44}, {-78, 66}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(glomerulus.Filtration, flowMeasure.q_in) annotation(Line(points = {{-74.2, 76}, {-60, 76}, {-60, 68}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(glomerulus.toEffHydraulic, EfferentArtery_Water_Hydraulic) annotation(Line(points = {{-78, 86}, {-78, 94}, {-46, 94}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(CollectingDuct.Outflow, flowMeasure1.q_in) annotation(Line(points = {{60, 2}, {78, 2}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(flowMeasure1.q_out, urine) annotation(Line(points = {{90, 2}, {93, 2}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(H2OChannels.Active, NephronADHOnPerm.yBase) annotation(Line(points = {{61.6, -41.4}, {78, -41.4}, {78, -24}, {74, -24}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(NephronADHOnPerm.y, PermOnOutflow.u) annotation(Line(points = {{70, -24}, {66, -24}, {66, -19.8}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(PermOnOutflow.y, CollectingDuct.FractReab) annotation(Line(points = {{64, -10}, {62, -10}, {62, -4}, {60, -4}, {60, -3.6}, {59.4, -3.6}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(Constant.y, PermOnOutflow.yBase) annotation(Line(points = {{71.8, -10}, {68, -10}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(CollectingDuct.Reabsorbtion, H2OChannels.CD_H2O_Reab) annotation(Line(points = {{50, -8}, {50, -38}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(Constant1.y, NephronADHEffect.yBase) annotation(Line(points = {{68.3, 81}, {70, 81}, {70, 76}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(NephronADHEffect.y, inv1.u) annotation(Line(points = {{70, 72}, {70, 66}, {70.40000000000001, 66}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(LoopOfHenle.FractReab, gain.y) annotation(Line(points = {{12.36, -47.14}, {14.18, -47.14}, {14.18, -47}, {19.7, -47}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(CollectingDuct.OutflowMin, MedullaNaEffect.y) annotation(Line(points = {{53.4, 7}, {66, 7}, {66, 16}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(H2OChannels.q_out, flowMeasure2.q_in) annotation(Line(points = {{50, -58}, {50, -64}, {38, -64}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(flowMeasure2.q_out, EfferentArtery_Water_Hydraulic) annotation(Line(points = {{26, -64}, {-92, -64}, {-92, 94}, {-46, 94}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(LoopOfHenle.Outflow, flowMeasure3.q_in) annotation(Line(points = {{12, -43}, {18, -43}, {18, -20}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(flowMeasure3.q_out, distalTubule.Inflow) annotation(Line(points = {{18, -8}, {18, 72}, {36, 72}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(flowMeasure.actualFlow, busConnector.GlomerulusFiltrate_GFR) annotation(Line(points = {{-65.40000000000001, 62}, {-94, 62}, {-94, 98}}, color = {0, 0, 127}, smooth = Smooth.None));
          //!!!
          connect(busConnector.NephronADH, NephronADHEffect.u) annotation(Line(points = {{-94, 98}, {99.05, 98}, {99.05, 74}, {79.8, 74}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(busConnector.NephronADH, NephronADHOnPerm.u) annotation(Line(points = {{-94, 98}, {-94, -68}, {72, -68}, {72, -33.8}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(busConnector.DT_Na_Outflow, ADHEffect.yBase) annotation(Line(points = {{-94, 98}, {54, 98}, {54, 62}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(ProximalTubule.FractReab, busConnector.PT_Na_FractReab) annotation(Line(points = {{-17.4, 51.6}, {-94, 51.6}, {-94, 98}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(gain.u, busConnector.LH_Na_FractReab) annotation(Line(points = {{26.6, -47}, {32.7, -47}, {32.7, -54}, {32, -54}, {32, 98}, {-94, 98}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(flowMeasure1.actualFlow, busConnector.CD_H2O_Outflow) annotation(Line(points = {{84, -3.4}, {100, -3.4}, {100, 98}, {-94, 98}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(inv2.u, busConnector.MedullaNa_conc) annotation(Line(points = {{88.8, 18}, {100, 18}, {100, 98}, {-94, 98}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(busConnector.CD_Glucose_Outflow, gain1.u) annotation(Line(points = {{-94, 98}, {100.1, 98}, {100.1, 38}, {72.40000000000001, 38}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(busConnector.CD_NH4_Outflow, sum1.u[2]) annotation(Line(points = {{-94, 98}, {100, 98}, {100, 32.8}, {66.2, 32.8}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(busConnector.CD_K_Outflow, sum1.u[3]) annotation(Line(points = {{-94, 98}, {99.3, 98}, {99.3, 32.8}, {65.8, 32.8}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(busConnector.CD_Na_Outflow, sum1.u[4]) annotation(Line(points = {{-94, 98}, {100, 98}, {100, 32.8}, {65.40000000000001, 32.8}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(flowMeasure2.actualFlow, busConnector.CD_H2O_Reab) annotation(Line(points = {{32, -58.6}, {32, 98}, {-94, 98}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(flowMeasure3.actualFlow, busConnector.LH_H2O_Outflow) annotation(Line(points = {{23.4, -14}, {32, -14}, {32, 98}, {-94, 98}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(busConnector.KidneyPlasmaFlow, ProteinsFlow.u1) annotation(Line(points = {{-94, 98}, {-94, 8.4}, {-40.8, 8.4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
          connect(busConnector.PlasmaProtein_Mass, conc.u1) annotation(Line(points = {{-94, 98}, {-94, -3.6}, {-54.8, -3.6}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
          connect(busConnector.PlasmaVol, conc.u2) annotation(Line(points = {{-94, 98}, {-94, -8.4}, {-54.8, -8.4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
          connect(conc.y, ProteinsFlow.u2) annotation(Line(points = {{-45.6, -6}, {-44, -6}, {-44, 3.6}, {-40.8, 3.6}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(ProteinsFlow.y, glomerulus.Protein_massFlow) annotation(Line(points = {{-31.6, 6}, {-28, 6}, {-28, 28}, {-90, 28}, {-90, 70}, {-83, 70}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(busConnector.Glomerulus_GFR, flowMeasure.actualFlow) annotation(Line(points = {{-94, 98}, {-94, 62}, {-65.40000000000001, 62}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
          annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -70}, {100, 100}}), graphics={  Text(extent=  {{-72, -102}, {76, -76}}, lineColor=  {0, 0, 0}, fillColor=  {255, 255, 255},
                    fillPattern=                                                                                                    FillPattern.Solid, textString=  "%name"), Bitmap(extent=  {{-96, 96}, {106, -74}}, fileName=  "icons/nefron.png")}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -70}, {100, 100}}), graphics));
        end Nephron;

        model Kidney
          import HumMod;
          extends PhysiolibraryOld.Icons.Kidney;
          PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
              Placement(transformation(extent={{-90,80},{-70,100}}),
                iconTransformation(extent={{-106,-10},{-86,10}})));
          HumMod.Water.WaterCompartments.Kidney.Nephron nephron annotation(Placement(transformation(extent = {{-27, -24}, {18, 14}})));
          PhysiolibraryOld.Semipermeable.PositiveOsmoticFlow vascularH2O(o(unit=
                 "g/ml")) annotation (Placement(transformation(extent={{6,74},{
                    26,94}}), iconTransformation(extent={{6,74},{26,94}})));
          PhysiolibraryOld.PressureFlow.NegativePressureFlow urine annotation (
              Placement(transformation(extent={{-4,-70},{16,-50}}),
                iconTransformation(extent={{-4,-70},{16,-50}})));
          PhysiolibraryOld.Semipermeable.ColloidHydraulicPressure0
            colloidhydraulicPressure0_1
            annotation (Placement(transformation(extent={{24,80},{32,88}})));
          PhysiolibraryOld.PressureFlow.Pump kidneyFlow annotation (Placement(
                transformation(
                extent={{-10,10},{10,-10}},
                rotation=270,
                origin={-32,34})));
          PhysiolibraryOld.Utilities.ConstantFromFile Medulla_Volume(
            varName="Medulla.Volume",
            varValue=31.0,
            initType=PhysiolibraryOld.Utilities.Init.NoInit)
            "Kidney medulla interstitial water volume. [ml]" annotation (
              Placement(transformation(extent={{-88,-24},{-82,-18}})));
        equation
          connect(nephron.urine, urine) annotation(Line(points = {{5.85, -24}, {5.85, -28.8235}, {6, -28.8235}, {6, -60}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(busConnector.GlomerulusBloodPressure, colloidhydraulicPressure0_1.hydraulicPressure) annotation(Line(points = {{-80, 90}, {29.6, 90}, {29.6, 88.8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
          connect(vascularH2O, colloidhydraulicPressure0_1.q_in) annotation(Line(points = {{16, 84}, {24, 84}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
          connect(kidneyFlow.q_in, colloidhydraulicPressure0_1.withoutCOP) annotation(Line(points = {{-32, 44}, {-32, 88}, {32, 88}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(busConnector.KidneyPlasmaFlow, kidneyFlow.desiredFlow) annotation(Line(points = {{-80, 90}, {-80, 34}, {-38, 34}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
          connect(kidneyFlow.q_out, nephron.AfferentArtery_Water_Hydraulic) annotation(Line(points = {{-32, 24}, {-32, 14.4471}, {-6.75, 14.4471}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(colloidhydraulicPressure0_1.withoutCOP, nephron.EfferentArtery_Water_Hydraulic) annotation(Line(points = {{32, 88}, {52, 88}, {52, 14}, {2.7, 14}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(busConnector, nephron.busConnector) annotation(Line(points = {{-80, 90}, {-80, 8}, {-18, 8}, {-18, 8.635289999999999}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
          connect(Medulla_Volume.y, busConnector.Medulla_Volume) annotation(Line(points = {{-81.7, -21}, {-80, -21}, {-80, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
          annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent = {{-100, 120}, {100, 104}}, lineColor = {0, 0, 255}, textString = "%name")}));
        end Kidney;
      end Kidney;

      model GILumen2
        import QHP = HumMod;
        extends PhysiolibraryOld.Icons.GILumen;
        PhysiolibraryOld.Semipermeable.NegativeOsmoticFlow vascularH2O(o(unit=
                "g/l")) annotation (Placement(transformation(extent={{80,44},{
                  100,64}}), iconTransformation(extent={{90,-10},{110,10}})));
        parameter Real Fiber_mass(final quantity = "Mass", final unit = "mOsm") = 0.043;
        parameter Real Na_EqToAllConnectedOsm(final unit = "mOsm/mEq") = 2;
        parameter Real K_EqToAllConnectedOsm(final unit = "mOsm/mEq") = 2;
        //parameter Real initialVolume(final quantity="Volume", final unit="ml") =  1000;
        HumMod.Water.WaterCompartments.GILumen gILumen(Fiber_mass = Fiber_mass, Na_EqToAllConnectedOsm = Na_EqToAllConnectedOsm, K_EqToAllConnectedOsm = K_EqToAllConnectedOsm, stateName = "GILumenVolume.Mass") annotation(Placement(transformation(extent = {{-35, 44}, {-15, 64}})));
        Outtake vomitus annotation(Placement(transformation(extent = {{-7, -7}, {7, 7}}, rotation = 180, origin = {-38, 81})));
        Outtake diarrhea annotation(Placement(transformation(extent = {{-31, 30}, {-45, 44}})));
        PhysiolibraryOld.Semipermeable.ResistorWithCondParam absorbtion1(cond=
              150) annotation (Placement(transformation(
              extent={{-8,-8},{8,8}},
              rotation=0,
              origin={12,54})));
        PhysiolibraryOld.PressureFlow.InputPump Diet
          annotation (Placement(transformation(extent={{-65,-26},{-55,-16}})));
        PhysiolibraryOld.Semipermeable.FlowMeasure flowMeasure annotation (
            Placement(transformation(
              extent={{-6,6},{6,-6}},
              rotation=0,
              origin={38,52})));
        PhysiolibraryOld.Factors.CurveValue DietThirst(data={{233,0.0,0},{253,
              2.0,0.2},{313,30.0,0}})
          annotation (Placement(transformation(extent={{-72,-6},{-52,14}})));
        PhysiolibraryOld.Blocks.Constant Constant0(k=1/1.44)
          annotation (Placement(transformation(extent={{-74,10},{-66,18}})));
        Modelica.Blocks.Math.Gain ML_TO_L(k = 1000) annotation(Placement(transformation(extent = {{-84, 0}, {-78, 6}})));
        PhysiolibraryOld.Semipermeable.OsmoticPump osmoticPump
          annotation (Placement(transformation(extent={{52,44},{74,64}})));
        Modelica.Blocks.Math.Gain per_ml(k = 1) annotation(Placement(transformation(extent = {{56, 64}, {62, 70}})));
        PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
            Placement(transformation(extent={{-84,80},{-64,100}}),
              iconTransformation(extent={{-106,-10},{-86,10}})));
        PhysiolibraryOld.PressureFlow.FlowMeasure flowMeasure1 annotation (
            Placement(transformation(
              extent={{-10,-10},{10,10}},
              rotation=90,
              origin={-48,22})));
      equation
        connect(gILumen.outtake, diarrhea.H2OLoss) annotation(Line(points = {{-25, 44}, {-25, 37}, {-31, 37}}, color = {0, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(gILumen.outtake, vomitus.H2OLoss) annotation(Line(points = {{-25, 44}, {-25, 81}, {-31, 81}}, color = {0, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(gILumen.absorbtion, absorbtion1.q_in) annotation(Line(points = {{-15, 54}, {4, 54}}, color = {0, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(absorbtion1.q_out, flowMeasure.q_in) annotation(Line(points = {{20, 54}, {27.5, 54}, {27.5, 54.04}, {32.6, 54.04}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(Constant0.y, DietThirst.yBase) annotation(Line(points = {{-65.59999999999999, 14}, {-62, 14}, {-62, 6}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(ML_TO_L.y, DietThirst.u) annotation(Line(points = {{-77.7, 3}, {-74.84999999999999, 3}, {-74.84999999999999, 4}, {-71.8, 4}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(flowMeasure.q_out, osmoticPump.q_in) annotation(Line(points = {{43.28, 53.92}, {53.4, 53.92}, {53.4, 54}, {54.2, 54}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(osmoticPump.q_out, vascularH2O) annotation(Line(points = {{71.8, 54}, {90, 54}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(per_ml.y, osmoticPump.desiredOsmoles) annotation(Line(points = {{62.3, 67}, {63, 67}, {63, 60}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.OsmBody_Osm_conc_CellWalls, per_ml.u) annotation(Line(points = {{-74, 90}, {50, 90}, {50, 67}, {55.4, 67}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.GILumenSodium_Mass, gILumen.GILumenSodium_Mass) annotation(Line(points = {{-74, 90}, {-54, 90}, {-54, 62}, {-34, 62}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.Osmreceptors, ML_TO_L.u) annotation(Line(points = {{-74, 90}, {-100, 90}, {-100, 3}, {-84.59999999999999, 3}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(gILumen.Vol, busConnector.GILumenVolume_Mass) annotation(Line(points = {{-14.8, 62}, {-4, 62}, {-4, 90}, {-74, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(flowMeasure.actualFlow, busConnector.GILumenVolume_Absorption) annotation(Line(points = {{37.88, 47.08}, {37.88, 24}, {96, 24}, {96, 90}, {-74, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(busConnector.GILumenPotassium_Mass, gILumen.GILumenPotassium_Mass) annotation(Line(points = {{-74, 90}, {-54, 90}, {-54, 56}, {-34, 56}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.GILumenDiarrhea_H2OLoss, diarrhea.outflow) annotation(Line(points = {{-74, 90}, {-74, 34.2}, {-45, 34.2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.GILumenVomitus_H2OLoss, vomitus.outflow) annotation(Line(points = {{-74, 90}, {-74, 83.8}, {-45, 83.8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(Diet.q_out, flowMeasure1.q_in) annotation(Line(points = {{-55, -20.5}, {-48, -20.5}, {-48, 16}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(flowMeasure1.q_out, gILumen.intake) annotation(Line(points = {{-48, 28}, {-48, 50}, {-35, 50}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(busConnector.GILumenVolume_Intake, flowMeasure1.actualFlow) annotation(Line(points = {{-74, 90}, {-100, 90}, {-100, 22}, {-53.4, 22}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.GILumenVomitus_H2OTarget, vomitus.H2OTarget) annotation(Line(points = {{-74, 90}, {-74, 78}, {-38, 78}, {-38, 78.2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.GILumenDiarrhea_H2OTarget, diarrhea.H2OTarget) annotation(Line(points = {{-74, 90}, {-74, 39.8}, {-38, 39.8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(DietThirst.y, Diet.desiredFlow) annotation(Line(points = {{-62, 2}, {-62, -18}, {-60, -18}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Documentation(info = "<HTML>
                   <PRE>
                   QHP 2008 / GILumenH2O.REF
                    
                   Created : 13-Mar-08
                   Last Modified : 13-Mar-08
                   Author : Tom Coleman
                   Copyright : 2008-2008
                   By : University of Mississippi Medical Center
                   Solver : QHP 2008
                   Schema : 2008.0
                    
                   Volume ========================================
                    
                   Typical lumen volume is 1000 mL on an intake of 1.4 mL/Min.
                   This number is based on lumen volume being 1.4% body weight
                   from
                    
                      JCI 36:289-296, 1957.
                    
                   Data suggests a 1L oral load is nearly all absorbed in
                   1 Hr.  Average rate would be 17 mL/Hr with a peak rate
                   of about 30.
                    
                      Baldes & Smirk. J.Physiol. 82:62,1934.
                    
                   Osmolar gradient is assumed to be 0.200 mOsm/mL.
                    
                      Rate = Perm * Grad
                      30 = Perm * 0.200
                      Perm = 150
                    
                   Temperature ===================================
                    
                   Typical lumen heat content is 155 kCal.
                    
                   Specific heat (SH) of H2O is 0.001 (kCal/G)/DegK.
                    
                   To get temperature from heat
                    
                      DegK = 1000.0 * kCal/G (or mL)
                      DegC = DegK - 273.15
                      DegF = ( 9 / 5 ) * DegC + 32
                    
                   To get heat from temperature
                    
                      kCal = 0.001 * DegK * mL
                      kCal/Min = 0.001 * DegK * mL/Min
                   </PRE>
                   </HTML>
                   ", revisions = "<html>
                   <ul>
                   <li><i>  </i>
                          </li>
                   <li><i> january 2009 </i><br> 
                          by Marek Matejak in Modelica initially implemented (consulted with Jiri Kofranek), Charles University, Prague<br>
                          orginaly described by Tom Coleman in QHP 2008 beta 3, University of Mississippi Medical Center
                          </li>
                   </ul>
                   </html>"), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent = {{-102, 124}, {98, 108}}, lineColor = {0, 0, 255}, textString = "%name")}));
      end GILumen2;

      package test
        model Bladder_steady
          // extends Library.PressureFlow.VolumeCompartement;
          extends PhysiolibraryOld.Icons.Bladder;
          PhysiolibraryOld.PressureFlow.PositivePressureFlow con annotation (
              Placement(transformation(extent={{-84,18},{-44,58}}, rotation=0),
                iconTransformation(extent={{-120,-20},{-80,20}})));
          PhysiolibraryOld.PressureFlow.OutputPump bladderVoidFlow
            annotation (Placement(transformation(extent={{-58,-23},{-73,-8}})));
          PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
              Placement(transformation(extent={{-100,69},{-80,89}}),
                iconTransformation(extent={{-100,-100},{-80,-80}})));
          PhysiolibraryOld.Blocks.VolumeConstant volumeConstant(k=300)
            annotation (Placement(transformation(extent={{-28,32},{-20,40}})));
          PhysiolibraryOld.PressureFlow.FlowMeasure flowMeasure annotation (
              Placement(transformation(
                extent={{-10,-10},{10,10}},
                rotation=270,
                origin={-38,6})));
          PhysiolibraryOld.PressureFlow.VolumeCompartement volumeCompartement(
            stateName="BladderVolume.Mass",
            STEADY=false,
            initialVolume=300)
            annotation (Placement(transformation(extent={{-30,56},{-10,76}})));
        equation
          connect(con, flowMeasure.q_in) annotation(Line(points = {{-64, 38}, {-38, 38}, {-38, 12}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(flowMeasure.q_out, bladderVoidFlow.q_in) annotation(Line(points = {{-38, 0}, {-38, -15.5}, {-58, -15.5}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(flowMeasure.actualFlow, busConnector.BladderVoidFlow) annotation(Line(points = {{-32.6, 6}, {20, 6}, {20, 79}, {-90, 79}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
          connect(busConnector.CD_H2O_Outflow, bladderVoidFlow.desiredFlow) annotation(Line(points = {{-90, 79}, {-92, 79}, {-92, 4}, {-65.5, 4}, {-65.5, -11}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
          connect(con, volumeCompartement.con) annotation(Line(points = {{-64, 38}, {-36, 38}, {-36, 66}, {-30, 66}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(volumeCompartement.Volume, busConnector.BladderVolume_Mass) annotation(Line(points = {{-18.8, 56}, {-18, 56}, {-18, 48}, {8, 48}, {8, 79}, {-90, 79}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
          annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent = {{-100, 96}, {100, 80}}, lineColor = {0, 0, 255}, textString = "%name")}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
        end Bladder_steady;
      end test;

      model TorsoExtravascularWater
        extends PhysiolibraryOld.Utilities.DynamicState;
        extends PhysiolibraryOld.Icons.OtherTissue;
        PhysiolibraryOld.Semipermeable.NegativeOsmoticFlow q_out(o(final unit=
                "g")) annotation (Placement(transformation(extent={{62,-32},{
                  102,8}}), iconTransformation(extent={{-18,-4},{2,16}})));
        parameter Real initialWaterVolume(final quantity = "Volume", unit = "ml");
        parameter Real PressureVolume[:, 3] = {{600.0, -30.0, 0.01}, {2400.0, -4.8, 0.0004}, {6000.0, 0.0, 0.0004}, {12000.0, 50.0, 0.01}}
          "curve of water pressure, that depends on interstitial water volume";
        PhysiolibraryOld.Interfaces.RealInput_ NotpermeableSolutes(quantity=
              "Mass", unit="g") annotation (Placement(transformation(extent={{-116,
                  0},{-76,40}}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=180,
              origin={80,80})));
        PhysiolibraryOld.Interfaces.RealOutput_ WaterVolume(
          start=initialWaterVolume,
          final quantity="Volume",
          unit="ml") annotation (Placement(transformation(
              extent={{-20,-120},{20,-80}},
              rotation=-90,
              origin={188,18}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=0,
              origin={80,-40})));
        PhysiolibraryOld.Interfaces.RealInput_ ICFV(quantity="Volume", unit=
              "ml") "intracellular water volume" annotation (Placement(
              transformation(extent={{-116,-40},{-76,0}}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=180,
              origin={80,20})));
        PhysiolibraryOld.Interfaces.RealOutput_ ECFV "extracellular water"
          annotation (Placement(transformation(extent={{34,-108},{74,-68}}),
              iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=0,
              origin={80,-100})));
        /*initial equation 
                                                                                                                                                          if STEADY then
                                                                                                                                                             WaterVolume = initialWaterVolume;
                                                                                                                                                          end if;
                                                                                                                                                        */
        PhysiolibraryOld.Curves.Curve PressureVolumeCurve(
          x=PressureVolume[:, 1],
          y=PressureVolume[:, 2],
          slope=PressureVolume[:, 3])
          "curve of water hydraulic pressure, that depends on interstitial water volume"
          annotation (Placement(transformation(extent={{-18,-40},{2,-20}})));
        PhysiolibraryOld.Interfaces.RealOutput_ InterstitialPressure
          "torso interstitial pressure" annotation (Placement(transformation(
                extent={{2,-72},{42,-32}}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=180,
              origin={-100,-80})));
      equation
        ECFV = WaterVolume - ICFV;
        q_out.o = if ECFV > 0 then NotpermeableSolutes / ECFV else 0;
        //  der(WaterVolume) = q_out.q / Library.SecPerMin;
        stateValue = WaterVolume;
        changePerMin = q_out.q;
        PressureVolumeCurve.u = ECFV;
        connect(PressureVolumeCurve.val, InterstitialPressure) annotation(Line(points = {{2.2, -30}, {16, -30}, {16, -52}, {22, -52}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent = {{-120, -130}, {112, -154}}, lineColor = {0, 0, 255}, textString = "%name")}), Documentation(revisions = "<html>
                   <p><i>2009-2010</i></p>
                   <p>Marek Matejak, Charles University, Prague, Czech Republic </p>
                   </html>"));
      end TorsoExtravascularWater;

      model UT
        import HumMod;
        extends PhysiolibraryOld.Icons.UpperTorso;
        PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
            Placement(transformation(extent={{-106,83},{-86,103}}),
              iconTransformation(extent={{60,60},{80,80}})));
        PhysiolibraryOld.Semipermeable.PositiveOsmoticFlow vascularH2O(o(final
              unit="g/ml")) "plasma capillary wall osmotic connector"
          annotation (Placement(transformation(extent={{-100,-4},{-80,16}}),
              iconTransformation(extent={{-110,30},{-90,50}})));
        Modelica.Blocks.Math.Gain MetabolicH2O(k = 1.0 / 4.0) annotation(Placement(transformation(extent = {{6, -6}, {-6, 6}}, rotation = 0, origin = {56, -42})));
        Real volume;
        Real change;
        HumMod.Water.WaterCompartments.CapilaryMembrane capilaryMembrane(CapilaryWallPermeability = 0.27) annotation(Placement(transformation(extent = {{-56, 12}, {-36, 32}})));
        HumMod.Water.WaterCompartments.Lymph lymph(InterstitialPressureOnLymphFlow = {{-14.0, 0.0, 0.0}, {-4.0, 1.0, 0.1}, {2.0, 8.0, 4.0}, {6.0, 25.0, 0.0}}, NormalLymphFlowRate = 0.4) annotation(Placement(transformation(extent = {{-74, -4}, {-54, -24}})));
        HumMod.Water.WaterCompartments.TorsoExtravascularWater extravascularH2O(NotpermeableSolutes(unit = "g"), stateName = "UT_H2O.Vol", PressureVolume = {{600.0, -30.0, 0.01}, {2000.0, -4.8, 0.0004}, {5000.0, 0.0, 0.0004}, {12000.0, 50.0, 0.01}}, initialWaterVolume = 7224.68) annotation(Placement(transformation(extent = {{18, -16}, {38, 4}})));
        PhysiolibraryOld.Semipermeable.InputPump metabolic
          annotation (Placement(transformation(extent={{50,-64},{30,-44}})));
        PhysiolibraryOld.Semipermeable.FlowMeasure flowMeasure1 annotation (
            Placement(transformation(
              extent={{5,-5},{-5,5}},
              rotation=270,
              origin={-13,65})));
        PhysiolibraryOld.Semipermeable.FlowMeasure flowMeasure2 annotation (
            Placement(transformation(
              extent={{5,-5},{-5,5}},
              rotation=270,
              origin={-11,39})));
        HumMod.Water.Skin.SweatGland sweatGland annotation(Placement(transformation(extent = {{-14, 70}, {-34, 90}})));
        HumMod.Water.Skin.InsensibleSkin insensibleSkin(bodyPart = 1.0 / 3.0) annotation(Placement(transformation(extent = {{-15, 40}, {-35, 60}})));
      equation
        volume = extravascularH2O.WaterVolume;
        change = extravascularH2O.q_out.q;
        connect(capilaryMembrane.q_out, extravascularH2O.q_out) annotation(Line(points = {{-36, 22}, {-12, 22}, {-12, -5.4}, {27.2, -5.4}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(lymph.port_a, extravascularH2O.q_out) annotation(Line(points = {{-57.4, -14}, {-12, -14}, {-12, -5.4}, {27.2, -5.4}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(extravascularH2O.InterstitialPressure, capilaryMembrane.InterstitialPressure) annotation(Line(points = {{18, -14}, {-6, -14}, {-6, 28}, {-42, 28}, {-42, 26}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(extravascularH2O.InterstitialPressure, lymph.InterstitialPressure) annotation(Line(points = {{18, -14}, {-6, -14}, {-6, -30}, {-64, -30}, {-64, -22}, {-63.2, -22}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(lymph.port_b, vascularH2O) annotation(Line(points = {{-71, -13.6}, {-90, -13.6}, {-90, 6}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(capilaryMembrane.q_in, vascularH2O) annotation(Line(points = {{-56, 22}, {-90, 22}, {-90, 6}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(busConnector.RegionalPressure_UpperCapy, capilaryMembrane.capilaryPressure) annotation(Line(points = {{-96, 93}, {-96, 26}, {-50, 26}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(extravascularH2O.ICFV, busConnector.UT_Cell_H2O) annotation(Line(points = {{36, -4}, {98, -4}, {98, 93}, {-96, 93}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(extravascularH2O.NotpermeableSolutes, busConnector.UT_InterstitialProtein_Mass) annotation(Line(points = {{36, 2}, {98, 2}, {98, 93}, {-96, 93}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(MetabolicH2O.y, metabolic.desiredFlow) annotation(Line(points = {{49.4, -42}, {40, -42}, {40, -50}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(metabolic.q_out, extravascularH2O.q_out) annotation(Line(points = {{34, -54}, {4, -54}, {4, -6}, {27.2, -6}, {27.2, -5.4}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(lymph.LymphFlow, busConnector.UT_LymphFlow) annotation(Line(points = {{-55, -6}, {-36, -6}, {-36, 93}, {-96, 93}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(extravascularH2O.ECFV, busConnector.UT_InterstitialWater_Vol) annotation(Line(points = {{36, -16}, {98, -16}, {98, 93}, {-96, 93}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(extravascularH2O.WaterVolume, busConnector.UT_H2O_Vol) annotation(Line(points = {{36, -10}, {98, -10}, {98, 93}, {-96, 93}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(MetabolicH2O.u, busConnector.MetabolicH2O_Rate) annotation(Line(points = {{63.2, -42}, {98, -42}, {98, 93}, {-96, 93}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(flowMeasure2.q_in, extravascularH2O.q_out) annotation(Line(points = {{-12.7, 34.5}, {27.2, 34.5}, {27.2, -5.4}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(insensibleSkin.q_out, flowMeasure2.q_out) annotation(Line(points = {{-17, 46}, {-12.6, 46}, {-12.6, 43.4}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(sweatGland.q_out, flowMeasure1.q_out) annotation(Line(points = {{-16, 76}, {-13.3, 76}, {-13.3, 69.40000000000001}, {-14.6, 69.40000000000001}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(flowMeasure1.q_in, extravascularH2O.q_out) annotation(Line(points = {{-14.7, 60.5}, {-14.7, 60}, {27.2, 60}, {27.2, -5.4}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(busConnector, insensibleSkin.busConnector) annotation(Line(points = {{-96, 93}, {-31, 93}, {-31, 57}, {-32, 57}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(sweatGland.busConnector, busConnector) annotation(Line(points = {{-31, 87}, {-31, 93}, {-96, 93}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(flowMeasure1.actualFlow, busConnector.UT_Sweat_H2OOutflow) annotation(Line(points = {{-8.9, 64.90000000000001}, {22, 64.90000000000001}, {22, 93}, {-96, 93}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(flowMeasure2.actualFlow, busConnector.UT_InsensibleSkin_H2O) annotation(Line(points = {{-6.9, 38.9}, {22, 38.9}, {22, 93}, {-96, 93}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent = {{-139, -91}, {142, -116}}, lineColor = {0, 0, 255}, textString = "%name")}));
      end UT;

      model MT
        import HumMod;
        extends PhysiolibraryOld.Icons.MidleTorso;
        PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
            Placement(transformation(extent={{-106,87},{-86,107}}),
              iconTransformation(extent={{60,60},{80,80}})));
        PhysiolibraryOld.Semipermeable.PositiveOsmoticFlow vascularH2O(o(final
              unit="g/ml")) "plasma capillary wall osmotic connector"
          annotation (Placement(transformation(extent={{-100,-36},{-80,-16}}),
              iconTransformation(extent={{-110,30},{-90,50}})));
        Real volume;
        Real change;
        HumMod.Water.InsensibleLungs lungs annotation(Placement(transformation(extent = {{-10, 75}, {-30, 95}})));
        HumMod.Water.Skin.InsensibleSkin insensibleSkin(bodyPart = 1.0 / 3.0) annotation(Placement(transformation(extent = {{-11, 12}, {-31, 32}})));
        HumMod.Water.WaterCompartments.TorsoExtravascularWater extravascularH2O(NotpermeableSolutes(unit = "g"), initialWaterVolume = 18613, stateName = "MT_H2O.Vol", PressureVolume = {{1200.0, -30.0, 0.01}, {4800.0, -4.8, 0.0004}, {12000.0, 0.0, 0.0004}, {24000.0, 50.0, 0.01}}) annotation(Placement(transformation(extent = {{20, -32}, {40, -12}})));
        HumMod.Water.WaterCompartments.CapilaryMembrane capilaryMembrane(CapilaryWallPermeability = 0.44) annotation(Placement(transformation(extent = {{-52, -22}, {-32, -2}})));
        HumMod.Water.WaterCompartments.Lymph lymph(NormalLymphFlowRate = 0.8, InterstitialPressureOnLymphFlow = {{-14.0, 0.0, 0.0}, {-4.0, 1.0, 0.1}, {2.0, 8.0, 4.0}, {6.0, 25.0, 0.0}}) annotation(Placement(transformation(extent = {{-48, -48}, {-28, -28}})));
        PhysiolibraryOld.Semipermeable.FlowMeasure flowMeasure annotation (
            Placement(transformation(
              extent={{5,-5},{-5,5}},
              rotation=270,
              origin={-7,75})));
        HumMod.Water.Skin.SweatGland sweatGland annotation(Placement(transformation(extent = {{-10, 42}, {-30, 62}})));
        PhysiolibraryOld.Semipermeable.FlowMeasure flowMeasure1 annotation (
            Placement(transformation(
              extent={{5,-5},{-5,5}},
              rotation=270,
              origin={-9,37})));
        PhysiolibraryOld.Semipermeable.FlowMeasure flowMeasure2 annotation (
            Placement(transformation(
              extent={{5,-5},{-5,5}},
              rotation=270,
              origin={-7,11})));
        Modelica.Blocks.Math.Gain MetabolicH2O(k = 1.0 / 2.0) annotation(Placement(transformation(extent = {{6, -6}, {-6, 6}}, rotation = 0, origin = {56, -56})));
        PhysiolibraryOld.Semipermeable.InputPump metabolic
          annotation (Placement(transformation(extent={{50,-78},{30,-58}})));
        PhysiolibraryOld.Blocks.VolumeConstant lungEdema(k=0)
          annotation (Placement(transformation(extent={{-74,68},{-66,76}})));
        HumMod.Water.WaterCompartments.Peritoneum_const peritoneum_const annotation(Placement(transformation(extent = {{-88, 26}, {-68, 46}})));
      equation
        volume = extravascularH2O.WaterVolume;
        change = extravascularH2O.q_out.q;
        connect(lungs.busConnector, busConnector) annotation(Line(points = {{-27, 92}, {-27, 97}, {-96, 97}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector, insensibleSkin.busConnector) annotation(Line(points = {{-96, 97}, {-27, 97}, {-27, 29}, {-28, 29}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(extravascularH2O.InterstitialPressure, lymph.InterstitialPressure) annotation(Line(points = {{20, -30}, {-37.2, -30}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(extravascularH2O.InterstitialPressure, capilaryMembrane.InterstitialPressure) annotation(Line(points = {{20, -30}, {-12, -30}, {-12, -4}, {-38, -4}, {-38, -8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(extravascularH2O.q_out, lymph.port_a) annotation(Line(points = {{29.2, -21.4}, {-18, -21.4}, {-18, -38}, {-31.4, -38}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(extravascularH2O.q_out, capilaryMembrane.q_out) annotation(Line(points = {{29.2, -21.4}, {-18, -21.4}, {-18, -12}, {-32, -12}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(capilaryMembrane.q_in, vascularH2O) annotation(Line(points = {{-52, -12}, {-90, -12}, {-90, -26}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(lymph.port_b, vascularH2O) annotation(Line(points = {{-45, -38.4}, {-90, -38.4}, {-90, -26}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(extravascularH2O.NotpermeableSolutes, busConnector.MT_InterstitialProtein_Mass) annotation(Line(points = {{38, -14}, {98, -14}, {98, 97}, {-96, 97}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(extravascularH2O.ICFV, busConnector.MT_Cell_H2O) annotation(Line(points = {{38, -20}, {98, -20}, {98, 97}, {-96, 97}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(extravascularH2O.WaterVolume, busConnector.MT_H2O_Vol) annotation(Line(points = {{38, -26}, {98, -26}, {98, 97}, {-96, 97}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(extravascularH2O.ECFV, busConnector.MT_InterstitialWater_Vol) annotation(Line(points = {{38, -32}, {98, -32}, {98, 97}, {-96, 97}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(busConnector.RegionalPressure_MiddleCapy, capilaryMembrane.capilaryPressure) annotation(Line(points = {{-96, 97}, {-96, -8}, {-46, -8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(flowMeasure.q_in, extravascularH2O.q_out) annotation(Line(points = {{-8.699999999999999, 70.5}, {29.2, 70.5}, {29.2, -21.4}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(flowMeasure.q_out, lungs.q_out) annotation(Line(points = {{-8.6, 79.40000000000001}, {-7.7, 79.40000000000001}, {-7.7, 82.40000000000001}, {-17.4, 82.40000000000001}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(sweatGland.q_out, flowMeasure1.q_out) annotation(Line(points = {{-12, 48}, {-9.300000000000001, 48}, {-9.300000000000001, 41.4}, {-10.6, 41.4}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(flowMeasure1.q_in, extravascularH2O.q_out) annotation(Line(points = {{-10.7, 32.5}, {-10.7, 32}, {29.2, 32}, {29.2, -21.4}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(flowMeasure.actualFlow, busConnector.HeatInsensibleLung_H2O) annotation(Line(points = {{-2.9, 74.90000000000001}, {28, 74.90000000000001}, {28, 97}, {-96, 97}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(insensibleSkin.q_out, flowMeasure2.q_out) annotation(Line(points = {{-13, 18}, {-8.6, 18}, {-8.6, 15.4}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(flowMeasure2.q_in, extravascularH2O.q_out) annotation(Line(points = {{-8.699999999999999, 6.5}, {29.2, 6.5}, {29.2, -21.4}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(flowMeasure2.actualFlow, busConnector.MT_InsensibleSkin_H2O) annotation(Line(points = {{-2.9, 10.9}, {28, 10.9}, {28, 97}, {-96, 97}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(sweatGland.busConnector, busConnector) annotation(Line(points = {{-27, 59}, {-27, 97}, {-96, 97}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(flowMeasure1.actualFlow, busConnector.MT_Sweat_H2OOutflow) annotation(Line(points = {{-4.9, 36.9}, {28, 36.9}, {28, 97}, {-96, 97}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(MetabolicH2O.y, metabolic.desiredFlow) annotation(Line(points = {{49.4, -56}, {40, -56}, {40, -64}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(MetabolicH2O.u, busConnector.MetabolicH2O_Rate) annotation(Line(points = {{63.2, -56}, {98, -56}, {98, 97}, {-96, 97}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(metabolic.q_out, extravascularH2O.q_out) annotation(Line(points = {{34, -68}, {12, -68}, {12, -22}, {29.2, -22}, {29.2, -21.4}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(lymph.LymphFlow, busConnector.MT_LymphFlow) annotation(Line(points = {{-29, -46}, {-6, -46}, {-6, -52}, {-96, -52}, {-96, 97}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(lungEdema.y, busConnector.ExcessLungWater_Volume) annotation(Line(points = {{-65.59999999999999, 72}, {-54, 72}, {-54, 97}, {-96, 97}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(peritoneum_const.flux, vascularH2O) annotation(Line(points = {{-78, 40}, {-90, 40}, {-90, -26}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(peritoneum_const.busConnector, busConnector) annotation(Line(points = {{-71, 43}, {-96, 97}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent = {{-141, -87}, {140, -112}}, lineColor = {0, 0, 255}, textString = "%name")}));
      end MT;

      model LT
        import HumMod;
        extends PhysiolibraryOld.Icons.LowerTorso;
        PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
            Placement(transformation(extent={{-106,85},{-86,105}}),
              iconTransformation(extent={{60,60},{80,80}})));
        PhysiolibraryOld.Semipermeable.PositiveOsmoticFlow vascularH2O(o(final
              unit="g/ml")) "plasma capillary wall osmotic connector"
          annotation (Placement(transformation(extent={{-104,-22},{-84,-2}}),
              iconTransformation(extent={{-110,30},{-90,50}})));
        Real volume;
        Real change;
        HumMod.Water.WaterCompartments.Lymph lymph(InterstitialPressureOnLymphFlow = {{-14.0, 0.0, 0.0}, {-4.0, 1.0, 0.1}, {2.0, 8.0, 4.0}, {6.0, 25.0, 0.0}}, NormalLymphFlowRate = 1.3) annotation(Placement(transformation(extent = {{-74, -22}, {-54, -42}})));
        HumMod.Water.WaterCompartments.CapilaryMembrane capilaryMembrane(CapilaryWallPermeability = 0.71) annotation(Placement(transformation(extent = {{-56, -6}, {-36, 14}})));
        HumMod.Water.WaterCompartments.TorsoExtravascularWater extravascularH2O(NotpermeableSolutes(unit = "g"), stateName = "LT_H2O.Vol", initialWaterVolume = 10876.6, PressureVolume = {{600.0, -30.0, 0.02}, {3000.0, -4.8, 0.0004}, {4000.0, -4.0, 0.0004}, {6000.0, 50.0, 0.03}}) annotation(Placement(transformation(extent = {{16, -28}, {36, -8}})));
        PhysiolibraryOld.Semipermeable.FlowMeasure flowMeasure1 annotation (
            Placement(transformation(
              extent={{5,-5},{-5,5}},
              rotation=270,
              origin={-15,55})));
        PhysiolibraryOld.Semipermeable.FlowMeasure flowMeasure2 annotation (
            Placement(transformation(
              extent={{5,-5},{-5,5}},
              rotation=270,
              origin={-13,29})));
        HumMod.Water.Skin.SweatGland sweatGland annotation(Placement(transformation(extent = {{-16, 60}, {-36, 80}})));
        HumMod.Water.Skin.InsensibleSkin insensibleSkin(bodyPart = 1.0 / 3.0) annotation(Placement(transformation(extent = {{-17, 30}, {-37, 50}})));
        Modelica.Blocks.Math.Gain MetabolicH2O1(k = 1.0 / 4.0) annotation(Placement(transformation(extent = {{6, -6}, {-6, 6}}, rotation = 0, origin = {56, -54})));
        PhysiolibraryOld.Semipermeable.InputPump metabolic1
          annotation (Placement(transformation(extent={{50,-76},{30,-56}})));
      equation
        volume = extravascularH2O.WaterVolume;
        change = extravascularH2O.q_out.q;
        connect(lymph.port_b, vascularH2O) annotation(Line(points = {{-71, -31.6}, {-94, -31.6}, {-94, -12}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(capilaryMembrane.q_in, vascularH2O) annotation(Line(points = {{-56, 4}, {-94, 4}, {-94, -12}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(capilaryMembrane.q_out, extravascularH2O.q_out) annotation(Line(points = {{-36, 4}, {-12, 4}, {-12, -17.4}, {25.2, -17.4}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(lymph.port_a, extravascularH2O.q_out) annotation(Line(points = {{-57.4, -32}, {-12, -32}, {-12, -17.4}, {25.2, -17.4}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(extravascularH2O.InterstitialPressure, capilaryMembrane.InterstitialPressure) annotation(Line(points = {{16, -26}, {-6, -26}, {-6, 10}, {-42, 10}, {-42, 8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(extravascularH2O.InterstitialPressure, lymph.InterstitialPressure) annotation(Line(points = {{16, -26}, {-6, -26}, {-6, -48}, {-64, -48}, {-64, -40}, {-63.2, -40}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(extravascularH2O.NotpermeableSolutes, busConnector.LT_InterstitialProtein_Mass) annotation(Line(points = {{34, -10}, {98, -10}, {98, 95}, {-96, 95}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(extravascularH2O.ICFV, busConnector.LT_Cell_H2O) annotation(Line(points = {{34, -16}, {98, -16}, {98, 95}, {-96, 95}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(extravascularH2O.WaterVolume, busConnector.LT_H2O_Vol) annotation(Line(points = {{34, -22}, {98, -22}, {98, 95}, {-96, 95}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(extravascularH2O.ECFV, busConnector.LT_InterstitialWater_Vol) annotation(Line(points = {{34, -28}, {98, -28}, {98, 95}, {-96, 95}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(busConnector.RegionalPressure_LowerCapy, capilaryMembrane.capilaryPressure) annotation(Line(points = {{-96, 95}, {-96, 8}, {-50, 8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(flowMeasure2.q_in, extravascularH2O.q_out) annotation(Line(points = {{-14.7, 24.5}, {25.2, 24.5}, {25.2, -17.4}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(insensibleSkin.q_out, flowMeasure2.q_out) annotation(Line(points = {{-19, 36}, {-14.6, 36}, {-14.6, 33.4}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(sweatGland.q_out, flowMeasure1.q_out) annotation(Line(points = {{-18, 66}, {-15.3, 66}, {-15.3, 59.4}, {-16.6, 59.4}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(flowMeasure1.q_in, extravascularH2O.q_out) annotation(Line(points = {{-16.7, 50.5}, {-16.7, 50}, {25.2, 50}, {25.2, -17.4}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(busConnector, insensibleSkin.busConnector) annotation(Line(points = {{-96, 95}, {-33, 95}, {-33, 47}, {-34, 47}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(sweatGland.busConnector, busConnector) annotation(Line(points = {{-33, 77}, {-33, 95}, {-96, 95}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(flowMeasure2.actualFlow, busConnector.LT_InsensibleSkin_H2O) annotation(Line(points = {{-8.9, 28.9}, {22, 28.9}, {22, 95}, {-96, 95}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(flowMeasure1.actualFlow, busConnector.LT_Sweat_H2OOutflow) annotation(Line(points = {{-10.9, 54.9}, {22, 54.9}, {22, 95}, {-96, 95}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(MetabolicH2O1.y, metabolic1.desiredFlow) annotation(Line(points = {{49.4, -54}, {40, -54}, {40, -62}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(metabolic1.q_out, extravascularH2O.q_out) annotation(Line(points = {{34, -66}, {4, -66}, {4, -18}, {25.2, -18}, {25.2, -17.4}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(MetabolicH2O1.u, busConnector.MetabolicH2O_Rate) annotation(Line(points = {{63.2, -54}, {98, -54}, {98, 95}, {-96, 95}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(lymph.LymphFlow, busConnector.LT_LymphFlow) annotation(Line(points = {{-55, -24}, {-28, -24}, {-28, -4}, {-96, -4}, {-96, 95}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent = {{-141, -103}, {140, -128}}, lineColor = {0, 0, 255}, textString = "%name")}));
      end LT;

      model Plasma
        // extends HumMod.Library.Utilities.DynamicState;
        extends PhysiolibraryOld.Icons.Plasma;
        // parameter Real initialVolume(final quantity="Volume",final unit="ml") = 3000   "initial plasma water volume";
        PhysiolibraryOld.Semipermeable.PositiveOsmoticFlow q_in(o(unit="g/ml"))
          annotation (Placement(transformation(extent={{-50,10},{-30,30}}),
              iconTransformation(extent={{-50,10},{-30,30}})));
        //initial equation
        //  Volume = initialVolume;
        PhysiolibraryOld.Semipermeable.WaterColloidOsmoticCompartment
          waterColloidOsmoticCompartment(stateName="PlasmaVol.Vol",
            initialWaterVolume=3000.4)
          annotation (Placement(transformation(extent={{-6,-22},{14,-2}})));
        PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
            Placement(transformation(extent={{-98,79},{-78,99}}),
              iconTransformation(extent={{-90,70},{-70,90}})));
        Real volume;
        Real change;
      equation
        volume = waterColloidOsmoticCompartment.WaterVolume;
        change = q_in.q;
        connect(busConnector.PlasmaProtein_Mass, waterColloidOsmoticCompartment.NotpermeableSolutes) annotation(Line(points = {{-88, 89}, {-88, -4}, {-6, -4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(waterColloidOsmoticCompartment.q_out, q_in) annotation(Line(points = {{4, -12}, {4, 20}, {-40, 20}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(waterColloidOsmoticCompartment.WaterVolume, busConnector.PlasmaVol) annotation(Line(points = {{4, -22}, {4, -36}, {48, -36}, {48, 89}, {-88, 89}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(waterColloidOsmoticCompartment.WaterVolume, busConnector.PlasmaVol_Vol) annotation(Line(points = {{4, -22}, {4, -36}, {48, -36}, {48, 89}, {-88, 89}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        annotation(Documentation(info = "<HTML>
                   <PRE>
                   QHP 2008 / BloodVolume/PlasmaVol.DES
                    
                   Created : 21-Oct-04
                   Last Modified : 20-Mar-08
                   Author : Tom Coleman
                   Copyright : 2005-2008
                   By : University of Mississippi Medical Center
                   Solver : DES 2005
                   Schema : 2005.0
                   </PRE>
                   </HTML>
                   ", revisions = "<html>
                   <ul>
                   <li><i>  </i>
                          </li>
                   <li><i> january 2009 </i><br> 
                          by Marek Matejak in Modelica initially implemented (consulted with Jiri Kofranek), Charles University, Prague<br>
                          orginaly described by Tom Coleman in QHP 2008 beta 3, University of Mississippi Medical Center
                          </li>
                   </ul>
                   </html>"), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Rectangle(extent = {{-100, 100}, {100, -100}}, lineColor = {0, 0, 0}), Text(extent = {{-100, -80}, {100, -100}}, lineColor = {0, 0, 255}, textString = "%name")}));
      end Plasma;

      model CapilaryMembrane
        extends PhysiolibraryOld.Icons.Resistor;
        PhysiolibraryOld.Interfaces.RealInput_ InterstitialPressure(final
            quantity="Pressure", final unit="mmHg") "interstitial pressure"
          annotation (Placement(transformation(extent={{20,2},{12,10}}),
              iconTransformation(
              extent={{20,-20},{-20,20}},
              rotation=90,
              origin={40,40})));
        parameter Real CapilaryWallPermeability(final unit = "ml/(min.mmHg)") = 1
          "Capilary wall permeability for water";
        PhysiolibraryOld.Semipermeable.PositiveOsmoticFlow q_in(o(final unit=
                "g/ml")) "plasma capillary wall osmotic connector" annotation (
            Placement(transformation(extent={{-110,-10},{-90,10}}),
              iconTransformation(extent={{-110,-10},{-90,10}})));
        PhysiolibraryOld.Semipermeable.ColloidHydraulicPressure toPressure
          annotation (Placement(transformation(extent={{-86,16},{-78,24}})));
        PhysiolibraryOld.Semipermeable.ColloidHydraulicPressure toPressure1
          annotation (Placement(transformation(extent={{6,34},{-2,26}})));
        PhysiolibraryOld.PressureFlow.ResistorWithCondParam CapillaryWall(cond=
              CapilaryWallPermeability)
          annotation (Placement(transformation(extent={{-65,32},{-43,54}})));
        PhysiolibraryOld.Interfaces.RealInput_ capilaryPressure(final quantity=
              "Pressure", final unit="mmHg")
          "average capilary hydraulic pressure in torso" annotation (Placement(
              transformation(
              extent={{5,-5},{-5,5}},
              rotation=180,
              origin={-92,40}), iconTransformation(
              extent={{20,-20},{-20,20}},
              rotation=90,
              origin={-40,40})));
        PhysiolibraryOld.Semipermeable.NegativeOsmoticFlow q_out annotation (
            Placement(transformation(extent={{90,-10},{110,10}}),
              iconTransformation(extent={{90,-10},{110,10}})));
      equation
        connect(toPressure.q_in, q_in) annotation(Line(points = {{-86, 20}, {-93, 20}, {-93, 0}, {-100, 0}}, color = {127, 127, 0}, pattern = LinePattern.None, thickness = 1, smooth = Smooth.None));
        connect(toPressure.q_out, CapillaryWall.q_in) annotation(Line(points = {{-78, 20}, {-72, 20}, {-72, 43}, {-65, 43}}, color = {0, 0, 0}, pattern = LinePattern.None, thickness = 1, smooth = Smooth.None));
        connect(CapillaryWall.q_out, toPressure1.q_out) annotation(Line(points = {{-43, 43}, {-12, 43}, {-12, 30}, {-2, 30}}, color = {0, 0, 0}, pattern = LinePattern.None, thickness = 1, smooth = Smooth.None));
        connect(capilaryPressure, toPressure.hydraulicPressure) annotation(Line(points = {{-92, 40}, {-80.40000000000001, 40}, {-80.40000000000001, 24.8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(toPressure1.hydraulicPressure, InterstitialPressure) annotation(Line(points = {{0.4, 25.2}, {0.4, 6}, {16, 6}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(toPressure1.q_in, q_out) annotation(Line(points = {{6, 30}, {44, 30}, {44, 0}, {100, 0}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        annotation(Documentation(info = "<HTML>
                   <PRE>
                   Torso water compartment.
                    
                   like
                   QHP 2008 / TissueH2O/UT_H2O.DES
                   and
                   QHP 2008 / TissueH2O/InterstitialWater/UT_InterstitialWater.DES
                    
                   Created : 24-Mar-08
                   Last Modified : 24-Mar-08
                   Author : Tom Coleman
                   Copyright : 2008-2008
                   By : University of Mississippi Medical Center
                   Solver : DES 2005
                   Schema : 2005.0
                   </PRE>
                   </HTML>
                   ", revisions = "<html>
                   <ul>
                   <li><i>  </i>
                          </li>
                   <li><i> january 2009 </i><br> 
                          by Marek Matejak in Modelica initially implemented (consulted with Jiri Kofranek), Charles University, Prague<br>
                          orginaly described by Tom Coleman in QHP 2008 beta 3, University of Mississippi Medical Center
                          </li>
                   </ul>
                   </html>"), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
      end CapilaryMembrane;

      model Lymph
        extends PhysiolibraryOld.Icons.Lymph;
        parameter Boolean CALC_INTERSTITIAL_PRESSURE_FROM_FLOW = false
          "==STEADY";
        parameter Real InterstitialPressureOnLymphFlow[:, 3] = {{-14.0, 0.0, 0.0}, {-4.0, 1.0, 0.1}, {2.0, 8.0, 4.0}, {6.0, 25.0, 0.0}}
          "dependence between interstitial water hydraulic pressure and lymph flow";
        parameter Real NormalLymphFlowRate(final unit = "ml/min") = 0.4;
        PhysiolibraryOld.Semipermeable.NegativeOsmoticFlow port_b(o(final unit=
                "g/ml")) "plasma capillary wall osmotic connector" annotation (
            Placement(transformation(extent={{-110,10},{-90,30}}),
              iconTransformation(extent={{-80,-14},{-60,6}})));
        PhysiolibraryOld.Interfaces.RealOutput_ LymphFlow(final quantity="Flow",
            final unit="ml/min") annotation (Placement(transformation(extent={{
                  -29,26},{-23,32}}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=0,
              origin={90,-80})));
        PhysiolibraryOld.Semipermeable.Pump pump annotation (Placement(
              transformation(
              extent={{-10,10},{10,-10}},
              rotation=180,
              origin={-44,20})));
        PhysiolibraryOld.Factors.SplineValue2 InterstitialPressureEffect(data=
              InterstitialPressureOnLymphFlow, INVERSE=
              CALC_INTERSTITIAL_PRESSURE_FROM_FLOW)
          annotation (Placement(transformation(extent={{-34,24},{-54,44}})));
        PhysiolibraryOld.Blocks.FlowConstant flowConstant(k=NormalLymphFlowRate)
          annotation (Placement(transformation(extent={{-54,38},{-46,46}})));
        PhysiolibraryOld.Semipermeable.PositiveOsmoticFlow port_a annotation (
            Placement(transformation(extent={{56,-10},{76,10}}),
              iconTransformation(extent={{56,-10},{76,10}})));
        PhysiolibraryOld.Interfaces.RealInput_ InterstitialPressure(final
            quantity="Pressure", final unit="mmHg") "interstitial pressure"
          annotation (Placement(transformation(extent={{-4,52},{-12,60}}),
              iconTransformation(
              extent={{20,-20},{-20,20}},
              rotation=90,
              origin={8,80})));
      equation
        connect(InterstitialPressureEffect.y, pump.desiredFlow) annotation(Line(points = {{-44, 32}, {-44, 24}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(flowConstant.y, InterstitialPressureEffect.yBase) annotation(Line(points = {{-45.6, 42}, {-44, 42}, {-44, 36}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(InterstitialPressureEffect.y, LymphFlow) annotation(Line(points = {{-44, 32}, {-44, 29}, {-26, 29}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(port_b, pump.q_out) annotation(Line(points = {{-100, 20}, {-54, 20}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(pump.q_in, port_a) annotation(Line(points = {{-34, 20}, {16, 20}, {16, 0}, {66, 0}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(InterstitialPressureEffect.u, InterstitialPressure) annotation(Line(points = {{-34.2, 34}, {-22, 34}, {-22, 56}, {-8, 56}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Documentation(info = "<HTML>
                   <PRE>
                   Torso water compartment.
                    
                   like
                   QHP 2008 / TissueH2O/UT_H2O.DES
                   and
                   QHP 2008 / TissueH2O/InterstitialWater/UT_InterstitialWater.DES
                    
                   Created : 24-Mar-08
                   Last Modified : 24-Mar-08
                   Author : Tom Coleman
                   Copyright : 2008-2008
                   By : University of Mississippi Medical Center
                   Solver : DES 2005
                   Schema : 2005.0
                   </PRE>
                   </HTML>
                   ", revisions = "<html>
                   <ul>
                   <li><i>  </i>
                          </li>
                   <li><i> january 2009 </i><br> 
                          by Marek Matejak in Modelica initially implemented (consulted with Jiri Kofranek), Charles University, Prague<br>
                          orginaly described by Tom Coleman in QHP 2008 beta 3, University of Mississippi Medical Center
                          </li>
                   </ul>
                   </html>"), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent = {{-96, -106}, {104, -126}}, lineColor = {0, 0, 255}, textString = "%name")}));
      end Lymph;

      model Peritoneum_const
        extends PhysiolibraryOld.Icons.Peritoneum;
        replaceable class Variable =
            PhysiolibraryOld.Utilities.ConstantFromFile;
        PhysiolibraryOld.Semipermeable.PositiveOsmoticFlow flux
          "plasma proteins concentration" annotation (Placement(transformation(
                extent={{56,30},{76,50}}), iconTransformation(extent={{-10,30},
                  {10,50}})));
        parameter Real initialVolume(final quantity = "Volume", final unit = "ml") = 0
          "initial water in peritoneum";
        PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
            Placement(transformation(extent={{-106,87},{-86,107}}),
              iconTransformation(extent={{60,60},{80,80}})));
        Variable PeritoneumSpace_Gain(
          varName="PeritoneumSpace.Gain",
          varValue=0.0,
          initType=PhysiolibraryOld.Utilities.Init.NoInit)
          "Water gain to peritoneum. [ml/min]"
          annotation (Placement(transformation(extent={{-66,-4},{-20,42}})));
        Variable PeritoneumSpace_Volume(
          varName="PeritoneumSpace.Volume",
          varValue=0.0,
          initType=PhysiolibraryOld.Utilities.Init.NoInit)
          "Water in peritoneum. [ml]"
          annotation (Placement(transformation(extent={{-66,48},{-20,94}})));
        Variable PeritoneumSpace_Loss(
          varName="PeritoneumSpace.Loss",
          varValue=0.0,
          initType=PhysiolibraryOld.Utilities.Init.NoInit)
          "Water flow from peritoneum to plasma. [ml/min]"
          annotation (Placement(transformation(extent={{-66,-50},{-20,-4}})));
      equation
        flux.q = 0;
        connect(PeritoneumSpace_Volume.y, busConnector.PeritoneumSpace_Vol) annotation(Line(points = {{-17.7, 71}, {16, 71}, {16, 97}, {-96, 97}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(PeritoneumSpace_Gain.y, busConnector.PeritoneumSpace_Gain) annotation(Line(points = {{-17.7, 19}, {16, 19}, {16, 97}, {-96, 97}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(PeritoneumSpace_Loss.y, busConnector.PeritoneumSpace_Loss) annotation(Line(points = {{-17.7, -27}, {16, -27}, {16, 97}, {-96, 97}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        annotation(Documentation(info = "<HTML>
                   <PRE>
                   QHP 2008 / Peritoneum
                    
                   Created : 19-Mar-08
                   Last Modified : 19-Mar-08
                   Author : Tom Coleman
                   Copyright : 2008-2008
                   By : University of Mississippi Medical Center
                   Solver : QHP 2008
                   Schema : 2008.0
                   </PRE>
                   </HTML>
                   ", revisions = "<html>
                   <ul>
                   <li><i>  </i>
                          </li>
                   <li><i> january 2009 </i><br> 
                          by Marek Matejak in Modelica initially implemented (consulted with Jiri Kofranek), Charles University, Prague<br>
                          orginaly described by Tom Coleman in QHP 2008 beta 3, University of Mississippi Medical Center
                          </li>
                   </ul>
                   </html>"), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent = {{-100, 120}, {100, 104}}, lineColor = {0, 0, 255}, textString = "%name"), Text(extent = {{-100, -6}, {100, -22}}, lineColor = {0, 0, 255}, textString = "(initial %initialVolume ml)")}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
      end Peritoneum_const;

      model GILumen
        extends PhysiolibraryOld.Utilities.DynamicState;
        extends PhysiolibraryOld.Icons.GILumen;
        PhysiolibraryOld.Interfaces.RealInput_ GILumenSodium_Mass(final
            quantity="Mass", final unit="mEq")
          "sodium in gastro intestinal lumen" annotation (Placement(
              transformation(extent={{120,20},{80,60}}), iconTransformation(
                extent={{-100,70},{-80,90}})));
        PhysiolibraryOld.Interfaces.RealInput_ GILumenPotassium_Mass(final
            quantity="Mass", final unit="mEq")
          "potasium in gastro intestinal lumen" annotation (Placement(
              transformation(extent={{120,60},{80,100}}), iconTransformation(
                extent={{-100,10},{-80,30}})));
        PhysiolibraryOld.Semipermeable.NegativeOsmoticFlow absorbtion
          annotation (Placement(transformation(extent={{60,-20},{100,20}}),
              iconTransformation(extent={{90,-10},{110,10}})));
        PhysiolibraryOld.VolumeFlow.NegativeVolumeFlow outtake annotation (
            Placement(transformation(extent={{-20,-120},{20,-80}}),
              iconTransformation(extent={{-20,-120},{20,-80}})));
        PhysiolibraryOld.PressureFlow.PositivePressureFlow intake annotation (
            Placement(transformation(extent={{-120,-60},{-80,-20}}),
              iconTransformation(extent={{-120,-60},{-80,-20}})));
        parameter Real Fiber_mass(final quantity = "Mass", final unit = "mOsm") = 0.043;
        parameter Real Na_EqToAllConnectedOsm(final unit = "mOsm/mEq") = 2;
        parameter Real K_EqToAllConnectedOsm(final unit = "mOsm/mEq") = 2;
        //parameter Real initialVolume(final quantity="Volume", final unit="ml") = initialValue;
        Real mass(final quantity = "Volume", final unit = "ml", start = 949.201)
          "water volume in gastro intestinal lumen";
        Real OsmNa;
        Real OsmK;
        Real Fiber;
        PhysiolibraryOld.Interfaces.RealOutput_ Vol annotation (Placement(
              transformation(extent={{82,60},{122,100}}), iconTransformation(
                extent={{82,60},{122,100}})));
      initial equation
        //mass = 949.201;
      equation
        //   der(mass) = (intake.q + absorbtion.q + outtake.q)/Library.SecPerMin;
        intake.pressure = 0;
        //not used
        OsmNa = Na_EqToAllConnectedOsm * GILumenSodium_Mass / mass;
        OsmK = K_EqToAllConnectedOsm * GILumenPotassium_Mass / mass;
        Fiber = Fiber_mass;
        ///mass;
        absorbtion.o = Fiber + OsmNa + OsmK;
        outtake.volume = mass;
        Vol = mass;
        stateValue = mass;
        changePerMin = intake.q + absorbtion.q + outtake.q;
        annotation(Documentation(info = "<HTML>
                   <PRE>
                   QHP 2008 / GILumenH2O.REF
                    
                   Created : 13-Mar-08
                   Last Modified : 13-Mar-08
                   Author : Tom Coleman
                   Copyright : 2008-2008
                   By : University of Mississippi Medical Center
                   Solver : QHP 2008
                   Schema : 2008.0
                    
                   Volume ========================================
                    
                   Typical lumen volume is 1000 mL on an intake of 1.4 mL/Min.
                   This number is based on lumen volume being 1.4% body weight
                   from
                    
                      JCI 36:289-296, 1957.
                    
                   Data suggests a 1L oral load is nearly all absorbed in
                   1 Hr.  Average rate would be 17 mL/Hr with a peak rate
                   of about 30.
                    
                      Baldes & Smirk. J.Physiol. 82:62,1934.
                    
                   Osmolar gradient is assumed to be 0.200 mOsm/mL.
                    
                      Rate = Perm * Grad
                      30 = Perm * 0.200
                      Perm = 150
                    
                   Temperature ===================================
                    
                   Typical lumen heat content is 155 kCal.
                    
                   Specific heat (SH) of H2O is 0.001 (kCal/G)/DegK.
                    
                   To get temperature from heat
                    
                      DegK = 1000.0 * kCal/G (or mL)
                      DegC = DegK - 273.15
                      DegF = ( 9 / 5 ) * DegC + 32
                    
                   To get heat from temperature
                    
                      kCal = 0.001 * DegK * mL
                      kCal/Min = 0.001 * DegK * mL/Min
                   </PRE>
                   </HTML>
                   ", revisions = "<html>
                   <ul>
                   <li><i>  </i>
                          </li>
                   <li><i> january 2009 </i><br> 
                          by Marek Matejak in Modelica initially implemented (consulted with Jiri Kofranek), Charles University, Prague<br>
                          orginaly described by Tom Coleman in QHP 2008 beta 3, University of Mississippi Medical Center
                          </li>
                   </ul>
                   </html>"), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent = {{-100, -10}, {100, -26}}, lineColor = {0, 0, 255}, textString = "(initial %initialVolume ml)"), Rectangle(extent = {{-100, 100}, {100, -100}}, lineColor = {0, 0, 0}), Text(extent = {{-100, 120}, {100, 104}}, lineColor = {0, 0, 255}, textString = "%name")}));
      end GILumen;
    end WaterCompartments;

    package TissuesVolume
      "Division of intracellular and interstitial water into tissues"
      model Tissue
        "compute tissue size from global interstitial and cell H20 volume"
        //extends Library.Interfaces.BaseModel;
        parameter Real FractIFV;
        parameter Real FractOrganH2O;
        PhysiolibraryOld.Interfaces.RealInput_ InterstitialWater_Vol(final unit=
             "ml")
          annotation (Placement(transformation(extent={{-120,60},{-80,100}})));
        PhysiolibraryOld.Interfaces.RealInput_ CellH2O_Vol(final unit="ml")
          annotation (Placement(transformation(extent={{-120,20},{-80,60}})));
        PhysiolibraryOld.Interfaces.RealOutput_ LiquidVol(final unit="ml")
          "all tissue water volume" annotation (Placement(transformation(extent=
                 {{80,60},{120,100}}), iconTransformation(extent={{80,60},{120,
                  100}})));
        PhysiolibraryOld.Interfaces.RealOutput_ OrganH2O(final unit="ml")
          "tissue cells water volume" annotation (Placement(transformation(
                extent={{80,20},{120,60}}), iconTransformation(extent={{80,20},
                  {120,60}})));
        PhysiolibraryOld.Interfaces.RealOutput_ InterstitialWater(final unit=
              "ml") "tissue interstitial water volume" annotation (Placement(
              transformation(extent={{80,20},{120,60}}), iconTransformation(
                extent={{80,-20},{120,20}})));
      equation
        OrganH2O = FractOrganH2O * CellH2O_Vol;
        LiquidVol = FractIFV * InterstitialWater_Vol + OrganH2O;
        InterstitialWater = LiquidVol - OrganH2O;
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent = {{-72, 64}, {64, 96}}, lineColor = {0, 0, 0},
                  fillPattern =                                                                                                    FillPattern.VerticalCylinder, fillColor = {215, 215, 215}, textString = "IST .. %FractIFV"), Text(extent = {{-72, 26}, {64, 58}}, lineColor = {0, 0, 0},
                  fillPattern =                                                                                                    FillPattern.VerticalCylinder, fillColor = {215, 215, 215}, textString = "ICF .. %FractOrganH2O"), Text(extent = {{-98, -104}, {102, -120}}, lineColor = {0, 0, 255}, textString = "%name"), Rectangle(extent = {{-100, 100}, {100, -100}}, lineColor = {0, 0, 0})}));
      end Tissue;

      model Tissues
        import QHP = HumMod;
        extends PhysiolibraryOld.Icons.Tissues;
        SkeletalMuscle skeletalMuscle(FractIFV = 0.597041124206978, FractOrganH2O = 0.597041124206978) annotation(Placement(transformation(extent = {{-54, 62}, {-34, 82}})));
        Bone bone(FractIFV = 0.075535107692334, FractOrganH2O = 0.075535107692334) annotation(Placement(transformation(extent = {{-54, 36}, {-34, 56}})));
        Fat fat(FractIFV = 0.0686793125415955, FractOrganH2O = 0.0686793125415955) annotation(Placement(transformation(extent = {{-54, -54}, {-34, -34}})));
        Brain brain(FractIFV = 0.0213850278381526, FractOrganH2O = 0.0213850278381526) annotation(Placement(transformation(extent = {{52, 28}, {72, 48}})));
        QHP.Water.TissuesVolume.RightHeart rightHeart(FractIFV = 0.000711479063056408, FractOrganH2O = 0.000711479063056408) annotation(Placement(transformation(extent = {{52, -92}, {72, -72}})));
        RespiratoryMuscle respiratoryMuscle(FractIFV = 0.0671126519181567, FractOrganH2O = 0.0671126519181567) annotation(Placement(transformation(extent = {{-54, -24}, {-34, -4}})));
        OtherTissue otherTissue(FractIFV = 0.0670823116596042, FractOrganH2O = 0.0670823116596042) annotation(Placement(transformation(extent = {{-54, 8}, {-34, 28}})));
        Liver liver(FractIFV = 0.0284998184687167, FractOrganH2O = 0.0284998184687167) annotation(Placement(transformation(extent = {{52, 58}, {72, 78}})));
        QHP.Water.TissuesVolume.LeftHeart leftHeart(FractIFV = 0.00426887437833845, FractOrganH2O = 0.00426887437833845) annotation(Placement(transformation(extent = {{52, -62}, {72, -42}})));
        QHP.Water.TissuesVolume.Kidney kidney(FractIFV = 0.00471608978940247, FractOrganH2O = 0.00471608978940247) annotation(Placement(transformation(extent = {{52, -34}, {72, -14}})));
        QHP.Water.TissuesVolume.GITract gITract(FractIFV = 0.0234991370540916, FractOrganH2O = 0.0234991370540916) annotation(Placement(transformation(extent = {{52, -2}, {72, 18}})));
        PhysiolibraryOld.Interfaces.BusConnector busConnector
          annotation (Placement(transformation(extent={{-108,72},{-68,112}})));
        Skin skin(FractIFV = 0.0414690653895735, FractOrganH2O = 0.0414690653895735) annotation(Placement(transformation(extent = {{-54, -84}, {-34, -64}})));
        //Real ifv;
        //Real organ;
      equation
        connect(busConnector.InterstitialWater_Vol, bone.InterstitialWater_Vol) annotation(Line(points = {{-88, 92}, {-88, 54}, {-54, 54}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.InterstitialWater_Vol, brain.InterstitialWater_Vol) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 46}, {52, 46}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.InterstitialWater_Vol, fat.InterstitialWater_Vol) annotation(Line(points = {{-88, 92}, {-88, -36}, {-54, -36}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.InterstitialWater_Vol, gITract.InterstitialWater_Vol) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 16}, {52, 16}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.InterstitialWater_Vol, kidney.InterstitialWater_Vol) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -16}, {52, -16}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.InterstitialWater_Vol, leftHeart.InterstitialWater_Vol) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -44}, {52, -44}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.InterstitialWater_Vol, liver.InterstitialWater_Vol) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 76}, {52, 76}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.InterstitialWater_Vol, otherTissue.InterstitialWater_Vol) annotation(Line(points = {{-88, 92}, {-88, 26}, {-54, 26}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.InterstitialWater_Vol, respiratoryMuscle.InterstitialWater_Vol) annotation(Line(points = {{-88, 92}, {-88, -6}, {-54, -6}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.InterstitialWater_Vol, rightHeart.InterstitialWater_Vol) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -74}, {52, -74}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.InterstitialWater_Vol, skin.InterstitialWater_Vol) annotation(Line(points = {{-88, 92}, {-88, -66}, {-54, -66}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.InterstitialWater_Vol, skeletalMuscle.InterstitialWater_Vol) annotation(Line(points = {{-88, 92}, {-87.5, 92}, {-87.5, 80}, {-54, 80}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.CellH2O_Vol, bone.CellH2O_Vol) annotation(Line(points = {{-88, 92}, {-88, 50}, {-54, 50}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.CellH2O_Vol, brain.CellH2O_Vol) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 42}, {52, 42}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.CellH2O_Vol, fat.CellH2O_Vol) annotation(Line(points = {{-88, 92}, {-88, -40}, {-54, -40}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.CellH2O_Vol, gITract.CellH2O_Vol) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 12}, {52, 12}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.CellH2O_Vol, kidney.CellH2O_Vol) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -20}, {52, -20}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.CellH2O_Vol, leftHeart.CellH2O_Vol) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -48}, {52, -48}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.CellH2O_Vol, liver.CellH2O_Vol) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 72}, {52, 72}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.CellH2O_Vol, otherTissue.CellH2O_Vol) annotation(Line(points = {{-88, 92}, {-88, 22}, {-54, 22}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.CellH2O_Vol, respiratoryMuscle.CellH2O_Vol) annotation(Line(points = {{-88, 92}, {-88, -10}, {-54, -10}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.CellH2O_Vol, rightHeart.CellH2O_Vol) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -78}, {52, -78}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.CellH2O_Vol, skin.CellH2O_Vol) annotation(Line(points = {{-88, 92}, {-88, -70}, {-54, -70}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.CellH2O_Vol, skeletalMuscle.CellH2O_Vol) annotation(Line(points = {{-88, 92}, {-87.5, 92}, {-87.5, 76}, {-54, 76}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(bone.LiquidVol, busConnector.bone_LiquidVol) annotation(Line(points = {{-34, 54}, {6, 54}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(brain.LiquidVol, busConnector.brain_LiquidVol) annotation(Line(points = {{72, 46}, {98, 46}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(fat.LiquidVol, busConnector.fat_LiquidVol) annotation(Line(points = {{-34, -36}, {6, -36}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(gITract.LiquidVol, busConnector.GITract_LiquidVol) annotation(Line(points = {{72, 16}, {98, 16}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(kidney.LiquidVol, busConnector.kidney_LiquidVol) annotation(Line(points = {{72, -16}, {98, -16}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(leftHeart.LiquidVol, busConnector.leftHeart_LiquidVol) annotation(Line(points = {{72, -44}, {98, -44}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(liver.LiquidVol, busConnector.liver_LiquidVol) annotation(Line(points = {{72, 76}, {98, 76}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(otherTissue.LiquidVol, busConnector.otherTissue_LiquidVol) annotation(Line(points = {{-34, 26}, {6, 26}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(respiratoryMuscle.LiquidVol, busConnector.respiratoryMuscle_LiquidVol) annotation(Line(points = {{-34, -6}, {6, -6}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(rightHeart.LiquidVol, busConnector.rightHeart_LiquidVol) annotation(Line(points = {{72, -74}, {98, -74}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(skin.LiquidVol, busConnector.skin_LiquidVol) annotation(Line(points = {{-34, -66}, {6, -66}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(skeletalMuscle.LiquidVol, busConnector.skeletalMuscle_LiquidVol) annotation(Line(points = {{-34, 80}, {5.5, 80}, {5.5, 92}, {-88, 92}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(bone.LiquidVol, busConnector.Bone_LiquidVol) annotation(Line(points = {{-34, 54}, {6, 54}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(brain.LiquidVol, busConnector.Brain_LiquidVol) annotation(Line(points = {{72, 46}, {98, 46}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(fat.LiquidVol, busConnector.Fat_LiquidVol) annotation(Line(points = {{-34, -36}, {6, -36}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(kidney.LiquidVol, busConnector.Kidney_LiquidVol) annotation(Line(points = {{72, -16}, {98, -16}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(leftHeart.LiquidVol, busConnector.LeftHeart_LiquidVol) annotation(Line(points = {{72, -44}, {98, -44}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(liver.LiquidVol, busConnector.Liver_LiquidVol) annotation(Line(points = {{72, 76}, {98, 76}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(otherTissue.LiquidVol, busConnector.OtherTissue_LiquidVol) annotation(Line(points = {{-34, 26}, {6, 26}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(respiratoryMuscle.LiquidVol, busConnector.RespiratoryMuscle_LiquidVol) annotation(Line(points = {{-34, -6}, {6, -6}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(rightHeart.LiquidVol, busConnector.RightHeart_LiquidVol) annotation(Line(points = {{72, -74}, {98, -74}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(skin.LiquidVol, busConnector.Skin_LiquidVol) annotation(Line(points = {{-34, -66}, {6, -66}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(skeletalMuscle.LiquidVol, busConnector.SkeletalMuscle_LiquidVol) annotation(Line(points = {{-34, 80}, {5.5, 80}, {5.5, 92}, {-88, 92}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(bone.OrganH2O, busConnector.bone_CellH2OVol) annotation(Line(points = {{-34, 50}, {6, 50}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(brain.OrganH2O, busConnector.brain_CellH2OVol) annotation(Line(points = {{72, 42}, {98, 42}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(fat.OrganH2O, busConnector.fat_CellH2OVol) annotation(Line(points = {{-34, -40}, {6, -40}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(gITract.OrganH2O, busConnector.GITract_CellH2OVol) annotation(Line(points = {{72, 12}, {98, 12}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(kidney.OrganH2O, busConnector.kidney_CellH2OVol) annotation(Line(points = {{72, -20}, {98, -20}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(leftHeart.OrganH2O, busConnector.leftHeart_CellH2OVol) annotation(Line(points = {{72, -48}, {98, -48}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(liver.OrganH2O, busConnector.liver_CellH2OVol) annotation(Line(points = {{72, 72}, {98, 72}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(otherTissue.OrganH2O, busConnector.otherTissue_CellH2OVol) annotation(Line(points = {{-34, 22}, {6, 22}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(respiratoryMuscle.OrganH2O, busConnector.respiratoryMuscle_CellH2OVol) annotation(Line(points = {{-34, -10}, {6, -10}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(rightHeart.OrganH2O, busConnector.rightHeart_CellH2OVol) annotation(Line(points = {{72, -78}, {98, -78}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(skin.OrganH2O, busConnector.skin_CellH2OVol) annotation(Line(points = {{-34, -70}, {6, -70}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(skeletalMuscle.OrganH2O, busConnector.skeletalMuscle_CellH2OVol) annotation(Line(points = {{-34, 76}, {5.5, 76}, {5.5, 92}, {-88, 92}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(bone.InterstitialWater, busConnector.bone_InterstitialWater) annotation(Line(points = {{-34, 46}, {6, 46}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(brain.InterstitialWater, busConnector.brain_InterstitialWater) annotation(Line(points = {{72, 38}, {98, 38}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(fat.InterstitialWater, busConnector.fat_InterstitialWater) annotation(Line(points = {{-34, -44}, {6, -44}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(gITract.InterstitialWater, busConnector.GITract_InterstitialWater) annotation(Line(points = {{72, 8}, {98, 8}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(kidney.InterstitialWater, busConnector.kidney_InterstitialWater) annotation(Line(points = {{72, -24}, {98, -24}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(leftHeart.InterstitialWater, busConnector.leftHeart_InterstitialWater) annotation(Line(points = {{72, -52}, {98, -52}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(liver.InterstitialWater, busConnector.liver_InterstitialWater) annotation(Line(points = {{72, 68}, {98, 68}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(otherTissue.InterstitialWater, busConnector.otherTissue_InterstitialWater) annotation(Line(points = {{-34, 18}, {6, 18}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(respiratoryMuscle.InterstitialWater, busConnector.respiratoryMuscle_InterstitialWater) annotation(Line(points = {{-34, -14}, {6, -14}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(rightHeart.InterstitialWater, busConnector.rightHeart_InterstitialWater) annotation(Line(points = {{72, -82}, {98, -82}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(skin.InterstitialWater, busConnector.skin_InterstitialWater) annotation(Line(points = {{-34, -74}, {6, -74}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(skeletalMuscle.InterstitialWater, busConnector.skeletalMuscle_InterstitialWater) annotation(Line(points = {{-34, 72}, {5.5, 72}, {5.5, 92}, {-88, 92}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        //ifv=bone.FractIFV +brain.FractIFV +fat.FractIFV +GITract.FractIFV +kidney.FractIFV +leftHeart.FractIFV +liver.FractIFV +otherTissue.FractIFV +respiratoryMuscle.FractIFV +rightHeart.FractIFV +skin.FractIFV +skeletalMuscle.FractIFV;
        //organ=bone.FractOrganH2O +brain.FractOrganH2O +fat.FractOrganH2O +GITract.FractOrganH2O +kidney.FractOrganH2O +leftHeart.FractOrganH2O +liver.FractOrganH2O +otherTissue.FractOrganH2O +respiratoryMuscle.FractOrganH2O +rightHeart.FractOrganH2O +skin.FractOrganH2O +skeletalMuscle.FractOrganH2O;
        /*
                                                                                                                                                         assert(bone.FractIFV +
                                                                                                                                                        brain.FractIFV +
                                                                                                                                                        fat.FractIFV +
                                                                                                                                                        GITract.FractIFV +
                                                                                                                                                        kidney.FractIFV +
                                                                                                                                                        leftHeart.FractIFV +
                                                                                                                                                        liver.FractIFV +
                                                                                                                                                        otherTissue.FractIFV +
                                                                                                                                                        respiratoryMuscle.FractIFV +
                                                                                                                                                        rightHeart.FractIFV +
                                                                                                                                                        skin.FractIFV +
                                                                                                                                                        skeletalMuscle.FractIFV <> 1, "Water.TissuesVolume.Tissues: Sum of FractIFV is not 1!");
                                                                                                                                                         assert(bone.FractOrganH2O +
                                                                                                                                                        brain.FractOrganH2O +
                                                                                                                                                        fat.FractOrganH2O +
                                                                                                                                                        GITract.FractOrganH2O +
                                                                                                                                                        kidney.FractOrganH2O +
                                                                                                                                                        leftHeart.FractOrganH2O +
                                                                                                                                                        liver.FractOrganH2O +
                                                                                                                                                        otherTissue.FractOrganH2O +
                                                                                                                                                        respiratoryMuscle.FractOrganH2O +
                                                                                                                                                        rightHeart.FractOrganH2O +
                                                                                                                                                        skin.FractOrganH2O +
                                                                                                                                                        skeletalMuscle.FractOrganH2O <> 1, "Water.TissuesVolume.Tissues: Sum of FractOrganH20 is not 1!");
                                                                                                                                                        */
        annotation(Icon(graphics={  Text(extent = {{-100, -104}, {100, -120}}, lineColor = {0, 0, 255}, textString = "%name")}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
      end Tissues;

      model SkeletalMuscle
        extends PhysiolibraryOld.Icons.SkeletalMuscle;
        extends Tissue;
      end SkeletalMuscle;

      model Bone
        extends PhysiolibraryOld.Icons.Bone;
        extends Tissue;
      end Bone;

      model OtherTissue
        extends PhysiolibraryOld.Icons.OtherTissue;
        extends Tissue;
      end OtherTissue;

      model RespiratoryMuscle
        extends PhysiolibraryOld.Icons.RespiratoryMuscle;
        extends Tissue;
      end RespiratoryMuscle;

      model Fat
        extends PhysiolibraryOld.Icons.Fat;
        extends Tissue;
      end Fat;

      model Skin
        extends PhysiolibraryOld.Icons.Skin;
        extends Tissue;
      end Skin;

      model Liver
        extends PhysiolibraryOld.Icons.Liver;
        extends Tissue;
      end Liver;

      model Brain
        extends PhysiolibraryOld.Icons.Brain;
        extends Tissue;
      end Brain;

      model GITract
        extends PhysiolibraryOld.Icons.GITract;
        extends Tissue;
      end GITract;

      model Kidney
        extends PhysiolibraryOld.Icons.Kidney;
        extends Tissue;
      end Kidney;

      model LeftHeart
        extends PhysiolibraryOld.Icons.LeftHeart;
        extends Tissue;
        annotation(Diagram(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics));
      end LeftHeart;

      model RightHeart
        extends PhysiolibraryOld.Icons.RightHeart;
        extends Tissue;
      end RightHeart;
    end TissuesVolume;

    model WaterProperties
      extends PhysiolibraryOld.Icons.Water;
      Osmoles.OsmBody osmBody(ECFV(start = 14600)) "intra/extracellular water" annotation(Placement(transformation(extent = {{-84, -22}, {-64, -2}})));
      Hydrostatics.Hydrostatics hydrostatics annotation(Placement(transformation(extent = {{-62, 62}, {-38, 86}})));
      Modelica.Blocks.Math.Feedback sub annotation(Placement(transformation(extent = {{-4, 4}, {4, -4}}, rotation = 90, origin = {-34, 4})));
      PhysiolibraryOld.Blocks.Parts CellH2O(nout=3, w={0.2,0.5,0.3})
        annotation (Placement(transformation(extent={{-28,22},{-16,34}})));
      Modelica.Blocks.Math.Sum BodyH2O1(nin = 6) annotation(Placement(transformation(extent = {{74, -42}, {66, -34}})));
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{-12,34},{0,46}}),
            iconTransformation(extent={{-118,62},{-80,100}})));
      TissuesVolume.Tissues tissues annotation(Placement(transformation(extent = {{-94, -96}, {-74, -76}})));
      Modelica.Blocks.Math.Sum InterstitialWater(nin = 3) annotation(Placement(transformation(extent = {{4, -4}, {-4, 4}}, rotation = 180, origin = {48, 54})));
      Modelica.Blocks.Math.Sum ExternalH2O(nin = 3) annotation(Placement(transformation(extent = {{4, -4}, {-4, 4}}, rotation = 180, origin = {54, 26})));
      Modelica.Blocks.Math.Sum IntravascularVol(nin = 2) annotation(Placement(transformation(extent = {{4, -4}, {-4, 4}}, rotation = 180, origin = {74, -8})));
      Modelica.Blocks.Math.Sum ExtravascularVol(nin = 3) annotation(Placement(transformation(extent = {{4, -4}, {-4, 4}}, rotation = 180, origin = {74, 8})));
      Modelica.Blocks.Math.Sum BodyH2O(nin = 2) annotation(Placement(transformation(extent = {{60, -30}, {52, -22}})));
      Modelica.Blocks.Math.Sum BodyH2O_Gain(nin = 4) annotation(Placement(transformation(extent = {{28, -66}, {44, -50}})));
      Modelica.Blocks.Math.Feedback BodyH2O_Change annotation(Placement(transformation(extent = {{62, -74}, {82, -54}})));
      Modelica.Blocks.Math.Sum BodyH2O_Loss(nin = 8) annotation(Placement(transformation(extent = {{38, -96}, {54, -80}})));
      Modelica.Blocks.Math.Sum sweatDuct(nin = 3) annotation(Placement(transformation(extent = {{14, 75}, {30, 91}})));
      Modelica.Blocks.Math.Sum insensibleSkin(nin = 3) annotation(Placement(transformation(extent = {{72, 68}, {88, 84}})));
    equation
      connect(hydrostatics.RegionalPressure_UpperCapy, busConnector.RegionalPressure_UpperCapy) annotation(Line(points = {{-38, 77.59999999999999}, {-6, 77.59999999999999}, {-6, 40}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(hydrostatics.RegionalPressure_MiddleCapy, busConnector.RegionalPressure_MiddleCapy) annotation(Line(points = {{-38, 72.8}, {-6, 72.8}, {-6, 40}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(hydrostatics.RegionalPressure_LowerCapy, busConnector.RegionalPressure_LowerCapy) annotation(Line(points = {{-38, 68}, {-6, 68}, {-6, 40}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(osmBody.ICFV, sub.u1) annotation(Line(points = {{-63.6, -4}, {-34, -4}, {-34, 0.8}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(sub.y, CellH2O.u) annotation(Line(points = {{-34, 7.6}, {-34, 28}, {-29.2, 28}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(CellH2O.y[1], busConnector.UT_Cell_H2O) annotation(Line(points = {{-15.4, 27.6}, {-12, 24}, {-6, 24}, {-6, 40}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(CellH2O.y[2], busConnector.MT_Cell_H2O) annotation(Line(points = {{-15.4, 28}, {-6, 28}, {-6, 40}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(CellH2O.y[3], busConnector.LT_Cell_H2O) annotation(Line(points = {{-15.4, 28.4}, {-12, 32}, {-6, 32}, {-6, 40}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(BodyH2O1.y, osmBody.BodyH2O_Vol) annotation(Line(points = {{65.59999999999999, -38}, {-96, -38}, {-96, -22}, {-82.8, -22}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(osmBody.OsmBody_Osm_conc_CellWalls, busConnector.OsmBody_Osm_conc_CellWalls) annotation(Line(points = {{-63.6, -16}, {-6, -16}, {-6, 40}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.Status_Posture, hydrostatics.Status_Posture) annotation(Line(points = {{-6, 40}, {-86, 40}, {-86, 83.59999999999999}, {-60.8, 83.59999999999999}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.SystemicArtys_Pressure, hydrostatics.SystemicArtys_Pressure) annotation(Line(points = {{-6, 40}, {-86, 40}, {-86, 71.59999999999999}, {-60.8, 71.59999999999999}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.RightAtrium_Pressure, hydrostatics.RightAtrium_Pressure) annotation(Line(points = {{-6, 40}, {-86, 40}, {-86, 76.40000000000001}, {-60.8, 76.40000000000001}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.LegMusclePump_Effect, hydrostatics.LegMusclePump_Effect) annotation(Line(points = {{-6, 40}, {-86, 40}, {-86, 64.40000000000001}, {-60.8, 64.40000000000001}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.OsmECFV_Electrolytes, osmBody.OsmECFV_Electrolytes) annotation(Line(points = {{-6, 40}, {-86, 40}, {-86, -2}, {-82.8, -2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.OsmCell_Electrolytes, osmBody.OsmCell_Electrolytes) annotation(Line(points = {{-6, 40}, {-86, 40}, {-86, -6}, {-82.8, -6}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.RBCH2O_Vol, sub.u2) annotation(Line(points = {{-6, 40}, {-86, 40}, {-86, 4}, {-37.2, 4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector, tissues.busConnector) annotation(Line(points = {{-6, 40}, {-6, -40}, {-92.8, -40}, {-92.8, -76.8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(sub.y, busConnector.CellH2O_Vol) annotation(Line(points = {{-34, 7.6}, {-34, 40}, {-6, 40}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(InterstitialWater.y, busConnector.InterstitialWater_Vol) annotation(Line(points = {{52.4, 54}, {100, 54}, {100, 40}, {-6, 40}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(osmBody.ECFV, busConnector.ECFV_Vol) annotation(Line(points = {{-63.6, -10}, {-6, -10}, {-6, 40}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(BodyH2O1.y, busConnector.BodyH2O_Vol) annotation(Line(points = {{65.59999999999999, -38}, {-6, -38}, {-6, 40}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(osmBody.ICFV, busConnector.ICFV_Vol) annotation(Line(points = {{-63.6, -4}, {-6, -4}, {-6, 40}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(osmBody.Osmoreceptors, busConnector.Osmreceptors) annotation(Line(points = {{-63.6, -20}, {-6, -20}, {-6, 40}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(busConnector.UreaECF_Osmoles, osmBody.UreaECF) annotation(Line(points = {{-6, 40}, {-86, 40}, {-86, -10}, {-82.8, -10}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.UreaICF_Osmoles, osmBody.UreaICF) annotation(Line(points = {{-6, 40}, {-86, 40}, {-86, -14}, {-82.8, -14}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.GlucoseECF_Osmoles, osmBody.GlucoseECF) annotation(Line(points = {{-6, 40}, {-86, 40}, {-86, -18}, {-82.8, -18}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.PlasmaVol, BodyH2O1.u[1]) annotation(Line(points={{-6,40},
              {100,40},{100,-38},{74.8,-38},{74.8,-38.6667}},                                                                                   color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.LT_H2O_Vol, BodyH2O1.u[2]) annotation(Line(points = {{-6, 40}, {100, 40}, {100, -38.4}, {74.8, -38.4}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.MT_H2O_Vol, BodyH2O1.u[3]) annotation(Line(points={{-6,40},
              {100,40},{100,-38.1333},{74.8,-38.1333}},                                                                                  color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.UT_H2O_Vol, BodyH2O1.u[4]) annotation(Line(points={{-6,40},
              {100,40},{100,-37.8667},{74.8,-37.8667}},                                                                                  color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.RBCH2O_Vol, BodyH2O1.u[5]) annotation(Line(points = {{-6, 40}, {88, 40}, {88, -37.6}, {74.8, -37.6}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(ExternalH2O.y, BodyH2O1.u[6]) annotation(Line(points={{58.4,26},{
              100,26},{100,-37.3333},{74.8,-37.3333}},                                                                           color = {0, 0, 127}, smooth = Smooth.None));
      /*  connect(busConnector.ExcessLungWater_Volume, BodyH2O.u[6]) annotation (Line(
                                                                                                                        points={{-6,40},{88,40},{88,-25.5429},{32.8,-25.5429}},
                                                                                                                        color={0,0,255},
                                                                                                                        thickness=0.5,
                                                                                                                        smooth=Smooth.None));
                                                                                                                    connect(busConnector.PeritoneumSpace_Vol, BodyH2O.u[7]) annotation (Line(
                                                                                                                        points={{-6,40},{88,40},{88,-25.3143},{32.8,-25.3143}},
                                                                                                                        color={0,0,255},
                                                                                                                        thickness=0.5,
                                                                                                                        smooth=Smooth.None));
                                                                                                                  */
      connect(busConnector.UT_InterstitialWater_Vol, InterstitialWater.u[1]) annotation(Line(points={{-6,40},
              {14,40},{14,54.5333},{43.2,54.5333}},                                                                                                    color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.MT_InterstitialWater_Vol, InterstitialWater.u[2]) annotation(Line(points = {{-6, 40}, {14, 40}, {14, 54}, {43.2, 54}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(busConnector.LT_InterstitialWater_Vol, InterstitialWater.u[3]) annotation(Line(points={{-6,40},
              {14,40},{14,53.4667},{43.2,53.4667}},                                                                                                    color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(busConnector.ExcessLungWater_Volume, ExternalH2O.u[1]) annotation(Line(points={{-6,40},
              {14,40},{14,30},{44,30},{44,26.5333},{49.2,26.5333}},                                                                                                    color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 6}, {-6, 6}}));
      connect(busConnector.GILumenVolume_Mass, ExternalH2O.u[2]) annotation(Line(points = {{-6, 40}, {14, 40}, {14, 26}, {49.2, 26}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 2}, {-6, 2}}));
      connect(busConnector.PeritoneumSpace_Vol, ExternalH2O.u[3]) annotation(Line(points={{-6,40},
              {14,40},{14,20},{44,20},{44,25.4667},{49.2,25.4667}},                                                                                                  color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, -3}, {-6, -3}}));
      connect(busConnector.PlasmaVol, IntravascularVol.u[1]) annotation(Line(points = {{-6, 40}, {14, 40}, {14, -6}, {66, -6}, {66, -7.6}, {69.2, -7.6}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.RBCH2O_Vol, IntravascularVol.u[2]) annotation(Line(points = {{-6, 40}, {14, 40}, {14, -12}, {66, -12}, {66, -8.4}, {69.2, -8.4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, -2}, {-6, -2}}));
      connect(ExternalH2O.y, ExtravascularVol.u[1]) annotation(Line(points={{58.4,26},
              {66,26},{66,8.53333},{69.2,8.53333}},                                                                                                    color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.CellH2O_Vol, ExtravascularVol.u[2]) annotation(Line(points = {{-6, 40}, {14, 40}, {14, 10}, {66, 10}, {66, 8}, {69.2, 8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.InterstitialWater_Vol, ExtravascularVol.u[3]) annotation(Line(points={{-6,40},
              {14,40},{14,4},{66,4},{66,7.46667},{69.2,7.46667}},                                                                                                    color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, -2}, {-6, -2}}));
      connect(ExtravascularVol.y, BodyH2O.u[1]) annotation(Line(points = {{78.40000000000001, 8}, {84, 8}, {84, -26.4}, {60.8, -26.4}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(IntravascularVol.y, BodyH2O.u[2]) annotation(Line(points = {{78.40000000000001, -8}, {82, -8}, {82, -25.6}, {60.8, -25.6}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(BodyH2O_Gain.y, BodyH2O_Change.u1) annotation(Line(points = {{44.8, -58}, {54, -58}, {54, -64}, {64, -64}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(BodyH2O_Loss.y, BodyH2O_Change.u2) annotation(Line(points = {{54.8, -88}, {72, -88}, {72, -72}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.GILumenVolume_Intake, BodyH2O_Gain.u[1]) annotation(Line(points = {{-6, 40}, {-6, -56}, {26, -56}, {26, -59.2}, {26.4, -59.2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 5}, {-6, 5}}));
      connect(busConnector.MetabolicH2O_Rate, BodyH2O_Gain.u[2]) annotation(Line(points = {{-6, 40}, {-6, -58}, {28, -58}, {28, -58.4}, {26.4, -58.4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 2}, {-6, 2}}));
      connect(busConnector.IVDrip_H2ORate, BodyH2O_Gain.u[3]) annotation(Line(points = {{-6, 40}, {-6, -60}, {26, -60}, {26, -57.6}, {26.4, -57.6}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, -1}, {-6, -1}}));
      connect(busConnector.Transfusion_H2ORate, BodyH2O_Gain.u[4]) annotation(Line(points = {{-6, 40}, {-6, -62}, {26, -62}, {26, -56.8}, {26.4, -56.8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, -4}, {-6, -4}}));
      connect(busConnector.CD_H2O_Outflow, BodyH2O_Loss.u[1]) annotation(Line(points = {{-6, 40}, {-6, -79}, {36.4, -79}, {36.4, -89.40000000000001}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 12}, {-6, 12}}));
      connect(busConnector.SweatDuct_H2OOutflow, BodyH2O_Loss.u[2]) annotation(Line(points = {{-6, 40}, {-6, -82}, {36, -82}, {36.4, -89}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 9}, {-6, 9}}));
      connect(busConnector.Hemorrhage_H2ORate, BodyH2O_Loss.u[3]) annotation(Line(points = {{-6, 40}, {-6, -84}, {36.4, -84}, {36.4, -88.59999999999999}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 6}, {-6, 6}}));
      connect(busConnector.DialyzerActivity_UltrafiltrationRate, BodyH2O_Loss.u[4]) annotation(Line(points = {{-6, 40}, {-6, -87}, {36.4, -87}, {36.4, -88.2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.HeatInsensibleSkin_H2O, BodyH2O_Loss.u[5]) annotation(Line(points = {{-6, 40}, {-6, -89}, {36.4, -89}, {36.4, -87.8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 0}, {-6, 0}}));
      connect(busConnector.HeatInsensibleLung_H2O, BodyH2O_Loss.u[6]) annotation(Line(points = {{-6, 40}, {-6, -92}, {36.4, -92}, {36.4, -87.40000000000001}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, -3}, {-6, -3}}));
      connect(busConnector.GILumenVomitus_H2OLoss, BodyH2O_Loss.u[7]) annotation(Line(points = {{-6, 40}, {-6, -94}, {36.4, -94}, {36.4, -87}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, -6}, {-6, -6}}));
      connect(busConnector.GILumenDiarrhea_H2OLoss, BodyH2O_Loss.u[8]) annotation(Line(points = {{-6, 40}, {-6, -97}, {36.4, -97}, {36.4, -86.59999999999999}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, -9}, {-6, -9}}));
      connect(busConnector.UT_Sweat_H2OOutflow, sweatDuct.u[1]) annotation(Line(points={{-6,40},
              {-6,82},{12.4,82},{12.4,81.9333}},                                                                                            color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.MT_Sweat_H2OOutflow, sweatDuct.u[2]) annotation(Line(points = {{-6, 40}, {-6, 83}, {12.4, 83}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.LT_Sweat_H2OOutflow, sweatDuct.u[3]) annotation(Line(points={{-6,40},
              {-6,84.0667},{12.4,84.0667}},                                                                                          color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(insensibleSkin.y, busConnector.HeatInsensibleSkin_H2O) annotation(Line(points = {{88.8, 76}, {92, 76}, {92, 63}, {0, 63}, {0, 40}, {-6, 40}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(busConnector.UT_InsensibleSkin_H2O, insensibleSkin.u[1]) annotation(Line(points={{-6,40},
              {-6,66},{60,66},{60,74.9333},{70.4,74.9333}},                                                                                                    color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.MT_InsensibleSkin_H2O, insensibleSkin.u[2]) annotation(Line(points = {{-6, 40}, {-6, 67}, {60, 67}, {60, 76}, {70.40000000000001, 76}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.LT_InsensibleSkin_H2O, insensibleSkin.u[3]) annotation(Line(points={{-6,40},
              {-6,68},{60,68},{60,77.0667},{70.4,77.0667}},                                                                                                    color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(sweatDuct.y, busConnector.SweatGland_H2ORate) annotation(Line(points = {{30.8, 83}, {100, 83}, {100, 40}, {-6, 40}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      annotation(Diagram(coordinateSystem(preserveAspectRatio=false,   extent={{-100,
                -100},{100,100}},                                                                           grid = {2, 1}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}, grid = {2, 1}), graphics={  Text(extent = {{-110, -103}, {132, -137}}, lineColor = {0, 0, 255}, textString = "%name")}), Documentation(revisions = "<html>
                   <table cellspacing=\"2\" cellpadding=\"0\" border=\"0\"><tr>
                   <td><p>Author:</p></td>
                   <td><p>Marek Matejak</p></td>
                   </tr>
                   <tr>
                   <td><p>Design:</p></td>
                   <td><p>Zuzana Rubaninska</p></td>
                   </tr>
                   <tr>
                   <td><p>Copyright:</p></td>
                   <td><p>In public domains</p></td>
                   </tr>
                   <tr>
                   <td><p>By:</p></td>
                   <td><p>Charles University, Prague</p></td>
                   </tr>
                   <tr>
                   <td><p>Date of:</p></td>
                   <td><p>2009</p></td>
                   </tr>
                   <tr>
                   <td><p>References:</p></td>
                   <td><p>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</p></td>
                   </tr>
                   </table>
                   </html>", info = "<html>
                   <p>Distribution of H2O in whole body:</p>
                   <p><ul>
                   <li>blood plasma</li>
                   <li>erythrocytes</li>
                   <li>upper torso interstitium</li>
                   <li>midle torso interstitium</li>
                   <li>lower torso interstitium</li>
                   <li>intracellular water (constant fraction coeficient in different tissues(torsos))</li>
                   </ul></p>
                   <p><br/>Water redistribution flows:</p>
                   <p><ul>
                   <li>semipermeable capilary walls (plasma - GIT/interstitium/glomerulus filtrate)</li>
                   <li>lymph from upper/lower/midle torso</li>
                   <li>kidney nephron filtration/reabsorbtion</li>
                   </ul></p>
                   <p><br/>driving by hydraulic, hydrostatic and coloid osmotic pressures.</p>
                   </html>"));
    end WaterProperties;

    package Skin
      model SweatGland
        extends PhysiolibraryOld.Icons.SweatGland;
        parameter Real bodyPart = 1 / 3;
        PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
            Placement(transformation(extent={{-100,81},{-80,101}}),
              iconTransformation(extent={{60,60},{80,80}})));
        PhysiolibraryOld.Semipermeable.NegativeOsmoticFlow q_out annotation (
            Placement(transformation(extent={{-48,-44},{-30,-28}}),
              iconTransformation(extent={{-90,-50},{-70,-30}})));
        PhysiolibraryOld.Semipermeable.OutputPump sweat
          annotation (Placement(transformation(extent={{-62,-46},{-82,-26}})));
        PhysiolibraryOld.Blocks.Constant fractConstant(k=bodyPart)
          annotation (Placement(transformation(extent={{-94,-4},{-68,22}})));
        PhysiolibraryOld.Factors.SimpleMultiply BodyPart
          annotation (Placement(transformation(extent={{-44,18},{-24,38}})));
      equation
        connect(sweat.q_in, q_out) annotation(Line(points = {{-66, -36}, {-39, -36}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(busConnector.SweatDuct_H2OOutflow, BodyPart.yBase) annotation(Line(points = {{-90, 91}, {-34, 91}, {-34, 30}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(fractConstant.y, BodyPart.u) annotation(Line(points = {{-66.7, 9}, {-53.35, 9}, {-53.35, 28}, {-43.8, 28}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(BodyPart.y, sweat.desiredFlow) annotation(Line(points = {{-34, 26}, {-36, 26}, {-36, -20}, {-72, -20}, {-72, -32}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent = {{-137, -103}, {144, -128}}, lineColor = {0, 0, 255}, textString = "%name")}));
      end SweatGland;

      model InsensibleSkin
        extends PhysiolibraryOld.Icons.Skin;
        parameter Real bodyPart = 1 / 3;
        PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
            Placement(transformation(extent={{-100,81},{-80,101}}),
              iconTransformation(extent={{60,60},{80,80}})));
        PhysiolibraryOld.Blocks.FlowConstant H2OReab1(k=0.37*bodyPart)
          annotation (Placement(transformation(extent={{-48,-64},{-40,-56}})));
        PhysiolibraryOld.Semipermeable.NegativeOsmoticFlow q_out annotation (
            Placement(transformation(extent={{-48,-44},{-30,-28}}),
              iconTransformation(extent={{-90,-50},{-70,-30}})));
        PhysiolibraryOld.Semipermeable.OutputPump vapor
          annotation (Placement(transformation(extent={{6,-92},{26,-72}})));
      equation
        connect(vapor.q_in, q_out) annotation(Line(points = {{10, -82}, {4, -82}, {4, -36}, {-39, -36}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
        connect(H2OReab1.y, vapor.desiredFlow) annotation(Line(points = {{-39.6, -60}, {16, -60}, {16, -78}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent = {{-155, -83}, {126, -108}}, lineColor = {0, 0, 255}, textString = "%name")}));
      end InsensibleSkin;
    end Skin;

    model InsensibleLungs
      extends PhysiolibraryOld.Icons.Lungs;
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{-84,67},{-64,87}}),
            iconTransformation(extent={{60,60},{80,80}})));
      Modelica.Blocks.Math.Product product annotation(Placement(transformation(extent = {{-44, 34}, {-24, 54}})));
      Modelica.Blocks.Math.Feedback feedback annotation(Placement(transformation(extent = {{-44, 2}, {-24, 22}})));
      Modelica.Blocks.Math.Division division annotation(Placement(transformation(extent = {{28, -10}, {48, 10}})));
      Modelica.Blocks.Math.Product product1 annotation(Placement(transformation(extent = {{-10, 8}, {10, 28}})));
      PhysiolibraryOld.Blocks.PressureConstant pressureConstant(k=47)
        annotation (Placement(transformation(extent={{-66,10},{-58,18}})));
      PhysiolibraryOld.Blocks.Constant Constant(k=0.0008)
        annotation (Placement(transformation(extent={{-66,46},{-58,54}})));
      PhysiolibraryOld.Semipermeable.OutputPump vapor
        annotation (Placement(transformation(extent={{64,-36},{84,-16}})));
      PhysiolibraryOld.Semipermeable.NegativeOsmoticFlow q_out
        annotation (Placement(transformation(extent={{-36,-36},{-16,-16}})));
    equation
      connect(busConnector.BarometerPressure, division.u2) annotation(Line(points = {{-74, 77}, {-74, -6}, {26, -6}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(product1.y, division.u1) annotation(Line(points = {{11, 18}, {18, 18}, {18, 6}, {26, 6}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(feedback.y, product1.u2) annotation(Line(points = {{-25, 12}, {-12, 12}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(pressureConstant.y, feedback.u1) annotation(Line(points = {{-57.6, 14}, {-50, 14}, {-50, 12}, {-42, 12}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.EnvironmentRelativeHumidity, feedback.u2) annotation(Line(points = {{-74, 77}, {-74, 4}, {-34, 4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(product.y, product1.u1) annotation(Line(points = {{-23, 44}, {-18, 44}, {-18, 24}, {-12, 24}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.BreathingTotalVentilation, product.u2) annotation(Line(points = {{-74, 77}, {-74, 38}, {-46, 38}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(Constant.y, product.u1) annotation(Line(points = {{-57.6, 50}, {-46, 50}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(vapor.q_in, q_out) annotation(Line(points = {{68, -26}, {-26, -26}}, color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
      connect(division.y, vapor.desiredFlow) annotation(Line(points = {{49, 0}, {74, 0}, {74, -22}}, color = {0, 0, 127}, smooth = Smooth.None));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent = {{-153, -59}, {128, -84}}, lineColor = {0, 0, 255}, textString = "%name")}));
    end InsensibleLungs;

    model Water2
      import QHP = HumMod;
      extends PhysiolibraryOld.Icons.Water;
      //  extends HumMod.Library.Utilities.DynamicState(stateName="BodyH2O.Vol", initType=Library.Utilities.Init.NoInit, STEADY=false);
      //extends QHP.Library.Interfaces.BaseModel;
      QHP.Water.WaterCompartments.Plasma plasma annotation(Placement(transformation(extent={{-40,7},
                {-20,27}})));
      PhysiolibraryOld.Semipermeable.OutputPump Hemorrhage
        annotation (Placement(transformation(extent={{17,51},{33,67}})));
      PhysiolibraryOld.Semipermeable.InputPump Transfusion
        annotation (Placement(transformation(extent={{33,38},{17,54}})));
      PhysiolibraryOld.Semipermeable.InputPump IVDrip
        annotation (Placement(transformation(extent={{33,25},{17,41}})));
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{-106,81},{-86,101}}),
            iconTransformation(extent={{60,60},{80,80}})));
      QHP.Water.WaterCompartments.UT UpperTorso annotation(Placement(transformation(extent = {{30, -9}, {50, 11}})));
      QHP.Water.WaterCompartments.MT MiddleTorso annotation(Placement(transformation(extent = {{31, -50}, {51, -30}})));
      QHP.Water.WaterCompartments.LT LowerTorso annotation(Placement(transformation(extent = {{31, -93}, {51, -73}})));
      QHP.Water.WaterCompartments.GILumen2 GILumen annotation(Placement(transformation(extent = {{-67, 39}, {-47, 59}})));
      QHP.Water.WaterCompartments.Kidney.Kidney Kidney annotation(Placement(transformation(extent = {{-67, -40}, {-47, -20}})));
      HumMod.Water.WaterCompartments.test.Bladder_steady Bladder annotation(Placement(transformation(extent = {{-57, -67}, {-37, -47}})));
      QHP.Water.WaterProperties waterProperties annotation(Placement(transformation(extent = {{-83, -94}, {-63, -74}})));
      //  Real bodyH2O;
      /*initial equation 
                                                                                                                    if STEADY then
                                                                                                                       waterProperties.BodyH2O_Change.y = 0;
                                                                                                                    end if;
                                                                                                                  */
      //initial equation
      //   bodyH2O = waterProperties.BodyH2O.y;
      QHP.Hormones.ADH antidiureticHormone annotation(Placement(transformation(extent = {{-23, 66}, {-3, 86}})));
    equation
      //   changePerMin = waterProperties.BodyH2O_Change.y;
      //   stateValue = bodyH2O;
      connect(IVDrip.desiredFlow, busConnector.IVDrip_H2ORate) annotation(Line(points = {{25, 36.2}, {62, 36.2}, {62, 91}, {-96, 91}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(Transfusion.desiredFlow, busConnector.Transfusion_H2ORate) annotation(Line(points = {{25, 49.2}, {62, 49.2}, {62, 91}, {-96, 91}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(Hemorrhage.desiredFlow, busConnector.Hemorrhage_H2ORate) annotation(Line(points = {{25, 62.2}, {62, 62.2}, {62, 91}, {-96, 91}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(plasma.q_in, Hemorrhage.q_in) annotation(Line(points={{-34,19},{
              -34,46},{9,46},{9,59},{20.2,59}},                                                                            color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
      connect(plasma.q_in, Transfusion.q_out) annotation(Line(points={{-34,19},
              {-34,46},{20.2,46}},                                                                         color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
      connect(IVDrip.q_out, plasma.q_in) annotation(Line(points={{20.2,33},{9,
              33},{9,46},{-34,46},{-34,19}},                                                                            color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
      connect(Kidney.urine, Bladder.con) annotation(Line(points = {{-56.4, -36}, {-56.4, -57}, {-57, -57}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(busConnector, Kidney.busConnector) annotation(Line(points = {{-96, 91}, {-96, -30}, {-66.59999999999999, -30}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(busConnector, waterProperties.busConnector) annotation(Line(points = {{-96, 91}, {-96, -75}, {-82.90000000000001, -75}, {-82.90000000000001, -75.90000000000001}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(UpperTorso.busConnector, busConnector) annotation(Line(points = {{47, 8}, {97, 8}, {97, 91}, {-96, 91}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(MiddleTorso.busConnector, busConnector) annotation(Line(points = {{48, -33}, {97, -33}, {97, 91}, {-96, 91}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(LowerTorso.busConnector, busConnector) annotation(Line(points = {{48, -76}, {97, -76}, {97, 91}, {-96, 91}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(busConnector, GILumen.busConnector) annotation(Line(points = {{-96, 91}, {-96, 49}, {-66.59999999999999, 49}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(Bladder.busConnector, busConnector) annotation(Line(points = {{-56, -66}, {-96, -66}, {-96, 91}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(busConnector, plasma.busConnector) annotation(Line(points={{-96,91},
              {-96,25},{-38,25}},                                                                            color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(plasma.q_in, UpperTorso.vascularH2O) annotation(Line(points={{-34,19},
              {1,19},{1,5},{30,5}},                                                                                color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
      connect(plasma.q_in, MiddleTorso.vascularH2O) annotation(Line(points={{-34,19},
              {1,19},{1,-36},{31,-36}},                                                                                 color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
      connect(plasma.q_in, LowerTorso.vascularH2O) annotation(Line(points={{-34,19},
              {1,19},{1,-79},{31,-79}},                                                                                color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
      connect(plasma.q_in, Kidney.vascularH2O) annotation(Line(points={{-34,19},
              {-47,19},{-47,-21.6},{-55.4,-21.6}},                                                                            color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
      connect(GILumen.vascularH2O, plasma.q_in) annotation(Line(points={{-47,49},
              {-34,49},{-34,19}},                                                                           color = {127, 127, 0}, thickness = 1, smooth = Smooth.None));
      connect(antidiureticHormone.busConnector, busConnector) annotation(Line(points = {{-21, 70}, {-32, 70}, {-32, 91}, {-96, 91}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      annotation(Documentation(info = "<HTML>
                   <PRE>
                   QHP 2008 / H2O Reference
                    
                   Created : 26-Jun-06
                   Last Modified : 24-Mar-08
                   Author : Tom Coleman
                   Copyright : 2008-2008
                   By : University of Mississippi Medical Center
                   Solver : DES 2005
                   Schema : 2005.0
                    
                   There are several different ways to describe the body's
                   water compartments while implementing mass balance.
                    
                   Water compartments can initially be divided into two
                   basic types: intracellular (ICFV) and extracellular (ECFV).
                    
                   Intracellular compartments are red blood cells and
                   (all other) cells.
                    
                   Extracellular compartments are plasma and interstitium.
                    
                   Red Cells     =  1.6
                   Cells         = 26.4
                                   -----
                   ICFV          = 28.0
                    
                   Interstitium  = 12.0
                   Plasma        =  3.0
                                   -----
                   ECFV          = 15.0
                    
                   Total         = 43.0
                    
                   The problem with this scheme is that water cannot move
                   freely between plasma and interstitium but it can move
                   freely between interstitium and cell H2O.
                    
                   So, we'll divide the body's water compartments into
                   vascular and extravascular. The vascular compartment
                   is futher subdivided into RBC water and plasma.
                    
                   Red Cells     =  1.6
                   Plasma        =  3.0
                                    ---
                   Vascular      =  4.6
                    
                   Cells         = 26.4 (ICFV less RBC's H2O)
                   Interstitium  = 12.0
                                   ----
                   Extravascular = 38.4
                    
                   Total         = 43.0
                    
                   To relax the nomenclature a bit, extravascular water
                   is referred to as tissue H2O.
                    
                   This scheme is implemented using three integrals: plasma,
                   RBC and extravascular.
                    
                   Exchanges are internal and external.
                    
                   Internal exchanges are capillary
                   filtration and lymph flow.
                    
                   External exchanges are many: absorption
                   from gut, urine, IV drip, transfusion,
                   hemorrhage ...
                    
                   External exchanges influence the derivative
                   of either plasma or extravasular H2O.
                    
                   Traditional compartments are also
                   represented here.
                    
                   Red Cell H2O  =  1584
                   Organ H2O     = 26428
                                   -----
                   Cell H2O      = 28012
                    
                   IFV           = 11988
                   Plasma        =  3000
                                   -----
                   Extracellular = 14988
                    
                   Total         = 43000
                   </PRE>
                   </HTML>
                   ", revisions = "<html>
                   <ul>
                   <li><i>  </i>
                          </li>
                   <li><i> january 2009 </i><br> 
                          by Marek Matejak in Modelica initially implemented (consulted with Jiri Kofranek), Charles University, Prague<br>
                          orginaly described by Tom Coleman in QHP 2008 beta 3, University of Mississippi Medical Center
                          </li>
                   </ul>
                   </html>"), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}, grid = {1, 1}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}, grid = {1, 1}), graphics={  Text(extent = {{-139, -99}, {142, -124}}, lineColor = {0, 0, 255}, textString = "%name")}));
    end Water2;
    annotation(Diagram(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics={  Bitmap(extent=  {{-100, 100}, {100, -100}}, fileName=  "icons/golem.png")}), Documentation(revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr>
                   </table>
                   </html>"), Icon(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics));
  end Water;

  package Proteins "Body Proteins"
    extends PhysiolibraryOld.Icons.ProteinsLib;
    model Proteins
      extends PhysiolibraryOld.Icons.Proteins;
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{82,4},{102,24}}),
            iconTransformation(extent={{46,66},{80,100}})));
      PhysiolibraryOld.ConcentrationFlow.ResistorWithCondParam UT_Capillary(
          cond=0.22)
        annotation (Placement(transformation(extent={{-2,78},{10,90}})));
      PhysiolibraryOld.ConcentrationFlow.ResistorWithCondParam MT_Capillary(
          cond=0.44)
        annotation (Placement(transformation(extent={{-2,32},{10,44}})));
      PhysiolibraryOld.ConcentrationFlow.ResistorWithCondParam LT_Capillary(
          cond=0.71)
        annotation (Placement(transformation(extent={{0,-8},{12,4}})));
      PhysiolibraryOld.ConcentrationFlow.OutputPump Hemorrhage
        annotation (Placement(transformation(extent={{-14,-102},{6,-82}})));
      PhysiolibraryOld.ConcentrationFlow.InputPump Transfusion
        annotation (Placement(transformation(extent={{-36,-94},{-16,-74}})));
      PhysiolibraryOld.ConcentrationFlow.InputPump IVDrip
        annotation (Placement(transformation(extent={{-44,-76},{-24,-56}})));
      PhysiolibraryOld.ConcentrationFlow.SolventFlowPump UT_Lymph
        annotation (Placement(transformation(extent={{10,74},{0,64}})));
      PhysiolibraryOld.ConcentrationFlow.SolventFlowPump MT_Lymph
        annotation (Placement(transformation(extent={{10,28},{0,18}})));
      PhysiolibraryOld.ConcentrationFlow.SolventFlowPump LT_Lymph
        annotation (Placement(transformation(extent={{10,-12},{0,-22}})));
      PhysiolibraryOld.ConcentrationFlow.SolventFlowPump Change
        annotation (Placement(transformation(extent={{-44,-36},{-56,-24}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment plasma(
          initialSoluteMass=211.361, stateName="PlasmaProtein.Mass")
        annotation (Placement(transformation(extent={{-76,32},{-56,52}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment UpperTorso(
          initialSoluteMass=74.3639, stateName="UT_InterstitialProtein.Mass")
        annotation (Placement(transformation(extent={{42,64},{22,84}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment MiddleTorso(
          initialSoluteMass=148.686, stateName="MT_InterstitialProtein.Mass")
        annotation (Placement(transformation(extent={{42,18},{22,38}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment LowerTorso(
          initialSoluteMass=76.11499999999999, stateName=
            "LT_InterstitialProtein.Mass")
        annotation (Placement(transformation(extent={{42,-22},{22,-2}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment peritoneum(
        initialSoluteMass=0,
        stateName="PeritoneumProtein.Mass",
        STEADY=false)
        annotation (Placement(transformation(extent={{-80,-40},{-60,-20}})));
      PhysiolibraryOld.ConcentrationFlow.Synthesis synthesis(SynthesisBasic=
            0.01)
        annotation (Placement(transformation(extent={{-68,80},{-48,100}})));
      PhysiolibraryOld.ConcentrationFlow.Degradation degradation(
          DegradationBasic=0.01)
        annotation (Placement(transformation(extent={{28,-56},{48,-36}})));
      PhysiolibraryOld.ConcentrationFlow.ResistorWithCondParam
        GlomerulusProtein_Perm(cond=0)
        annotation (Placement(transformation(extent={{8,-78},{28,-58}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment Bladder(
        stateName="BladderProtein.Mass",
        STEADY=false,
        initialSoluteMass=0)
        annotation (Placement(transformation(extent={{74,-78},{54,-58}})));
      PhysiolibraryOld.Blocks.Parts alb_glb(nout=2, w={60,40})
        "distribution to albumins(60%) and globulins(40%) "
        annotation (Placement(transformation(extent={{-62,20},{-56,26}})));
      Modelica.Blocks.Math.Gain alb_molar_mass(y(unit = "mmol/l"), k(unit = "mmol/g") = 1 / 66.438, u(unit = "g/l")) annotation(Placement(transformation(extent = {{-48, 26}, {-44, 30}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
        concentrationMeasure(unitsString="g/l", toAnotherUnitCoef=1000)
        annotation (Placement(transformation(extent={{-80,14},{-60,34}})));
      Modelica.Blocks.Math.Feedback PeritoneumChange annotation(Placement(transformation(extent = {{-6, -6}, {6, 6}}, rotation = 270, origin = {-50, -14})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
        concentrationMeasure1(unitsString="g/ml", toAnotherUnitCoef=1)
        annotation (Placement(transformation(
            extent={{-10,-10},{10,10}},
            rotation=180,
            origin={-96,32})));
      PhysiolibraryOld.Utilities.ConstantFromFile NBB(
        varName="BloodIons.Protein",
        varValue=15.0835337930175,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-70,48},{-52,66}})));
    equation
      connect(Transfusion.desiredFlow, busConnector.Transfusion_ProteinRate) annotation(Line(points = {{-26, -80}, {-26, 14}, {92, 14}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(IVDrip.desiredFlow, busConnector.IVDripProteinRate) annotation(Line(points = {{-34, -62}, {-34, 14}, {92, 14}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(busConnector.Hemorrhage_ProteinRate, Hemorrhage.desiredFlow) annotation(Line(points = {{92, 14}, {-4, 14}, {-4, -88}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(UpperTorso.SolventVolume, busConnector.UT_InterstitialWater_Vol) annotation(Line(points = {{40, 80}, {50, 80}, {50, 14}, {92, 14}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(MiddleTorso.SolventVolume, busConnector.MT_InterstitialWater_Vol) annotation(Line(points = {{40, 34}, {50, 34}, {50, 14}, {92, 14}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(LowerTorso.SolventVolume, busConnector.LT_InterstitialWater_Vol) annotation(Line(points = {{40, -6}, {50, -6}, {50, 14}, {92, 14}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(busConnector.PeritoneumSpace_Vol, peritoneum.SolventVolume) annotation(Line(points = {{92, 14}, {-84, 14}, {-84, -24}, {-78, -24}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.LT_LymphFlow, LT_Lymph.solventFlow) annotation(Line(points = {{92, 14}, {50, 14}, {50, -26}, {6, -26}, {6, -24}, {5, -20}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.MT_LymphFlow, MT_Lymph.solventFlow) annotation(Line(points = {{92, 14}, {6, 14}, {6, 20}, {5, 20}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.UT_LymphFlow, UT_Lymph.solventFlow) annotation(Line(points = {{92, 14}, {50, 14}, {50, 60}, {6, 60}, {6, 64}, {5, 66}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.LT_InterstitialProtein_Mass, LowerTorso.soluteMass) annotation(Line(points = {{92, 14}, {50, 14}, {50, -26}, {32, -26}, {32, -19.8}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.MT_InterstitialProtein_Mass, MiddleTorso.soluteMass) annotation(Line(points = {{92, 14}, {32, 14}, {32, 20.2}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.UT_InterstitialProtein_Mass, UpperTorso.soluteMass) annotation(Line(points = {{92, 14}, {50, 14}, {50, 60}, {32, 60}, {32, 66.2}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(plasma.soluteMass, busConnector.PlasmaProtein_Mass) annotation(Line(points = {{-66, 34.2}, {-66, 14}, {92, 14}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(synthesis.q_out, plasma.q_out) annotation(Line(points = {{-48, 90}, {-14, 90}, {-14, 42}, {-66, 42}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(UT_Capillary.q_out, UpperTorso.q_out) annotation(Line(points = {{9.16, 84}, {16, 84}, {16, 74}, {32, 74}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(UT_Lymph.q_in, UpperTorso.q_out) annotation(Line(points = {{10, 69}, {16, 69}, {16, 74}, {32, 74}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(plasma.q_out, UT_Capillary.q_in) annotation(Line(points = {{-66, 42}, {-14, 42}, {-14, 84}, {-1.16, 84}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(plasma.q_out, UT_Lymph.q_out) annotation(Line(points = {{-66, 42}, {-14, 42}, {-14, 69}, {0, 69}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(plasma.q_out, MT_Capillary.q_in) annotation(Line(points = {{-66, 42}, {-14, 42}, {-14, 38}, {-1.16, 38}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(MT_Capillary.q_out, MiddleTorso.q_out) annotation(Line(points = {{9.16, 38}, {20, 38}, {20, 28}, {32, 28}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(MT_Lymph.q_in, MiddleTorso.q_out) annotation(Line(points = {{10, 23}, {20, 23}, {20, 28}, {32, 28}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(plasma.q_out, MT_Lymph.q_out) annotation(Line(points = {{-66, 42}, {-14, 42}, {-14, 23}, {0, 23}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(plasma.q_out, LT_Capillary.q_in) annotation(Line(points = {{-66, 42}, {-14, 42}, {-14, -2}, {0.84, -2}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(plasma.q_out, LT_Lymph.q_out) annotation(Line(points = {{-66, 42}, {-14, 42}, {-14, -16}, {0, -16}, {0, -17}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(plasma.q_out, GlomerulusProtein_Perm.q_in) annotation(Line(points = {{-66, 42}, {-14, 42}, {-14, -68}, {9.4, -68}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(plasma.q_out, Hemorrhage.q_in) annotation(Line(points = {{-66, 42}, {-14, 42}, {-14, -92}, {-10, -92}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(plasma.q_out, Transfusion.q_out) annotation(Line(points = {{-66, 42}, {-14, 42}, {-14, -84}, {-20, -84}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(plasma.q_out, IVDrip.q_out) annotation(Line(points = {{-66, 42}, {-14, 42}, {-14, -66}, {-28, -66}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(plasma.q_out, degradation.q_in) annotation(Line(points = {{-66, 42}, {-14, 42}, {-14, -46}, {28, -46}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(plasma.q_out, Change.q_in) annotation(Line(points = {{-66, 42}, {-14, 42}, {-14, -30}, {-44, -30}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(LT_Capillary.q_out, LowerTorso.q_out) annotation(Line(points = {{11.16, -2}, {20, -2}, {20, -12}, {32, -12}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(LT_Lymph.q_in, LowerTorso.q_out) annotation(Line(points = {{10, -17}, {20, -17}, {20, -12}, {32, -12}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(Change.q_out, peritoneum.q_out) annotation(Line(points = {{-56, -30}, {-70, -30}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(GlomerulusProtein_Perm.q_out, Bladder.q_out) annotation(Line(points = {{26.6, -68}, {64, -68}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(alb_molar_mass.u, alb_glb.y[1]) annotation(Line(points = {{-48.4, 28}, {-54, 28}, {-54, 22.85}, {-55.7, 22.85}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(alb_molar_mass.y, busConnector.ctAlb) annotation(Line(points = {{-43.8, 28}, {-28, 28}, {-28, 14}, {92, 14}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(alb_glb.y[2], busConnector.ctGlb) annotation(Line(points = {{-55.7, 23.15}, {-54, 23.15}, {-54, 18}, {-30, 18}, {-30, 14}, {92, 14}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, -3}, {6, -3}}));
      connect(concentrationMeasure.actualConc, alb_glb.u) annotation(Line(points = {{-70, 28}, {-70, 23}, {-62.6, 23}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(concentrationMeasure.q_in, plasma.q_out) annotation(Line(points = {{-70, 24}, {-74, 24}, {-74, 42}, {-66, 42}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(busConnector.PeritoneumSpace_Gain, PeritoneumChange.u1) annotation(Line(points = {{92, 14}, {-50, 14}, {-50, -9.199999999999999}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.PeritoneumSpace_Loss, PeritoneumChange.u2) annotation(Line(points = {{92, 14}, {-84, 14}, {-84, -14}, {-54.8, -14}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(PeritoneumChange.y, Change.solventFlow) annotation(Line(points = {{-50, -19.4}, {-50, -26.4}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Bladder.SolventVolume, busConnector.BladderVolume_Mass) annotation(Line(points = {{72, -62}, {96, -62}, {96, 14}, {92, 14}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(plasma.q_out, concentrationMeasure1.q_in) annotation(Line(points = {{-66, 42}, {-74, 42}, {-74, 32}, {-96, 32}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(concentrationMeasure1.actualConc, busConnector.PlasmaProteinConc) annotation(Line(points = {{-96, 28}, {-96, 14}, {92, 14}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(plasma.SolventVolume, busConnector.PlasmaVol) annotation(Line(points = {{-74, 48}, {-84, 48}, {-84, 14}, {92, 14}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(NBB.y, busConnector.BloodIons_ProteinAnions) annotation(Line(points = {{-51.1, 57}, {92, 57}, {92, 14}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent = {{-114, -86}, {128, -120}}, lineColor = {0, 0, 255}, textString = "%name")}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
    end Proteins;
    annotation(Documentation(revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr>
                   </table>
                   </html>"), Icon(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics));
  end Proteins;

  package Electrolytes "Body Electrolytes"
    extends PhysiolibraryOld.Icons.ElectrolytesLib;
    package Sodium "Body Sodium Distribution"
      model GlomerulusCationFiltration
        PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow q_out
          annotation (extent=[-10,-110; 10,-90], Placement(transformation(
                extent={{90,-10},{110,10}})));
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow q_in
          annotation (Placement(transformation(extent={{-120,-20},{-80,20}}),
              iconTransformation(extent={{-110,-10},{-90,10}})));
        PhysiolibraryOld.Interfaces.RealInput_ otherCations(final quantity=
              "Concentration", final unit="mEq/l") annotation (Placement(
              transformation(extent={{-78,30},{-38,70}}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=270,
              origin={-60,50})));
        PhysiolibraryOld.Interfaces.RealInput_ ProteinAnions(final quantity=
              "Concentration", final unit="mEq/l") annotation (Placement(
              transformation(extent={{-40,30},{0,70}}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=270,
              origin={-20,50})));
        Real KAdjustment;
        Real Cations(final quantity = "Concentration", final unit = "mEq/l");
        Real Anions(final quantity = "Concentration", final unit = "mEq/l");
      equation
        q_in.q + q_out.q = 0;
        Cations = q_in.conc * 1000 + otherCations;
        Anions = Cations;
        KAdjustment = (Cations - (Anions - ProteinAnions)) / (Cations + Anions - ProteinAnions);
        q_out.conc = (1 - KAdjustment) * q_in.conc;
        annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Rectangle(extent=  {{-100, -50}, {100, 50}}, lineColor=  {0, 0, 127}, fillColor=  {255, 255, 255},
                  fillPattern=                                                                                                    FillPattern.Solid), Text(extent=  {{-150, -100}, {150, -60}}, textString=  "%name", lineColor=  {0, 0, 255}), Line(points=  {{0, 42}, {0, 26}}, color=  {0, 0, 255}, smooth=  Smooth.None, thickness=  0.5), Line(points=  {{0, 20}, {0, 4}}, color=  {0, 0, 255}, smooth=  Smooth.None, thickness=  0.5), Line(points=  {{0, -4}, {0, -20}}, color=  {0, 0, 255}, smooth=  Smooth.None, thickness=  0.5), Line(points=  {{0, -26}, {0, -42}}, color=  {0, 0, 255}, smooth=  Smooth.None, thickness=  0.5)}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
      end GlomerulusCationFiltration;

      model Sodium
        import HumMod;
        extends PhysiolibraryOld.Icons.Sodium;
        PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment NaPool(
            initialSoluteMass=2058.45, stateName="NaPool.Mass")
          annotation (Placement(transformation(extent={{-10,6},{10,26}})));
        PhysiolibraryOld.ConcentrationFlow.OutputPump Hemorrhage
          annotation (Placement(transformation(extent={{-42,-70},{-22,-50}})));
        PhysiolibraryOld.ConcentrationFlow.OutputPump DialyzerActivity
          annotation (Placement(transformation(extent={{-42,-100},{-22,-80}})));
        PhysiolibraryOld.ConcentrationFlow.InputPump IVDrip
          annotation (Placement(transformation(extent={{-64,-46},{-44,-26}})));
        PhysiolibraryOld.ConcentrationFlow.InputPump Transfusion
          annotation (Placement(transformation(extent={{-62,-88},{-42,-68}})));
        PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
          concentrationMeasure1(unitsString="mEq/l", toAnotherUnitCoef=1000)
          annotation (Placement(transformation(
              extent={{-10,-10},{10,10}},
              rotation=0,
              origin={-60,26})));
        PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
            Placement(transformation(extent={{-74,84},{-62,96}}),
              iconTransformation(extent={{60,60},{100,100}})));
        Real ECF_conc;
        SweatGlandSalt sweatGlandSalt annotation(Placement(transformation(extent = {{52, 50}, {68, 66}})));
        GILumen gILumen annotation(Placement(transformation(extent = {{-20, 54}, {0, 74}})));
        HumMod.Electrolytes.Bladder bladder(stateVarName = "BladderSodium.Mass") annotation(Placement(transformation(extent = {{60, -50}, {80, -30}})));
        HumMod.Electrolytes.Sodium.KidneyNa kidneyNa annotation(Placement(transformation(extent = {{52, -8}, {72, 12}})));
      equation
        ECF_conc = concentrationMeasure1.actualConc;
        connect(NaPool.SolventVolume, busConnector.ECFV_Vol) annotation(Line(points = {{-8, 22}, {-24, 22}, {-24, 90}, {-68, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(Hemorrhage.q_in, NaPool.q_out) annotation(Line(points = {{-38, -60}, {-42, -60}, {-42, 16}, {0, 16}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(DialyzerActivity.q_in, NaPool.q_out) annotation(Line(points = {{-38, -90}, {-42, -90}, {-42, 16}, {0, 16}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(Transfusion.q_out, NaPool.q_out) annotation(Line(points = {{-46, -78}, {-42, -78}, {-42, 16}, {0, 16}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(IVDrip.q_out, NaPool.q_out) annotation(Line(points = {{-48, -36}, {-42, -36}, {-42, 16}, {0, 16}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(IVDrip.desiredFlow, busConnector.IVDrip_NaRate) annotation(Line(points = {{-54, -32}, {-74, -32}, {-74, 90}, {-68, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(Transfusion.desiredFlow, busConnector.Transfusion_NaRate) annotation(Line(points = {{-52, -74}, {-74, -74}, {-74, 90}, {-68, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(busConnector.Hemorrhage_NaRate, Hemorrhage.desiredFlow) annotation(Line(points = {{-68, 90}, {-74, 90}, {-74, -56}, {-32, -56}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(DialyzerActivity.desiredFlow, busConnector.DialyzerActivity_Na_Flux) annotation(Line(points = {{-32, -86}, {-74, -86}, {-74, 90}, {-68, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(concentrationMeasure1.q_in, NaPool.q_out) annotation(Line(points = {{-60, 26}, {-42, 26}, {-42, 16}, {0, 16}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(concentrationMeasure1.actualConc, busConnector.NaPool_conc_per_liter) annotation(Line(points = {{-60, 30}, {-60, 90}, {-68, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(NaPool.q_out, sweatGlandSalt.salt) annotation(Line(points = {{0, 16}, {52, 16}, {52, 53.2}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(gILumen.busConnector, busConnector) annotation(Line(points = {{-2, 72}, {-2, 90}, {-68, 90}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(gILumen.q_out, NaPool.q_out) annotation(Line(points = {{-10, 64}, {0, 64}, {0, 16}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(bladder.busConnector, busConnector) annotation(Line(points = {{78, -32}, {78, 90}, {-68, 90}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector, sweatGlandSalt.busConnector) annotation(Line(points = {{-68, 90}, {78, 90}, {78, 64}, {66.40000000000001, 64}, {66.40000000000001, 64.40000000000001}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(kidneyNa.q_out, bladder.q_in) annotation(Line(points = {{64, -6}, {70, -6}, {70, -32}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(kidneyNa.q_in, NaPool.q_out) annotation(Line(points = {{64, 2}, {64, 16}, {0, 16}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(kidneyNa.busConnector, busConnector) annotation(Line(points = {{70, 10}, {78, 10}, {78, 90}, {-68, 90}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(NaPool.soluteMass, busConnector.NaPool_mass) annotation(Line(points = {{0, 8.199999999999999}, {0, -4}, {-74, -4}, {-74, 90}, {-68, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-110, -104}, {110, -130}}, lineColor=  {0, 0, 255}, textString=  "%name")}), Documentation(revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr>
                   </table>
                   </html>"));
      end Sodium;

      model GILumen
        extends PhysiolibraryOld.Icons.GILumen;
        PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment GILumen(
            initialSoluteMass=80, stateName="GILumenSodium.Mass")
          annotation (Placement(transformation(extent={{-6,-54},{14,-34}})));
        PhysiolibraryOld.ConcentrationFlow.SoluteFlowPump Absorbtion
          annotation (Placement(transformation(extent={{10,-18},{-2,-30}})));
        Modelica.Blocks.Math.Gain Perm(k = 0.0015) annotation(Placement(transformation(extent = {{14, -64}, {20, -58}})));
        PhysiolibraryOld.ConcentrationFlow.InputPump Diet
          annotation (Placement(transformation(extent={{-36,-68},{-16,-48}})));
        PhysiolibraryOld.ConcentrationFlow.OutputPump Diarrhea annotation (
            Placement(transformation(
              extent={{-10,-10},{10,10}},
              rotation=180,
              origin={-26,-72})));
        PhysiolibraryOld.Factors.CurveValue LeptinEffect2(data={{0,3.0,0},{8,
              1.0,-0.04},{50,0.0,0}})
          annotation (Placement(transformation(extent={{-36,-58},{-16,-38}})));
        PhysiolibraryOld.Blocks.Constant Constant7(k=180/1440)
          annotation (Placement(transformation(extent={{-36,-44},{-28,-36}})));
        PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
            Placement(transformation(extent={{-62,-72},{-50,-60}}),
              iconTransformation(extent={{60,60},{100,100}})));
        PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow q_out
          annotation (Placement(transformation(extent={{-10,-10},{10,10}}),
              iconTransformation(extent={{-10,-10},{10,10}})));
      equation
        connect(GILumen.SolventVolume, busConnector.GILumenVolume_Mass) annotation(Line(points = {{-4, -38}, {-43, -38}, {-43, -66}, {-56, -66}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(GILumen.q_out, Absorbtion.q_in) annotation(Line(points = {{4, -44}, {16, -44}, {16, -24}, {10, -24}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(Diet.q_out, GILumen.q_out) annotation(Line(points = {{-20, -58}, {-4, -58}, {-4, -44}, {4, -44}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(Diarrhea.desiredFlow, busConnector.GILumenDiarrhea_NaLoss) annotation(Line(points = {{-26, -76}, {-26, -78}, {-44, -78}, {-44, -66}, {-56, -66}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(GILumen.q_out, Diarrhea.q_in) annotation(Line(points = {{4, -44}, {-4, -44}, {-4, -72}, {-20, -72}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(GILumen.soluteMass, Perm.u) annotation(Line(points = {{4, -51.8}, {4, -61}, {13.4, -61}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Perm.y, Absorbtion.soluteFlow) annotation(Line(points = {{20.3, -61}, {22, -62}, {22, -32}, {4, -32}, {4, -27.6}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(GILumen.soluteMass, busConnector.GILumenSodium_Mass) annotation(Line(points = {{4, -51.8}, {4, -68}, {-22, -68}, {-22, -66}, {-56, -66}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(Constant7.y, LeptinEffect2.yBase) annotation(Line(points = {{-27.6, -40}, {-26, -40}, {-26, -46}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(LeptinEffect2.y, Diet.desiredFlow) annotation(Line(points = {{-26, -50}, {-26, -54}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.Leptin, LeptinEffect2.u) annotation(Line(points = {{-56, -66}, {-44, -66}, {-44, -48}, {-35.8, -48}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(Absorbtion.q_out, q_out) annotation(Line(points = {{-2, -24}, {-8, -24}, {-8, 0}, {0, 0}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
      end GILumen;

      model KidneyNa
        import HumMod;
        extends PhysiolibraryOld.Icons.Kidney;
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow q_in
          "sodium concentration in blood incomming to glomerulus capillaries; sodium mass flow is filtration - reabsorbtion"
          annotation (Placement(transformation(extent={{-64,-4},{-46,14}}),
              iconTransformation(extent={{10,-10},{30,10}})));
        PhysiolibraryOld.ConcentrationFlow.SolventFlowPump_InitialPatch
          glomerulusSudiumRate
          annotation (Placement(transformation(extent={{-16,14},{4,34}})));
        PhysiolibraryOld.ConcentrationFlow.FractReabsorbtion PT
          annotation (Placement(transformation(extent={{8,14},{28,34}})));
        PhysiolibraryOld.Blocks.FractConstant const1(k=58)
          annotation (Placement(transformation(extent={{2,34},{8,40}})));
        PhysiolibraryOld.Factors.CurveValue IFPEffect(data={{1.0,1.4,0},{4.0,
              1.0,-0.2},{7.0,0.3,0}})
          annotation (Placement(transformation(extent={{14,32},{34,52}})));
        PhysiolibraryOld.Factors.CurveValue ANPEffect(data={{0.0,1.2,0},{1.3,
              1.0,-0.2},{2.7,0.6,0}})
          annotation (Placement(transformation(extent={{14,40},{34,60}})));
        PhysiolibraryOld.Factors.CurveValue SympsEffect(data={{0.6,0.6,0},{1.0,
              1.0,0.5},{4.0,1.5,0}})
          annotation (Placement(transformation(extent={{14,48},{34,68}})));
        PhysiolibraryOld.Factors.CurveValue A2Effect(data={{0.7,0.8,0},{1.3,1.0,
              0.8},{1.6,1.2,0}})
          annotation (Placement(transformation(extent={{14,56},{34,76}})));
        PhysiolibraryOld.ConcentrationFlow.FractReabsorbtion LH(MaxReab=7)
          annotation (Placement(transformation(extent={{68,14},{88,34}})));
        PhysiolibraryOld.Blocks.FractConstant const2(k=75)
          annotation (Placement(transformation(extent={{64,30},{70,36}})));
        PhysiolibraryOld.ConcentrationFlow.FractReabsorbtion2 DT
          annotation (Placement(transformation(extent={{80,-74},{60,-54}})));
        PhysiolibraryOld.ConcentrationFlow.FractReabsorbtion CD(MaxReab=0.7)
          annotation (Placement(transformation(extent={{30,-74},{10,-54}})));
        PhysiolibraryOld.Blocks.FractConstant const3(k=75)
          annotation (Placement(transformation(extent={{18,-58},{24,-52}})));
        PhysiolibraryOld.Blocks.FractConstant const4(k=75)
          annotation (Placement(transformation(extent={{68,-58},{74,-52}})));
        PhysiolibraryOld.Factors.CurveValue Furosemide(data={{0.0,1.0,-1},{0.1,
              0.0,0}})
          annotation (Placement(transformation(extent={{64,62},{84,82}})));
        PhysiolibraryOld.Factors.CurveValue AldoEffect(data={{0.0,0.7,0},{10.0,
              1.0,0}})
          annotation (Placement(transformation(extent={{76,40},{96,60}})));
        PhysiolibraryOld.Factors.CurveValue LoadEffect(data={{0.0,3.0,0},{7.2,
              1.0,-0.2},{20.0,0.5,0}})
          annotation (Placement(transformation(extent={{76,32},{96,52}})));
        PhysiolibraryOld.Factors.SimpleMultiply FurosemideEffect
          annotation (Placement(transformation(extent={{76,48},{96,68}})));
        PhysiolibraryOld.Factors.SimpleMultiply Filtering_xNormal
          annotation (Placement(transformation(extent={{64,54},{84,74}})));
        PhysiolibraryOld.ConcentrationFlow.FlowMeasure flowMeasure
          annotation (Placement(transformation(extent={{50,14},{70,34}})));
        PhysiolibraryOld.ConcentrationFlow.FlowMeasure flowMeasure1
          annotation (Placement(transformation(extent={{98,-74},{78,-54}})));
        PhysiolibraryOld.Factors.CurveValue LoadEffect1(data={{0.0,2.0,0},{1.6,
              1.0,0}})
          annotation (Placement(transformation(extent={{72,-56},{52,-36}})));
        PhysiolibraryOld.Factors.CurveValue ThiazideEffect(data={{0.0,1.0,-2.0},
              {0.6,0.2,0.0}})
          annotation (Placement(transformation(extent={{72,-48},{52,-28}})));
        PhysiolibraryOld.ConcentrationFlow.FlowMeasure flowMeasure2
          annotation (Placement(transformation(extent={{58,-74},{38,-54}})));
        PhysiolibraryOld.Factors.CurveValue LoadEffect2(data={{0.0,2.0,0},{0.4,
              1.0,0}})
          annotation (Placement(transformation(extent={{22,-58},{2,-38}})));
        PhysiolibraryOld.Factors.CurveValue ANPEffect2(data={{0.0,1.2,0},{1.3,
              1.0,-0.4},{2.7,0.2,0}})
          annotation (Placement(transformation(extent={{22,-50},{2,-30}})));
        PhysiolibraryOld.Factors.SimpleMultiply AldoEffect2 annotation (
            Placement(transformation(
              extent={{10,-10},{-10,10}},
              rotation=270,
              origin={84,-78})));
        PhysiolibraryOld.Blocks.Constant const5(k=2)
          annotation (Placement(transformation(extent={{94,-80},{90,-76}})));
        PhysiolibraryOld.ConcentrationFlow.FlowMeasure flowMeasure3
          annotation (Placement(transformation(extent={{10,-54},{-10,-74}})));
        PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment Medulla(
            stateName="MedullaNa.Mass", initialSoluteMass=13)
          annotation (Placement(transformation(extent={{28,-102},{48,-82}})));
        PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
          concentrationMeasure(unitsString="mEq/l", toAnotherUnitCoef=1000)
          annotation (Placement(transformation(
              extent={{-9,-9},{9,9}},
              rotation=270,
              origin={57,-97})));
        PhysiolibraryOld.ConcentrationFlow.SolventFlowPump VasaRectaOutflow
          annotation (Placement(transformation(extent={{-4,-100},{-20,-84}})));
        Modelica.Blocks.Math.Gain gain(k = 0.03) annotation(Placement(transformation(extent = {{-28, -88}, {-20, -80}})));
        PhysiolibraryOld.ConcentrationFlow.FlowMeasure flowMeasure4
          annotation (Placement(transformation(extent={{64,-68},{44,-88}})));
        PhysiolibraryOld.ConcentrationFlow.FlowMeasure flowMeasure5
          annotation (Placement(transformation(extent={{80,16},{60,-4}})));
        PhysiolibraryOld.ConcentrationFlow.FlowMeasure flowMeasure6 annotation (
           Placement(transformation(
              extent={{10,10},{-10,-10}},
              rotation=90,
              origin={18,12})));
        PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
            Placement(transformation(extent={{-98,86},{-86,98}}),
              iconTransformation(extent={{60,60},{100,100}})));
        Modelica.Blocks.Math.Gain Osm(k = 2) annotation(Placement(transformation(extent = {{68, -100}, {74, -94}})));
        PhysiolibraryOld.Factors.CurveValue AldoEffect1(data={{0.0,0.5,0},{12.0,
              1.0,0.08},{50.0,3.0,0}})
          annotation (Placement(transformation(extent={{52,-40},{72,-20}})));
        Modelica.Blocks.Math.Division division annotation(Placement(transformation(extent = {{80, -16}, {86, -10}})));
        Modelica.Blocks.Math.Gain ml2l(k = 1000) annotation(Placement(transformation(extent = {{90, -16}, {96, -10}})));
        PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
          concentrationMeasure2(unitsString="mEq/ml", toAnotherUnitCoef=1)
          annotation (Placement(transformation(
              extent={{-9,-9},{9,9}},
              rotation=270,
              origin={57,-91})));
        GlomerulusCationFiltration glomerulus annotation(Placement(transformation(extent = {{-40, 14}, {-20, 34}})));
        PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow q_out
          "sodium mass outflow to urine from collecting ducts" annotation (
            Placement(transformation(extent={{-24,-70},{-8,-56}}),
              iconTransformation(extent={{10,-90},{30,-70}})));
      equation
        connect(glomerulusSudiumRate.solventFlow, busConnector.GlomerulusFiltrate_GFR) annotation(Line(points = {{-6, 30}, {-6, 38}, {-32, 38}, {-32, 92}, {-92, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(glomerulusSudiumRate.q_out, PT.Inflow) annotation(Line(points = {{4, 24}, {8, 24}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(const1.y, PT.Normal) annotation(Line(points = {{8.300000000000001, 37}, {12, 37}, {12, 28}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(A2Effect.yBase, busConnector.KidneyFunctionEffect) annotation(Line(points = {{24, 68}, {24, 92}, {-92, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(A2Effect.y, SympsEffect.yBase) annotation(Line(points = {{24, 64}, {24, 60}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(SympsEffect.y, ANPEffect.yBase) annotation(Line(points = {{24, 56}, {24, 52}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(ANPEffect.y, IFPEffect.yBase) annotation(Line(points = {{24, 48}, {24, 44}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(IFPEffect.y, PT.Effects) annotation(Line(points = {{24, 40}, {24, 28}, {26, 28}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.A2Pool_Log10Conc, A2Effect.u) annotation(Line(points = {{-92, 92}, {-18.9, 92}, {-18.9, 66}, {14.2, 66}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(SympsEffect.u, busConnector.KidneyAlpha_PT_NA) annotation(Line(points = {{14.2, 58}, {-18.9, 58}, {-18.9, 92}, {-92, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(busConnector.NephronANP_Log10Conc, ANPEffect.u) annotation(Line(points = {{-92, 92}, {-18.9, 92}, {-18.9, 50}, {14.2, 50}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.NephronIFP_Pressure, IFPEffect.u) annotation(Line(points = {{-92, 92}, {-18.9, 92}, {-18.9, 42}, {14.2, 42}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(const2.y, LH.Normal) annotation(Line(points = {{70.3, 33}, {72, 33}, {72, 28}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(const3.y, CD.Normal) annotation(Line(points = {{24.3, -55}, {26, -55}, {26, -60}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(const4.y, DT.Normal) annotation(Line(points = {{74.3, -55}, {76, -55}, {76, -60}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Furosemide.u, busConnector.FurosemidePool_Furosemide_conc) annotation(Line(points = {{64.2, 72}, {48, 72}, {48, 92}, {-92, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(AldoEffect.y, LoadEffect.yBase) annotation(Line(points = {{86, 48}, {86, 44}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(LoadEffect.y, LH.Effects) annotation(Line(points = {{86, 40}, {86, 28}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(FurosemideEffect.y, AldoEffect.yBase) annotation(Line(points = {{86, 56}, {86, 52}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Filtering_xNormal.u, busConnector.Kidney_NephronCount_Filtering_xNormal) annotation(Line(points = {{64.2, 64}, {48, 64}, {48, 92}, {-92, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(Filtering_xNormal.y, FurosemideEffect.u) annotation(Line(points = {{74, 62}, {74, 58}, {76.2, 58}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Furosemide.y, Filtering_xNormal.yBase) annotation(Line(points = {{74, 70}, {74, 66}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.KidneyFunctionEffect, Furosemide.yBase) annotation(Line(points = {{-92, 92}, {74, 92}, {74, 74}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(FurosemideEffect.yBase, busConnector.KidneyFunctionEffect) annotation(Line(points = {{86, 60}, {86, 92}, {-92, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(PT.Outflow, flowMeasure.q_in) annotation(Line(points = {{28, 24}, {56, 24}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(flowMeasure.q_out, LH.Inflow) annotation(Line(points = {{64, 24}, {68, 24}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(flowMeasure.actualFlow, LoadEffect.u) annotation(Line(points = {{60, 29}, {60, 42}, {76.2, 42}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(DT.Inflow, flowMeasure1.q_out) annotation(Line(points = {{80, -64}, {84, -64}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(flowMeasure1.q_in, LH.Outflow) annotation(Line(points = {{92, -64}, {98, -64}, {98, 24}, {88, 24}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(LoadEffect1.y, DT.Effects) annotation(Line(points = {{62, -48}, {62, -60}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(LoadEffect1.u, flowMeasure1.actualFlow) annotation(Line(points = {{71.8, -46}, {88, -46}, {88, -59}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(ThiazideEffect.u, busConnector.ThiazidePool_Thiazide_conc) annotation(Line(points = {{71.8, -38}, {99.90000000000001, -38}, {99.90000000000001, 92}, {-92, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(CD.Inflow, flowMeasure2.q_out) annotation(Line(points = {{30, -64}, {44, -64}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(flowMeasure2.q_in, DT.Outflow) annotation(Line(points = {{52, -64}, {60, -64}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(LoadEffect2.y, CD.Effects) annotation(Line(points = {{12, -50}, {12, -60}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(LoadEffect2.u, flowMeasure2.actualFlow) annotation(Line(points = {{21.8, -48}, {48, -48}, {48, -59}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(ANPEffect2.y, LoadEffect2.yBase) annotation(Line(points = {{12, -42}, {12, -46}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(ANPEffect2.yBase, busConnector.KidneyFunctionEffect) annotation(Line(points = {{12, -38}, {12, -36}, {48, -36}, {48, 92}, {-92, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(ANPEffect2.u, busConnector.NephronANP_Log10Conc) annotation(Line(points = {{21.8, -40}, {48, -40}, {48, 92}, {-92, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(const5.y, AldoEffect2.yBase) annotation(Line(points = {{89.8, -78}, {86, -78}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(AldoEffect2.y, DT.MaxReab) annotation(Line(points = {{82, -78}, {76, -78}, {76, -68.2}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(CD.Outflow, flowMeasure3.q_in) annotation(Line(points = {{10, -64}, {4, -64}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(CD.Reabsorbtion, Medulla.q_out) annotation(Line(points = {{20, -68}, {20, -92}, {38, -92}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(Medulla.q_out, concentrationMeasure.q_in) annotation(Line(points = {{38, -92}, {42, -92}, {42, -97}, {57, -97}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(Medulla.q_out, VasaRectaOutflow.q_in) annotation(Line(points = {{38, -92}, {-4, -92}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(gain.y, VasaRectaOutflow.solventFlow) annotation(Line(points = {{-19.6, -84}, {-12, -84}, {-12, -87.2}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.VasaRecta_Outflow, gain.u) annotation(Line(points = {{-92, 92}, {-98.40000000000001, 92}, {-98.40000000000001, -84}, {-28.8, -84}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(Medulla.SolventVolume, busConnector.Medulla_Volume) annotation(Line(points = {{30, -86}, {26, -86}, {26, -78}, {-98, -78}, {-98, 92}, {-92, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(AldoEffect1.y, busConnector.DT_AldosteroneEffect) annotation(Line(points = {{62, -32}, {62, -34}, {100, -34}, {100, 92}, {-92, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(DT.Reabsorbtion, flowMeasure4.q_in) annotation(Line(points = {{70, -68}, {70, -78}, {58, -78}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(flowMeasure5.actualFlow, busConnector.LH_Na_Reab) annotation(Line(points = {{70, 1}, {100, 1}, {100, 92}, {-92, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(LH.Reabsorbtion, flowMeasure5.q_in) annotation(Line(points = {{78, 20}, {78, 6}, {74, 6}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(flowMeasure6.actualFlow, busConnector.PT_Na_Reab) annotation(Line(points = {{23, 12}, {47.5, 12}, {47.5, 92}, {-92, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(PT.Reabsorbtion, flowMeasure6.q_in) annotation(Line(points = {{18, 20}, {18, 16}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(concentrationMeasure.actualConc, Osm.u) annotation(Line(points = {{60.6, -97}, {67.40000000000001, -97}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Osm.y, busConnector.MedullaNa_Osmolarity) annotation(Line(points = {{74.3, -97}, {100, -97}, {100, 92}, {-92, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(busConnector.KidneyFunctionEffect, AldoEffect1.yBase) annotation(Line(points = {{-92, 92}, {48, 92}, {48, -28}, {62, -28}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(AldoEffect1.y, ThiazideEffect.yBase) annotation(Line(points = {{62, -32}, {62, -36}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(ThiazideEffect.y, LoadEffect1.yBase) annotation(Line(points = {{62, -40}, {62, -44}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(AldoEffect1.y, AldoEffect2.u) annotation(Line(points = {{62, -32}, {62, -34}, {96, -34}, {96, -90}, {84, -90}, {84, -87.8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(LH.ReabFract, busConnector.LH_Na_FractReab) annotation(Line(points = {{88, 20}, {100, 20}, {100, 92}, {-92, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(PT.ReabFract, busConnector.PT_Na_FractReab) annotation(Line(points = {{28, 20}, {48, 20}, {48, 92}, {-92, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(flowMeasure2.actualFlow, busConnector.DT_Na_Outflow) annotation(Line(points = {{48, -59}, {48, 92}, {-92, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(flowMeasure3.actualFlow, busConnector.CD_Na_Outflow) annotation(Line(points = {{0, -69}, {0, -74}, {-98, -74}, {-98, 92}, {-92, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(flowMeasure4.actualFlow, busConnector.DT_Na_Reab) annotation(Line(points = {{54, -83}, {54, -90}, {100, -90}, {100, 92}, {-92, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(flowMeasure1.actualFlow, division.u1) annotation(Line(points = {{88, -59}, {88, -24}, {74, -24}, {74, -11.2}, {79.40000000000001, -11.2}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.LH_H2O_Outflow, division.u2) annotation(Line(points = {{-92, 92}, {-98, 92}, {-98, -6}, {56, -6}, {56, -14.8}, {79.40000000000001, -14.8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(ml2l.u, division.y) annotation(Line(points = {{89.40000000000001, -13}, {89.40000000000001, -12.5}, {86.3, -12.5}, {86.3, -13}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(ml2l.y, busConnector.MD_Na) annotation(Line(points = {{96.3, -13}, {100, -14}, {100, 92}, {-92, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(busConnector.NephronAldo_conc_in_nG_per_dl, AldoEffect.u) annotation(Line(points = {{-92, 92}, {48, 92}, {48, 50}, {76.2, 50}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.NephronAldo_conc_in_nG_per_dl, AldoEffect1.u) annotation(Line(points = {{-92, 92}, {48, 92}, {48, -30}, {52.2, -30}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(Medulla.q_out, concentrationMeasure2.q_in) annotation(Line(points = {{38, -92}, {52, -92}, {52, -91}, {57, -91}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(concentrationMeasure2.actualConc, busConnector.MedullaNa_conc) annotation(Line(points = {{60.6, -91}, {100, -91}, {100, 92}, {-92, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(glomerulus.ProteinAnions, busConnector.BloodIons_ProteinAnions) annotation(Line(points = {{-32, 29}, {-32, 92}, {-92, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(glomerulusSudiumRate.q_in, glomerulus.q_out) annotation(Line(points = {{-16, 24}, {-20, 24}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(glomerulus.q_in, q_in) annotation(Line(points = {{-40, 24}, {-54, 24}, {-54, 5}, {-55, 5}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(flowMeasure6.q_out, q_in) annotation(Line(points = {{18, 8}, {18, 5}, {-55, 5}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(flowMeasure5.q_out, q_in) annotation(Line(points = {{66, 6}, {18, 6}, {18, 5}, {-55, 5}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(flowMeasure4.q_out, q_in) annotation(Line(points = {{50, -78}, {-55, -78}, {-55, 5}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(VasaRectaOutflow.q_out, q_in) annotation(Line(points = {{-20, -92}, {-55, -92}, {-55, 5}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(flowMeasure3.q_out, q_out) annotation(Line(points = {{-4, -64}, {-16, -64}, {-16, -63}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(busConnector.KAPool_conc_per_liter, glomerulus.otherCations) annotation(Line(points = {{-92, 92}, {-36, 92}, {-36, 29}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-110, -104}, {110, -130}}, lineColor=  {0, 0, 255}, textString=  "%name")}), Documentation(revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr>
                   </table>
                   </html>"));
      end KidneyNa;
    end Sodium;

    package Potassium "Body Potassium Distribution"
      model Potassium
        import HumMod;
        //extends Library.Interfaces.BaseModel;
        extends PhysiolibraryOld.Icons.Potassium;
        PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment KPool(
            initialSoluteMass=62.897, stateName="KPool.Mass")
          annotation (Placement(transformation(extent={{-34,14},{-14,34}})));
        PhysiolibraryOld.ConcentrationFlow.OutputPump Hemorrhage
          annotation (Placement(transformation(extent={{20,-86},{40,-66}})));
        PhysiolibraryOld.ConcentrationFlow.OutputPump DialyzerActivity
          annotation (Placement(transformation(extent={{20,-100},{40,-80}})));
        PhysiolibraryOld.ConcentrationFlow.InputPump IVDrip
          annotation (Placement(transformation(extent={{0,-80},{20,-60}})));
        PhysiolibraryOld.ConcentrationFlow.InputPump Transfusion
          annotation (Placement(transformation(extent={{0,-94},{20,-74}})));
        PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
          concentrationMeasure2(unitsString="mEq/l", toAnotherUnitCoef=1000)
          annotation (Placement(transformation(
              extent={{-10,-10},{10,10}},
              rotation=0,
              origin={-80,42})));
        PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
            Placement(transformation(extent={{-94,88},{-82,100}}),
              iconTransformation(extent={{60,60},{100,100}})));
        GILumenK gILumenK annotation(Placement(transformation(extent = {{-74, -40}, {-54, -20}})));
        HumMod.Electrolytes.Bladder bladder(stateVarName = "BladderPotassium.Mass") annotation(Placement(transformation(extent = {{56, -52}, {76, -32}})));
        HumMod.Electrolytes.Potassium.KindeyK kindeyK annotation(Placement(transformation(extent = {{42, -22}, {62, -2}})));
        Real ECF_conc;
        HumMod.Electrolytes.SweatGlandSalt sweatGlandSalt(FractReabBasic = 0, FractReabK = 0) annotation(Placement(transformation(extent = {{22, 42}, {42, 62}})));
        HumMod.Electrolytes.Potassium.IntracellularPotassium_const intracellularPotassium annotation(Placement(transformation(extent = {{-32, 68}, {-12, 88}})));
      equation
        ECF_conc = concentrationMeasure2.actualConc;
        connect(KPool.SolventVolume, busConnector.ECFV_Vol) annotation(Line(points = {{-32, 30}, {-95, 30}, {-95, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, 1}, {3, 1}}));
        connect(Hemorrhage.q_in, KPool.q_out) annotation(Line(points = {{24, -76}, {22, -76}, {22, 24}, {-24, 24}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(DialyzerActivity.q_in, KPool.q_out) annotation(Line(points = {{24, -90}, {22, -90}, {22, 24}, {-24, 24}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(Transfusion.q_out, KPool.q_out) annotation(Line(points = {{16, -84}, {22, -84}, {22, 24}, {-24, 24}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(IVDrip.q_out, KPool.q_out) annotation(Line(points = {{16, -70}, {22, -70}, {22, 24}, {-24, 24}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(IVDrip.desiredFlow, busConnector.IVDrip_KRate) annotation(Line(points = {{10, -66}, {10, -64}, {-96, -64}, {-96, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, 1}, {3, 1}}));
        connect(Transfusion.desiredFlow, busConnector.Transfusion_KRate) annotation(Line(points = {{10, -80}, {-96, -80}, {-96, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, 1}, {3, 1}}));
        connect(busConnector.Hemorrhage_KRate, Hemorrhage.desiredFlow) annotation(Line(points = {{-88, 94}, {98, 94}, {98, -72}, {30, -72}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-3, 1}, {-3, 1}}));
        connect(DialyzerActivity.desiredFlow, busConnector.DialyzerActivity_K_Flux) annotation(Line(points = {{30, -86}, {98, -86}, {98, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, 1}, {3, 1}}));
        connect(concentrationMeasure2.q_in, KPool.q_out) annotation(Line(points = {{-80, 42}, {-64, 42}, {-64, 24}, {-24, 24}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(concentrationMeasure2.actualConc, busConnector.KPool_per_liter) annotation(Line(points = {{-80, 46}, {-96, 46}, {-96, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, 1}, {3, 1}}));
        connect(concentrationMeasure2.actualConc, busConnector.KPool) annotation(Line(points = {{-80, 46}, {-96, 46}, {-96, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(gILumenK.busConnector, busConnector) annotation(Line(points = {{-56, -22}, {-56, -16}, {-96, -16}, {-96, 94}, {-88, 94}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(gILumenK.q_out, KPool.q_out) annotation(Line(points = {{-64, -30}, {-64, 24}, {-24, 24}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(kindeyK.q_out, bladder.q_in) annotation(Line(points = {{54, -20}, {66, -20}, {66, -34}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(kindeyK.q_in, KPool.q_out) annotation(Line(points = {{54, -12}, {54, 24}, {-24, 24}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(bladder.busConnector, busConnector) annotation(Line(points = {{74, -34}, {82, -34}, {82, 94}, {-88, 94}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(kindeyK.busConnector, busConnector) annotation(Line(points = {{60, -4}, {82, -4}, {82, 94}, {-88, 94}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(concentrationMeasure2.actualConc, busConnector.KPool_conc_per_liter) annotation(Line(points = {{-80, 46}, {-96, 46}, {-96, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(KPool.soluteMass, busConnector.KPool_mass) annotation(Line(points = {{-24, 16.2}, {-24, 10}, {-96, 10}, {-96, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, 1}, {3, 1}}));
        connect(KPool.q_out, sweatGlandSalt.salt) annotation(Line(points = {{-24, 24}, {22, 24}, {22, 46}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(sweatGlandSalt.busConnector, busConnector) annotation(Line(points = {{40, 60}, {82, 60}, {82, 94}, {-88, 94}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(KPool.q_out, intracellularPotassium.q_in) annotation(Line(points = {{-24, 24}, {-24, 78}, {-22, 78}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(busConnector, intracellularPotassium.busConnector) annotation(Line(points = {{-88, 94}, {-14, 94}, {-14, 86}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Text(extent=  {{-112, -102}, {108, -128}}, lineColor=  {0, 0, 255}, textString=  "%name")}), Documentation(revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr><tr>
                   <td></td>
                   <td>Noriaki Ikeda: A model of overall regulation of body fluids (1979), Kitasato University</td>
                   </tr>
                   </table>
                   </html>", info = "<html>
                   <p>TODO: Ikeda - Potassium glucose flow from ECF to ICF with insulin affects potassium flow to cells.</p>
                   </html>"));
      end Potassium;

      model KindeyK
        extends PhysiolibraryOld.Icons.Kidney;
        PhysiolibraryOld.Factors.CurveValue NaEffect(data={{0.0,0.3,0},{0.4,1.0,
              1.5},{4.0,3.0,0}})
          annotation (Placement(transformation(extent={{44,30},{24,50}})));
        PhysiolibraryOld.Factors.CurveValue AldoEffect(data={{0.0,0.3,0},{12.0,
              1.0,0.06},{50.0,3.0,0}})
          annotation (Placement(transformation(extent={{44,38},{24,58}})));
        PhysiolibraryOld.Factors.CurveValue ThiazideEffect(data={{0.0,1.0,2.0},
              {0.6,2.0,0}})
          annotation (Placement(transformation(extent={{44,46},{24,66}})));
        PhysiolibraryOld.Blocks.ElectrolytesFlowConstant
          electrolytesFlowConstant(k=0.05)
          annotation (Placement(transformation(extent={{18,76},{30,88}})));
        PhysiolibraryOld.ConcentrationFlow.SoluteFlowPump DT_K annotation (
            Placement(transformation(
              extent={{-6,-6},{6,6}},
              rotation=0,
              origin={34,22})));
        PhysiolibraryOld.Factors.CurveValue KEffect(data={{0.0,0.0,0},{4.4,1.0,
              0.5},{5.5,3.0,0}})
          annotation (Placement(transformation(extent={{24,22},{44,42}})));
        PhysiolibraryOld.Factors.SimpleMultiply KidneyFunction
          annotation (Placement(transformation(extent={{44,54},{24,74}})));
        PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
            Placement(transformation(extent={{-94,88},{-82,100}}),
              iconTransformation(extent={{60,60},{100,100}})));
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow q_in
          "sodium concentration in blood incomming to glomerulus capillaries; sodium mass flow is filtration - reabsorbtion"
          annotation (Placement(transformation(extent={{-54,6},{-36,24}}),
              iconTransformation(extent={{10,-10},{30,10}})));
        PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow q_out
          "sodium mass outflow to urine from collecting ducts" annotation (
            Placement(transformation(extent={{-14,-60},{2,-46}}),
              iconTransformation(extent={{10,-90},{30,-70}})));
      equation
        connect(AldoEffect.y, NaEffect.yBase) annotation(Line(points = {{34, 46}, {34, 42}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(ThiazideEffect.y, AldoEffect.yBase) annotation(Line(points = {{34, 54}, {34, 50}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(ThiazideEffect.u, busConnector.ThiazidePool_Thiazide_conc) annotation(Line(points = {{43.8, 56}, {98, 56}, {98, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, 1}, {3, 1}}));
        connect(NaEffect.u, busConnector.DT_Na_Outflow) annotation(Line(points = {{43.8, 40}, {98, 40}, {98, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, 1}, {3, 1}}));
        connect(NaEffect.y, KEffect.yBase) annotation(Line(points = {{34, 38}, {34, 34}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(KEffect.y, DT_K.soluteFlow) annotation(Line(points = {{34, 30}, {34, 25.6}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(electrolytesFlowConstant.y, KidneyFunction.yBase) annotation(Line(points = {{30.6, 82}, {34, 82}, {34, 66}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(KidneyFunction.y, ThiazideEffect.yBase) annotation(Line(points = {{34, 62}, {34, 58}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(KidneyFunction.u, busConnector.KidneyFunctionEffect) annotation(Line(points = {{43.8, 64}, {98, 64}, {98, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, 1}, {3, 1}}));
        connect(KEffect.y, busConnector.CD_K_Outflow) annotation(Line(points = {{34, 30}, {98, 30}, {98, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, 1}, {3, 1}}));
        connect(AldoEffect.u, busConnector.NephronAldo_conc_in_nG_per_dl) annotation(Line(points = {{43.8, 48}, {98, 48}, {98, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(q_in, DT_K.q_in) annotation(Line(points = {{-45, 15}, {-8.5, 15}, {-8.5, 22}, {28, 22}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(DT_K.q_out, q_out) annotation(Line(points = {{40, 22}, {56, 22}, {56, -44}, {-4, -44}, {-4, -53}, {-6, -53}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(busConnector.KPool_conc_per_liter, KEffect.u) annotation(Line(points = {{-88, 94}, {-88, 32}, {24.2, 32}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Text(extent=  {{-112, -102}, {108, -128}}, lineColor=  {0, 0, 255}, textString=  "%name")}), Documentation(revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr><tr>
                   <td></td>
                   <td>Noriaki Ikeda: A model of overall regulation of body fluids (1979), Kitasato University</td>
                   </tr>
                   </table>
                   </html>", info = "<html>
                   <p>TODO: Ikeda - Potassium glucose flow from ECF to ICF with insulin affects potassium flow to cells.</p>
                   </html>"));
      end KindeyK;

      model GILumenK
        extends PhysiolibraryOld.Icons.GILumen;
        PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment GILumen(
            initialSoluteMass=25, stateName="GILumenPotassium.Mass")
          annotation (Placement(transformation(extent={{-18,-36},{2,-16}})));
        PhysiolibraryOld.ConcentrationFlow.SoluteFlowPump Absorbtion
          annotation (Placement(transformation(extent={{6,-20},{18,-32}})));
        Modelica.Blocks.Math.Gain Perm(k = 0.002) annotation(Placement(transformation(extent = {{0, -48}, {6, -42}})));
        PhysiolibraryOld.ConcentrationFlow.InputPump Diet
          annotation (Placement(transformation(extent={{-66,-42},{-46,-22}})));
        PhysiolibraryOld.ConcentrationFlow.OutputPump Diarrhea annotation (
            Placement(transformation(
              extent={{-10,-10},{10,10}},
              rotation=180,
              origin={-56,-44})));
        PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
            Placement(transformation(extent={{-94,88},{-82,100}}),
              iconTransformation(extent={{60,60},{100,100}})));
        PhysiolibraryOld.Blocks.Constant Constant7(k=70/1440)
          annotation (Placement(transformation(extent={{-66,-16},{-58,-8}})));
        PhysiolibraryOld.Factors.CurveValue LeptinEffect2(data={{0,3.0,0},{8,
              1.0,-0.04},{50,0.0,0}})
          annotation (Placement(transformation(extent={{-66,-30},{-46,-10}})));
        PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow q_out
          "sodium mass outflow to urine from collecting ducts" annotation (
            Placement(transformation(extent={{56,-24},{72,-10}}),
              iconTransformation(extent={{-10,-10},{10,10}})));
      equation
        connect(GILumen.SolventVolume, busConnector.GILumenVolume_Mass) annotation(Line(points = {{-16, -20}, {-24, -20}, {-24, -4}, {-96, -4}, {-96, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, 1}, {3, 1}}));
        connect(GILumen.q_out, Absorbtion.q_in) annotation(Line(points = {{-8, -26}, {6, -26}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(Diet.q_out, GILumen.q_out) annotation(Line(points = {{-50, -32}, {-16, -32}, {-16, -26}, {-8, -26}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(Diarrhea.desiredFlow, busConnector.GILumenDiarrhea_KLoss) annotation(Line(points = {{-56, -48}, {-96, -48}, {-96, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, 1}, {3, 1}}));
        connect(GILumen.q_out, Diarrhea.q_in) annotation(Line(points = {{-8, -26}, {-16, -26}, {-16, -44}, {-50, -44}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(Perm.y, Absorbtion.soluteFlow) annotation(Line(points = {{6.3, -45}, {12, -45}, {12, -29.6}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Perm.u, GILumen.soluteMass) annotation(Line(points = {{-0.6, -45}, {-8, -45}, {-8, -33.8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(GILumen.soluteMass, busConnector.GILumenPotasium_Mass) annotation(Line(points = {{-8, -33.8}, {-8, -54}, {-96, -54}, {-96, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, 1}, {3, 1}}));
        connect(GILumen.soluteMass, busConnector.GILumenPotassium_Mass) annotation(Line(points = {{-8, -33.8}, {-8, -54}, {-96, -54}, {-96, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(busConnector.Leptin, LeptinEffect2.u) annotation(Line(points = {{-88, 94}, {-96, 94}, {-96, -20}, {-65.8, -20}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(Constant7.y, LeptinEffect2.yBase) annotation(Line(points = {{-57.6, -12}, {-56, -12}, {-56, -18}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(LeptinEffect2.y, Diet.desiredFlow) annotation(Line(points = {{-56, -22}, {-56, -28}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Absorbtion.q_out, q_out) annotation(Line(points = {{18, -26}, {42, -26}, {42, -17}, {64, -17}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Text(extent=  {{-112, -102}, {108, -128}}, lineColor=  {0, 0, 255}, textString=  "%name")}), Documentation(revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr><tr>
                   <td></td>
                   <td>Noriaki Ikeda: A model of overall regulation of body fluids (1979), Kitasato University</td>
                   </tr>
                   </table>
                   </html>", info = "<html>
                   <p>TODO: Ikeda - Potassium glucose flow from ECF to ICF with insulin affects potassium flow to cells.</p>
                   </html>"));
      end GILumenK;

      model IntracellularPotassium_const
        extends PhysiolibraryOld.Icons.Cell;
        PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
            Placement(transformation(extent={{-86,58},{-74,70}}),
              iconTransformation(extent={{60,60},{100,100}})));
        PhysiolibraryOld.Blocks.ElectrolytesFlowConstant
          electrolytesFlowConstant1(k=0)
          annotation (Placement(transformation(extent={{-66,-46},{-56,-36}})));
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow q_in
          "sodium concentration in blood incomming to glomerulus capillaries; sodium mass flow is filtration - reabsorbtion"
          annotation (Placement(transformation(extent={{-62,-96},{-44,-78}}),
              iconTransformation(extent={{-10,-10},{10,10}})));
        Modelica.Blocks.Math.Gain gain(k = 1000, y(unit = "mEq/l")) annotation(Placement(transformation(extent = {{52, -30}, {62, -20}})));
        PhysiolibraryOld.Blocks.ElectrolytesConcentrationConstant_per_l
          electrolytesFlowConstant2(k=142)
          annotation (Placement(transformation(extent={{10,-78},{28,-60}})));
        PhysiolibraryOld.Blocks.ElectrolytesMassConstant
          electrolytesFlowConstant3(k=0.142*26481.1911733325)
          annotation (Placement(transformation(extent={{-68,-22},{-50,-4}})));
        Modelica.Blocks.Math.Division division annotation(Placement(transformation(extent = {{10, -54}, {30, -34}})));
      equation
        q_in.q = 0;
        connect(gain.y, busConnector.KCell_conc_per_liter) annotation(Line(points = {{62.5, -25}, {106, -25}, {106, 64}, {-80, 64}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(electrolytesFlowConstant1.y, busConnector.PotassiumToCells) annotation(Line(points = {{-55.5, -41}, {-22, -41}, {-22, 64}, {-80, 64}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(electrolytesFlowConstant3.y, busConnector.KCell_Mass) annotation(Line(points = {{-49.1, -13}, {32, -13}, {32, 64}, {-80, 64}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(division.y, gain.u) annotation(Line(points = {{31, -44}, {40, -44}, {40, -25}, {51, -25}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.ICFV_Vol, division.u2) annotation(Line(points = {{-80, 64}, {-36, 64}, {-36, -50}, {8, -50}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(electrolytesFlowConstant3.y, division.u1) annotation(Line(points = {{-49.1, -13}, {-49.1, -14.5}, {8, -14.5}, {8, -38}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Diagram(graphics));
      end IntracellularPotassium_const;
    end Potassium;

    package Chloride "Body Chloride Distribution"
      model GILumenCl
        extends PhysiolibraryOld.Icons.GILumen;
        PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment GILumen(
            initialSoluteMass=90, stateName="GILumenChloride.Mass")
          annotation (Placement(transformation(extent={{-44,-36},{-24,-16}})));
        PhysiolibraryOld.ConcentrationFlow.SoluteFlowPump Absorbtion
          annotation (Placement(transformation(extent={{-20,-20},{-8,-32}})));
        Modelica.Blocks.Math.Gain Perm(k = 0.0015) annotation(Placement(transformation(extent = {{-26, -48}, {-20, -42}})));
        PhysiolibraryOld.ConcentrationFlow.InputPump Diet
          annotation (Placement(transformation(extent={{-82,-46},{-62,-26}})));
        PhysiolibraryOld.ConcentrationFlow.OutputPump Diarrhea annotation (
            Placement(transformation(
              extent={{-10,-10},{10,10}},
              rotation=180,
              origin={-52,-44})));
        PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
            Placement(transformation(extent={{-92,-4},{-80,8}}),
              iconTransformation(extent={{62,62},{100,100}})));
        PhysiolibraryOld.Blocks.Constant Constant7(k=200/1440)
          annotation (Placement(transformation(extent={{-82,-22},{-74,-14}})));
        PhysiolibraryOld.Factors.CurveValue LeptinEffect2(data={{0,3.0,0},{8,
              1.0,-0.04},{50,0.0,0}})
          annotation (Placement(transformation(extent={{-82,-36},{-62,-16}})));
        PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow q_out
          "sodium mass outflow to urine from collecting ducts" annotation (
            Placement(transformation(extent={{14,-28},{30,-14}}),
              iconTransformation(extent={{-10,-10},{10,10}})));
      equation
        connect(GILumen.SolventVolume, busConnector.GILumenVolume_Mass) annotation(Line(points = {{-42, -20}, {-49, -20}, {-49, 2}, {-86, 2}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, 1}, {3, 1}}));
        connect(GILumen.q_out, Absorbtion.q_in) annotation(Line(points = {{-34, -26}, {-20, -26}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(Diet.q_out, GILumen.q_out) annotation(Line(points = {{-66, -36}, {-42, -36}, {-42, -26}, {-34, -26}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(Diarrhea.desiredFlow, busConnector.GILumenVomitus_ClLoss) annotation(Line(points = {{-52, -48}, {-52, 2}, {-86, 2}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, 1}, {3, 1}}));
        connect(GILumen.q_out, Diarrhea.q_in) annotation(Line(points = {{-34, -26}, {-42, -26}, {-42, -44}, {-46, -44}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(Perm.y, Absorbtion.soluteFlow) annotation(Line(points = {{-19.7, -45}, {-14, -45}, {-14, -29.6}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Perm.u, GILumen.soluteMass) annotation(Line(points = {{-26.6, -45}, {-34, -45}, {-34, -33.8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.Leptin, LeptinEffect2.u) annotation(Line(points = {{-86, 2}, {-90, 2}, {-90, -26}, {-81.8, -26}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(Constant7.y, LeptinEffect2.yBase) annotation(Line(points = {{-73.59999999999999, -18}, {-72, -18}, {-72, -24}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(LeptinEffect2.y, Diet.desiredFlow) annotation(Line(points = {{-72, -28}, {-72, -32}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Absorbtion.q_out, q_out) annotation(Line(points = {{-8, -26}, {8, -26}, {8, -21}, {22, -21}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Text(extent=  {{-112, -102}, {108, -128}}, lineColor=  {0, 0, 255}, textString=  "%name")}), Documentation(revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr>
                   </table>
                   </html>"));
      end GILumenCl;

      model KidneyCl
        import HumMod;
        extends PhysiolibraryOld.Icons.Kidney;
        PhysiolibraryOld.Factors.CurveValue PhEffect(data={{7.0,1.0,0},{7.45,
              0.93,-0.5},{7.8,0.0,0}})
          annotation (Placement(transformation(extent={{16,42},{36,62}})));
        PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
            Placement(transformation(extent={{-92,-4},{-80,8}}),
              iconTransformation(extent={{62,62},{100,100}})));
        PhysiolibraryOld.ConcentrationFlow.SoluteFlowPump CD_Outflow
          annotation (Placement(transformation(extent={{10,30},{22,18}})));
        Modelica.Blocks.Math.Sum CD_Cations_Outflow(nin = 3) annotation(Placement(transformation(extent = {{42, -38}, {52, -28}})));
        Modelica.Blocks.Math.Sum CD_AnionsLessCl_Outflow(nin = 3) annotation(Placement(transformation(extent = {{42, -52}, {52, -42}})));
        Modelica.Blocks.Math.Feedback CD_Cl_Outflow annotation(Placement(transformation(extent = {{60, -42}, {78, -24}})));
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow q_in
          "sodium concentration in blood incomming to glomerulus capillaries; sodium mass flow is filtration - reabsorbtion"
          annotation (Placement(transformation(extent={{-44,16},{-26,34}}),
              iconTransformation(extent={{10,-10},{30,10}})));
        PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow q_out
          "sodium mass outflow to urine from collecting ducts" annotation (
            Placement(transformation(extent={{50,18},{66,32}}),
              iconTransformation(extent={{10,-90},{30,-70}})));
        Modelica.Blocks.Math.Sum CD_AnionsLessCl_Outflow1(nin = 3) annotation(Placement(transformation(extent = {{42, -74}, {52, -64}})));
      equation
        connect(busConnector.CollectingDuct_NetSumCats, PhEffect.yBase) annotation(Line(points = {{-86, 2}, {-90, 2}, {-90, 64}, {26, 64}, {26, 54}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-3, 1}, {-3, 1}}));
        connect(busConnector.Artys_pH, PhEffect.u) annotation(Line(points = {{-86, 2}, {-90, 2}, {-90, 52}, {16.2, 52}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.CD_Na_Outflow, CD_Cations_Outflow.u[1]) annotation(Line(points = {{-86, 2}, {10, 2}, {10, -32}, {40, -32}, {40, -33.6667}, {41, -33.6667}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.CD_NH4_Outflow, CD_Cations_Outflow.u[2]) annotation(Line(points = {{-86, 2}, {10, 2}, {10, -38}, {41, -38}, {41, -33}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 0}, {-6, 0}}));
        connect(busConnector.CD_K_Outflow, CD_Cations_Outflow.u[3]) annotation(Line(points = {{-86, 2}, {10, 2}, {10, -34}, {40, -34}, {40, -32.3333}, {41, -32.3333}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, -3}, {-6, -3}}));
        connect(busConnector.CD_PO4_mEq_Outflow, CD_AnionsLessCl_Outflow.u[1]) annotation(Line(points = {{-86, 2}, {10, 2}, {10, -46}, {40, -46}, {40, -47.6667}, {41, -47.6667}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.CD_SO4_Outflow, CD_AnionsLessCl_Outflow.u[2]) annotation(Line(points = {{-86, 2}, {10, 2}, {10, -48}, {40, -48}, {41, -47}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 0}, {-6, 0}}));
        connect(busConnector.CD_KA_Outflow, CD_AnionsLessCl_Outflow.u[3]) annotation(Line(points = {{-86, 2}, {10, 2}, {10, -52}, {40, -52}, {40, -46.3333}, {41, -46.3333}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, -3}, {-6, -3}}));
        connect(CD_Cations_Outflow.y, CD_Cl_Outflow.u1) annotation(Line(points = {{52.5, -33}, {52, -34}, {52, -33}, {61.8, -33}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(q_in, CD_Outflow.q_in) annotation(Line(points = {{-35, 25}, {-12.5, 25}, {-12.5, 24}, {10, 24}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(CD_Outflow.q_out, q_out) annotation(Line(points = {{22, 24}, {40, 24}, {40, 25}, {58, 25}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(busConnector.CD_SO4_Outflow, CD_AnionsLessCl_Outflow1.u[2]) annotation(Line(points = {{-86, 2}, {10, 2}, {10, -70}, {40, -70}, {41, -69}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 0}, {-6, 0}}));
        connect(busConnector.CD_KA_Outflow, CD_AnionsLessCl_Outflow1.u[3]) annotation(Line(points = {{-86, 2}, {10, 2}, {10, -74}, {40, -74}, {40, -68.33329999999999}, {41, -68.33329999999999}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, -3}, {-6, -3}}));
        connect(busConnector.CD_PO4_Outflow, CD_AnionsLessCl_Outflow1.u[1]) annotation(Line(points = {{-86, 2}, {10, 2}, {10, -66}, {41, -66}, {41, -69.66670000000001}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(CD_AnionsLessCl_Outflow.y, CD_Cl_Outflow.u2) annotation(Line(points = {{52.5, -47}, {69, -40.2}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(PhEffect.y, CD_Outflow.soluteFlow) annotation(Line(points = {{26, 50}, {26, 8}, {16, 8}, {16, 20.4}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Text(extent=  {{-112, -102}, {108, -128}}, lineColor=  {0, 0, 255}, textString=  "%name")}), Documentation(revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr>
                   </table>
                   </html>", info = "<html>
                   <p>TODO: Chloride extracellular body concentration should play a role in chloride excretion by kidney?</p>
                   <p>In this implementation is chloride outflow driven only by electroneutrality.</p>
                   <p>That means - there is hard to calculate steady state for chloride concentration !!</p>
                   <p>Chloride concentration sholud be calculate also from internal electroneutrality, better than integrated value from inflow and outflow.</p>
                   </html>"));
      end KidneyCl;

      model Chloride2
        import HumMod;
        // extends Library.Interfaces.BaseModel;
        extends PhysiolibraryOld.Icons.Chloride;
        PhysiolibraryOld.ConcentrationFlow.OutputPump Hemorrhage
          annotation (Placement(transformation(extent={{-6,-86},{14,-66}})));
        PhysiolibraryOld.ConcentrationFlow.OutputPump DialyzerActivity
          annotation (Placement(transformation(extent={{-6,-100},{14,-80}})));
        PhysiolibraryOld.ConcentrationFlow.InputPump IVDrip
          annotation (Placement(transformation(extent={{-26,-80},{-6,-60}})));
        PhysiolibraryOld.ConcentrationFlow.InputPump Transfusion
          annotation (Placement(transformation(extent={{-26,-94},{-6,-74}})));
        PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
            Placement(transformation(extent={{-92,-4},{-80,8}}),
              iconTransformation(extent={{62,62},{100,100}})));
        Real ECF_conc;
        SweatGlandSalt sweatGlandSalt annotation(Placement(transformation(extent = {{-34, 76}, {-18, 92}})));
        GILumenCl gILumenCl annotation(Placement(transformation(extent = {{-58, -38}, {-38, -18}})));
        HumMod.Electrolytes.Bladder bladder(stateVarName = "BladderChloride.Mass") annotation(Placement(transformation(extent = {{54, -20}, {74, 0}})));
        HumMod.Electrolytes.Chloride.KidneyCl kidneyCl annotation(Placement(transformation(extent = {{22, 6}, {42, 26}})));
        PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment ClPool(
            initialSoluteMass=1515.2456531712, stateName="ClPool.Mass")
          annotation (Placement(transformation(extent={{8,46},{28,66}})));
        PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
          concentrationMeasure1(unitsString="mEq/l", toAnotherUnitCoef=1000)
          annotation (Placement(transformation(
              extent={{-10,-10},{10,10}},
              rotation=0,
              origin={10,72})));
      equation
        ECF_conc = concentrationMeasure1.actualConc;
        connect(Hemorrhage.q_in, ClPool.q_out) annotation(Line(points = {{-2, -76}, {-6, -76}, {-6, 56}, {18, 56}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(DialyzerActivity.q_in, ClPool.q_out) annotation(Line(points = {{-2, -90}, {-6, -90}, {-6, 56}, {18, 56}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(Transfusion.q_out, ClPool.q_out) annotation(Line(points = {{-10, -84}, {-6, -84}, {-6, 56}, {18, 56}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(IVDrip.q_out, ClPool.q_out) annotation(Line(points = {{-10, -70}, {-6, -70}, {-6, 56}, {18, 56}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(IVDrip.desiredFlow, busConnector.IVDrip_ClRate) annotation(Line(points = {{-16, -66}, {-16, 2}, {-86, 2}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, 1}, {3, 1}}));
        connect(Transfusion.desiredFlow, busConnector.Transfusion_ClRate) annotation(Line(points = {{-16, -80}, {-38, -80}, {-38, 2}, {-86, 2}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, 1}, {3, 1}}));
        connect(busConnector.Hemorrhage_ClRate, Hemorrhage.desiredFlow) annotation(Line(points = {{-86, 2}, {4.5, 2}, {4.5, -72}, {4, -72}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-3, 1}, {-3, 1}}));
        connect(DialyzerActivity.desiredFlow, busConnector.DialyzerActivity_Cl_Flux) annotation(Line(points = {{4, -86}, {4, 2}, {-86, 2}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, 1}, {3, 1}}));
        connect(ClPool.q_out, sweatGlandSalt.salt) annotation(Line(points = {{18, 56}, {-62, 56}, {-62, 79.2}, {-34, 79.2}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(busConnector, gILumenCl.busConnector) annotation(Line(points = {{-86, 2}, {-40, 2}, {-40, -19.9}, {-39.9, -19.9}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(gILumenCl.q_out, ClPool.q_out) annotation(Line(points = {{-48, -28}, {-48, 56}, {18, 56}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(bladder.busConnector, busConnector) annotation(Line(points = {{72, -2}, {72, 2}, {-86, 2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(sweatGlandSalt.busConnector, busConnector) annotation(Line(points = {{-19.6, 90.40000000000001}, {-94, 90.40000000000001}, {-94, 2}, {-86, 2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(kidneyCl.busConnector, busConnector) annotation(Line(points = {{40.1, 24.1}, {40.1, 2}, {-86, 2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(bladder.q_in, kidneyCl.q_out) annotation(Line(points = {{64, -2}, {64, 8}, {34, 8}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(kidneyCl.q_in, ClPool.q_out) annotation(Line(points = {{34, 16}, {34, 56}, {18, 56}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(concentrationMeasure1.actualConc, busConnector.ClPool_conc_per_liter) annotation(Line(points = {{10, 76}, {-16, 76}, {-16, 2}, {-86, 2}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(ClPool.soluteMass, busConnector.ClPool_mass) annotation(Line(points = {{18, 48.2}, {-30, 48.2}, {-30, 2}, {-86, 2}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(busConnector.ECFV_Vol, ClPool.SolventVolume) annotation(Line(points = {{-86, 2}, {-86, 62}, {10, 62}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(ClPool.q_out, concentrationMeasure1.q_in) annotation(Line(points = {{18, 56}, {16, 56}, {16, 72}, {10, 72}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Text(extent=  {{-112, -102}, {108, -128}}, lineColor=  {0, 0, 255}, textString=  "%name")}), Documentation(revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr>
                   </table>
                   </html>"));
      end Chloride2;
    end Chloride;

    package Phosphate "Body Phosphate Distribution"
      model GlomerulusStrongAnionFiltration
        PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow q_out
          annotation (extent=[-10,-110; 10,-90], Placement(transformation(
                extent={{90,-10},{110,10}})));
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow q_in
          annotation (Placement(transformation(extent={{-120,-20},{-80,20}}),
              iconTransformation(extent={{-110,-10},{-90,10}})));
        PhysiolibraryOld.Interfaces.RealInput_ Cations(final quantity=
              "Concentration", final unit="mEq/l") annotation (Placement(
              transformation(extent={{-80,30},{-40,70}}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=270,
              origin={-60,50})));
        PhysiolibraryOld.Interfaces.RealInput_ ProteinAnions(final quantity=
              "Concentration", final unit="mEq/l") annotation (Placement(
              transformation(extent={{-40,30},{0,70}}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=270,
              origin={-20,50})));
        Real KAdjustment;
        //Real Cations( final quantity="Concentration", final unit = "mEq/l");
        Real Anions(final quantity = "Concentration", final unit = "mEq/l");
        //  Real ProteinAnions( final quantity="Concentration", final unit = "mEq/l");
        /*  Library.Interfaces.RealInput_ HCO3(final quantity="Concentration",
                                                                                                                                                              final unit="mEq/l")                                                                               annotation (Placement(
                                                                                                                                                                transformation(extent={{0,30},{40,70}}),  iconTransformation(
                                                                                                                                                                extent={{-20,-20},{20,20}},
                                                                                                                                                                rotation=270,
                                                                                                                                                                origin={20,50})));
                                                                                                                                                        */
      equation
        q_in.q + q_out.q = 0;
        //Cations = q_in.conc*1000+otherCations;
        Anions = Cations;
        //  ProteinAnions = Anions - otherStrongAnions - q_in.conc*1000 - HCO3;
        KAdjustment = (Cations - (Anions - ProteinAnions)) / (Cations + Anions - ProteinAnions);
        q_out.conc = (1 + KAdjustment) * q_in.conc;
        annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Rectangle(extent=  {{-100, -50}, {100, 50}}, lineColor=  {0, 0, 127}, fillColor=  {255, 255, 255}, fillPattern=  FillPattern.Solid), Text(extent=  {{-150, -100}, {150, -60}}, textString=  "%name", lineColor=  {0, 0, 255}), Line(points=  {{0, 42}, {0, 26}}, color=  {0, 0, 255}, smooth=  Smooth.None, thickness=  0.5), Line(points=  {{0, 20}, {0, 4}}, color=  {0, 0, 255}, smooth=  Smooth.None, thickness=  0.5), Line(points=  {{0, -4}, {0, -20}}, color=  {0, 0, 255}, smooth=  Smooth.None, thickness=  0.5), Line(points=  {{0, -26}, {0, -42}}, color=  {0, 0, 255}, smooth=  Smooth.None, thickness=  0.5)}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
      end GlomerulusStrongAnionFiltration;

      model Phosphate3
        import HumMod;
        // extends Library.Interfaces.BaseModel;
        extends PhysiolibraryOld.Icons.Phosphate;
        PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment PO4Pool(
            initialSoluteMass=2.43011, stateName="PO4Pool.Mass")
          annotation (Placement(transformation(extent={{-64,14},{-44,34}})));
        PhysiolibraryOld.ConcentrationFlow.InputPump Diet
          annotation (Placement(transformation(extent={{-84,-4},{-64,16}})));
        PhysiolibraryOld.ConcentrationFlow.SolventFlowPump
          glomerulusPhosphateRate
          annotation (Placement(transformation(extent={{0,14},{20,34}})));
        HumMod.Electrolytes.Sulphate.GlomerulusStrongAnionFiltration glomerulus annotation(Placement(transformation(extent = {{-28, 14}, {-8, 34}})));
        PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
          concentrationMeasure annotation (Placement(transformation(
              extent={{-10,-10},{10,10}},
              rotation=270,
              origin={-28,2})));
        Modelica.Blocks.Math.Gain gain(k = 1000) annotation(Placement(transformation(extent = {{-18, 0}, {-14, 4}})));
        PhysiolibraryOld.ConcentrationFlow.FlowMeasure flowMeasure
          annotation (Placement(transformation(extent={{20,34},{40,14}})));
        Modelica.Blocks.Math.Gain gain1(k = 0.5) annotation(Placement(transformation(extent = {{-50, -14}, {-46, -10}})));
        PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
          concentrationMeasure1(unitsString="mmol/l", toAnotherUnitCoef=1000)
          annotation (Placement(transformation(
              extent={{-10,-10},{10,10}},
              rotation=0,
              origin={-60,60})));
        PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
            Placement(transformation(extent={{-90,76},{-78,88}}),
              iconTransformation(extent={{60,60},{100,100}})));
        PhysiolibraryOld.Blocks.Constant Constant7(k=30/1440)
          annotation (Placement(transformation(extent={{-84,24},{-76,32}})));
        PhysiolibraryOld.Factors.CurveValue LeptinEffect2(data={{0,3.0,0},{8,
              1.0,-0.04},{50,0.0,0}})
          annotation (Placement(transformation(extent={{-84,10},{-64,30}})));
        Real ECF_conc;
        HumMod.Electrolytes.Bladder bladder(stateVarName = "BladderPhosphate.Mass") annotation(Placement(transformation(extent = {{66, 6}, {86, 26}})));
      equation
        ECF_conc = concentrationMeasure1.actualConc;
        connect(PO4Pool.SolventVolume, busConnector.ECFV_Vol) annotation(Line(points = {{-62, 30}, {-67, 30}, {-67, 82}, {-84, 82}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, 1}, {3, 1}}));
        connect(Diet.q_out, PO4Pool.q_out) annotation(Line(points = {{-68, 6}, {-60, 6}, {-60, 24}, {-54, 24}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(glomerulusPhosphateRate.solventFlow, busConnector.GlomerulusFiltrate_GFR) annotation(Line(points = {{10, 30}, {10, 82}, {-84, 82}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, 1}, {3, 1}}));
        connect(glomerulus.q_out, glomerulusPhosphateRate.q_in) annotation(Line(points = {{-8, 24}, {0, 24}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(PO4Pool.q_out, glomerulus.q_in) annotation(Line(points = {{-54, 24}, {-28, 24}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(concentrationMeasure.actualConc, gain.u) annotation(Line(points = {{-24, 2}, {-21.2, 2}, {-21.2, 2}, {-18.4, 2}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(gain.y, busConnector.PO4Pool_conc_per_liter) annotation(Line(points = {{-13.8, 2}, {-48.9, 2}, {-48.9, 82}, {-84, 82}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, 1}, {3, 1}}));
        connect(concentrationMeasure.q_in, PO4Pool.q_out) annotation(Line(points = {{-28, 2}, {-34, 2}, {-34, 24}, {-54, 24}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(flowMeasure.actualFlow, busConnector.CD_PO4_Outflow) annotation(Line(points = {{30, 19}, {30, -26}, {100, -26}, {100, 82}, {-84, 82}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, 1}, {3, 1}}));
        connect(glomerulusPhosphateRate.q_out, flowMeasure.q_in) annotation(Line(points = {{20, 24}, {26, 24}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(busConnector.BloodIons_Cations, glomerulus.Cations) annotation(Line(points = {{-84, 82}, {-24, 82}, {-24, 29}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-3, 1}, {-3, 1}}));
        connect(PO4Pool.soluteMass, gain1.u) annotation(Line(points = {{-54, 16.2}, {-54, -12}, {-50.4, -12}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(gain1.y, busConnector.PO4Pool_Osmoles) annotation(Line(points = {{-45.8, -12}, {-64.90000000000001, -12}, {-64.90000000000001, 82}, {-84, 82}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, 1}, {3, 1}}));
        connect(concentrationMeasure1.actualConc, busConnector.ctPO4) annotation(Line(points = {{-60, 64}, {-60, 82}, {-84, 82}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, 1}, {3, 1}}));
        connect(concentrationMeasure1.q_in, PO4Pool.q_out) annotation(Line(points = {{-60, 60}, {-54, 60}, {-54, 24}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(busConnector.Leptin, LeptinEffect2.u) annotation(Line(points = {{-84, 82}, {-92, 82}, {-92, 20}, {-83.8, 20}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(Constant7.y, LeptinEffect2.yBase) annotation(Line(points = {{-75.59999999999999, 28}, {-74, 28}, {-74, 22}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(LeptinEffect2.y, Diet.desiredFlow) annotation(Line(points = {{-74, 18}, {-74, 10}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.BloodIons_ProteinAnions, glomerulus.ProteinAnions) annotation(Line(points = {{-84, 82}, {-20, 82}, {-20, 29}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(bladder.busConnector, busConnector) annotation(Line(points = {{84, 24}, {84, 82}, {-84, 82}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(bladder.q_in, flowMeasure.q_out) annotation(Line(points = {{76, 24}, {34, 24}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(flowMeasure.actualFlow, busConnector.CD_PO4_mEq_Outflow) annotation(Line(points = {{30, 19}, {30, -26}, {100, -26}, {100, 84}, {-84, 84}, {-84, 82}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Text(extent=  {{-108, -98}, {112, -124}}, lineColor=  {0, 0, 255}, textString=  "%name")}));
      end Phosphate3;
    end Phosphate;

    package Sulphate "Body Sulphate Distribution"
      model GlomerulusStrongAnionFiltration
        PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow q_out
          annotation (extent=[-10,-110; 10,-90], Placement(transformation(
                extent={{90,-10},{110,10}})));
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow q_in
          annotation (Placement(transformation(extent={{-120,-20},{-80,20}}),
              iconTransformation(extent={{-110,-10},{-90,10}})));
        PhysiolibraryOld.Interfaces.RealInput_ Cations(final quantity=
              "Concentration", final unit="mEq/l") annotation (Placement(
              transformation(extent={{-80,30},{-40,70}}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=270,
              origin={-60,50})));
        PhysiolibraryOld.Interfaces.RealInput_ ProteinAnions(final quantity=
              "Concentration", final unit="mEq/l") annotation (Placement(
              transformation(extent={{-40,30},{0,70}}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=270,
              origin={-20,50})));
        Real KAdjustment;
        //Real Cations( final quantity="Concentration", final unit = "mEq/l");
        Real Anions(final quantity = "Concentration", final unit = "mEq/l");
        // Real ProteinAnions( final quantity="Concentration", final unit = "mEq/l");
        /*  Library.Interfaces.RealInput_ HCO3(final quantity="Concentration",
                                                                                                                                                              final unit="mEq/l")                                                                               annotation (Placement(
                                                                                                                                                                transformation(extent={{0,30},{40,70}}),  iconTransformation(
                                                                                                                                                                extent={{-20,-20},{20,20}},
                                                                                                                                                                rotation=270,
                                                                                                                                                                origin={20,50})));
                                                                                                                                                        */
      equation
        q_in.q + q_out.q = 0;
        //Cations = q_in.conc*1000+otherCations;
        Anions = Cations;
        // ProteinAnions = Anions - otherStrongAnions - q_in.conc*1000 - HCO3;
        KAdjustment = (Cations - (Anions - ProteinAnions)) / (Cations + Anions - ProteinAnions);
        q_out.conc = (1 + KAdjustment) * q_in.conc;
        annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Rectangle(extent=  {{-100, -50}, {100, 50}}, lineColor=  {0, 0, 127}, fillColor=  {255, 255, 255}, fillPattern=  FillPattern.Solid), Text(extent=  {{-150, -100}, {150, -60}}, textString=  "%name", lineColor=  {0, 0, 255}), Line(points=  {{0, 42}, {0, 26}}, color=  {0, 0, 255}, smooth=  Smooth.None, thickness=  0.5), Line(points=  {{0, 20}, {0, 4}}, color=  {0, 0, 255}, smooth=  Smooth.None, thickness=  0.5), Line(points=  {{0, -4}, {0, -20}}, color=  {0, 0, 255}, smooth=  Smooth.None, thickness=  0.5), Line(points=  {{0, -26}, {0, -42}}, color=  {0, 0, 255}, smooth=  Smooth.None, thickness=  0.5)}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
      end GlomerulusStrongAnionFiltration;

      model Sulphate2
        import HumMod;
        //extends Library.Interfaces.BaseModel;
        extends PhysiolibraryOld.Icons.Sulphate;
        PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment SO4Pool(
            initialSoluteMass=4.00254, stateName="SO4Pool.Mass")
          annotation (Placement(transformation(extent={{-64,14},{-44,34}})));
        PhysiolibraryOld.ConcentrationFlow.InputPump Diet
          annotation (Placement(transformation(extent={{-88,-4},{-68,16}})));
        PhysiolibraryOld.ConcentrationFlow.SolventFlowPump
          glomerulusPhosphateRate
          annotation (Placement(transformation(extent={{-2,14},{18,34}})));
        GlomerulusStrongAnionFiltration glomerulus annotation(Placement(transformation(extent = {{-28, 14}, {-8, 34}})));
        PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
          concentrationMeasure annotation (Placement(transformation(
              extent={{-10,-10},{10,10}},
              rotation=270,
              origin={-18,4})));
        Modelica.Blocks.Math.Gain gain(k = 1000) annotation(Placement(transformation(extent = {{-8, 2}, {-4, 6}})));
        PhysiolibraryOld.ConcentrationFlow.FlowMeasure flowMeasure
          annotation (Placement(transformation(extent={{18,34},{38,14}})));
        Modelica.Blocks.Math.Gain gain1(k = 0.5) annotation(Placement(transformation(extent = {{-52, -6}, {-48, -2}})));
        PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
            Placement(transformation(extent={{-96,76},{-84,88}}),
              iconTransformation(extent={{60,60},{100,100}})));
        PhysiolibraryOld.Blocks.Constant Constant7(k=50/1440)
          annotation (Placement(transformation(extent={{-88,20},{-80,28}})));
        PhysiolibraryOld.Factors.CurveValue LeptinEffect2(data={{0,3.0,0},{8,
              1.0,-0.04},{50,0.0,0}})
          annotation (Placement(transformation(extent={{-88,6},{-68,26}})));
        Real ECF_conc;
        HumMod.Electrolytes.Bladder bladder(stateVarName = "BladderSulphate.Mass") annotation(Placement(transformation(extent = {{64, 6}, {84, 26}})));
      equation
        ECF_conc = gain.y;
        connect(SO4Pool.SolventVolume, busConnector.ECFV_Vol) annotation(Line(points = {{-62, 30}, {-67, 30}, {-67, 82}, {-90, 82}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, 1}, {3, 1}}));
        connect(Diet.q_out, SO4Pool.q_out) annotation(Line(points = {{-72, 6}, {-60, 6}, {-60, 24}, {-54, 24}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(glomerulusPhosphateRate.solventFlow, busConnector.GlomerulusFiltrate_GFR) annotation(Line(points = {{8, 30}, {8, 82}, {-90, 82}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, 1}, {3, 1}}));
        connect(glomerulus.q_out, glomerulusPhosphateRate.q_in) annotation(Line(points = {{-8, 24}, {-2, 24}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(SO4Pool.q_out, glomerulus.q_in) annotation(Line(points = {{-54, 24}, {-28, 24}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(concentrationMeasure.actualConc, gain.u) annotation(Line(points = {{-14, 4}, {-11.2, 4}, {-11.2, 4}, {-8.4, 4}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(gain.y, busConnector.SO4Pool_conc_per_liter) annotation(Line(points = {{-3.8, 4}, {13.1, 4}, {13.1, 82}, {-90, 82}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, 1}, {3, 1}}));
        connect(concentrationMeasure.q_in, SO4Pool.q_out) annotation(Line(points = {{-18, 4}, {-36, 4}, {-36, 24}, {-54, 24}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(flowMeasure.actualFlow, busConnector.CD_SO4_Outflow) annotation(Line(points = {{28, 19}, {28, 82}, {-90, 82}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, 1}, {3, 1}}));
        connect(glomerulusPhosphateRate.q_out, flowMeasure.q_in) annotation(Line(points = {{18, 24}, {24, 24}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(busConnector.BloodIons_Cations, glomerulus.Cations) annotation(Line(points = {{-90, 82}, {-24, 82}, {-24, 29}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-3, 1}, {-3, 1}}));
        connect(gain1.y, busConnector.SO4Pool_Osmoles) annotation(Line(points = {{-47.8, -4}, {13.1, -4}, {13.1, 82}, {-90, 82}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, 1}, {3, 1}}));
        connect(gain1.u, SO4Pool.soluteMass) annotation(Line(points = {{-52.4, -4}, {-54, -4}, {-54, 16.2}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.Leptin, LeptinEffect2.u) annotation(Line(points = {{-90, 82}, {-96, 82}, {-96, 16}, {-87.8, 16}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(Constant7.y, LeptinEffect2.yBase) annotation(Line(points = {{-79.59999999999999, 24}, {-78, 24}, {-78, 18}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(LeptinEffect2.y, Diet.desiredFlow) annotation(Line(points = {{-78, 14}, {-78, 10}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.BloodIons_ProteinAnions, glomerulus.ProteinAnions) annotation(Line(points = {{-90, 82}, {-20, 82}, {-20, 29}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(flowMeasure.q_out, bladder.q_in) annotation(Line(points = {{32, 24}, {74, 24}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(bladder.busConnector, busConnector) annotation(Line(points = {{82, 24}, {82, 82}, {-90, 82}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Text(extent=  {{-110, -104}, {110, -130}}, lineColor=  {0, 0, 255}, textString=  "%name")}));
      end Sulphate2;
    end Sulphate;

    package NH4 "Body Amonium Distribution"
      model Amonium2
        //  extends Physiolibrary.Interfaces.BaseModel;
        extends PhysiolibraryOld.Icons.Amonium;
        PhysiolibraryOld.Factors.CurveValue AcuteEffect(data={{7.0,2.0,0},{7.45,
              1.0,-3.0},{7.8,0.0,0}})
          annotation (Placement(transformation(extent={{-60,52},{-40,72}})));
        PhysiolibraryOld.Factors.SplineDelayByDay ChronicEffect(
          Tau=3,
          data={{7.0,3.0,0},{7.45,1.0,-4.0},{7.8,0.0,0}},
          stateName="PT_NH3.ChronicPhEffect")
          annotation (Placement(transformation(extent={{-60,42},{-40,62}})));
        PhysiolibraryOld.Factors.CurveValue PhOnFlux(data={{7.0,1.0,0},{7.45,
              0.6,-2.0},{7.8,0.0,0}})
          annotation (Placement(transformation(extent={{-60,26},{-40,46}})));
        PhysiolibraryOld.Blocks.ElectrolytesFlowConstant
          electrolytesFlowConstant(k=0.04)
          annotation (Placement(transformation(extent={{-68,74},{-56,86}})));
        PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
            Placement(transformation(extent={{-98,42},{-86,54}}),
              iconTransformation(extent={{62,62},{100,100}})));
      equation
        connect(AcuteEffect.y, ChronicEffect.yBase) annotation(Line(points = {{-50, 60}, {-50, 54}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(ChronicEffect.y, PhOnFlux.yBase) annotation(Line(points = {{-50, 50}, {-50, 38}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(electrolytesFlowConstant.y, AcuteEffect.yBase) annotation(Line(points = {{-55.4, 80}, {-50, 80}, {-50, 64}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.Artys_pH, AcuteEffect.u) annotation(Line(points = {{-92, 48}, {-76, 48}, {-76, 62}, {-59.8, 62}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(PhOnFlux.y, busConnector.CD_NH4_Outflow) annotation(Line(points = {{-50, 34}, {-50, 26}, {-92, 26}, {-92, 48}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, -3}, {6, -3}}));
        connect(busConnector.Artys_pH, ChronicEffect.u) annotation(Line(points = {{-92, 48}, {-76, 48}, {-76, 52}, {-59.8, 52}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.Artys_pH, PhOnFlux.u) annotation(Line(points = {{-92, 48}, {-76, 48}, {-76, 36}, {-59.8, 36}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Text(extent=  {{-112, -102}, {108, -128}}, lineColor=  {0, 0, 255}, textString=  "%name")}), Documentation(revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr>
                   </table>
                   </html>"));
      end Amonium2;
    end NH4;

    model Electrolytes
      //extends QHP.Library.Interfaces.BaseModel;
      extends PhysiolibraryOld.Icons.Electrolytes;
      Sodium.Sodium sodium annotation(Placement(transformation(extent = {{-80, 60}, {-60, 80}})));
      Potassium.Potassium potassium annotation(Placement(transformation(extent = {{-44, 60}, {-24, 80}})));
      Chloride.Chloride2 chloride annotation(Placement(transformation(extent = {{-10, 60}, {10, 80}})));
      Phosphate.Phosphate3 phosphate annotation(Placement(transformation(extent = {{-44, 16}, {-24, 36}})));
      Sulphate.Sulphate2 sulphate annotation(Placement(transformation(extent = {{-10, 16}, {10, 36}})));
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{82,36},{106,60}}),
            iconTransformation(extent={{-120,20},{-80,60}})));
      ElectrolytesProperties electrolytesProperties annotation(Placement(transformation(extent = {{48, 18}, {68, 38}})));
      NH4.Amonium2 amonium annotation(Placement(transformation(extent = {{-86, 16}, {-66, 36}})));
    equation
      connect(sodium.busConnector, busConnector) annotation(Line(points = {{-62, 78}, {-62, 48}, {94, 48}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(busConnector, potassium.busConnector) annotation(Line(points = {{94, 48}, {-26, 48}, {-26, 78}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(busConnector, chloride.busConnector) annotation(Line(points = {{94, 48}, {8.1, 48}, {8.1, 78.09999999999999}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(busConnector, electrolytesProperties.busConnector) annotation(Line(points = {{94, 48}, {48, 48}, {48, 32}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(sulphate.busConnector, busConnector) annotation(Line(points = {{8, 34}, {8, 48}, {94, 48}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(phosphate.busConnector, busConnector) annotation(Line(points = {{-26, 34}, {-26, 48}, {94, 48}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(amonium.busConnector, busConnector) annotation(Line(points = {{-67.90000000000001, 34.1}, {-67.90000000000001, 48}, {94, 48}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent = {{-122, -58}, {120, -92}}, lineColor = {0, 0, 255}, textString = "%name")}), Documentation(revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr><tr>
                   <td></td>
                   <td>Noriaki Ikeda: A model of overall regulation of body fluids (1979), Kitasato University</td>
                   </tr>
                   </table>
                   </html>"));
    end Electrolytes;

    model ElectrolytesProperties
      //extends QHP.Library.Interfaces.BaseModel;
      extends PhysiolibraryOld.Icons.Electrolytes;
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{-104,88},{-86,106}}),
            iconTransformation(extent={{-120,20},{-80,60}})));
      PhysiolibraryOld.Blocks.OsmolarityConstant OsmCell_OtherCations(k=692)
        annotation (Placement(transformation(extent={{4,-72},{24,-52}})));
      PhysiolibraryOld.Blocks.OsmolarityConstant CellElectrolytesMass(k=1000)
        annotation (Placement(transformation(extent={{6,-96},{26,-76}})));
      Modelica.Blocks.Math.Add3 Cells(k3 = -1, k1 = 2, k2 = 2) annotation(Placement(transformation(extent = {{48, -68}, {68, -48}})));
      PhysiolibraryOld.Blocks.OsmolarityConstant OsmECFV_OtherAnions(k=373.0)
        annotation (Placement(transformation(extent={{-62,-12},{-42,8}})));
      Modelica.Blocks.Math.Sum ECF(nin = 8) annotation(Placement(transformation(extent = {{-24, 2}, {-4, 22}})));
      Modelica.Blocks.Math.Sum BloodCations(nin = 2) annotation(Placement(transformation(extent = {{-46, 54}, {-26, 74}})));
      Modelica.Blocks.Math.Feedback lessPO4 annotation(Placement(transformation(extent = {{76, 74}, {96, 54}})));
      Modelica.Blocks.Math.Feedback lessSO4 annotation(Placement(transformation(extent = {{76, 94}, {96, 74}})));
      Modelica.Blocks.Math.Add3 AnFlow annotation(Placement(transformation(extent = {{-80, -72}, {-60, -52}})));
      Modelica.Blocks.Math.Add3 CatFlow annotation(Placement(transformation(extent = {{-80, -44}, {-60, -24}})));
      Modelica.Blocks.Math.Feedback CollectingDuct_NetSumCats annotation(Placement(transformation(extent = {{-44, -44}, {-24, -24}})));
      Modelica.Blocks.Math.Sum StrongAnions(nin = 5) annotation(Placement(transformation(extent = {{-82, 70}, {-62, 90}})));
      Modelica.Blocks.Math.Feedback WeakAnions2 annotation(Placement(transformation(extent = {{-10, 10}, {10, -10}}, rotation = 0, origin = {28, 64})));
      Modelica.Blocks.Math.Feedback NBB(y(unit = "mEq/l"))
        "nonbicarbonate buffers"                                                    annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 0, origin = {50, 40})));
      Modelica.Blocks.Math.Feedback lessCl annotation(Placement(transformation(extent = {{78, 52}, {98, 32}})));
    equation
      connect(busConnector.KCell_Mass, Cells.u1) annotation(Line(points = {{-95, 97}, {-96, 97}, {-96, -86}, {-22, -86}, {-22, -50}, {46, -50}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(OsmCell_OtherCations.y, Cells.u2) annotation(Line(points = {{25, -62}, {28, -62}, {28, -58}, {46, -58}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(CellElectrolytesMass.y, Cells.u3) annotation(Line(points = {{27, -86}, {31.5, -86}, {31.5, -66}, {46, -66}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.NaPool_mass, ECF.u[1]) annotation(Line(points = {{-95, 97}, {-96, 98}, {-96, 12}, {-26, 12}, {-26, 10.25}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.KPool_mass, ECF.u[2]) annotation(Line(points = {{-95, 97}, {-96, 97}, {-96, 12}, {-26, 12}, {-26, 10.75}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.ClPool_mass, ECF.u[3]) annotation(Line(points = {{-95, 97}, {-95, 12}, {-26, 12}, {-26, 11.25}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(OsmECFV_OtherAnions.y, ECF.u[8]) annotation(Line(points = {{-41, -2}, {-26, -2}, {-26, 13.75}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.NaPool_conc_per_liter, BloodCations.u[1]) annotation(Line(points = {{-95, 97}, {-96, 64}, {-48, 64}, {-48, 63}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.KPool_conc_per_liter, BloodCations.u[2]) annotation(Line(points = {{-95, 97}, {-96, 97}, {-96, 66}, {-48, 66}, {-48, 65}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(lessSO4.y, busConnector.BloodIons_StrongAnionsLessSO4) annotation(Line(points = {{95, 84}, {100, 84}, {100, 97}, {-95, 97}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.BloodIons_StrongAnionsLessPO4, lessPO4.y) annotation(Line(points = {{-95, 97}, {100, 97}, {100, 64}, {95, 64}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.PO4Pool_conc_per_liter, lessPO4.u2) annotation(Line(points = {{-95, 97}, {100, 97}, {100, 72}, {86, 72}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.SO4Pool_conc_per_liter, lessSO4.u2) annotation(Line(points = {{-95, 97}, {86, 97}, {86, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(CollectingDuct_NetSumCats.y, busConnector.CollectingDuct_NetSumCats) annotation(Line(points = {{-25, -34}, {100, -34}, {100, 96}, {-96, 96}, {-96, 97}, {-95, 97}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(CatFlow.y, CollectingDuct_NetSumCats.u1) annotation(Line(points = {{-59, -34}, {-42, -34}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(AnFlow.y, CollectingDuct_NetSumCats.u2) annotation(Line(points = {{-59, -62}, {-34, -62}, {-34, -42}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.CD_NH4_Outflow, CatFlow.u1) annotation(Line(points = {{-95, 97}, {-96, 97}, {-96, -26}, {-82, -26}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.CD_PO4_Outflow, AnFlow.u2) annotation(Line(points = {{-95, 97}, {-96, 97}, {-96, -62}, {-82, -62}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.CD_SO4_Outflow, AnFlow.u3) annotation(Line(points = {{-95, 97}, {-96, 97}, {-96, -70}, {-82, -70}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(BloodCations.y, WeakAnions2.u1) annotation(Line(points = {{-25, 64}, {20, 64}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.PO4Pool_conc_per_liter, StrongAnions.u[2]) annotation(Line(points = {{-95, 97}, {-96, 97}, {-96, 79.2}, {-84, 79.2}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.SO4Pool_conc_per_liter, StrongAnions.u[3]) annotation(Line(points = {{-95, 97}, {-96, 80}, {-84, 80}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.ClPool_conc_per_liter, StrongAnions.u[5]) annotation(Line(points = {{-95, 97}, {-94, 97}, {-94, 80}, {-84, 80}, {-84, 81.59999999999999}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.PO4Pool_Osmoles, ECF.u[4]) annotation(Line(points = {{-95, 97}, {-96, 97}, {-96, 11.75}, {-26, 11.75}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.SO4Pool_Osmoles, ECF.u[5]) annotation(Line(points = {{-95, 97}, {-96, 97}, {-96, 12}, {-26, 12}, {-26, 12.25}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.LacPool_Mass_mEq, ECF.u[6]) annotation(Line(points = {{-95, 97}, {-96, 97}, {-96, 12}, {-26, 12}, {-26, 12.75}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(busConnector.LacPool_Lac_mEq_per_litre, StrongAnions.u[4]) annotation(Line(points = {{-95, 97}, {-95, 80.8}, {-84, 80.8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(ECF.y, busConnector.OsmECFV_Electrolytes) annotation(Line(points = {{-3, 12}, {14, 12}, {14, 28}, {-95, 28}, {-95, 97}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(Cells.y, busConnector.OsmCell_Electrolytes) annotation(Line(points = {{69, -58}, {100, -58}, {100, 96}, {-95, 96}, {-95, 97}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(busConnector.KAPool_conc_per_liter, StrongAnions.u[1]) annotation(Line(points = {{-95, 97}, {-95, 78.40000000000001}, {-84, 78.40000000000001}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(busConnector.CD_KA_Outflow, AnFlow.u1) annotation(Line(points = {{-95, 97}, {-96, 52}, {-96, -54}, {-82, -54}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.KAPool_Osmoles, ECF.u[7]) annotation(Line(points = {{-95, 97}, {-96, 97}, {-96, 12}, {-26, 12}, {-26, 13.25}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(BloodCations.y, busConnector.BloodIons_Cations) annotation(Line(points = {{-25, 64}, {10, 64}, {10, 96}, {-95, 96}, {-95, 97}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(busConnector.CD_Na_Outflow, CatFlow.u2) annotation(Line(points = {{-95, 97}, {-96, -34}, {-82, -34}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.CD_K_Outflow, CatFlow.u3) annotation(Line(points = {{-95, 97}, {-96, -42}, {-82, -42}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(BloodCations.y, busConnector.BloodCations) annotation(Line(points = {{-25, 64}, {10, 64}, {10, 97}, {-95, 97}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(StrongAnions.y, busConnector.BloodIons_StrongAnions) annotation(Line(points = {{-61, 80}, {100, 80}, {100, 97}, {-95, 97}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(StrongAnions.y, lessSO4.u1) annotation(Line(points = {{-61, 80}, {74, 80}, {74, 84}, {78, 84}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(StrongAnions.y, lessPO4.u1) annotation(Line(points = {{-61, 80}, {74, 80}, {74, 64}, {78, 64}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(StrongAnions.y, WeakAnions2.u2) annotation(Line(points = {{-61, 80}, {28, 80}, {28, 72}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(WeakAnions2.y, NBB.u1) annotation(Line(points = {{37, 64}, {46, 64}, {46, 40}, {42, 40}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.CO2Veins_cHCO3, NBB.u2) annotation(Line(points = {{-95, 97}, {-96, 68}, {-96, 32}, {50, 32}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.ClPool_conc_per_liter, lessCl.u2) annotation(Line(points = {{-95, 97}, {100, 97}, {100, 50}, {88, 50}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(StrongAnions.y, lessCl.u1) annotation(Line(points = {{-61, 80}, {74, 80}, {74, 42}, {80, 42}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(lessCl.y, busConnector.BloodIons_StrongAnionsLessCl) annotation(Line(points = {{97, 42}, {100, 42}, {100, 97}, {-95, 97}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(WeakAnions2.y, busConnector.BloodIons_SID) annotation(Line(points = {{37, 64}, {48, 64}, {48, 97}, {-95, 97}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-122, -58}, {120, -92}}, lineColor=  {0, 0, 255}, textString=  "%name")}), Documentation(revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr><tr>
                   <td></td>
                   <td>Noriaki Ikeda: A model of overall regulation of body fluids (1979), Kitasato University</td>
                   </tr>
                   </table>
                   </html>"));
    end ElectrolytesProperties;

    model SweatGlandSalt
      extends PhysiolibraryOld.Icons.SweatGland;
      parameter Real FractReabBasic = 0.8;
      parameter Real FractReabK = log(FractReabBasic) / 15.0;
      PhysiolibraryOld.Factors.CurveValue AldoEffect(data={{0,0.5,0.0},{12,1.0,
            0.03},{100,2.0,0.0}})
        annotation (Placement(transformation(extent={{-40,32},{-20,52}})));
      PhysiolibraryOld.Blocks.Constant Constant(k=1)
        annotation (Placement(transformation(extent={{-40,48},{-32,56}})));
      Modelica.Blocks.Math.Division division annotation(Placement(transformation(extent = {{-4, 32}, {16, 52}})));
      Modelica.Blocks.Math.Exp FractReab annotation(Placement(transformation(extent = {{26, 32}, {46, 52}})));
      Modelica.Blocks.Math.Product product annotation(Placement(transformation(extent = {{-48, 4}, {-28, 24}})));
      PhysiolibraryOld.Blocks.Constant Constant1(k=FractReabK)
        annotation (Placement(transformation(extent={{-72,4},{-64,12}})));
      Modelica.Blocks.Math.Product Reab annotation(Placement(transformation(extent = {{72, 26}, {92, 46}})));
      Modelica.Blocks.Math.Feedback Outflow annotation(Placement(transformation(extent = {{-10, 10}, {10, -10}}, rotation = 270, origin = {78, -12})));
      PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow salt
        annotation (Placement(transformation(extent={{-110,-70},{-90,-50}}),
            iconTransformation(extent={{-110,-70},{-90,-50}})));
      PhysiolibraryOld.ConcentrationFlow.OutputPump outputPump(desiredFlow(
            start=0))
        annotation (Placement(transformation(extent={{66,-72},{90,-48}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
        concentrationMeasure annotation (Placement(transformation(
            extent={{-10,-10},{10,10}},
            rotation=0,
            origin={2,-60})));
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{-88,76},{-76,88}}),
            iconTransformation(extent={{60,60},{100,100}})));
      Modelica.Blocks.Math.Product SaltInflow annotation(Placement(transformation(extent = {{16, -30}, {36, -10}})));
    equation
      connect(Constant.y, AldoEffect.yBase) annotation(Line(points = {{-31.6, 52}, {-30, 52}, {-30, 44}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(AldoEffect.y, division.u2) annotation(Line(points = {{-30, 40}, {-30, 36}, {-6, 36}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(division.y, FractReab.u) annotation(Line(points = {{17, 42}, {24, 42}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(product.y, division.u1) annotation(Line(points = {{-27, 14}, {-14, 14}, {-14, 48}, {-6, 48}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Constant1.y, product.u2) annotation(Line(points = {{-63.6, 8}, {-50, 8}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(FractReab.y, Reab.u1) annotation(Line(points = {{47, 42}, {70, 42}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Reab.y, Outflow.u2) annotation(Line(points = {{93, 36}, {100, 36}, {100, -12}, {86, -12}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(salt, outputPump.q_in) annotation(Line(points = {{-100, -60}, {70.8, -60}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(outputPump.desiredFlow, Outflow.y) annotation(Line(points = {{78, -55.2}, {78, -21}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(salt, concentrationMeasure.q_in) annotation(Line(points = {{-100, -60}, {2, -60}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(busConnector.Aldo_conc_in_nG_per_dl, AldoEffect.u) annotation(Line(points = {{-82, 82}, {-78, 82}, {-78, 42}, {-39.8, 42}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.SweatGland_H2ORate, product.u1) annotation(Line(points = {{-82, 82}, {-78, 82}, {-78, 20}, {-50, 20}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(concentrationMeasure.actualConc, SaltInflow.u2) annotation(Line(points = {{2, -56}, {2, -26}, {14, -26}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.SweatGland_H2ORate, SaltInflow.u1) annotation(Line(points = {{-82, 82}, {-80, 82}, {-80, -14}, {14, -14}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(SaltInflow.y, Reab.u2) annotation(Line(points = {{37, -20}, {54, -20}, {54, 30}, {70, 30}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(SaltInflow.y, Outflow.u1) annotation(Line(points = {{37, -20}, {54, -20}, {54, 2}, {78, 2}, {78, -4}}, color = {0, 0, 127}, smooth = Smooth.None));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
    end SweatGlandSalt;

    model Bladder
      extends PhysiolibraryOld.Icons.Bladder;
      parameter String stateVarName;
      PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment Bladder(
          initialSoluteMass=0, stateName=stateVarName)
        annotation (Placement(transformation(extent={{-12,-52},{8,-32}})));
      PhysiolibraryOld.ConcentrationFlow.SolventOutflowPump bladderVoid
        annotation (Placement(transformation(extent={{28,-48},{40,-36}})));
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{8,-28},{20,-16}}),
            iconTransformation(extent={{60,60},{100,100}})));
      PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow q_in
        annotation (Placement(transformation(extent={{0,0},{20,20}}),
            iconTransformation(extent={{-10,70},{10,90}})));
    equation
      connect(Bladder.SolventVolume, busConnector.BladderVolume_Mass) annotation(Line(points = {{-10, -36}, {-20, -36}, {-20, -22}, {14, -22}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(Bladder.q_out, bladderVoid.q_in) annotation(Line(points = {{-2, -42}, {28, -42}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(bladderVoid.solventFlow, busConnector.BladderVoidFlow) annotation(Line(points = {{34, -38.4}, {34, -22}, {14, -22}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(q_in, Bladder.q_out) annotation(Line(points = {{10, 10}, {-32, 10}, {-32, -42}, {-2, -42}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
    end Bladder;
    annotation(Documentation(revisions = "<html>
                   <table cellspacing=\"2\" cellpadding=\"0\" border=\"0\"><tr>
                   <td><p>Author:</p></td>
                   <td><p>Marek Matejak</p></td>
                   </tr>
                   <tr>
                   <td><p>Copyright:</p></td>
                   <td><p>In public domains</p></td>
                   </tr>
                   <tr>
                   <td><p>By:</p></td>
                   <td><p>Charles University, Prague</p></td>
                   </tr>
                   <tr>
                   <td><p>Date of:</p></td>
                   <td><p>2009-2013</p></td>
                   </tr>
                   <tr>
                   <td><p>References:</p></td>
                   <td><p>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</p></td>
                   </tr>
                   </table>
                   </html>"), Icon(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics));
  end Electrolytes;

  package Gases "Body O2 and CO2"
    extends PhysiolibraryOld.Icons.GasesLib;
    package O2 "Body O2 Transport"
      model O2
        //extends Library.Interfaces.BaseModel;
        extends PhysiolibraryOld.Icons.Oxygen;
        PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment artys(
            stateName="O2Artys.Mass[mMol]", initialSoluteMass=13.0979)
          annotation (Placement(transformation(extent={{60,-96},{80,-76}})));
        PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment veins(
            stateName="O2Veins.Mass[mMol]", initialSoluteMass=24.7781)
          annotation (Placement(transformation(extent={{-88,-54},{-68,-34}})));
        ExternalO2 air_O2(concentration = 21) annotation(Placement(transformation(extent = {{-40, 72}, {-20, 92}})));
        PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
            Placement(transformation(extent={{88,16},{108,36}}),
              iconTransformation(extent={{60,60},{100,100}})));
        RespiratoryRegulations.AlveolarVentilation alveolarVentilation(solventFlowPump(q_out(conc(start = 104 / 760)))) annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 0, origin = {-8, 50})));
        TissuesO2 tissuesO2(boneO2(O2Tissue(pO2(start = 7.706), cO2Hb(start = 5.915), a(start = 0.4183)), arty(q(start = 2.58114))), fatO2(O2Tissue(pO2(start = 9.066280000000001), cO2Hb(start = 6.72935), a(start = 0.40662)), arty(q(start = 1.9206))), otherTissueO2(O2Tissue(pO2(start = 9.50212), cO2Hb(start = 6.92105), a(start = 0.403818)), arty(q(start = 2.9876))), respiratoryMuscleO2(O2Tissue(pO2(start = 6.979), cO2Hb(start = 5.3182), a(start = 0.426692)), arty(q(start = 0.7824680000000001))), skinO2(O2Tissue(pO2(start = 5.32132), cO2Hb(start = 6.27243), a(start = 0.422803)), arty(q(start = 1.26465))), liverO2(O2Tissue(pO2(start = 4.12887), cO2Hb(start = 2.50865), a(start = 0.401361)), pCO2(start = 4.71942), hepaticArty(q(start = 1.96287))), brainO2(O2Tissue(pO2(start = 7.47591), cO2Hb(start = 5.73949), a(start = 0.420777)), arty(q(start = 6.50714))), GITractO2(O2Tissue(pO2(start = 10.0668), cO2Hb(start = 7.1305), a(start = 0.40072)), arty(q(start = 9.18834))), kidneyO2(O2Tissue(pO2(start = 10.0613), cO2Hb(start = 7.12884), a(start = 0.400742)), arty(q(start = 9.896940000000001))), leftHeartO2(O2Tissue(pO2(start = 3.579), cO2Hb(start = 1.59478), a(start = 0.476472)), arty(q(start = 1.48263))), rightHeartO2(O2Tissue(pO2(start = 3.41451), cO2Hb(start = 1.44372), a(start = 0.478421)), arty(q(start = 0.278399))), skeletalMuscleO2(arty(q(start = 5.12266)), O2Tissue(cO2Hb(start = 5.857), pO2(start = 8.33), a(start = 0.46)))) annotation(Placement(transformation(extent = {{-10, -96}, {10, -76}})));
        PhysiolibraryOld.ConcentrationFlow.SolventFlowPump pulmShortCircuit
          annotation (Placement(transformation(extent={{-16,-28},{4,-48}})));
        Modelica.Blocks.Math.Feedback pulmShortCircuitFlow annotation(Placement(transformation(extent = {{26, -64}, {6, -44}})));
        PhysiolibraryOld.PressureFlow.Gas_FromMLtoMMOL fromMLtoMMOL annotation (
           Placement(transformation(
              extent={{-8,-8},{8,8}},
              rotation=270,
              origin={-8,16})));
        MeassureBloodO2 artysO2(pO2(start = 13.459), cO2Hb(start = 7.82305), pCO2(start = 4.42803), a(start = -0.1)) annotation(Placement(transformation(extent = {{64, -20}, {84, 0}})));
        /**/
        MeassureBloodO2 veinsO2(pO2(start = 6.14), cO2Hb(start = 6.52), a(start = 0.076), pCO2(start = 6.4)) annotation(Placement(transformation(extent = {{-90, -18}, {-70, 2}})));
        /**/
        HumMod.Gases.O2.BloodO2_Siggaard O2Lung(pCO2(start = 5.7), pO2(start = 13.87), sO2CO(start = 0.977), q_in(q(start = 10)), a(start = -0.1), cO2Hb(start = 8.16), tO2(start = 8.161)) annotation(Placement(transformation(extent = {{-16, -18}, {4, 2}})));
        // sO2CO(start=0.951486),
        /**/
        Real x;
      initial equation
        //if Artys.STEADY then
        // Veins.soluteMass
        // x = -O2Lung.q_out.q;
        //   x = ((-O2Lung.q_out.q - tissuesO2.O2ToTissues)/O2Lung.BloodFlow)*Veins.SolventVolume;
        // end if;
      equation
        x = ((-O2Lung.q_out.q) - tissuesO2.O2ToTissues) / O2Lung.BloodFlow * veins.SolventVolume;
        connect(busConnector.ArtysVol, artys.SolventVolume) annotation(Line(points = {{98, 26}, {34, 26}, {34, -80}, {62, -80}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.VeinsVol, veins.SolventVolume) annotation(Line(points = {{98, 26}, {-100, 26}, {-100, -38}, {-86, -38}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(alveolarVentilation.inspired, air_O2.q_out) annotation(Line(points = {{-18, 58}, {-24, 58}, {-24, 64}, {-8, 64}, {-8, 82}, {-29.8, 82}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(air_O2.q_out, alveolarVentilation.expired) annotation(Line(points = {{-29.8, 82}, {-8, 82}, {-8, 64}, {6, 64}, {6, 58}, {2, 58}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(tissuesO2.q_in, artys.q_out) annotation(Line(points = {{12, -86}, {70, -86}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(tissuesO2.busConnector, busConnector) annotation(Line(points = {{-8.800000000000001, -76.8}, {-8.800000000000001, -74}, {34, -74}, {34, 26}, {98, 26}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(tissuesO2.q_out, veins.q_out) annotation(Line(points = {{-12, -86}, {-54, -86}, {-54, -44}, {-78, -44}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(pulmShortCircuitFlow.u1, busConnector.CardiacOutput) annotation(Line(points = {{24, -54}, {34, -54}, {34, 26}, {98, 26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(pulmShortCircuit.q_out, artys.q_out) annotation(Line(points = {{4, -38}, {14, -38}, {14, -18}, {70, -18}, {70, -86}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(pulmShortCircuit.solventFlow, pulmShortCircuitFlow.y) annotation(Line(points = {{-6, -44}, {-6, -54}, {7, -54}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.AlveolarVentilated_BloodFlow, pulmShortCircuitFlow.u2) annotation(Line(points = {{98, 26}, {-50, 26}, {-50, -14}, {-30, -14}, {-30, -62}, {16, -62}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(veins.q_out, pulmShortCircuit.q_in) annotation(Line(points = {{-78, -44}, {-78, -18}, {-24, -18}, {-24, -38}, {-16, -38}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(alveolarVentilation.alveolar, fromMLtoMMOL.q_ML) annotation(Line(points = {{-7.8, 40}, {-8, 40}, {-8, 24}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(busConnector.CO2Artys_pCO2, artysO2.pCO2_mmHg) annotation(Line(points = {{98, 26}, {34, 26}, {34, -4}, {65, -4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(artysO2.ctHb, busConnector.ctHb) annotation(Line(points = {{83, 0}, {104, 0}, {104, 26}, {98, 26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(artysO2.cDPG, busConnector.cDPG) annotation(Line(points = {{83, -4}, {104, -4}, {104, 26}, {98, 26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(artysO2.FMetHb, busConnector.FMetHb) annotation(Line(points = {{83, -8}, {104, -8}, {104, 26}, {98, 26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(artysO2.FHbF, busConnector.FHbF) annotation(Line(points = {{83, -12}, {104, -12}, {104, 26}, {98, 26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(artysO2.pCO_mmHg, busConnector.pCO) annotation(Line(points = {{83, -16}, {104, -16}, {104, 26}, {98, 26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(busConnector.Artys_pH, artysO2.pH) annotation(Line(points = {{98, 26}, {34, 26}, {34, 0}, {65, 0}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.core_T, artysO2.T) annotation(Line(points = {{98, 26}, {34, 26}, {34, -8}, {65, -8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(artys.q_out, artysO2.q_in) annotation(Line(points = {{70, -86}, {70, -18}, {74, -18}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(veinsO2.ctHb, busConnector.ctHb) annotation(Line(points = {{-71, 2}, {-50, 2}, {-50, 26}, {98, 26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(veinsO2.cDPG, busConnector.cDPG) annotation(Line(points = {{-71, -2}, {-50, -2}, {-50, 26}, {98, 26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(veinsO2.FMetHb, busConnector.FMetHb) annotation(Line(points = {{-71, -6}, {-50, -6}, {-50, 26}, {98, 26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(veinsO2.FHbF, busConnector.FHbF) annotation(Line(points = {{-71, -10}, {-50, -10}, {-50, 26}, {98, 26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(veinsO2.pCO_mmHg, busConnector.pCO) annotation(Line(points = {{-71, -14}, {-50, -14}, {-50, 26}, {98, 26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(busConnector.CO2Veins_pCO2, veinsO2.pCO2_mmHg) annotation(Line(points = {{98, 26}, {-100, 26}, {-100, -2}, {-89, -2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.Veins_pH, veinsO2.pH) annotation(Line(points = {{98, 26}, {-100, 26}, {-100, 2}, {-89, 2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.core_T, veinsO2.T) annotation(Line(points = {{98, 26}, {-100, 26}, {-100, -6}, {-89, -6}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(veins.q_out, veinsO2.q_in) annotation(Line(points = {{-78, -44}, {-78, -16}, {-80, -16}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(busConnector.O2Veins_sO2, veinsO2.sO2) annotation(Line(points = {{98, 26}, {-100, 26}, {-100, -26}, {-80, -26}, {-80, -20}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-3, -3}, {-3, -3}}));
        connect(artysO2.sO2, busConnector.O2Artys_sO2) annotation(Line(points = {{74, -22}, {74, -28}, {104, -28}, {104, 26}, {98, 26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, -3}, {3, -3}}));
        connect(artysO2.PO2, busConnector.O2Artys_PO2) annotation(Line(points = {{78, -22}, {104, -22}, {104, 26}, {98, 26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(busConnector.CO2Lung_pCO2, O2Lung.pCO2_mmHg) annotation(Line(points = {{98, 26}, {-50, 26}, {-50, -2}, {-15, -2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(O2Lung.ctHb, busConnector.ctHb) annotation(Line(points = {{3, 2}, {34, 2}, {34, 26}, {98, 26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(O2Lung.cDPG, busConnector.cDPG) annotation(Line(points = {{3, -2}, {34, -2}, {34, 26}, {98, 26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(O2Lung.FMetHb, busConnector.FMetHb) annotation(Line(points = {{3, -6}, {34, -6}, {34, 26}, {98, 26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(O2Lung.FHbF, busConnector.FHbF) annotation(Line(points = {{3, -10}, {34, -10}, {34, 26}, {98, 26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(O2Lung.pCO_mmHg, busConnector.pCO) annotation(Line(points = {{3, -14}, {34, -14}, {34, 26}, {98, 26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(busConnector.AlveolarVentilated_BloodFlow, O2Lung.BloodFlow) annotation(Line(points = {{98, 26}, {-50, 26}, {-50, -14}, {-15, -14}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(O2Lung.sO2, busConnector.O2Lung_sO2) annotation(Line(points = {{-6, -20}, {-6, -26}, {34, -26}, {34, 26}, {98, 26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, -3}, {6, -3}}));
        connect(busConnector.core_T, O2Lung.T) annotation(Line(points = {{98, 26}, {-50, 26}, {-50, -6}, {-15, -6}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(veins.q_out, O2Lung.q_in) annotation(Line(points = {{-78, -44}, {-78, -18}, {-16, -18}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(O2Lung.q_out, artys.q_out) annotation(Line(points = {{4, -18}, {70, -18}, {70, -86}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(fromMLtoMMOL.q_MMOL, O2Lung.alveolar) annotation(Line(points = {{-8, 8}, {-8, 2}, {-6, 2}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(busConnector.BarometerPressure, alveolarVentilation.EnvironmentPressure) annotation(Line(points = {{98, 26}, {-50, 26}, {-50, 48}, {-16, 48}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.lungs_pH_plasma, O2Lung.pH) annotation(Line(points = {{98, 26}, {-50, 26}, {-50, 2}, {-15, 2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(alveolarVentilation.AlveolarVentilation_STPD, busConnector.AlveolarVentilation_STPD) annotation(Line(points = {{0, 52}, {34, 52}, {34, 26}, {98, 26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(alveolarVentilation.BronchiDilution, busConnector.BronchiDilution) annotation(Line(points = {{0, 46}, {34, 46}, {34, 26}, {98, 26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(fromMLtoMMOL.T, busConnector.core_T) annotation(Line(points = {{-0.08, 16.24}, {12, 16.24}, {12, 26}, {98, 26}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-120, -62}, {122, -96}}, lineColor=  {0, 0, 255}, textString=  "%name")}), Documentation(revisions = "<html>
                   <table cellspacing=\"2\" cellpadding=\"0\" border=\"0\"><tr>
                   <td><p>Author:</p></td>
                   <td><p>Marek Matejak</p></td>
                   </tr>
                   <tr>
                   <td><p>Copyright:</p></td>
                   <td><p>In public domains</p></td>
                   </tr>
                   <tr>
                   <td><p>By:</p></td>
                   <td><p>Charles University, Prague</p></td>
                   </tr>
                   <tr>
                   <td><p>Date of:</p></td>
                   <td><p>2009</p></td>
                   </tr>
                   <tr>
                   <td><p>References:</p></td>
                   <td>Siggaard Andersen: OSA (2005), University of Copenhagen</td>
                   </tr>
                   <tr>
                   <td></td>
                   <td><p>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</p></td>
                   </tr>
                   </table>
                   </html>"));
      end O2;

      model TissuesO2
        extends PhysiolibraryOld.Icons.Tissues;
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow q_in
          annotation (Placement(transformation(extent={{80,-20},{120,20}}),
              iconTransformation(extent={{100,-20},{140,20}})));
        PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow q_out
          annotation (Placement(transformation(extent={{-120,-20},{-80,20}}),
              iconTransformation(extent={{-140,-20},{-100,20}})));
        tissues.SkeletalMuscleO2 skeletalMuscleO2(initialMass = 323.9) annotation(Placement(transformation(extent = {{-54, 64}, {-34, 84}})));
        tissues.BoneO2 boneO2(initialMass = 56.2) annotation(Placement(transformation(extent = {{-54, 36}, {-34, 56}})));
        tissues.FatO2 fatO2(initialMass = 39.8) annotation(Placement(transformation(extent = {{-54, -54}, {-34, -34}})));
        tissues.BrainO2 brainO2(initialMass = 19.1) annotation(Placement(transformation(extent = {{52, 20}, {72, 40}})));
        tissues.RightHeartO2 rightHeartO2(initialMass = 0.6) annotation(Placement(transformation(extent = {{52, -100}, {72, -80}})));
        tissues.RespiratoryMuscleO2 respiratoryMuscleO2(initialMass = 48.1) annotation(Placement(transformation(extent = {{-54, -24}, {-34, -4}})));
        tissues.OtherTissueO2 otherTissueO2(initialMass = 50.7) annotation(Placement(transformation(extent = {{-54, 6}, {-34, 26}})));
        tissues.TissueO2_liver2 liverO2(initialMass = 22.8) annotation(Placement(transformation(extent = {{52, 50}, {72, 70}})));
        tissues.LeftHeartO2 leftHeartO2(initialMass = 3.5) annotation(Placement(transformation(extent = {{52, -70}, {72, -50}})));
        HumMod.Gases.O2.tissues.TissueO2_kidney kidneyO2(initialMass = 4.1) annotation(Placement(transformation(extent = {{52, -40}, {72, -20}})));
        tissues.GITractO2 GITractO2(initialMass = 17.6) annotation(Placement(transformation(extent = {{52, -10}, {72, 10}})));
        PhysiolibraryOld.Interfaces.BusConnector busConnector
          annotation (Placement(transformation(extent={{-108,72},{-68,112}})));
        tissues.SkinO2 skinO2(initialMass = 28.2) annotation(Placement(transformation(extent = {{-54, -84}, {-34, -64}})));
        Real O2ToTissues(unit = "mmol/min");
        Real O2ToTissues2(unit = "mmol/min");
        Real O2ToTissues3(unit = "ml/min");
        Real BloodFlow(unit = "ml/min");
      equation
        O2ToTissues = q_in.q + q_out.q;
        O2ToTissues2 = skeletalMuscleO2.O2Use_mmol_per_min + boneO2.O2Use_mmol_per_min + fatO2.O2Use_mmol_per_min + brainO2.O2Use_mmol_per_min + rightHeartO2.O2Use_mmol_per_min + respiratoryMuscleO2.O2Use_mmol_per_min + otherTissueO2.O2Use_mmol_per_min + liverO2.O2Use_mmol_per_min + leftHeartO2.O2Use_mmol_per_min + kidneyO2.O2Use_mmol_per_min + GITractO2.O2Use_mmol_per_min + skinO2.O2Use_mmol_per_min;
        O2ToTissues3 = skeletalMuscleO2.O2Use_ml_per_min + boneO2.O2Use_ml_per_min + fatO2.O2Use_ml_per_min + brainO2.O2Use_ml_per_min + rightHeartO2.O2Use_ml_per_min + respiratoryMuscleO2.O2Use_ml_per_min + otherTissueO2.O2Use_ml_per_min + liverO2.O2Use_ml_per_min + leftHeartO2.O2Use_ml_per_min + kidneyO2.O2Use_ml_per_min + GITractO2.O2Use_ml_per_min + skinO2.O2Use_ml_per_min;
        BloodFlow = skeletalMuscleO2.BloodFlow + boneO2.BloodFlow + fatO2.BloodFlow + brainO2.BloodFlow + rightHeartO2.BloodFlow + respiratoryMuscleO2.BloodFlow + otherTissueO2.BloodFlow + liverO2.HepaticArtyBloodFlow + leftHeartO2.BloodFlow + kidneyO2.BloodFlow + GITractO2.BloodFlow + skinO2.BloodFlow;
        connect(q_out, skeletalMuscleO2.vein) annotation(Line(points = {{-100, 0}, {-82, 0}, {-82, 76}, {-54, 76}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(q_out, boneO2.vein) annotation(Line(points = {{-100, 0}, {-82, 0}, {-82, 48}, {-54, 48}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(q_out, otherTissueO2.vein) annotation(Line(points = {{-100, 0}, {-82, 0}, {-82, 18}, {-54, 18}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(q_out, respiratoryMuscleO2.vein) annotation(Line(points = {{-100, 0}, {-81, 0}, {-81, -12}, {-54, -12}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(q_out, fatO2.vein) annotation(Line(points = {{-100, 0}, {-82, 0}, {-82, -42}, {-54, -42}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(q_out, skinO2.vein) annotation(Line(points = {{-100, 0}, {-82, 0}, {-82, -72}, {-54, -72}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(q_out, liverO2.vein) annotation(Line(points = {{-100, 0}, {-82, 0}, {-82, 62}, {52, 62}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(q_out, brainO2.vein) annotation(Line(points = {{-100, 0}, {-82, 0}, {-82, 32}, {52, 32}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(q_out, kidneyO2.vein) annotation(Line(points = {{-100, 0}, {-82, 0}, {-82, -28}, {52, -28}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(q_out, leftHeartO2.vein) annotation(Line(points = {{-100, 0}, {-82, 0}, {-82, -58}, {52, -58}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(skeletalMuscleO2.arty, q_in) annotation(Line(points = {{-34, 76}, {84, 76}, {84, 0}, {100, 0}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(brainO2.arty, q_in) annotation(Line(points = {{72, 32}, {84, 32}, {84, 0}, {100, 0}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(GITractO2.arty, q_in) annotation(Line(points = {{72, 2}, {86, 2}, {86, 0}, {100, 0}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(kidneyO2.arty, q_in) annotation(Line(points = {{72, -28}, {84, -28}, {84, 0}, {100, 0}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(leftHeartO2.arty, q_in) annotation(Line(points = {{72, -58}, {84, -58}, {84, 0}, {100, 0}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(rightHeartO2.arty, q_in) annotation(Line(points = {{72, -88}, {84, -88}, {84, 0}, {100, 0}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(rightHeartO2.vein, q_out) annotation(Line(points = {{52, -88}, {-82, -88}, {-82, 0}, {-100, 0}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(boneO2.arty, q_in) annotation(Line(points = {{-34, 48}, {84, 48}, {84, 0}, {100, 0}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(otherTissueO2.arty, q_in) annotation(Line(points = {{-34, 18}, {84, 18}, {84, 0}, {100, 0}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(fatO2.arty, q_in) annotation(Line(points = {{-34, -42}, {84, -42}, {84, 0}, {100, 0}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(skinO2.arty, q_in) annotation(Line(points = {{-34, -72}, {84, -72}, {84, 0}, {100, 0}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(q_in, respiratoryMuscleO2.arty) annotation(Line(points = {{100, 0}, {84, 0}, {84, -12}, {-34, -12}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(busConnector.cDPG, boneO2.cDPG) annotation(Line(points = {{-88, 92}, {-88, 56}, {-53, 56}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.cDPG, brainO2.cDPG) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 40}, {53, 40}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.cDPG, fatO2.cDPG) annotation(Line(points = {{-88, 92}, {-88, -34}, {-53, -34}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.cDPG, GITractO2.cDPG) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 10}, {53, 10}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.cDPG, kidneyO2.cDPG) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -20}, {53, -20}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.cDPG, leftHeartO2.cDPG) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -50}, {53, -50}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.cDPG, liverO2.cDPG) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 70}, {53, 70}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.cDPG, otherTissueO2.cDPG) annotation(Line(points = {{-88, 92}, {-88, 26}, {-53, 26}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.cDPG, respiratoryMuscleO2.cDPG) annotation(Line(points = {{-88, 92}, {-88, -4}, {-53, -4}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.cDPG, rightHeartO2.cDPG) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -80}, {53, -80}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.cDPG, skinO2.cDPG) annotation(Line(points = {{-88, 92}, {-88, -64}, {-53, -64}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.cDPG, skeletalMuscleO2.cDPG) annotation(Line(points = {{-88, 92}, {-87.5, 92}, {-87.5, 84}, {-53, 84}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.FHbF, boneO2.FHbF) annotation(Line(points = {{-88, 92}, {-88, 40}, {-53, 40}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.FHbF, brainO2.FHbF) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 24}, {53, 24}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.FHbF, fatO2.FHbF) annotation(Line(points = {{-88, 92}, {-88, -50}, {-53, -50}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.FHbF, GITractO2.FHbF) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -6}, {53, -6}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.FHbF, kidneyO2.FHbF) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -36}, {53, -36}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.FHbF, leftHeartO2.FHbF) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -66}, {53, -66}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.FHbF, liverO2.FHbF) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 54}, {53, 54}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.FHbF, otherTissueO2.FHbF) annotation(Line(points = {{-88, 92}, {-88, 10}, {-53, 10}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.FHbF, respiratoryMuscleO2.FHbF) annotation(Line(points = {{-88, 92}, {-88, -20}, {-53, -20}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.FHbF, rightHeartO2.FHbF) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -96}, {53, -96}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.FHbF, skinO2.FHbF) annotation(Line(points = {{-88, 92}, {-88, -80}, {-53, -80}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.FHbF, skeletalMuscleO2.FHbF) annotation(Line(points = {{-88, 92}, {-87.5, 92}, {-87.5, 68}, {-53, 68}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.bone_pCO2, boneO2.pCO2) annotation(Line(points = {{-88, 92}, {-88, 36}, {-53, 36}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.brain_pCO2, brainO2.pCO2) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 20}, {53, 20}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.fat_pCO2, fatO2.pCO2) annotation(Line(points = {{-88, 92}, {-88, -54}, {-53, -54}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.GITract_pCO2, GITractO2.pCO2) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -10}, {53, -10}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.kidney_pCO2, kidneyO2.pCO2) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -40}, {53, -40}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.leftHeart_pCO2, leftHeartO2.pCO2) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -70}, {53, -70}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.liver_pCO2, liverO2.pCO2) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 50}, {53, 50}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.otherTissue_pCO2, otherTissueO2.pCO2) annotation(Line(points = {{-88, 92}, {-88, 6}, {-53, 6}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.respiratoryMuscle_pCO2, respiratoryMuscleO2.pCO2) annotation(Line(points = {{-88, 92}, {-88, -24}, {-53, -24}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.rightHeart_pCO2, rightHeartO2.pCO2) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -100}, {53, -100}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.skin_pCO2, skinO2.pCO2) annotation(Line(points = {{-88, 92}, {-88, -84}, {-53, -84}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.skeletalMuscle_pCO2, skeletalMuscleO2.pCO2) annotation(Line(points = {{-88, 92}, {-87.5, 92}, {-87.5, 64}, {-53, 64}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.ctHb, boneO2.ctHb) annotation(Line(points = {{-88, 92}, {-88, 44}, {-53, 44}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.ctHb, brainO2.ctHb) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 28}, {53, 28}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.ctHb, fatO2.ctHb) annotation(Line(points = {{-88, 92}, {-88, -46}, {-53, -46}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.ctHb, GITractO2.ctHb) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -2}, {53, -2}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.ctHb, kidneyO2.ctHb) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -32}, {53, -32}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.ctHb, leftHeartO2.ctHb) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -62}, {53, -62}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.ctHb, liverO2.ctHb) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 58}, {53, 58}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.ctHb, otherTissueO2.ctHb) annotation(Line(points = {{-88, 92}, {-88, 14}, {-53, 14}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.ctHb, respiratoryMuscleO2.ctHb) annotation(Line(points = {{-88, 92}, {-88, -16}, {-53, -16}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.ctHb, rightHeartO2.ctHb) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -92}, {53, -92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.ctHb, skinO2.ctHb) annotation(Line(points = {{-88, 92}, {-88, -76}, {-53, -76}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.ctHb, skeletalMuscleO2.ctHb) annotation(Line(points = {{-88, 92}, {-87.5, 92}, {-87.5, 72}, {-53, 72}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.pCO, boneO2.pCO) annotation(Line(points = {{-88, 92}, {-87.5, 92}, {-87.5, 52}, {-53, 52}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.pCO, brainO2.pCO) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 36}, {53, 36}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.pCO, fatO2.pCO) annotation(Line(points = {{-88, 92}, {-88, -38}, {-53, -38}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.pCO, GITractO2.pCO) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 6}, {53, 6}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.pCO, kidneyO2.pCO) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -24}, {53, -24}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.pCO, leftHeartO2.pCO) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -54}, {53, -54}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.pCO, liverO2.pCO) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 66}, {53, 66}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.pCO, otherTissueO2.pCO) annotation(Line(points = {{-88, 92}, {-88, 22}, {-53, 22}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.pCO, respiratoryMuscleO2.pCO) annotation(Line(points = {{-88, 92}, {-88, -8}, {-53, -8}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.pCO, rightHeartO2.pCO) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -84}, {53, -84}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.pCO, skinO2.pCO) annotation(Line(points = {{-88, 92}, {-88, -68}, {-53, -68}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(busConnector.pCO, skeletalMuscleO2.pCO) annotation(Line(points = {{-88, 92}, {-87.5, 92}, {-87.5, 80}, {-53, 80}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
        connect(boneO2.pH_plasma, busConnector.bone_pH_plasma) annotation(Line(points = {{-35, 56}, {6, 56}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(brainO2.pH_plasma, busConnector.brain_pH_plasma) annotation(Line(points = {{71, 40}, {98, 40}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(fatO2.pH_plasma, busConnector.fat_pH_plasma) annotation(Line(points = {{-35, -34}, {6, -34}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(GITractO2.pH_plasma, busConnector.GITract_pH_plasma) annotation(Line(points = {{71, 10}, {98, 10}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(kidneyO2.pH_plasma, busConnector.kidney_pH_plasma) annotation(Line(points = {{71, -20}, {98, -20}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(leftHeartO2.pH_plasma, busConnector.leftHeart_pH_plasma) annotation(Line(points = {{71, -50}, {98, -50}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(liverO2.pH_plasma, busConnector.liver_pH_plasma) annotation(Line(points = {{71, 70}, {98, 70}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(otherTissueO2.pH_plasma, busConnector.otherTissue_pH_plasma) annotation(Line(points = {{-35, 26}, {6, 26}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(respiratoryMuscleO2.pH_plasma, busConnector.respiratoryMuscle_pH_plasma) annotation(Line(points = {{-35, -4}, {6, -4}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(rightHeartO2.pH_plasma, busConnector.rightHeart_pH_plasma) annotation(Line(points = {{71, -80}, {98, -80}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(skinO2.pH_plasma, busConnector.skin_pH_plasma) annotation(Line(points = {{-35, -64}, {6, -64}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(skeletalMuscleO2.pH_plasma, busConnector.skeletalMuscle_pH_plasma) annotation(Line(points = {{-35, 84}, {5.5, 84}, {5.5, 92}, {-88, 92}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(boneO2.FMetHb, busConnector.FMetHb) annotation(Line(points = {{-35, 52}, {6, 52}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(brainO2.FMetHb, busConnector.FMetHb) annotation(Line(points = {{71, 36}, {98, 36}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(fatO2.FMetHb, busConnector.FMetHb) annotation(Line(points = {{-35, -38}, {6, -38}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(GITractO2.FMetHb, busConnector.FMetHb) annotation(Line(points = {{71, 6}, {98, 6}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(kidneyO2.FMetHb, busConnector.FMetHb) annotation(Line(points = {{71, -24}, {98, -24}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(leftHeartO2.FMetHb, busConnector.FMetHb) annotation(Line(points = {{71, -54}, {98, -54}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(liverO2.FMetHb, busConnector.FMetHb) annotation(Line(points = {{71, 66}, {98, 66}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(otherTissueO2.FMetHb, busConnector.FMetHb) annotation(Line(points = {{-35, 22}, {6, 22}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(respiratoryMuscleO2.FMetHb, busConnector.FMetHb) annotation(Line(points = {{-35, -8}, {6, -8}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(rightHeartO2.FMetHb, busConnector.FMetHb) annotation(Line(points = {{71, -84}, {98, -84}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(skinO2.FMetHb, busConnector.FMetHb) annotation(Line(points = {{-35, -68}, {6, -68}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(skeletalMuscleO2.FMetHb, busConnector.FMetHb) annotation(Line(points = {{-35, 80}, {5.5, 80}, {5.5, 92}, {-88, 92}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(boneO2.Tissue_O2Use, busConnector.bone_O2Use) annotation(Line(points = {{-35, 44}, {6, 44}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(brainO2.Tissue_O2Use, busConnector.brain_O2Use) annotation(Line(points = {{71, 28}, {98, 28}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(fatO2.Tissue_O2Use, busConnector.fat_O2Use) annotation(Line(points = {{-35, -46}, {6, -46}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(GITractO2.Tissue_O2Use, busConnector.GITract_O2Use) annotation(Line(points = {{71, -2}, {98, -2}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(kidneyO2.Tissue_O2Use, busConnector.kidney_O2Use) annotation(Line(points = {{71, -32}, {98, -32}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(leftHeartO2.Tissue_O2Use, busConnector.leftHeart_O2Use) annotation(Line(points = {{71, -62}, {98, -62}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(liverO2.Tissue_O2Use, busConnector.liver_O2Use) annotation(Line(points = {{71, 58}, {98, 58}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(otherTissueO2.Tissue_O2Use, busConnector.otherTissue_O2Use) annotation(Line(points = {{-35, 14}, {6, 14}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(respiratoryMuscleO2.Tissue_O2Use, busConnector.respiratoryMuscle_O2Use) annotation(Line(points = {{-35, -16}, {6, -16}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(rightHeartO2.Tissue_O2Use, busConnector.rightHeart_O2Use) annotation(Line(points = {{71, -92}, {98, -92}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(skinO2.Tissue_O2Use, busConnector.skin_O2Use) annotation(Line(points = {{-35, -76}, {6, -76}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(skeletalMuscleO2.Tissue_O2Use, busConnector.skeletalMuscle_O2Use) annotation(Line(points = {{-35, 72}, {5.5, 72}, {5.5, 92}, {-88, 92}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(boneO2.BloodFlow, busConnector.bone_BloodFlow) annotation(Line(points = {{-35, 36}, {6, 36}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(brainO2.BloodFlow, busConnector.brain_BloodFlow) annotation(Line(points = {{71, 20}, {98, 20}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(fatO2.BloodFlow, busConnector.fat_BloodFlow) annotation(Line(points = {{-35, -54}, {6, -54}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(GITractO2.BloodFlow, busConnector.GITract_BloodFlow) annotation(Line(points = {{71, -10}, {98, -10}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(kidneyO2.BloodFlow, busConnector.kidney_BloodFlow) annotation(Line(points = {{71, -40}, {98, -40}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(leftHeartO2.BloodFlow, busConnector.leftHeart_BloodFlow) annotation(Line(points = {{71, -70}, {98, -70}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(otherTissueO2.BloodFlow, busConnector.otherTissue_BloodFlow) annotation(Line(points = {{-35, 6}, {6, 6}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(respiratoryMuscleO2.BloodFlow, busConnector.respiratoryMuscle_BloodFlow) annotation(Line(points = {{-35, -24}, {6, -24}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(rightHeartO2.BloodFlow, busConnector.rightHeart_BloodFlow) annotation(Line(points = {{71, -100}, {98, -100}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(skinO2.BloodFlow, busConnector.skin_BloodFlow) annotation(Line(points = {{-35, -84}, {6, -84}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(skeletalMuscleO2.BloodFlow, busConnector.skeletalMuscle_BloodFlow) annotation(Line(points = {{-35, 64}, {5.5, 64}, {5.5, 92}, {-88, 92}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(boneO2.T, busConnector.bone_T) annotation(Line(points = {{-35, 40}, {6, 40}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(brainO2.T, busConnector.brain_T) annotation(Line(points = {{71, 24}, {98, 24}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(fatO2.T, busConnector.fat_T) annotation(Line(points = {{-35, -50}, {6, -50}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(GITractO2.T, busConnector.GITract_T) annotation(Line(points = {{71, -6}, {98, -6}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(kidneyO2.T, busConnector.kidney_T) annotation(Line(points = {{71, -36}, {98, -36}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(leftHeartO2.T, busConnector.leftHeart_T) annotation(Line(points = {{71, -66}, {98, -66}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(liverO2.T, busConnector.liver_T) annotation(Line(points = {{71, 54}, {98, 54}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(otherTissueO2.T, busConnector.otherTissue_T) annotation(Line(points = {{-35, 10}, {6, 10}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(respiratoryMuscleO2.T, busConnector.respiratoryMuscle_T) annotation(Line(points = {{-35, -20}, {6, -20}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(rightHeartO2.T, busConnector.rightHeart_T) annotation(Line(points = {{71, -96}, {98, -96}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(skinO2.T, busConnector.skin_T) annotation(Line(points = {{-35, -80}, {6, -80}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(skeletalMuscleO2.T, busConnector.skeletalMuscle_T) annotation(Line(points = {{-35, 68}, {5.5, 68}, {5.5, 92}, {-88, 92}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
        connect(boneO2.sO2, busConnector.bone_sO2) annotation(Line(points = {{-44, 35}, {6, 35}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
        connect(brainO2.sO2, busConnector.brain_sO2) annotation(Line(points = {{62, 19}, {98, 19}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
        connect(fatO2.sO2, busConnector.fat_sO2) annotation(Line(points = {{-44, -55}, {6, -55}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
        connect(GITractO2.sO2, busConnector.GITract_sO2) annotation(Line(points = {{62, -11}, {98, -11}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
        connect(kidneyO2.sO2, busConnector.kidney_sO2) annotation(Line(points = {{62, -41}, {98, -41}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
        connect(leftHeartO2.sO2, busConnector.leftHeart_sO2) annotation(Line(points = {{62, -71}, {98, -71}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
        connect(liverO2.sO2, busConnector.liver_sO2) annotation(Line(points = {{62, 49}, {98, 49}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
        connect(otherTissueO2.sO2, busConnector.otherTissue_sO2) annotation(Line(points = {{-44, 5}, {6, 5}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
        connect(respiratoryMuscleO2.sO2, busConnector.respiratoryMuscle_sO2) annotation(Line(points = {{-44, -25}, {6, -25}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
        connect(rightHeartO2.sO2, busConnector.rightHeart_sO2) annotation(Line(points = {{62, -101}, {98, -101}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
        connect(skinO2.sO2, busConnector.skin_sO2) annotation(Line(points = {{-44, -85}, {6, -85}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
        connect(skeletalMuscleO2.sO2, busConnector.skeletalMuscle_sO2) annotation(Line(points = {{-44, 63}, {5.5, 63}, {5.5, 92}, {-88, 92}}, color = {127, 0, 0}, smooth = Smooth.None));
        connect(boneO2.pO2, busConnector.Bone_PO2) annotation(Line(points = {{-46, 35}, {6, 35}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
        connect(brainO2.pO2, busConnector.Brain_PO2) annotation(Line(points = {{60, 19}, {98, 19}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
        connect(fatO2.pO2, busConnector.Fat_PO2) annotation(Line(points = {{-46, -55}, {6, -55}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
        connect(GITractO2.pO2, busConnector.GITract_PO2) annotation(Line(points = {{60, -11}, {98, -11}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
        connect(kidneyO2.pO2, busConnector.Kidney_PO2) annotation(Line(points = {{60, -41}, {98, -41}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
        connect(leftHeartO2.pO2, busConnector.LeftHeart_PO2) annotation(Line(points = {{60, -71}, {98, -71}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
        connect(liverO2.pO2, busConnector.Liver_PO2) annotation(Line(points = {{60, 49}, {98, 49}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
        connect(otherTissueO2.pO2, busConnector.OtherTissue_PO2) annotation(Line(points = {{-46, 5}, {6, 5}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
        connect(respiratoryMuscleO2.pO2, busConnector.RespiratoryMuscle_PO2) annotation(Line(points = {{-46, -25}, {6, -25}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
        connect(rightHeartO2.pO2, busConnector.RightHeart_PO2) annotation(Line(points = {{60, -101}, {98, -101}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
        connect(skinO2.pO2, busConnector.Skin_PO2) annotation(Line(points = {{-46, -85}, {6, -85}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
        connect(skeletalMuscleO2.pO2, busConnector.SkeletalMuscle_PO2) annotation(Line(points = {{-46, 63}, {5.5, 63}, {5.5, 92}, {-88, 92}}, color = {127, 0, 0}, smooth = Smooth.None));
        connect(liverO2.hepaticArty, q_in) annotation(Line(points = {{72, 62}, {84, 62}, {84, 0}, {100, 0}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(GITractO2.vein, liverO2.portalVein) annotation(Line(points = {{52, 2}, {30, 2}, {30, 84}, {64, 84}, {64, 70}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(liverO2.HepaticArtyBloodFlow, busConnector.HepaticArty_BloodFlow) annotation(Line(points = {{71, 50}, {96, 50}, {96, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(liverO2.PortalVeinBloodFlow, busConnector.GITract_BloodFlow) annotation(Line(points = {{60, 69}, {60, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, 13}, {3, 13}}));
        connect(kidneyO2.TubulePO2, busConnector.KidneyO2_TubulePO2) annotation(Line(points = {{64, -41}, {64, -46}, {98, -46}, {98, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, -3}, {6, -3}}));
        annotation(Icon(graphics={  Rectangle(extent=  {{-120, 100}, {120, -100}}, lineColor=  {0, 0, 0})}), Diagram(coordinateSystem(preserveAspectRatio=false,  extent={{-100,
                  -100},{100,100}}),                                                                                                    graphics));
      end TissuesO2;

      package tissues
        model TissueO2_kidney
          extends PhysiolibraryOld.Icons.Kidney;
          PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow arty
            annotation (Placement(transformation(extent={{-82,-6},{-62,14}}),
                iconTransformation(extent={{80,0},{120,40}})));
          PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow vein
            annotation (Placement(transformation(extent={{86,-6},{106,14}}),
                iconTransformation(extent={{-120,0},{-80,40}})));
          parameter Real initialMass;
          PhysiolibraryOld.Interfaces.RealInput_ ctHb
            "concentration of haemoglobin" annotation (Placement(transformation(
                  extent={{96,-20},{88,-12}}), iconTransformation(extent={{-100,
                    -30},{-80,-10}})));
          PhysiolibraryOld.Interfaces.RealInput_ cDPG
            "outgoing concentration of DPG" annotation (Placement(
                transformation(extent={{86,-16},{78,-8}}), iconTransformation(
                  extent={{-100,90},{-80,110}})));
          PhysiolibraryOld.Interfaces.RealInput_ BloodFlow
            "blood flow through tissue" annotation (Placement(transformation(
                  extent={{-50,-4},{-42,4}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=180,
                origin={90,-100})));
          PhysiolibraryOld.Interfaces.RealInput_ T "outgoing temperature"
            annotation (Placement(transformation(extent={{-38,-12},{-30,-4}}),
                iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=180,
                origin={90,-60})));
          PhysiolibraryOld.Interfaces.RealInput_ pCO
            "outgoing partial pressure of CO" annotation (Placement(
                transformation(extent={{62,-4},{54,4}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=0,
                origin={-90,60})));
          PhysiolibraryOld.Interfaces.RealInput_ FHbF
            "Foetal haemoglobin fraction" annotation (Placement(transformation(
                  extent={{70,-8},{62,0}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=0,
                origin={-90,-60})));
          PhysiolibraryOld.Interfaces.RealInput_ FMetHb
            "methaemoglobin fraction" annotation (Placement(transformation(
                  extent={{80,-12},{72,-4}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=180,
                origin={90,60})));
          PhysiolibraryOld.Interfaces.RealInput_ Tissue_O2Use annotation (
              Placement(transformation(extent={{-82,-92},{-74,-84}}),
                iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=180,
                origin={90,-20})));
          PhysiolibraryOld.Interfaces.RealInput_ pH_plasma
            "outgoing veins pH of plasma" annotation (Placement(transformation(
                  extent={{-60,-20},{-52,-12}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=180,
                origin={90,100})));
          BloodO2_Siggaard O2Tissue annotation(Placement(transformation(extent = {{-18, 4}, {2, -16}})));
          /*(cO2Hb(start=7.39))*/
          PhysiolibraryOld.PressureFlow.OutputPump Metabolism_O2Use annotation (
             Placement(transformation(
                extent={{-10,10},{10,-10}},
                rotation=270,
                origin={-8,-88})));
          PhysiolibraryOld.Interfaces.RealOutput_ sO2 annotation (Placement(
                transformation(extent={{8,14},{14,20}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=270,
                origin={0,-110})));
          PhysiolibraryOld.Interfaces.RealInput_ pCO2
            "outgoing veins CO2 partial pressure" annotation (Placement(
                transformation(extent={{-46,-16},{-38,-8}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=0,
                origin={-90,-100})));
          PhysiolibraryOld.Interfaces.RealOutput_ pO2(final unit="mmHg")
            annotation (Placement(transformation(extent={{4,-28},{12,-20}}),
                iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=270,
                origin={-20,-110})));
          PhysiolibraryOld.PressureFlow.PressureMeasure pressureMeasure
            annotation (Placement(transformation(
                extent={{-10,-10},{10,10}},
                rotation=0,
                origin={-2,-22})));
          PhysiolibraryOld.PressureFlow.Gas_FromMLtoMMOL fromMLtoMMOL
            annotation (Placement(transformation(
                extent={{-8,-8},{8,8}},
                rotation=90,
                origin={-8,-36})));
          PhysiolibraryOld.PressureFlow.ResistorWithCond resistorWithCond
            annotation (Placement(transformation(
                extent={{10,10},{-10,-10}},
                rotation=90,
                origin={-8,-60})));
          PhysiolibraryOld.Blocks.CondConstant O2PermBasic(k=0.9)
            annotation (Placement(transformation(extent={{14,-52},{28,-38}})));
          PhysiolibraryOld.Factors.CurveValue HgbOnPerm(data={{0.0,0.4,0},{0.15,
                1.0,8.0},{0.25,2.0,0}})
            "\"recalculated [Hb] in mmol = 56*[Hb] in ml\""
            annotation (Placement(transformation(extent={{42,-66},{22,-46}})));
          PhysiolibraryOld.PressureFlow.PressureMeasure pressureMeasure1
            annotation (Placement(transformation(
                extent={{-10,-10},{10,10}},
                rotation=0,
                origin={4,-68})));
          PhysiolibraryOld.Interfaces.RealOutput_ TubulePO2(final unit="mmHg")
            "KidneyO2_TubulePO2" annotation (Placement(transformation(extent={{
                    10,-74},{18,-66}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=270,
                origin={20,-110})));
          Modelica.Blocks.Math.Gain mmol_TO_ml(k = 0.15 / 8.4) annotation(Placement(transformation(extent = {{34, 30}, {54, 50}})));
          Real O2Use_ml_per_min;
          Real O2Use_mmol_per_min;
        equation
          O2Use_mmol_per_min = fromMLtoMMOL.q_MMOL.q;
          O2Use_ml_per_min = -fromMLtoMMOL.q_ML.q;
          connect(O2Tissue.sO2, sO2) annotation(Line(points = {{-8, 6}, {-8, 17}, {11, 17}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(pH_plasma, O2Tissue.pH) annotation(Line(points = {{-56, -16}, {-17, -16}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(T, O2Tissue.T) annotation(Line(points = {{-34, -8}, {-17, -8}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(O2Tissue.pCO2_mmHg, pCO2) annotation(Line(points = {{-17, -12}, {-42, -12}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(BloodFlow, O2Tissue.BloodFlow) annotation(Line(points = {{-46, 0}, {-17, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(O2Tissue.ctHb, ctHb) annotation(Line(points = {{1, -16}, {92, -16}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(O2Tissue.cDPG, cDPG) annotation(Line(points = {{1, -12}, {82, -12}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(FMetHb, O2Tissue.FMetHb) annotation(Line(points = {{76, -8}, {1, -8}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(FHbF, O2Tissue.FHbF) annotation(Line(points = {{66, -4}, {1, -4}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(O2Tissue.pCO_mmHg, pCO) annotation(Line(points = {{1, 0}, {58, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(arty, O2Tissue.q_in) annotation(Line(points = {{-72, 4}, {-18, 4}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(O2Tissue.q_out, vein) annotation(Line(points = {{2, 4}, {96, 4}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(O2Tissue.alveolar, pressureMeasure.q_in) annotation(Line(points = {{-8, -16}, {-8, -26}, {-4, -26}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(pressureMeasure.actualPressure, pO2) annotation(Line(points = {{3.2, -24}, {8, -24}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(Tissue_O2Use, Metabolism_O2Use.desiredFlow) annotation(Line(points = {{-78, -88}, {-14, -88}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(fromMLtoMMOL.q_MMOL, O2Tissue.alveolar) annotation(Line(points = {{-8, -28}, {-8, -22}, {-8, -22}, {-8, -16}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(O2PermBasic.y, HgbOnPerm.yBase) annotation(Line(points = {{28.7, -45}, {32, -45}, {32, -54}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(HgbOnPerm.y, resistorWithCond.cond) annotation(Line(points = {{32, -58}, {32, -60}, {-4, -60}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(fromMLtoMMOL.q_ML, resistorWithCond.q_in) annotation(Line(points = {{-8, -44}, {-8, -47}, {-8, -50}, {-8, -50}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(resistorWithCond.q_out, Metabolism_O2Use.q_in) annotation(Line(points = {{-8, -70}, {-8, -74}, {-8, -78}, {-8, -78}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(pressureMeasure1.actualPressure, TubulePO2) annotation(Line(points = {{9.199999999999999, -70}, {14, -70}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(resistorWithCond.q_out, pressureMeasure1.q_in) annotation(Line(points = {{-8, -70}, {-8, -72}, {2, -72}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(mmol_TO_ml.y, HgbOnPerm.u) annotation(Line(points = {{55, 40}, {62, 40}, {62, -56}, {41.8, -56}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(O2Tissue.ceHb_, mmol_TO_ml.u) annotation(Line(points = {{-12, 6}, {-12, 40}, {32, 40}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(T, fromMLtoMMOL.T) annotation(Line(points = {{-34, -8}, {-28, -8}, {-28, -36.24}, {-15.92, -36.24}}, color = {0, 0, 127}, smooth = Smooth.None));
          annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-80, -78}, {80, -100}}, lineColor=  {127, 0, 0},
                    fillPattern=                                                                                                    FillPattern.Solid, textString=  "(init %initialMass mEq)"), Text(extent=  {{28, 94}, {76, 34}}, lineColor=  {0, 0, 0}, textString=  "O"), Text(extent=  {{62, 34}, {82, 62}}, lineColor=  {0, 0, 0}, textString=  "2"), Rectangle(extent=  {{-100, 100}, {100, -100}}, lineColor=  {0, 0, 0})}));
        end TissueO2_kidney;

        model TissueO2
          //extends Library.Interfaces.BaseModel;
          PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow arty
            annotation (Placement(transformation(extent={{-82,-6},{-62,14}}),
                iconTransformation(extent={{80,0},{120,40}})));
          PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow vein
            annotation (Placement(transformation(extent={{62,-6},{82,14}}),
                iconTransformation(extent={{-120,0},{-80,40}})));
          parameter Real initialMass;
          PhysiolibraryOld.Interfaces.RealInput_ ctHb
            "concentration of haemoglobin" annotation (Placement(transformation(
                  extent={{72,-20},{64,-12}}), iconTransformation(extent={{-100,
                    -30},{-80,-10}})));
          PhysiolibraryOld.Interfaces.RealInput_ cDPG
            "outgoing concentration of DPG" annotation (Placement(
                transformation(extent={{62,-16},{54,-8}}), iconTransformation(
                  extent={{-100,90},{-80,110}})));
          PhysiolibraryOld.Interfaces.RealInput_ BloodFlow
            "blood flow through tissue" annotation (Placement(transformation(
                  extent={{-50,-4},{-42,4}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=180,
                origin={90,-100})));
          PhysiolibraryOld.Interfaces.RealInput_ T "outgoing temperature"
            annotation (Placement(transformation(extent={{-38,-12},{-30,-4}}),
                iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=180,
                origin={90,-60})));
          PhysiolibraryOld.Interfaces.RealInput_ pCO
            "outgoing partial pressure of CO" annotation (Placement(
                transformation(extent={{38,-4},{30,4}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=0,
                origin={-90,60})));
          PhysiolibraryOld.Interfaces.RealInput_ FHbF
            "Foetal haemoglobin fraction" annotation (Placement(transformation(
                  extent={{46,-8},{38,0}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=0,
                origin={-90,-60})));
          PhysiolibraryOld.Interfaces.RealInput_ FMetHb
            "methaemoglobin fraction" annotation (Placement(transformation(
                  extent={{56,-12},{48,-4}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=180,
                origin={90,60})));
          PhysiolibraryOld.Interfaces.RealInput_ Tissue_O2Use annotation (
              Placement(transformation(extent={{-82,-64},{-74,-56}}),
                iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=180,
                origin={90,-20})));
          PhysiolibraryOld.Interfaces.RealInput_ pH_plasma
            "outgoing veins pH of plasma" annotation (Placement(transformation(
                  extent={{-60,-20},{-52,-12}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=180,
                origin={90,100})));
          BloodO2_Siggaard O2Tissue annotation(Placement(transformation(extent = {{-18, 4}, {2, -16}})));
          PhysiolibraryOld.PressureFlow.OutputPump Metabolism_O2Use annotation (
             Placement(transformation(
                extent={{-10,10},{10,-10}},
                rotation=270,
                origin={-8,-60})));
          PhysiolibraryOld.Interfaces.RealOutput_ sO2 annotation (Placement(
                transformation(extent={{8,14},{14,20}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=270,
                origin={0,-110})));
          PhysiolibraryOld.Interfaces.RealInput_ pCO2
            "outgoing veins CO2 partial pressure" annotation (Placement(
                transformation(extent={{-46,-16},{-38,-8}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=0,
                origin={-90,-100})));
          PhysiolibraryOld.Interfaces.RealOutput_ pO2(final unit="mmHg")
            annotation (Placement(transformation(extent={{4,-28},{12,-20}}),
                iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=270,
                origin={-20,-110})));
          PhysiolibraryOld.PressureFlow.PressureMeasure pressureMeasure
            annotation (Placement(transformation(
                extent={{-10,-10},{10,10}},
                rotation=0,
                origin={-4,-22})));
          PhysiolibraryOld.PressureFlow.Gas_FromMLtoMMOL fromMLtoMMOL
            annotation (Placement(transformation(
                extent={{-8,-8},{8,8}},
                rotation=90,
                origin={-8,-36})));
          Real O2Use_ml_per_min;
          Real O2Use_mmol_per_min;
        equation
          O2Use_mmol_per_min = fromMLtoMMOL.q_MMOL.q;
          O2Use_ml_per_min = -fromMLtoMMOL.q_ML.q;
          connect(O2Tissue.sO2, sO2) annotation(Line(points = {{-8, 6}, {-8, 17}, {11, 17}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(pH_plasma, O2Tissue.pH) annotation(Line(points = {{-56, -16}, {-17, -16}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(T, O2Tissue.T) annotation(Line(points = {{-34, -8}, {-17, -8}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(O2Tissue.pCO2_mmHg, pCO2) annotation(Line(points = {{-17, -12}, {-42, -12}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(BloodFlow, O2Tissue.BloodFlow) annotation(Line(points = {{-46, 0}, {-17, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(O2Tissue.ctHb, ctHb) annotation(Line(points = {{1, -16}, {68, -16}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(O2Tissue.cDPG, cDPG) annotation(Line(points = {{1, -12}, {58, -12}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(FMetHb, O2Tissue.FMetHb) annotation(Line(points = {{52, -8}, {1, -8}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(FHbF, O2Tissue.FHbF) annotation(Line(points = {{42, -4}, {1, -4}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(O2Tissue.pCO_mmHg, pCO) annotation(Line(points = {{1, 0}, {34, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(arty, O2Tissue.q_in) annotation(Line(points = {{-72, 4}, {-18, 4}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(O2Tissue.q_out, vein) annotation(Line(points = {{2, 4}, {72, 4}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(O2Tissue.alveolar, pressureMeasure.q_in) annotation(Line(points = {{-8, -16}, {-8, -26}, {-6, -26}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(pressureMeasure.actualPressure, pO2) annotation(Line(points = {{1.2, -24}, {8, -24}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(Tissue_O2Use, Metabolism_O2Use.desiredFlow) annotation(Line(points = {{-78, -60}, {-46, -60}, {-46, -60}, {-14, -60}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(fromMLtoMMOL.q_ML, Metabolism_O2Use.q_in) annotation(Line(points = {{-8, -44}, {-8, -47}, {-8, -50}, {-8, -50}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(fromMLtoMMOL.q_MMOL, O2Tissue.alveolar) annotation(Line(points = {{-8, -28}, {-8, -22}, {-8, -22}, {-8, -16}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(T, fromMLtoMMOL.T) annotation(Line(points = {{-34, -8}, {-28, -8}, {-28, -36.24}, {-15.92, -36.24}}, color = {0, 0, 127}, smooth = Smooth.None));
          annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-80, -80}, {80, -100}}, lineColor=  {127, 0, 0},
                    fillPattern=                                                                                                    FillPattern.Solid, textString=  "(init %initialMass mEq)"), Text(extent=  {{28, 94}, {76, 34}}, lineColor=  {0, 0, 0}, textString=  "O"), Text(extent=  {{62, 34}, {82, 62}}, lineColor=  {0, 0, 0}, textString=  "2"), Rectangle(extent=  {{-100, 100}, {100, -100}}, lineColor=  {0, 0, 0})}));
        end TissueO2;

        model SkeletalMuscleO2
          extends HumMod.Gases.O2.tissues.TissueO2(arty(q(start = 5.048)));
          extends PhysiolibraryOld.Icons.SkeletalMuscle;
          annotation(Diagram(graphics));
        end SkeletalMuscleO2;

        model BoneO2
          extends HumMod.Gases.O2.tissues.TissueO2;
          extends PhysiolibraryOld.Icons.Bone;
        end BoneO2;

        model OtherTissueO2
          extends HumMod.Gases.O2.tissues.TissueO2;
          extends PhysiolibraryOld.Icons.OtherTissue;
        end OtherTissueO2;

        model RespiratoryMuscleO2
          extends HumMod.Gases.O2.tissues.TissueO2;
          extends PhysiolibraryOld.Icons.RespiratoryMuscle;
        end RespiratoryMuscleO2;

        model FatO2
          extends HumMod.Gases.O2.tissues.TissueO2;
          extends PhysiolibraryOld.Icons.Fat;
        end FatO2;

        model SkinO2
          extends TissueO2;
          extends PhysiolibraryOld.Icons.Skin;
        end SkinO2;

        model BrainO2
          extends TissueO2;
          extends PhysiolibraryOld.Icons.Brain;
        end BrainO2;

        model GITractO2
          extends TissueO2;
          extends PhysiolibraryOld.Icons.GITract;
        end GITractO2;

        model LeftHeartO2
          extends TissueO2;
          extends PhysiolibraryOld.Icons.LeftHeart;
        end LeftHeartO2;

        model RightHeartO2
          extends TissueO2;
          extends PhysiolibraryOld.Icons.RightHeart;
        end RightHeartO2;

        model TissueO2_liver2
          extends PhysiolibraryOld.Icons.Liver;
          PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow
            hepaticArty annotation (Placement(transformation(extent={{-82,2},{-62,
                    22}}), iconTransformation(extent={{80,0},{120,40}})));
          PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow vein
            annotation (Placement(transformation(extent={{62,-6},{82,14}}),
                iconTransformation(extent={{-120,0},{-80,40}})));
          parameter Real initialMass;
          PhysiolibraryOld.Interfaces.RealInput_ ctHb
            "concentration of haemoglobin" annotation (Placement(transformation(
                  extent={{72,-20},{64,-12}}), iconTransformation(extent={{-100,
                    -30},{-80,-10}})));
          PhysiolibraryOld.Interfaces.RealInput_ cDPG
            "outgoing concentration of DPG" annotation (Placement(
                transformation(extent={{62,-16},{54,-8}}), iconTransformation(
                  extent={{-100,90},{-80,110}})));
          PhysiolibraryOld.Interfaces.RealInput_ HepaticArtyBloodFlow
            "blood flow through hepatic artery" annotation (Placement(
                transformation(extent={{-84,56},{-76,64}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=180,
                origin={90,-100})));
          PhysiolibraryOld.Interfaces.RealInput_ T "outgoing temperature"
            annotation (Placement(transformation(extent={{-38,-14},{-30,-6}}),
                iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=180,
                origin={90,-60})));
          PhysiolibraryOld.Interfaces.RealInput_ pCO
            "outgoing partial pressure of CO" annotation (Placement(
                transformation(extent={{38,-4},{30,4}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=0,
                origin={-90,60})));
          PhysiolibraryOld.Interfaces.RealInput_ FHbF
            "Foetal haemoglobin fraction" annotation (Placement(transformation(
                  extent={{46,-8},{38,0}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=0,
                origin={-90,-60})));
          PhysiolibraryOld.Interfaces.RealInput_ FMetHb
            "methaemoglobin fraction" annotation (Placement(transformation(
                  extent={{56,-12},{48,-4}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=180,
                origin={90,60})));
          PhysiolibraryOld.Interfaces.RealInput_ Tissue_O2Use annotation (
              Placement(transformation(extent={{-82,-64},{-74,-56}}),
                iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=180,
                origin={90,-20})));
          PhysiolibraryOld.Interfaces.RealInput_ pH_plasma
            "outgoing veins pH of plasma" annotation (Placement(transformation(
                  extent={{-60,-22},{-52,-14}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=180,
                origin={90,100})));
          BloodO2_Siggaard O2Tissue annotation(Placement(transformation(extent = {{-18, 4}, {2, -16}})));
          PhysiolibraryOld.PressureFlow.OutputPump Metabolism_O2Use annotation (
             Placement(transformation(
                extent={{-10,10},{10,-10}},
                rotation=270,
                origin={-8,-60})));
          PhysiolibraryOld.Interfaces.RealOutput_ sO2 annotation (Placement(
                transformation(extent={{8,14},{14,20}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=270,
                origin={0,-110})));
          PhysiolibraryOld.Interfaces.RealInput_ pCO2
            "outgoing veins CO2 partial pressure" annotation (Placement(
                transformation(extent={{-46,-18},{-38,-10}}),
                iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=0,
                origin={-90,-100})));
          PhysiolibraryOld.Interfaces.RealOutput_ pO2(final unit="mmHg")
            annotation (Placement(transformation(extent={{6,-34},{12,-28}}),
                iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=270,
                origin={-20,-110})));
          PhysiolibraryOld.PressureFlow.PressureMeasure pressureMeasure
            annotation (Placement(transformation(
                extent={{-10,-10},{10,10}},
                rotation=270,
                origin={-8,-22})));
          PhysiolibraryOld.PressureFlow.Gas_FromMLtoMMOL fromMLtoMMOL
            annotation (Placement(transformation(
                extent={{-8,-8},{8,8}},
                rotation=90,
                origin={-8,-36})));
          PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow
            portalVein annotation (Placement(transformation(extent={{-102,-12},
                    {-82,8}}), iconTransformation(extent={{0,80},{40,120}})));
          PhysiolibraryOld.Interfaces.RealInput_ PortalVeinBloodFlow
            "blood flow through portal vein" annotation (Placement(
                transformation(extent={{-82,28},{-74,36}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=270,
                origin={-20,90})));
          Real O2Use_ml_per_min;
          Real O2Use_mmol_per_min;
          Modelica.Blocks.Math.Add add annotation(Placement(transformation(extent = {{-44, 32}, {-36, 40}})));
        equation
          O2Use_mmol_per_min = fromMLtoMMOL.q_MMOL.q;
          O2Use_ml_per_min = -fromMLtoMMOL.q_ML.q;
          connect(O2Tissue.sO2, sO2) annotation(Line(points = {{-8, 6}, {-8, 17}, {11, 17}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(pH_plasma, O2Tissue.pH) annotation(Line(points = {{-56, -18}, {-36, -18}, {-36, -16}, {-17, -16}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(T, O2Tissue.T) annotation(Line(points = {{-34, -10}, {-25.5, -10}, {-25.5, -8}, {-17, -8}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(O2Tissue.pCO2_mmHg, pCO2) annotation(Line(points = {{-17, -12}, {-29.5, -12}, {-29.5, -14}, {-42, -14}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(O2Tissue.ctHb, ctHb) annotation(Line(points = {{1, -16}, {68, -16}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(O2Tissue.cDPG, cDPG) annotation(Line(points = {{1, -12}, {58, -12}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(FMetHb, O2Tissue.FMetHb) annotation(Line(points = {{52, -8}, {1, -8}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(FHbF, O2Tissue.FHbF) annotation(Line(points = {{42, -4}, {1, -4}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(O2Tissue.pCO_mmHg, pCO) annotation(Line(points = {{1, 0}, {34, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(O2Tissue.q_out, vein) annotation(Line(points = {{2, 4}, {72, 4}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(O2Tissue.alveolar, pressureMeasure.q_in) annotation(Line(points = {{-8, -16}, {-8, -20}, {-12, -20}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(pressureMeasure.actualPressure, pO2) annotation(Line(points = {{-10, -27.2}, {5.5, -27.2}, {5.5, -31}, {9, -31}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(Tissue_O2Use, Metabolism_O2Use.desiredFlow) annotation(Line(points = {{-78, -60}, {-14, -60}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(fromMLtoMMOL.q_ML, Metabolism_O2Use.q_in) annotation(Line(points = {{-8, -44}, {-8, -47}, {-8, -50}, {-8, -50}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(fromMLtoMMOL.q_MMOL, O2Tissue.alveolar) annotation(Line(points = {{-8, -28}, {-8, -22}, {-8, -22}, {-8, -16}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(hepaticArty, O2Tissue.q_in) annotation(Line(points = {{-72, 12}, {-46, 12}, {-46, 4}, {-18, 4}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(PortalVeinBloodFlow, add.u2) annotation(Line(points = {{-78, 32}, {-56, 32}, {-56, 33.6}, {-44.8, 33.6}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(add.u1, HepaticArtyBloodFlow) annotation(Line(points = {{-44.8, 38.4}, {-58.4, 38.4}, {-58.4, 60}, {-80, 60}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(portalVein, O2Tissue.q_out) annotation(Line(points = {{-92, -2}, {-90, -2}, {-90, 20}, {2, 20}, {2, 4}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(HepaticArtyBloodFlow, O2Tissue.BloodFlow) annotation(Line(points = {{-80, 60}, {-28, 60}, {-28, 0}, {-17, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(T, fromMLtoMMOL.T) annotation(Line(points = {{-34, -10}, {-26, -10}, {-26, -36.24}, {-15.92, -36.24}}, color = {0, 0, 127}, smooth = Smooth.None));
          annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-80, -80}, {80, -100}}, lineColor=  {127, 0, 0},
                    fillPattern=                                                                                                    FillPattern.Solid, textString=  "(init %initialMass mEq)"), Text(extent=  {{28, 94}, {76, 34}}, lineColor=  {0, 0, 0}, textString=  "O"), Text(extent=  {{62, 34}, {82, 62}}, lineColor=  {0, 0, 0}, textString=  "2"), Rectangle(extent=  {{-100, 100}, {100, -100}}, lineColor=  {0, 0, 0})}));
        end TissueO2_liver2;
      end tissues;

      model ExternalO2
        extends PhysiolibraryOld.ConcentrationFlow.UnlimitedStorage;
        extends PhysiolibraryOld.Icons.Oxygen;
        annotation(Icon(graphics));
      end ExternalO2;

      model MeassureBloodO2
        extends HumMod.Gases.O2.BloodO2Base;
        //_withoutCO_;
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow q_in
          annotation (Placement(transformation(extent={{-28,-116},{12,-76}}),
              iconTransformation(extent={{-20,-100},{20,-60}})));
      equation
        q_in.q = 0;
        //flows: mmol/min
        tO2 = MiniliterPerLiter * q_in.conc;
        //mmol/l
        annotation(Diagram(graphics), Icon(graphics));
      end MeassureBloodO2;

      model BloodO2_Siggaard
        extends HumMod.Gases.O2.BloodO2Base;
        //_withoutCO_;
        extends PhysiolibraryOld.Icons.LungShunt;
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow q_in
          annotation (Placement(transformation(extent={{-120,-120},{-80,-80}}),
              iconTransformation(extent={{-120,-120},{-80,-80}})));
        PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow q_out
          annotation (Placement(transformation(extent={{80,-120},{120,-80}}),
              iconTransformation(extent={{80,-120},{120,-80}})));
        PhysiolibraryOld.PressureFlow.PositivePressureFlow alveolar annotation (
           Placement(transformation(extent={{-20,80},{20,120}}),
              iconTransformation(extent={{-20,80},{20,120}})));
        PhysiolibraryOld.Interfaces.RealOutput_ ceHb_(unit="mmol/l")
          "effective haemoglobin" annotation (Placement(transformation(extent={
                  {16,-112},{56,-72}}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=270,
              origin={-40,-120})));
        PhysiolibraryOld.Interfaces.RealInput_ BloodFlow(unit="ml/min")
          annotation (Placement(transformation(extent={{-120,-80},{-80,-40}}),
              iconTransformation(extent={{-100,-70},{-80,-50}})));
      equation
        q_in.q + q_out.q + alveolar.q = 0;
        //flows: mmol/min
        alveolar.pressure =PhysiolibraryOld.NonSIunits.PaTOmmHg*1000*pO2;
        q_in.conc = q_in.q / BloodFlow;
        //mmol/ml
        tO2 = MiniliterPerLiter * (-q_out.q / BloodFlow);
        //mmol/l
        ceHb_ = ceHb;
        annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-74, -32}, {74, -64}}, lineColor=  {0, 0, 255}, textString=  "%name"), Polygon(points=  {{-72, 10}, {80, 0}, {-72, -10}, {-72, 10}}, lineColor=  {0, 0, 127}, fillColor=  {255, 255, 255},
                  fillPattern=                                                                                                    FillPattern.Solid, origin=  {-2, -84}, rotation=  360)}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
      end BloodO2_Siggaard;

      partial model BloodO2Base
        //start values is for tissues veins blood
        parameter Boolean isSaturated = false;
        Real tO2(start = 5.17, unit = "mmol/l");
        //0.75 * 8.140000000000001
        Real aO2;
        Real pO2(start = 5.33, unit = "kPa");
        // start=13,
        Real sO2CO(start = 0.75);
        Real pO2CO(start = 5.33, unit = "kPa");
        Real cO2Hb(start = 6, unit = "mmol/l");
        //
        Real sCO;
        Real ceHb(start = 8.38915596, unit = "mmol/l");
        Real a(start = 0.5);
        Real k;
        Real x;
        Real y;
        Real h;
        /*  Real ex;
                                                                                                                                Real ey;
                                                                                                                                Real ey0;
                                                                                                                                Real tnh;
                                                                                                                              */
        Real FCOHb(start = 0);
        Real pCO;
        Real pCO2;
        //(start=5);
        PhysiolibraryOld.Interfaces.RealOutput_ sO2 annotation (Placement(
              transformation(extent={{-30,-112},{10,-72}}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=270,
              origin={0,-120})));
        PhysiolibraryOld.Interfaces.RealInput_ pH annotation (Placement(
              transformation(extent={{-120,70},{-80,110}}), iconTransformation(
                extent={{-100,90},{-80,110}})));
        PhysiolibraryOld.Interfaces.RealInput_ ctHb(unit="mmol/l") annotation (
            Placement(transformation(extent={{60,60},{100,100}}),
              iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=180,
              origin={90,100})));
        PhysiolibraryOld.Interfaces.RealInput_ T(unit="DegC", start=37)
          annotation (Placement(transformation(extent={{-120,-20},{-80,20}}),
              iconTransformation(extent={{-100,10},{-80,30}})));
        PhysiolibraryOld.Interfaces.RealInput_ pCO_mmHg(unit="mmHg")
          annotation (Placement(transformation(extent={{60,-100},{100,-60}}),
              iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=180,
              origin={90,-60})));
        PhysiolibraryOld.Interfaces.RealInput_ pCO2_mmHg(unit="mmHg")
          annotation (Placement(transformation(extent={{-120,20},{-80,60}}),
              iconTransformation(extent={{-100,50},{-80,70}})));
        PhysiolibraryOld.Interfaces.RealInput_ cDPG(unit="mmol/l") annotation (
            Placement(transformation(extent={{60,20},{100,60}}),
              iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=180,
              origin={90,60})));
        PhysiolibraryOld.Interfaces.RealInput_ FMetHb annotation (Placement(
              transformation(extent={{60,-20},{100,20}}), iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=180,
              origin={90,20})));
        PhysiolibraryOld.Interfaces.RealInput_ FHbF annotation (Placement(
              transformation(extent={{60,-60},{100,-20}}), iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=180,
              origin={90,-20})));
        //  Real mlTOmmol_O2(unit="mMol/ml") = 8.18/0.182
        //    "conversion constant for oxygen mass from ml to mMol";
        // Real mlTOmmol_O2(unit="mMol/ml") = 1/(740*2*16/1000)
        //   "conversion constant for oxygen mass from ml to mMol";
        //8.18 / 0.182
        //molar mass = 2*16 g/mol; density = 740 ml/g
        constant Real MiniliterPerLiter(final unit = "ml/l") = 1000;
        PhysiolibraryOld.Interfaces.RealOutput_ PO2 annotation (Placement(
              transformation(extent={{-30,-112},{10,-72}}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=270,
              origin={40,-120})));
        Real cdO2;
        /*    
                                                                                                                                Real aa;
                                                                                                                                Real xx;
                                                                                                                                Real yy;
                                                                                                                                Real ssO2CO(start=0.96);
                                                                                                                              */
        parameter Real T0(unit = "degC") = 37 "normal temperature";
        parameter Real pH0 = 7.4 "normal arterial pH";
        parameter Real pCO20(unit = "kPa") = 5.33
          "normal arterial CO2 partial pressure";
        parameter Real cDPG0(unit = "mmol/l") = 5 "normal DPG,used by a";
        parameter Real dadcDPG0 = 0.3 "used by a";
        parameter Real dadcDPGxHbF = -0.1 "or perhabs -0.125";
        parameter Real dadpH = -0.88 "used by a";
        parameter Real dadlnpCO2 = 0.048 "used by a";
        parameter Real dadxMetHb = -0.7 "used by a";
        parameter Real dadxHbF = -0.25 "used by a";
      equation
        PO2 =PhysiolibraryOld.NonSIunits.PaTOmmHg*1000*pO2;
        pCO_mmHg =PhysiolibraryOld.NonSIunits.PaTOmmHg*1000*pCO;
        pCO2_mmHg =PhysiolibraryOld.NonSIunits.PaTOmmHg*1000*pCO2;
        //oxygen:
        ceHb = ctHb * (1 - FCOHb - FMetHb);
        //effective haemoglobin
        //  assert(tO2 <= ceHb * 1.06, "Model does not support this high level of oxygen in blood. Maximum of oxygen concentration should be connected with efective hemoglobin concentration!");
        //pO2,pCO,pCO2 .. Pa
        //TODO: check units of solubility
        aO2 = exp(log(0.0105) + (-0.0115 * (T - 37)) + 0.5 * 0.00042 * (T - 37) ^ 2);
        // /1000; //solubility
        cdO2 = aO2 * pO2;
        /*  if (isSaturated) then
                                                                                                                                  cdO2 = homotopy( tO2 - sO2*ceHb, tO2 - 0.9999*ceHb);
                                                                                                                                else
                                                                                                                                  sO2 = homotopy( (tO2-cdO2)/ceHb,  tO2/ceHb);  // ctO2 = aO2*pO2 + ceHb*sO2;  nazaciatok postaci veskery kyslik mat iba na hemoglobine a potom pridat uz len to zrnko rozpusteneho..
                                                                                                                                end if; */
        //TODO: why not sO2 = homotopy( (tO2-cdO2)/ceHb,  tO2/ceHb);
        tO2 = aO2 * pO2 + ceHb * sO2;
        //  cO2Hb = tO2 - cdO2;
        sO2 = cO2Hb / ceHb;
        //TODO: check this: a=-0.88*(pH-7.4)+0.048*log(pCO2/5.33)-0.7*FMetHb+(0.3-0.25*FHbF)*cDPG/(5-1);
        //TANH
        a = dadpH * (pH - pH0) + dadlnpCO2 * log(max(1e-015 + 1e-019 * pCO2, pCO2 / pCO20)) + dadxMetHb * FMetHb + (dadcDPG0 + dadcDPGxHbF * FHbF) * (cDPG / cDPG0 - 1);
        //log(pCO2/5.330)
        //orginal:
        x = log(max(Modelica.Constants.eps * (1 + pO2CO), pO2CO) / 7) - a - 0.055 * (T - 37);
        //namiesto:  x=log(pO2CO/7) - a - 0.055*(T-37);
        y - 1.8747 = x + h * tanh(k * x);
        k = 0.5342857;
        h = 3.5 + a;
        y = log(sO2CO / (1 - sO2CO));
        //simplification:
        /*  ey/ey0=ex*exp((3.5 + a)*tnh);  //TANH:  y-log(0.867/(1-0.867))=x+(3.5 + a)*tanh(0.5342857*x);
                                                                                                                                ey0=0.867/(1-0.867);  //y0=log(0.867/(1-0.867)); //1.8747
                                                                                                                                tnh = (ex^(2*k) - 1) / (ex^(2*k) + 1);  // = tanh(k*x)
                                                                                                                                ex=max(1e-15*(1+1e-6*pO2CO),(pO2CO/7.000) / exp(a + 0.055*(T-37)));  // = exp(x); x=log(max(1e-15*(1+1e-6*pO2CO),pO2CO/7000)) - a - 0.055*(T_degC-37);
                                                                                                                                k=0.5342857;
                                                                                                                                ey=sO2CO/(1-sO2CO); // = exp(y);  y=log(max(1e-15*(1+1e-6*sO2CO/(1-sO2CO)),sO2CO/(1-sO2CO)));
                                                                                                                                */
        /************ O2 ********************/
        /************ CO ********************/
        //Haldane:
        /* if (pCO_mmHg<1e-10) then
                                                                                                                                  sCO = 0;
                                                                                                                                  pO2CO = pO2;
                                                                                                                                  sO2CO = sO2;
                                                                                                                                  FCOHb = 0;/*
                                                                                                                                else*/
        pCO = sCO * pO2CO / 218 * sO2CO;
        pO2CO = pO2 + 218 * pCO;
        sO2CO = (cO2Hb + ctHb * FCOHb) / (ctHb * (1 - FMetHb));
        sCO = ctHb * FCOHb / (ctHb * (1 - FMetHb));
        //  end if;
        /*  ceHb = ctHb * (1-FCOHb-FMetHb); //effective haemoglobin
                                                                                                                                aO2 = exp(log(0.0105)+(-0.0115*(T-37))+0.5*0.00042*(T-37)^2); //solubility
                                                                                                                                tO2 = aO2*pO2 + ceHb*sO2;
                                                                                                                                //Haldane:
                                                                                                                                sCO*pO2CO = 218*pCO*sO2CO;
                                                                                                                                pO2CO = pO2 + 218*pCO;
                                                                                                                                //saturation definitions: "result: sO2CO = (sO2*(ceHb/ctHb)+FCOHb)/(1-FMetHb);"
                                                                                                                                sO2 = cO2Hb/ceHb;
                                                                                                                                sO2CO = (cO2Hb + ctHb*FCOHb)/(ctHb*(1-FMetHb));
                                                                                                                                sCO = ctHb*FCOHb/(ctHb*(1-FMetHb));
                                                                                                                                //TANH
                                                                                                                              //  a=-0.88*(pH-7.4)+0.048*log(pCO2/5.33)-0.7*FMetHb+(0.3-0.25*FHbF)*cDPG/(5-1); //Bohr coefficient: -der(log10(pO2),pH)=0.88/ln(10)=0.38, -der(ln(pO2),pH)=0.88
                                                                                                                              //  x=log(pO2CO/7); //namiesto:  x=log(pO2CO/7) - a - 0.055*(T-37);
                                                                                                                                y-y0=x+h*tanh(k*x);
                                                                                                                                y0=log(0.867/(1-0.867)); //1.8747

                                                                                                                                k=0.5342857;
                                                                                                                                h=3.5 + a;
                                                                                                                              //  y=log(sO2CO/(1-sO2CO));

                                                                                                                              //corrected:
                                                                                                                                a=-0.88*(pH-7.4)+0.048*log(max(1e-15+1e-24*pCO2,pCO2/5.33))-0.7*FMetHb+(0.3-0.1*FHbF)*(cDPG/5 - 1);
                                                                                                                                x=log(max(1e-15+1e-24*pO2CO,pO2CO/7)) - a - 0.055*(T-37);
                                                                                                                                y=log(max(1e-15+1e-24*sO2CO/(1-sO2CO),sO2CO/(1-sO2CO)));

                                                                                                                              */
        //oxygen: working well:
        //TANH
        //  a=-0.88*(pH-7.4)+0.048*log(max(1e-15+1e-19*pCO2,pCO2/5.33))-0.7*FMetHb+(0.3-0.25*FHbF)*cDPG/(5-1); //Bohr coefficient: -der(log10(pO2),pH)=0.88/ln(10)=0.38, -der(ln(pO2),pH)=0.88
        //  x=log(pO2CO/7);
        //  x=log(max(1e-15+1e-19*pO2CO,pO2CO/7)) - a - 0.055*(T-37); //namiesto:  x=log(pO2CO/7) - a - 0.055*(T-37);
        //  y=log(max(1e-15+1e-19*sO2CO/(1-sO2CO),sO2CO/(1-sO2CO)));
        annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Rectangle(extent=  {{-100, 100}, {100, -100}}, lineColor=  {0, 0, 255}, fillColor=  {215, 215, 215},
                  fillPattern=                                                                                                    FillPattern.Solid), Text(extent=  {{-74, -32}, {74, -64}}, lineColor=  {0, 0, 255}, textString=  "%name")}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
      end BloodO2Base;
      annotation(Documentation(revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr><tr>
                   <td></td>
                   <td>Siggaard Andersen: OSA (2005), University of Copenhagen</td>
                   </tr>
                   </table>
                   </html>"));
    end O2;

    package CO2 "Body CO2 Transport"
      partial model HendersonHasselbach
        import Modelica.Math;
        Real pK;
        Real aCO2(final unit = "mmol/(l.kPa)");
        Real cdCO2(final unit = "mmol/l");
        // start=3,
        Real pCO2(start = 6, unit = "kPa");
        //  start=6,
        constant Real MiniliterPerLiter(final unit = "ml/l") = 1000;
        PhysiolibraryOld.Interfaces.RealOutput_ cHCO3(final unit="mmol/l")
          "outgoing concentration of HCO3" annotation (Placement(transformation(
                extent={{20,-70},{60,-30}}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=270,
              origin={80,-120})));
        PhysiolibraryOld.Interfaces.RealInput_ T(final unit="degC")
          "outgoing temperature" annotation (Placement(transformation(extent={{
                  70,-26},{110,14}}), iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=180,
              origin={90,80})));
        /*start=37,*/
        PhysiolibraryOld.Interfaces.RealInput_ pH "outgoing plasma pH"
          annotation (Placement(transformation(extent={{-120,50},{-80,90}}),
              iconTransformation(extent={{-100,70},{-80,90}})));
      equation
        //Henderson-Hasselbalch equation:
        pK = 6.1 + (-0.0026) * (T - 37);
        aCO2 = 0.23 * 10 ^ (-0.0092 * (T - 37));
        //solubility depends on temperature
        cdCO2 = aCO2 * pCO2;
        // pH = if ( cdCO2 > 1e-8) then  pK + log10(max(1e-15,cHCO3/cdCO2)) else pK;
        cdCO2 * 10 ^ (pH - pK) = cHCO3;
        annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
      end HendersonHasselbach;

      partial model BloodCO2Base
        extends HumMod.Gases.CO2.HendersonHasselbach;
        import Modelica.Math;
        Real tCO2_P(start = 24, final unit = "mmol/l");
        //start=24,
        Real pK_ery;
        Real aCO2_ery(final unit = "mmol/l/mmHg");
        Real tCO2_ery(final unit = "mmol/l");
        Real tCO2(final unit = "mmol/l");
        //  constant Real MiniliterPerLiter(final unit="ml/l")=1000;
        PhysiolibraryOld.Interfaces.RealInput_ pH_ery
          "outgoing intracellular erytrocytes pH" annotation (Placement(
              transformation(extent={{-120,10},{-80,50}}), iconTransformation(
                extent={{-100,30},{-80,50}})));
        PhysiolibraryOld.Interfaces.RealInput_ Hct
          "outgoing hematocrit (erytrocytes volume/blood volume)" annotation (
            Placement(transformation(extent={{60,60},{100,100}}),
              iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=180,
              origin={90,40})));
        PhysiolibraryOld.Interfaces.RealInput_ sO2 "outgoing oxygen saturation"
          annotation (Placement(transformation(extent={{60,20},{100,60}}),
              iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=180,
              origin={90,0})));
        PhysiolibraryOld.Interfaces.RealOutput_ pCO2_mmHg(unit="mmHg")
          "alveolar partial pressure of pCO2" annotation (Placement(
              transformation(extent={{20,-70},{60,-30}}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=270,
              origin={40,-120})));
        /*start=40,*/
      equation
        pCO2_mmHg =PhysiolibraryOld.NonSIunits.PaTOmmHg*1000*pCO2;
        //total plasma CO2 from SimpleCO2Solution
        tCO2_P = cHCO3 + cdCO2;
        //erythrocytes:
        pK_ery = 6.125 - log10(1 + 10 ^ (pH_ery - 7.84 - 0.06 * sO2));
        tCO2_ery = aCO2_ery * pCO2 * (1 + 10 ^ (pH_ery - pK_ery));
        aCO2_ery = 0.195;
        //solubility
        //plasma+erythrocyte
        tCO2 = tCO2_ery * Hct + tCO2_P * (1 - Hct);
        annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Rectangle(extent=  {{-100, 100}, {100, -100}}, lineColor=  {0, 0, 255}, fillColor=  {215, 215, 215},
                  fillPattern=                                                                                                    FillPattern.Solid), Text(extent=  {{-74, -26}, {74, -58}}, lineColor=  {0, 0, 255}, textString=  "%name")}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
      end BloodCO2Base;

      partial model BloodCO2TransportBase
        extends BloodCO2Base;
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow q_in
          "CO2 inflow to ventilated alveols in mmol/ml" annotation (Placement(
              transformation(extent={{-120,-100},{-80,-60}}),
              iconTransformation(extent={{-120,-100},{-80,-60}})));
        PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow q_out
          "CO2 outflow from ventilated alveols in mmol/ml" annotation (
            Placement(transformation(extent={{80,-100},{120,-60}}),
              iconTransformation(extent={{80,-100},{120,-60}})));
        PhysiolibraryOld.Interfaces.RealInput_ BloodFlow(final unit="ml/min")
          "blood flow through ventilated alveols" annotation (Placement(
              transformation(extent={{-120,-80},{-80,-40}}), iconTransformation(
                extent={{-100,-10},{-80,10}})));
      equation
        q_in.conc = q_in.q / BloodFlow;
        //mmol/ml
        tCO2 = MiniliterPerLiter * (-q_out.q / BloodFlow);
        //mmol/l
        annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Rectangle(extent=  {{-100, 100}, {100, -100}}, lineColor=  {0, 0, 255}, fillColor=  {215, 215, 215},
                  fillPattern=                                                                                                    FillPattern.Solid), Text(extent=  {{-74, -26}, {74, -58}}, lineColor=  {0, 0, 255}, textString=  "%name"), Polygon(points=  {{-72, 10}, {80, 0}, {-72, -10}, {-72, 10}}, lineColor=  {0, 0, 127}, fillColor=  {255, 255, 255},
                  fillPattern=                                                                                                    FillPattern.Solid, origin=  {-2, -80}, rotation=  360)}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
      end BloodCO2TransportBase;

      model BloodCO2
        extends HumMod.Gases.CO2.BloodCO2TransportBase;
        // extends Physiolibrary.Icons.LungShunt;
        PhysiolibraryOld.PressureFlow.NegativePressureFlow alveolar_outflow
          "CO2 outflow from blood to alveol space in mmol/min" annotation (
            Placement(transformation(extent={{-20,80},{20,120}}),
              iconTransformation(extent={{-20,80},{20,120}})));
      equation
        q_in.q + q_out.q + alveolar_outflow.q = 0;
        alveolar_outflow.pressure = pCO2_mmHg;
        annotation(Icon(graphics));
      end BloodCO2;

      model CO2
        // extends Library.Interfaces.BaseModel;
        extends PhysiolibraryOld.Icons.Carbondioxyd;
        PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment veins(
            stateName="CO2Veins.Mass[mMol]", initialSoluteMass=
              86.90000000000001)
          annotation (Placement(transformation(extent={{-96,-14},{-76,6}})));
        PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment artys(
            stateName="CO2Artys.Mass[mMol]", initialSoluteMass=34.3)
          annotation (Placement(transformation(extent={{92,-12},{72,8}})));
        TissuesWithInterstitium.TissuesCO2 CO2Tissues(skeletalMuscleCO2(vein(q(start = -14.5357))), liverCO2(vein(q(start = -31.11))), boneCO2(vein(q(start = -7.3))), brainCO2(vein(q(start = -18.5364)), tissueVeinsCO2(tCO2_P(start = 27.1283))), otherTissueCO2(vein(q(start = -8.148999999999999))), gITractCO2(vein(q(start = -24.8656))), respiratoryMuscleCO2(vein(q(start = -2.26257))), kidneyCO2(vein(q(start = -26.7849))), fatCO2(vein(q(start = -5.277))), leftHeartCO2(vein(q(start = -4.84675))), rightHeartCO2(vein(q(start = -0.914))), skinCO2(vein(q(start = -3.5889)))) annotation(Placement(transformation(extent = {{-48, -40}, {-28, -20}})));
        /*(
                                                                                                                                                            skeletalMuscleCO2(tissueVeinsCO2(pCO2(start=6.079))),
                                                                                                                                                            liverCO2(tissueVeinsCO2(pCO2(start=5.8879))),
                                                                                                                                                            boneCO2(tissueVeinsCO2(pCO2(start=6.0267))),
                                                                                                                                                            brainCO2(tissueVeinsCO2(pCO2(start=6.2398))),
                                                                                                                                                            otherTissueCO2(tissueVeinsCO2(pCO2(start=5.7258))),
                                                                                                                                                            gITractCO2(tissueVeinsCO2(pCO2(start=5.6768))),
                                                                                                                                                            respiratoryMuscleCO2(tissueVeinsCO2(pCO2(start=6.34097))),
                                                                                                                                                            kidneyCO2(tissueVeinsCO2(pCO2(start=5.51929))),
                                                                                                                                                            fatCO2(tissueVeinsCO2(pCO2(start=5.6931))),
                                                                                                                                                            leftHeartCO2(tissueVeinsCO2(pCO2(start=7.8986))),
                                                                                                                                                            rightHeartCO2(tissueVeinsCO2(pCO2(start=7.9346))),
                                                                                                                                                            skinCO2(tissueVeinsCO2(pCO2(start=5.9118))))*/
        PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
            Placement(transformation(extent={{-114,-62},{-74,-22}}),
              iconTransformation(extent={{60,40},{100,80}})));
        ExternalCO2 air_CO2(concentration = 0) annotation(Placement(transformation(extent = {{-62, 88}, {-50, 100}})));
        RespiratoryRegulations.AlveolarVentilation alveolarVentilation annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 0, origin = {0, 78})));
        /*(
                                                                                                                                                            solventFlowPump(q_out(conc(start=0.05))))*/
        PhysiolibraryOld.ConcentrationFlow.SolventFlowPump pulmShortCircuit
          annotation (Placement(transformation(extent={{-22,14},{-2,-6}})));
        Modelica.Blocks.Math.Feedback pulmShortCircuitFlow annotation(Placement(transformation(extent = {{10, -10}, {-10, 10}}, rotation = 270, origin = {-12, -10})));
        PhysiolibraryOld.PressureFlow.Gas_FromMLtoMMOL fromMLtoMMOL annotation (
           Placement(transformation(
              extent={{-8,-8},{8,8}},
              rotation=270,
              origin={0,54})));
        //1000 * 1.977/40.01
        HumMod.Gases.CO2.MeassureBloodCO2 veinsCO2(tCO2_P(start = 27.4), pCO2(start = 6.24)) annotation(Placement(transformation(extent = {{-96, 22}, {-76, 42}})));
        HumMod.Gases.CO2.MeassureBloodCO2 artysCO2(tCO2_P(start = 26), pCO2(start = 5.33)) annotation(Placement(transformation(extent = {{72, 22}, {92, 42}})));
        HumMod.Gases.CO2.BloodCO2 CO2Lung(q_in(q(start = 115.472)), pCO2(start = 5.16), tCO2_P(start = 24.9)) annotation(Placement(transformation(extent = {{-10, 22}, {10, 42}})));
      equation
        connect(busConnector.VeinsVol, veins.SolventVolume) annotation(Line(points = {{-94, -42}, {-100, -42}, {-100, 2}, {-94, 2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(artys.SolventVolume, busConnector.ArtysVol) annotation(Line(points = {{90, 4}, {100, 4}, {100, -42}, {-94, -42}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(CO2Tissues.q_out, veins.q_out) annotation(Line(points = {{-50, -30}, {-70, -30}, {-70, -4}, {-86, -4}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(air_CO2.q_out, alveolarVentilation.inspired) annotation(Line(points = {{-55.88, 94}, {-14, 94}, {-14, 86}, {-10, 86}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(air_CO2.q_out, alveolarVentilation.expired) annotation(Line(points = {{-55.88, 94}, {14, 94}, {14, 86}, {10, 86}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(pulmShortCircuit.solventFlow, pulmShortCircuitFlow.y) annotation(Line(points = {{-12, -2}, {-12, -1.5}, {-12, -1}, {-12, -1}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(pulmShortCircuitFlow.u1, busConnector.CardiacOutput) annotation(Line(points = {{-12, -18}, {10, -18}, {10, -42}, {-94, -42}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(busConnector.AlveolarVentilated_BloodFlow, pulmShortCircuitFlow.u2) annotation(Line(points = {{-94, -42}, {-54, -42}, {-54, -10}, {-20, -10}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(veins.q_out, pulmShortCircuit.q_in) annotation(Line(points = {{-86, -4}, {-86, 24}, {-46, 24}, {-46, 4}, {-22, 4}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(pulmShortCircuit.q_out, artys.q_out) annotation(Line(points = {{-2, 4}, {24, 4}, {24, 24}, {82, 24}, {82, -2}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(busConnector.Veins_pH, veinsCO2.pH) annotation(Line(points = {{-94, -42}, {-100, -42}, {-100, 40}, {-95, 40}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.Veins_pH_ery, veinsCO2.pH_ery) annotation(Line(points = {{-94, -42}, {-100, -42}, {-100, 36}, {-95, 36}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(veinsCO2.sO2, busConnector.O2Veins_sO2) annotation(Line(points = {{-77, 32}, {-54, 32}, {-54, -42}, {-94, -42}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(veinsCO2.Hct, busConnector.BloodVol_Hct) annotation(Line(points = {{-77, 36}, {-54, 36}, {-54, -42}, {-94, -42}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(veinsCO2.T, busConnector.core_T) annotation(Line(points = {{-77, 40}, {-54, 40}, {-54, -42}, {-94, -42}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(alveolarVentilation.alveolar, fromMLtoMMOL.q_ML) annotation(Line(points = {{0.2, 68}, {1.46958e-015, 68}, {1.46958e-015, 62}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(veinsCO2.cHCO3, busConnector.CO2Veins_cHCO3) annotation(Line(points = {{-78, 20}, {-78, 14}, {-100, 14}, {-100, -42}, {-94, -42}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, -3}, {3, -3}}));
        connect(veins.q_out, veinsCO2.q_in) annotation(Line(points = {{-86, -4}, {-86, 24}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(busConnector.Artys_pH, artysCO2.pH) annotation(Line(points = {{-94, -42}, {50, -42}, {50, 40}, {73, 40}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.Artys_pH_ery, artysCO2.pH_ery) annotation(Line(points = {{-94, -42}, {50, -42}, {50, 36}, {73, 36}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(artysCO2.sO2, busConnector.O2Artys_sO2) annotation(Line(points = {{91, 32}, {100, 32}, {100, -42}, {-94, -42}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(artysCO2.Hct, busConnector.BloodVol_Hct) annotation(Line(points = {{91, 36}, {100, 36}, {100, -42}, {-94, -42}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(artysCO2.T, busConnector.core_T) annotation(Line(points = {{91, 40}, {100, 40}, {100, -42}, {-94, -42}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(artysCO2.q_in, artys.q_out) annotation(Line(points = {{82, 24}, {82, -2}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(artysCO2.cHCO3, busConnector.CO2Artys_cHCO3) annotation(Line(points = {{90, 20}, {90, 14}, {100, 14}, {100, -42}, {-94, -42}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{3, -3}, {3, -3}}));
        connect(veinsCO2.pCO2_mmHg, busConnector.CO2Veins_pCO2) annotation(Line(points = {{-82, 20}, {-82, 6}, {-102, 6}, {-102, -42}, {-94, -42}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(artysCO2.pCO2_mmHg, busConnector.CO2Artys_pCO2) annotation(Line(points = {{86, 20}, {86, 14}, {100, 14}, {100, -42}, {-94, -42}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector, CO2Tissues.busConnector) annotation(Line(points = {{-94, -42}, {-54, -42}, {-54, -20.8}, {-46.8, -20.8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(CO2Lung.sO2, busConnector.O2Lung_sO2) annotation(Line(points = {{9, 32}, {50, 32}, {50, -42}, {-94, -42}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(busConnector.AlveolarVentilated_BloodFlow, CO2Lung.BloodFlow) annotation(Line(points = {{-94, -42}, {-54, -42}, {-54, 32}, {-9, 32}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(CO2Lung.q_out, artys.q_out) annotation(Line(points = {{10, 24}, {82, 24}, {82, -2}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(CO2Lung.Hct, busConnector.BloodVol_Hct) annotation(Line(points = {{9, 36}, {50, 36}, {50, -42}, {-94, -42}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(CO2Lung.T, busConnector.core_T) annotation(Line(points = {{9, 40}, {50, 40}, {50, -42}, {-94, -42}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(CO2Lung.pCO2_mmHg, busConnector.CO2Lung_pCO2) annotation(Line(points = {{4, 20}, {4, 12}, {10, 12}, {10, -42}, {-94, -42}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, -5}, {6, -5}}));
        connect(CO2Lung.cHCO3, busConnector.CO2Lung_cHCO3) annotation(Line(points = {{8, 20}, {8, 12}, {10, 12}, {10, -42}, {-94, -42}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(veins.q_out, CO2Lung.q_in) annotation(Line(points = {{-86, -4}, {-86, 24}, {-10, 24}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(fromMLtoMMOL.q_MMOL, CO2Lung.alveolar_outflow) annotation(Line(points = {{-1.46958e-015, 46}, {0, 42}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(busConnector.BarometerPressure, alveolarVentilation.EnvironmentPressure) annotation(Line(points = {{-94, -42}, {-40, -42}, {-40, 76}, {-8, 76}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.lungs_pH_plasma, CO2Lung.pH) annotation(Line(points = {{-94, -42}, {-54, -42}, {-54, 40}, {-9, 40}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.lungs_pH_ery, CO2Lung.pH_ery) annotation(Line(points = {{-94, -42}, {-54, -42}, {-54, 36}, {-9, 36}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(alveolarVentilation.AlveolarVentilation_STPD, busConnector.AlveolarVentilation_STPD) annotation(Line(points = {{8, 80}, {100, 80}, {100, -42}, {-94, -42}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(artys.q_out, CO2Tissues.q_in) annotation(Line(points = {{82, -2}, {52, -2}, {52, -30}, {-26, -30}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(alveolarVentilation.BronchiDilution, busConnector.BronchiDilution) annotation(Line(points = {{8, 74}, {100, 74}, {100, -42}, {-94, -42}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(fromMLtoMMOL.T, busConnector.core_T) annotation(Line(points = {{7.92, 54.24}, {50, 54.24}, {50, -42}, {-94, -42}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-116, -60}, {126, -94}}, lineColor=  {0, 0, 255}, textString=  "%name")}), Documentation(revisions = "<html>
                   <table cellspacing=\"2\" cellpadding=\"0\" border=\"0\"><tr>
                   <td><p>Author:</p></td>
                   <td><p>Marek Matejak</p></td>
                   </tr>
                   <tr>
                   <td><p>Copyright:</p></td>
                   <td><p>In public domains</p></td>
                   </tr>
                   <tr>
                   <td><p>By:</p></td>
                   <td><p>Charles University, Prague</p></td>
                   </tr>
                   <tr>
                   <td><p>Date of:</p></td>
                   <td><p>2009</p></td>
                   </tr>
                   <tr>
                   <td><p>References:</p></td>
                   <td>Siggaard Andersen: OSA (2005), University of Copenhagen</td>
                   </tr>
                   <tr>
                   <td></td>
                   <td><p>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</p></td>
                   </tr>
                   </table>
                   </html>"));
      end CO2;

      model MeassureBloodCO2
        extends BloodCO2Base;
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow q_in
          annotation (Placement(transformation(extent={{80,-20},{120,20}}),
              iconTransformation(extent={{-20,-100},{20,-60}})));
      equation
        q_in.q = 0;
        tCO2 = q_in.conc * MiniliterPerLiter;
        //mmol/l
        annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Rectangle(extent=  {{-100, 100}, {100, -100}}, lineColor=  {0, 0, 255}, fillColor=  {215, 215, 215},
                  fillPattern=                                                                                                    FillPattern.Solid), Text(extent=  {{-74, -26}, {74, -58}}, lineColor=  {0, 0, 255}, textString=  "%name")}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
      end MeassureBloodCO2;

      model TissueHCO3
        extends HumMod.Gases.CO2.HendersonHasselbach;
        import Modelica.Math;
        /*  Real pK;
                                                                                                                                                          Real aCO2(final unit="mmol/(l.kPa)");
                                                                                                                                                          Real cdCO2(start=3,             final unit="mmol/l");

                                                                                                                                                          Real pCO2(unit="kPa");

                                                                                                                                                          constant Real MiniliterPerLiter(final unit="ml/l")=1000;

                                                                                                                                                          
                                                                                                                                                          Library.Interfaces.RealOutput_ cHCO3(final unit="mmol/l") 
                                                                                                                                                            "outgoing concentration of HCO3"                                                           annotation (Placement(
                                                                                                                                                                transformation(extent={{20,-70},{60,-30}}), iconTransformation(
                                                                                                                                                                extent={{-20,-20},{20,20}},
                                                                                                                                                                rotation=270,
                                                                                                                                                                origin={80,-120})));
                                                                                                                                                          Library.Interfaces.RealInput_ T(final unit="degC") "outgoing temperature" annotation (Placement(transformation(extent={{70,-26},
                                                                                                                                                                    {110,14}}),           iconTransformation(extent={{-10,-10},{10,10}},
                                                                                                                                                                rotation=180,
                                                                                                                                                                origin={90,80})));

                                                                                                                                                          Library.Interfaces.RealInput_ pH "outgoing plasma pH" annotation (Placement(transformation(extent={{-120,50},
                                                                                                                                                                    {-80,90}}),           iconTransformation(extent={{-100,70},{-80,90}})));
                                                                                                                                                        */
        Real tCO2(final unit = "mmol/l");
        PhysiolibraryOld.Interfaces.RealInput_ pCO2_mmHg(unit="mmHg")
          "tissue venous partial pressure of CO2" annotation (Placement(
              transformation(extent={{20,-70},{60,-30}}), iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=0,
              origin={-90,42})));
        //start=45,
      equation
        pCO2_mmHg =PhysiolibraryOld.NonSIunits.PaTOmmHg*1000*pCO2;
        /*
                                                                                                                                                          
                                                                                                                                                           
                                                                                                                                                           

                                                                                                                                                          //Henderson-Hasselbalch equation:
                                                                                                                                                          pK = 6.1 + (-0.0026)*(T-37);
                                                                                                                                                          pH = pK + log10(max(1e-15,cHCO3/cdCO2));
                                                                                                                                                          cdCO2 = aCO2*pCO2;
                                                                                                                                                          aCO2 = 0.23 * 10^(-0.0092*(T-37)); //solubility depends on temperature

                                                                                                                                                        */
        //total interstitial CO2 from SimpleCO2Solution
        tCO2 = cHCO3 + cdCO2;
        annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Rectangle(extent=  {{-100, 100}, {100, -100}}, lineColor=  {0, 0, 255}, fillColor=  {215, 215, 215},
                  fillPattern=                                                                                                    FillPattern.Solid), Text(extent=  {{-96, -40}, {98, -68}}, lineColor=  {0, 0, 255}, textString=  "%name")}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
      end TissueHCO3;

      model FlowMeasureCO2
        extends HumMod.Gases.CO2.BloodCO2Base;
        import Modelica.Math;
        /*
                                                                                                                                                          Real tCO2_P(start=24,              final unit="mmol/l");

                                                                                                                                                          Real pK_ery;
                                                                                                                                                          Real aCO2_ery(final unit="mmol/l/mmHg");
                                                                                                                                                          Real tCO2_ery(final unit="mmol/l");

                                                                                                                                                          Real tCO2(final unit="mmol/l");

                                                                                                                                                          constant Real MiniliterPerLiter(final unit="ml/l")=1000;
                                                                                                                                                        */
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow q_in
          "CO2 inflow to ventilated alveols in mmol/ml" annotation (Placement(
              transformation(extent={{-120,-100},{-80,-60}}),
              iconTransformation(extent={{-120,-100},{-80,-60}})));
        /*  Library.Interfaces.RealInput_ pH_ery "outgoing intracellular erytrocytes pH"
                                                                                                                                                                                          annotation (Placement(transformation(extent={{-120,10},
                                                                                                                                                                    {-80,50}}),           iconTransformation(extent={{-100,30},{-80,50}})));
                                                                                                                                                          Library.Interfaces.RealInput_ Hct 
                                                                                                                                                            "outgoing hematocrit (erytrocytes volume/blood volume)"
                                                                                                                                                                                           annotation (Placement(transformation(extent={{60,60},
                                                                                                                                                                    {100,100}}),          iconTransformation(
                                                                                                                                                                extent={{-10,-10},{10,10}},
                                                                                                                                                                rotation=180,
                                                                                                                                                                origin={90,40})));
                                                                                                                                                          Library.Interfaces.RealInput_ sO2 "outgoing oxygen saturation"
                                                                                                                                                                                           annotation (Placement(transformation(extent={{60,20},
                                                                                                                                                                    {100,60}}),           iconTransformation(
                                                                                                                                                                extent={{-10,-10},{10,10}},
                                                                                                                                                                rotation=180,
                                                                                                                                                                origin={90,0})));
                                                                                                                                                        */
        PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow q_out
          "CO2 outflow from ventilated alveols in mmol/ml" annotation (
            Placement(transformation(extent={{80,-100},{120,-60}}),
              iconTransformation(extent={{80,-100},{120,-60}})));
        PhysiolibraryOld.Interfaces.RealInput_ BloodFlow(final unit="ml/min")
          "blood flow through ventilated alveols" annotation (Placement(
              transformation(extent={{-120,-80},{-80,-40}}), iconTransformation(
                extent={{-100,-10},{-80,10}})));
      equation
        q_in.q + q_out.q = 0;
        q_in.conc = q_in.q / BloodFlow;
        tCO2 = MiniliterPerLiter * (-q_out.q / BloodFlow);
        //mmol/l
        /*
                                                                                                                                                          //total plasma CO2 from SimpleCO2Solution
                                                                                                                                                          tCO2_P = cHCO3 + cdCO2;

                                                                                                                                                          //erythrocytes:
                                                                                                                                                          pK_ery = 6.125 - log10(1+10^(pH_ery-7.84-0.06*sO2));
                                                                                                                                                          tCO2_ery=aCO2_ery*pCO2*(1+10^(pH_ery-pK_ery));
                                                                                                                                                          aCO2_ery=0.195; //solubility

                                                                                                                                                          //plasma+erythrocyte
                                                                                                                                                          tCO2 = tCO2_ery*Hct + tCO2_P*(1-Hct);
                                                                                                                                                        */
        annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Rectangle(extent=  {{-100, 100}, {100, -100}}, lineColor=  {0, 0, 255}, fillColor=  {215, 215, 215},
                  fillPattern=                                                                                                    FillPattern.Solid), Text(extent=  {{-74, -26}, {74, -58}}, lineColor=  {0, 0, 255}, textString=  "%name"), Polygon(points=  {{-72, 10}, {80, 0}, {-72, -10}, {-72, 10}}, lineColor=  {0, 0, 127}, fillColor=  {255, 255, 255},
                  fillPattern=                                                                                                    FillPattern.Solid, origin=  {-2, -80}, rotation=  360)}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
      end FlowMeasureCO2;

      package TissuesWithInterstitium
        model TissuesCO2
          import QHP = HumMod;
          extends PhysiolibraryOld.Icons.Tissues;
          PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow q_in
            annotation (Placement(transformation(extent={{80,-20},{120,20}}),
                iconTransformation(extent={{100,-20},{140,20}})));
          PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow q_out
            annotation (Placement(transformation(extent={{-140,-20},{-100,20}}),
                iconTransformation(extent={{-140,-20},{-100,20}})));
          SkeletalMuscleCO2 skeletalMuscleCO2(initialMass = 323.9) annotation(Placement(transformation(extent = {{-54, 64}, {-34, 84}})));
          BoneCO2 boneCO2(initialMass = 56.2) annotation(Placement(transformation(extent = {{-54, 36}, {-34, 56}})));
          FatCO2 fatCO2(initialMass = 39.8) annotation(Placement(transformation(extent = {{-54, -54}, {-34, -34}})));
          BrainCO2 brainCO2(initialMass = 19.1) annotation(Placement(transformation(extent = {{52, 20}, {72, 40}})));
          QHP.Gases.CO2.TissuesWithInterstitium.RightHeartCO2 rightHeartCO2(initialMass = 0.6) annotation(Placement(transformation(extent = {{52, -100}, {72, -80}})));
          RespiratoryMuscleCO2 respiratoryMuscleCO2(initialMass = 48.1) annotation(Placement(transformation(extent = {{-54, -24}, {-34, -4}})));
          OtherTissueCO2 otherTissueCO2(initialMass = 50.7) annotation(Placement(transformation(extent = {{-54, 6}, {-34, 26}})));
          TissueCO2_liver liverCO2(initialMass = 22.8) annotation(Placement(transformation(extent = {{52, 50}, {72, 70}})));
          QHP.Gases.CO2.TissuesWithInterstitium.LeftHeartCO2 leftHeartCO2(initialMass = 3.5) annotation(Placement(transformation(extent = {{52, -70}, {72, -50}})));
          QHP.Gases.CO2.TissuesWithInterstitium.KidneyCO2 kidneyCO2(initialMass = 4.1) annotation(Placement(transformation(extent = {{52, -40}, {72, -20}})));
          QHP.Gases.CO2.TissuesWithInterstitium.GITractCO2 gITractCO2(initialMass = 17.6) annotation(Placement(transformation(extent = {{52, -10}, {72, 10}})));
          PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
              Placement(transformation(extent={{-108,72},{-68,112}})));
          SkinCO2 skinCO2(initialMass = 28.2) annotation(Placement(transformation(extent = {{-54, -84}, {-34, -64}})));
          Real CO2FromTissues(unit = "mmol/min");
        equation
          CO2FromTissues = -(q_out.q + q_in.q);
          connect(q_out, skeletalMuscleCO2.vein) annotation(Line(points = {{-120, 0}, {-82, 0}, {-82, 75}, {-54, 75}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(q_out, boneCO2.vein) annotation(Line(points = {{-120, 0}, {-82, 0}, {-82, 47}, {-54, 47}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(q_out, otherTissueCO2.vein) annotation(Line(points = {{-120, 0}, {-82, 0}, {-82, 17}, {-54, 17}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(q_out, respiratoryMuscleCO2.vein) annotation(Line(points = {{-120, 0}, {-81, 0}, {-81, -13}, {-54, -13}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(q_out, fatCO2.vein) annotation(Line(points = {{-120, 0}, {-82, 0}, {-82, -43}, {-54, -43}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(q_out, skinCO2.vein) annotation(Line(points = {{-120, 0}, {-82, 0}, {-82, -73}, {-54, -73}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(q_out, liverCO2.vein) annotation(Line(points = {{-120, 0}, {-82, 0}, {-82, 61}, {52, 61}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(q_out, brainCO2.vein) annotation(Line(points = {{-120, 0}, {-82, 0}, {-82, 31}, {52, 31}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(q_out, kidneyCO2.vein) annotation(Line(points = {{-120, 0}, {-82, 0}, {-82, -29}, {52, -29}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(q_out, leftHeartCO2.vein) annotation(Line(points = {{-120, 0}, {-82, 0}, {-82, -59}, {52, -59}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(skeletalMuscleCO2.arty, q_in) annotation(Line(points = {{-34, 75}, {84, 75}, {84, 0}, {100, 0}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(brainCO2.arty, q_in) annotation(Line(points = {{72, 31}, {84, 31}, {84, 0}, {100, 0}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(gITractCO2.arty, q_in) annotation(Line(points = {{72, 1}, {72, 0}, {100, 0}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(kidneyCO2.arty, q_in) annotation(Line(points = {{72, -29}, {84, -29}, {84, 0}, {100, 0}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(leftHeartCO2.arty, q_in) annotation(Line(points = {{72, -59}, {84, -59}, {84, 0}, {100, 0}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(rightHeartCO2.arty, q_in) annotation(Line(points = {{72, -89}, {84, -89}, {84, 0}, {100, 0}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(rightHeartCO2.vein, q_out) annotation(Line(points = {{52, -89}, {-82, -89}, {-82, 0}, {-120, 0}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(boneCO2.arty, q_in) annotation(Line(points = {{-34, 47}, {84, 47}, {84, 0}, {100, 0}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(otherTissueCO2.arty, q_in) annotation(Line(points = {{-34, 17}, {84, 17}, {84, 0}, {100, 0}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(fatCO2.arty, q_in) annotation(Line(points = {{-34, -43}, {84, -43}, {84, 0}, {100, 0}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(skinCO2.arty, q_in) annotation(Line(points = {{-34, -73}, {84, -73}, {84, 0}, {100, 0}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(q_in, respiratoryMuscleCO2.arty) annotation(Line(points = {{100, 0}, {84, 0}, {84, -13}, {-34, -13}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(busConnector.bone_pH_plasma, boneCO2.pH_plasma) annotation(Line(points = {{-88, 92}, {-88, 44}, {-53, 44}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.brain_pH_plasma, brainCO2.pH_plasma) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 28}, {53, 28}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.fat_pH_plasma, fatCO2.pH_plasma) annotation(Line(points = {{-88, 92}, {-88, -46}, {-53, -46}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.GITract_pH_plasma, gITractCO2.pH_plasma) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -2}, {53, -2}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.kidney_pH_plasma, kidneyCO2.pH_plasma) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -32}, {53, -32}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.leftHeart_pH_plasma, leftHeartCO2.pH_plasma) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -62}, {53, -62}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.liver_pH_plasma, liverCO2.pH_plasma) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 58}, {53, 58}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.otherTissue_pH_plasma, otherTissueCO2.pH_plasma) annotation(Line(points = {{-88, 92}, {-88, 14}, {-53, 14}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.respiratoryMuscle_pH_plasma, respiratoryMuscleCO2.pH_plasma) annotation(Line(points = {{-88, 92}, {-88, -16}, {-53, -16}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.rightHeart_pH_plasma, rightHeartCO2.pH_plasma) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -92}, {53, -92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.skin_pH_plasma, skinCO2.pH_plasma) annotation(Line(points = {{-88, 92}, {-88, -76}, {-53, -76}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.skeletalMuscle_pH_plasma, skeletalMuscleCO2.pH_plasma) annotation(Line(points = {{-88, 92}, {-87.5, 92}, {-87.5, 72}, {-53, 72}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.bone_pH_ery, boneCO2.pH_ery) annotation(Line(points = {{-88, 92}, {-88, 56}, {-53, 56}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.brain_pH_ery, brainCO2.pH_ery) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 40}, {53, 40}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.fat_pH_ery, fatCO2.pH_ery) annotation(Line(points = {{-88, 92}, {-88, -34}, {-53, -34}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.GITract_pH_ery, gITractCO2.pH_ery) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 10}, {53, 10}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.kidney_pH_ery, kidneyCO2.pH_ery) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -20}, {53, -20}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.leftHeart_pH_ery, leftHeartCO2.pH_ery) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -50}, {53, -50}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.liver_pH_ery, liverCO2.pH_ery) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 70}, {53, 70}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.otherTissue_pH_ery, otherTissueCO2.pH_ery) annotation(Line(points = {{-88, 92}, {-88, 26}, {-53, 26}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.respiratoryMuscle_pH_ery, respiratoryMuscleCO2.pH_ery) annotation(Line(points = {{-88, 92}, {-88, -4}, {-53, -4}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.rightHeart_pH_ery, rightHeartCO2.pH_ery) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -80}, {53, -80}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.skin_pH_ery, skinCO2.pH_ery) annotation(Line(points = {{-88, 92}, {-88, -64}, {-53, -64}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.skeletalMuscle_pH_ery, skeletalMuscleCO2.pH_ery) annotation(Line(points = {{-88, 92}, {-87.5, 92}, {-87.5, 84}, {-53, 84}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.bone_sO2, boneCO2.sO2) annotation(Line(points = {{-88, 92}, {-88, 52}, {-53, 52}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.brain_sO2, brainCO2.sO2) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 36}, {53, 36}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.fat_sO2, fatCO2.sO2) annotation(Line(points = {{-88, 92}, {-88, -38}, {-53, -38}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.GITract_sO2, gITractCO2.sO2) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 6}, {53, 6}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.kidney_sO2, kidneyCO2.sO2) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -24}, {53, -24}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.leftHeart_sO2, leftHeartCO2.sO2) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -54}, {53, -54}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.liver_sO2, liverCO2.sO2) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 66}, {53, 66}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.otherTissue_sO2, otherTissueCO2.sO2) annotation(Line(points = {{-88, 92}, {-88, 22}, {-53, 22}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.respiratoryMuscle_sO2, respiratoryMuscleCO2.sO2) annotation(Line(points = {{-88, 92}, {-88, -8}, {-53, -8}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.rightHeart_sO2, rightHeartCO2.sO2) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -84}, {53, -84}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.skin_sO2, skinCO2.sO2) annotation(Line(points = {{-88, 92}, {-88, -68}, {-53, -68}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.skeletalMuscle_sO2, skeletalMuscleCO2.sO2) annotation(Line(points = {{-88, 92}, {-87.5, 92}, {-87.5, 80}, {-53, 80}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.BloodVol_Hct, boneCO2.Hct) annotation(Line(points = {{-88, 92}, {-88, 40}, {-53, 40}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.BloodVol_Hct, brainCO2.Hct) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 24}, {53, 24}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.BloodVol_Hct, fatCO2.Hct) annotation(Line(points = {{-88, 92}, {-88, -50}, {-53, -50}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.BloodVol_Hct, gITractCO2.Hct) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -6}, {53, -6}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.BloodVol_Hct, kidneyCO2.Hct) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -36}, {53, -36}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.BloodVol_Hct, leftHeartCO2.Hct) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -66}, {53, -66}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.BloodVol_Hct, liverCO2.Hct) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 54}, {53, 54}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.BloodVol_Hct, otherTissueCO2.Hct) annotation(Line(points = {{-88, 92}, {-88, 10}, {-53, 10}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.BloodVol_Hct, respiratoryMuscleCO2.Hct) annotation(Line(points = {{-88, 92}, {-88, -20}, {-53, -20}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.BloodVol_Hct, rightHeartCO2.Hct) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -96}, {53, -96}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.BloodVol_Hct, skinCO2.Hct) annotation(Line(points = {{-88, 92}, {-88, -80}, {-53, -80}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.BloodVol_Hct, skeletalMuscleCO2.Hct) annotation(Line(points = {{-88, 92}, {-87.5, 92}, {-87.5, 68}, {-53, 68}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(boneCO2.Tissue_CO2FromMetabolism, busConnector.bone_CO2FromMetabolism) annotation(Line(points = {{-35, 44}, {6, 44}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(brainCO2.Tissue_CO2FromMetabolism, busConnector.brain_CO2FromMetabolism) annotation(Line(points = {{71, 28}, {98, 28}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(fatCO2.Tissue_CO2FromMetabolism, busConnector.fat_CO2FromMetabolism) annotation(Line(points = {{-35, -46}, {6, -46}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(gITractCO2.Tissue_CO2FromMetabolism, busConnector.GITract_CO2FromMetabolism) annotation(Line(points = {{71, -2}, {98, -2}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(kidneyCO2.Tissue_CO2FromMetabolism, busConnector.kidney_CO2FromMetabolism) annotation(Line(points = {{71, -32}, {98, -32}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(leftHeartCO2.Tissue_CO2FromMetabolism, busConnector.leftHeart_CO2FromMetabolism) annotation(Line(points = {{71, -62}, {98, -62}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(liverCO2.Tissue_CO2FromMetabolism, busConnector.liver_CO2FromMetabolism) annotation(Line(points = {{71, 56}, {98, 56}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(otherTissueCO2.Tissue_CO2FromMetabolism, busConnector.otherTissue_CO2FromMetabolism) annotation(Line(points = {{-35, 14}, {6, 14}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(respiratoryMuscleCO2.Tissue_CO2FromMetabolism, busConnector.respiratoryMuscle_CO2FromMetabolism) annotation(Line(points = {{-35, -16}, {6, -16}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(rightHeartCO2.Tissue_CO2FromMetabolism, busConnector.rightHeart_CO2FromMetabolism) annotation(Line(points = {{71, -92}, {98, -92}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(skinCO2.Tissue_CO2FromMetabolism, busConnector.skin_CO2FromMetabolism) annotation(Line(points = {{-35, -76}, {6, -76}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(skeletalMuscleCO2.Tissue_CO2FromMetabolism, busConnector.skeletalMuscle_CO2FromMetabolism) annotation(Line(points = {{-35, 72}, {5.5, 72}, {5.5, 92}, {-88, 92}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(boneCO2.BloodFlow, busConnector.bone_BloodFlow) annotation(Line(points = {{-35, 51.4}, {6, 51.4}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(brainCO2.BloodFlow, busConnector.brain_BloodFlow) annotation(Line(points = {{71, 35.4}, {98, 35.4}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(fatCO2.BloodFlow, busConnector.fat_BloodFlow) annotation(Line(points = {{-35, -38.6}, {6, -38.6}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(gITractCO2.BloodFlow, busConnector.GITract_BloodFlow) annotation(Line(points = {{71, 5.4}, {98, 5.4}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(kidneyCO2.BloodFlow, busConnector.kidney_BloodFlow) annotation(Line(points = {{71, -24.6}, {98, -24.6}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(leftHeartCO2.BloodFlow, busConnector.leftHeart_BloodFlow) annotation(Line(points = {{71, -54.6}, {98, -54.6}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(otherTissueCO2.BloodFlow, busConnector.otherTissue_BloodFlow) annotation(Line(points = {{-35, 21.4}, {6, 21.4}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(respiratoryMuscleCO2.BloodFlow, busConnector.respiratoryMuscle_BloodFlow) annotation(Line(points = {{-35, -8.6}, {6, -8.6}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(rightHeartCO2.BloodFlow, busConnector.rightHeart_BloodFlow) annotation(Line(points = {{71, -84.59999999999999}, {98, -84.59999999999999}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(skinCO2.BloodFlow, busConnector.skin_BloodFlow) annotation(Line(points = {{-35, -68.59999999999999}, {6, -68.59999999999999}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(skeletalMuscleCO2.BloodFlow, busConnector.skeletalMuscle_BloodFlow) annotation(Line(points = {{-35, 79.40000000000001}, {5.5, 79.40000000000001}, {5.5, 92}, {-88, 92}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(boneCO2.T, busConnector.bone_T) annotation(Line(points = {{-35, 40}, {6, 40}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(brainCO2.T, busConnector.brain_T) annotation(Line(points = {{71, 24}, {98, 24}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(fatCO2.T, busConnector.fat_T) annotation(Line(points = {{-35, -50}, {6, -50}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(gITractCO2.T, busConnector.GITract_T) annotation(Line(points = {{71, -6}, {98, -6}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(kidneyCO2.T, busConnector.kidney_T) annotation(Line(points = {{71, -36}, {98, -36}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(leftHeartCO2.T, busConnector.leftHeart_T) annotation(Line(points = {{71, -66}, {98, -66}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(liverCO2.T, busConnector.liver_T) annotation(Line(points = {{71, 65.8}, {98, 65.8}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(otherTissueCO2.T, busConnector.otherTissue_T) annotation(Line(points = {{-35, 10}, {6, 10}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(respiratoryMuscleCO2.T, busConnector.respiratoryMuscle_T) annotation(Line(points = {{-35, -20}, {6, -20}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(rightHeartCO2.T, busConnector.rightHeart_T) annotation(Line(points = {{71, -96}, {98, -96}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(skinCO2.T, busConnector.skin_T) annotation(Line(points = {{-35, -80}, {6, -80}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(skeletalMuscleCO2.T, busConnector.skeletalMuscle_T) annotation(Line(points = {{-35, 68}, {5.5, 68}, {5.5, 92}, {-88, 92}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(boneCO2.pCO2, busConnector.bone_pCO2) annotation(Line(points = {{-44, 35}, {6, 35}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(brainCO2.pCO2, busConnector.brain_pCO2) annotation(Line(points = {{62, 19}, {98, 19}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(fatCO2.pCO2, busConnector.fat_pCO2) annotation(Line(points = {{-44, -55}, {6, -55}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(gITractCO2.pCO2, busConnector.GITract_pCO2) annotation(Line(points = {{62, -11}, {98, -11}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(kidneyCO2.pCO2, busConnector.kidney_pCO2) annotation(Line(points = {{62, -41}, {98, -41}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(leftHeartCO2.pCO2, busConnector.leftHeart_pCO2) annotation(Line(points = {{62, -71}, {98, -71}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(liverCO2.pCO2, busConnector.liver_pCO2) annotation(Line(points = {{62, 49}, {98, 49}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(otherTissueCO2.pCO2, busConnector.otherTissue_pCO2) annotation(Line(points = {{-44, 5}, {6, 5}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(respiratoryMuscleCO2.pCO2, busConnector.respiratoryMuscle_pCO2) annotation(Line(points = {{-44, -25}, {6, -25}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(rightHeartCO2.pCO2, busConnector.rightHeart_pCO2) annotation(Line(points = {{62, -101}, {98, -101}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(skinCO2.pCO2, busConnector.skin_pCO2) annotation(Line(points = {{-44, -85}, {6, -85}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(skeletalMuscleCO2.pCO2, busConnector.skeletalMuscle_pCO2) annotation(Line(points = {{-44, 63}, {5.5, 63}, {5.5, 92}, {-88, 92}}, color = {127, 0, 0}, smooth = Smooth.None));
          connect(boneCO2.pCO2, busConnector.Bone_PCO2) annotation(Line(points = {{-44, 35}, {6, 35}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(brainCO2.pCO2, busConnector.Brain_PCO2) annotation(Line(points = {{62, 19}, {98, 19}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(fatCO2.pCO2, busConnector.Fat_PCO2) annotation(Line(points = {{-44, -55}, {6, -55}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(gITractCO2.pCO2, busConnector.GITract_PCO2) annotation(Line(points = {{62, -11}, {98, -11}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(kidneyCO2.pCO2, busConnector.Kidney_PCO2) annotation(Line(points = {{62, -41}, {98, -41}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(leftHeartCO2.pCO2, busConnector.LeftHeart_PCO2) annotation(Line(points = {{62, -71}, {98, -71}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(liverCO2.pCO2, busConnector.Liver_PCO2) annotation(Line(points = {{62, 49}, {98, 49}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(otherTissueCO2.pCO2, busConnector.OtherTissue_PCO2) annotation(Line(points = {{-44, 5}, {6, 5}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(respiratoryMuscleCO2.pCO2, busConnector.RespiratoryMuscle_PCO2) annotation(Line(points = {{-44, -25}, {6, -25}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(rightHeartCO2.pCO2, busConnector.RightHeart_PCO2) annotation(Line(points = {{62, -101}, {98, -101}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(skinCO2.pCO2, busConnector.Skin_PCO2) annotation(Line(points = {{-44, -85}, {6, -85}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(skeletalMuscleCO2.pCO2, busConnector.SkeletalMuscle_PCO2) annotation(Line(points = {{-44, 63}, {5.5, 63}, {5.5, 92}, {-88, 92}}, color = {127, 0, 0}, smooth = Smooth.None));
          connect(boneCO2.cHCO3, busConnector.bone_cHCO3) annotation(Line(points = {{-46, 35}, {6, 35}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(brainCO2.cHCO3, busConnector.brain_cHCO3) annotation(Line(points = {{60, 19}, {98, 19}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(fatCO2.cHCO3, busConnector.fat_cHCO3) annotation(Line(points = {{-46, -55}, {6, -55}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(gITractCO2.cHCO3, busConnector.GITract_cHCO3) annotation(Line(points = {{60, -11}, {98, -11}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(kidneyCO2.cHCO3, busConnector.kidney_cHCO3) annotation(Line(points = {{60, -41}, {98, -41}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(leftHeartCO2.cHCO3, busConnector.leftHeart_cHCO3) annotation(Line(points = {{60, -71}, {98, -71}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(liverCO2.cHCO3, busConnector.liver_cHCO3) annotation(Line(points = {{60, 49}, {98, 49}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(otherTissueCO2.cHCO3, busConnector.otherTissue_cHCO3) annotation(Line(points = {{-46, 5}, {6, 5}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(respiratoryMuscleCO2.cHCO3, busConnector.respiratoryMuscle_cHCO3) annotation(Line(points = {{-46, -25}, {6, -25}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(rightHeartCO2.cHCO3, busConnector.rightHeart_cHCO3) annotation(Line(points = {{60, -101}, {98, -101}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(skinCO2.cHCO3, busConnector.skin_cHCO3) annotation(Line(points = {{-46, -85}, {6, -85}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(skeletalMuscleCO2.cHCO3, busConnector.skeletalMuscle_cHCO3) annotation(Line(points = {{-46, 63}, {5.5, 63}, {5.5, 92}, {-88, 92}}, color = {127, 0, 0}, smooth = Smooth.None));
          connect(boneCO2.cHCO3_interstitial, busConnector.bone_cHCO3_interstitial) annotation(Line(points = {{-42, 35}, {6, 35}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(brainCO2.cHCO3_interstitial, busConnector.brain_cHCO3_interstitial) annotation(Line(points = {{64, 19}, {98, 19}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(fatCO2.cHCO3_interstitial, busConnector.fat_cHCO3_interstitial) annotation(Line(points = {{-42, -55}, {6, -55}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(gITractCO2.cHCO3_interstitial, busConnector.GITract_cHCO3_interstitial) annotation(Line(points = {{64, -11}, {98, -11}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(kidneyCO2.cHCO3_interstitial, busConnector.kidney_cHCO3_interstitial) annotation(Line(points = {{64, -41}, {98, -41}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(leftHeartCO2.cHCO3_interstitial, busConnector.leftHeart_cHCO3_interstitial) annotation(Line(points = {{64, -71}, {98, -71}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(liverCO2.cHCO3_interstitial, busConnector.liver_cHCO3_interstitial) annotation(Line(points = {{64, 49}, {98, 49}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(otherTissueCO2.cHCO3_interstitial, busConnector.otherTissue_cHCO3_interstitial) annotation(Line(points = {{-42, 5}, {6, 5}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(respiratoryMuscleCO2.cHCO3_interstitial, busConnector.respiratoryMuscle_cHCO3_interstitial) annotation(Line(points = {{-42, -25}, {6, -25}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(rightHeartCO2.cHCO3_interstitial, busConnector.rightHeart_cHCO3_interstitial) annotation(Line(points = {{64, -101}, {98, -101}, {98, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(skinCO2.cHCO3_interstitial, busConnector.skin_cHCO3_interstitial) annotation(Line(points = {{-42, -85}, {6, -85}, {6, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None));
          connect(skeletalMuscleCO2.cHCO3_interstitial, busConnector.skeletalMuscle_cHCO3_interstitial) annotation(Line(points = {{-42, 63}, {5.5, 63}, {5.5, 92}, {-88, 92}}, color = {127, 0, 0}, smooth = Smooth.None));
          connect(liverCO2.HepaticArtyBloodFlow, busConnector.HepaticArty_BloodFlow) annotation(Line(points = {{71, 50}, {98, 50}, {98, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
          connect(busConnector.GITract_BloodFlow, liverCO2.PortalVeinBloodFlow) annotation(Line(points = {{-88, 92}, {60, 92}, {60, 69}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-3, 13}, {-3, 13}}));
          connect(gITractCO2.vein, liverCO2.portalVein) annotation(Line(points = {{52, 1}, {38, 1}, {38, 80}, {64, 80}, {64, 70}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(q_in, liverCO2.hepaticArty) annotation(Line(points = {{100, 0}, {84, 0}, {84, 61}, {72, 61}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          annotation(Icon(graphics={  Rectangle(extent=  {{-120, 100}, {120, -100}}, lineColor=  {0, 0, 0})}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
        end TissuesCO2;

        model TissueCO2
          //extends Library.Interfaces.BaseModel;
          PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow arty
            annotation (Placement(transformation(extent={{76,-66},{96,-46}}),
                iconTransformation(extent={{80,-10},{120,30}})));
          PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow vein
            annotation (Placement(transformation(extent={{-88,-66},{-68,-46}}),
                iconTransformation(extent={{-120,-10},{-80,30}})));
          PhysiolibraryOld.ConcentrationFlow.InputPump InflowBase
            annotation (Placement(transformation(extent={{-64,42},{-44,62}})));
          parameter Real initialMass;
          PhysiolibraryOld.Interfaces.RealInput_ pH_plasma "outgoing plasma pH"
            annotation (Placement(transformation(
                extent={{-3,-3},{3,3}},
                rotation=180,
                origin={9,-39}), iconTransformation(extent={{-100,-30},{-80,-10}})));
          PhysiolibraryOld.Interfaces.RealInput_ pH_ery
            "outgoing intracellular erytrocytes pH" annotation (Placement(
                transformation(
                extent={{-3,-3},{3,3}},
                rotation=180,
                origin={9,-45}), iconTransformation(extent={{-100,90},{-80,110}})));
          PhysiolibraryOld.Interfaces.RealInput_ BloodFlow
            "blood flow through ventilated alveols" annotation (Placement(
                transformation(extent={{64,-50},{58,-44}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=180,
                origin={90,54})));
          PhysiolibraryOld.Interfaces.RealInput_ T "outgoing temperature"
            annotation (Placement(transformation(
                extent={{-4,-4},{4,4}},
                rotation=180,
                origin={86,20}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=180,
                origin={90,-60})));
          PhysiolibraryOld.Interfaces.RealInput_ sO2
            "outgoing oxygen saturation" annotation (Placement(transformation(
                extent={{3,-3},{-3,3}},
                rotation=180,
                origin={-35,-47}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=0,
                origin={-90,60})));
          PhysiolibraryOld.Interfaces.RealInput_ Hct
            "outgoing hematocrit (erytrocytes volume/blood volume)" annotation (
             Placement(transformation(
                extent={{3,-3},{-3,3}},
                rotation=180,
                origin={-35,-41}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=0,
                origin={-90,-60})));
          PhysiolibraryOld.Interfaces.RealInput_ Tissue_CO2FromMetabolism
            "Co2 flow from metabolism" annotation (Placement(transformation(
                  extent={{-74,66},{-66,74}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=180,
                origin={90,-20})));
          PhysiolibraryOld.Interfaces.RealOutput_ pCO2(start=45) annotation (
              Placement(transformation(extent={{38,-82},{46,-74}}),
                iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=270,
                origin={0,-110})));
          PhysiolibraryOld.Interfaces.RealOutput_ cHCO3 annotation (Placement(
                transformation(extent={{36,-90},{44,-82}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=270,
                origin={-20,-110})));
          PhysiolibraryOld.Interfaces.RealOutput_ cHCO3_interstitial
            annotation (Placement(transformation(extent={{50,36},{58,44}}),
                iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=270,
                origin={20,-110})));
          PhysiolibraryOld.ConcentrationFlow.SolventFlowPump tissueFlow
            annotation (Placement(transformation(
                extent={{-10,10},{10,-10}},
                rotation=180,
                origin={42,-56})));
          FlowMeasureCO2 tissueVeinsCO2 annotation(Placement(transformation(extent = {{-4, -58}, {-24, -38}})));
          Modelica.Blocks.Math.Gain DonnansCoeficient(k = 1.04) annotation(Placement(transformation(extent = {{34, 36}, {42, 44}})));
        equation
          connect(arty, tissueFlow.q_in) annotation(Line(points = {{86, -56}, {52, -56}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(tissueFlow.solventFlow, BloodFlow) annotation(Line(points = {{42, -50}, {42, -47}, {61, -47}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(tissueVeinsCO2.pCO2_mmHg, pCO2) annotation(Line(points = {{-18, -60}, {-18, -78}, {42, -78}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(tissueVeinsCO2.cHCO3, cHCO3) annotation(Line(points = {{-22, -60}, {-22, -86}, {40, -86}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(tissueVeinsCO2.T, T) annotation(Line(points = {{-23, -40}, {-26, -40}, {-26, 20}, {86, 20}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(tissueVeinsCO2.Hct, Hct) annotation(Line(points = {{-23, -44}, {-29, -44}, {-29, -41}, {-35, -41}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(tissueVeinsCO2.sO2, sO2) annotation(Line(points = {{-23, -48}, {-30, -48}, {-30, -47}, {-35, -47}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(tissueVeinsCO2.pH, pH_plasma) annotation(Line(points = {{-5, -40}, {2, -40}, {2, -39}, {9, -39}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(pH_ery, tissueVeinsCO2.pH_ery) annotation(Line(points = {{9, -45}, {0.5, -45}, {0.5, -44}, {-5, -44}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(InflowBase.q_out, tissueVeinsCO2.q_in) annotation(Line(points = {{-48, 52}, {10, 52}, {10, -56}, {-4, -56}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(tissueFlow.q_out, tissueVeinsCO2.q_in) annotation(Line(points = {{32, -56}, {-4, -56}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(tissueVeinsCO2.q_out, vein) annotation(Line(points = {{-24, -56}, {-78, -56}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(BloodFlow, tissueVeinsCO2.BloodFlow) annotation(Line(points = {{61, -47}, {28.5, -47}, {28.5, -48}, {-5, -48}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(InflowBase.desiredFlow, Tissue_CO2FromMetabolism) annotation(Line(points = {{-54, 56}, {-54, 70}, {-70, 70}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(DonnansCoeficient.y, cHCO3_interstitial) annotation(Line(points = {{42.4, 40}, {54, 40}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(tissueVeinsCO2.cHCO3, DonnansCoeficient.u) annotation(Line(points = {{-22, -60}, {-22, -86}, {26, -86}, {26, 40}, {33.2, 40}}, color = {0, 0, 127}, smooth = Smooth.None));
          annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Text(extent=  {{-100, -80}, {100, -100}}, lineColor=  {127, 0, 0}, fillPattern=  FillPattern.Solid, textString=  "(init %initialMass mEq)"), Text(extent=  {{-6, 92}, {80, 34}}, lineColor=  {0, 0, 0}, textString=  "CO"), Text(extent=  {{66, 34}, {86, 62}}, lineColor=  {0, 0, 0}, textString=  "2"), Rectangle(extent=  {{-100, 100}, {100, -100}}, lineColor=  {0, 0, 0})}));
        end TissueCO2;

        model TissueCO2_liver
          extends PhysiolibraryOld.Icons.Liver;
          PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow vein
            annotation (Placement(transformation(extent={{-42,-66},{-22,-46}}),
                iconTransformation(extent={{-120,-10},{-80,30}})));
          PhysiolibraryOld.ConcentrationFlow.InputPump InflowBase
            annotation (Placement(transformation(extent={{-64,24},{-44,44}})));
          parameter Real initialMass;
          PhysiolibraryOld.Interfaces.RealInput_ pH_plasma "outgoing plasma pH"
            annotation (Placement(transformation(
                extent={{-3,-3},{3,3}},
                rotation=180,
                origin={7,-37}), iconTransformation(extent={{-100,-30},{-80,-10}})));
          PhysiolibraryOld.Interfaces.RealInput_ pH_ery
            "outgoing intracellular erytrocytes pH" annotation (Placement(
                transformation(
                extent={{-3,-3},{3,3}},
                rotation=180,
                origin={7,-43}), iconTransformation(extent={{-100,90},{-80,110}})));
          PhysiolibraryOld.Interfaces.RealInput_ T "outgoing temperature"
            annotation (Placement(transformation(
                extent={{-4,-4},{4,4}},
                rotation=180,
                origin={86,20}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=180,
                origin={90,58})));
          PhysiolibraryOld.Interfaces.RealInput_ sO2
            "outgoing oxygen saturation" annotation (Placement(transformation(
                extent={{3,-3},{-3,3}},
                rotation=180,
                origin={-35,-47}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=0,
                origin={-90,60})));
          PhysiolibraryOld.Interfaces.RealInput_ Hct
            "outgoing hematocrit (erytrocytes volume/blood volume)" annotation (
             Placement(transformation(
                extent={{3,-3},{-3,3}},
                rotation=180,
                origin={-35,-41}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=0,
                origin={-90,-60})));
          PhysiolibraryOld.Interfaces.RealOutput_ pCO2 annotation (Placement(
                transformation(extent={{38,-82},{46,-74}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=270,
                origin={0,-110})));
          PhysiolibraryOld.Interfaces.RealOutput_ cHCO3 annotation (Placement(
                transformation(extent={{36,-90},{44,-82}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=270,
                origin={-20,-110})));
          PhysiolibraryOld.Interfaces.RealOutput_ cHCO3_interstitial
            annotation (Placement(transformation(extent={{50,36},{58,44}}),
                iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=270,
                origin={20,-110})));
          PhysiolibraryOld.ConcentrationFlow.SolventFlowPump tissueFlow
            annotation (Placement(transformation(
                extent={{-10,10},{10,-10}},
                rotation=180,
                origin={42,-56})));
          FlowMeasureCO2 tissueVeinsCO2 annotation(Placement(transformation(extent = {{-4, -58}, {-24, -38}})));
          PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow
            portalVein annotation (Placement(transformation(extent={{68,-86},{
                    88,-66}}), iconTransformation(extent={{0,80},{40,120}})));
          PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow
            hepaticArty annotation (Placement(transformation(extent={{78,-66},{
                    98,-46}}), iconTransformation(extent={{80,-10},{120,30}})));
          PhysiolibraryOld.Interfaces.RealInput_ HepaticArtyBloodFlow
            "blood flow through hepatic artery" annotation (Placement(
                transformation(extent={{62,-50},{54,-42}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=180,
                origin={90,-100})));
          PhysiolibraryOld.Interfaces.RealInput_ PortalVeinBloodFlow
            "blood flow through portal vein" annotation (Placement(
                transformation(
                extent={{-4,-4},{4,4}},
                rotation=180,
                origin={46,-28}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=270,
                origin={-20,90})));
          Modelica.Blocks.Math.Add add annotation(Placement(transformation(extent = {{-4, -4}, {4, 4}}, rotation = 180, origin = {30, -40})));
          PhysiolibraryOld.Interfaces.RealInput_ Tissue_CO2FromMetabolism
            "Co2 flow from metabolism" annotation (Placement(transformation(
                  extent={{-72,40},{-64,48}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=180,
                origin={90,-40})));
          Modelica.Blocks.Math.Gain DonnansCoeficient(k = 1.04) annotation(Placement(transformation(extent = {{32, 36}, {40, 44}})));
        equation
          connect(tissueVeinsCO2.pCO2_mmHg, pCO2) annotation(Line(points = {{-18, -60}, {-18, -78}, {42, -78}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(tissueVeinsCO2.cHCO3, cHCO3) annotation(Line(points = {{-22, -60}, {-22, -86}, {40, -86}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(tissueVeinsCO2.T, T) annotation(Line(points = {{-23, -40}, {-26, -40}, {-26, 20}, {86, 20}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(tissueVeinsCO2.Hct, Hct) annotation(Line(points = {{-23, -44}, {-29, -44}, {-29, -41}, {-35, -41}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(tissueVeinsCO2.sO2, sO2) annotation(Line(points = {{-23, -48}, {-30, -48}, {-30, -47}, {-35, -47}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(tissueVeinsCO2.pH, pH_plasma) annotation(Line(points = {{-5, -40}, {0, -40}, {0, -37}, {7, -37}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(pH_ery, tissueVeinsCO2.pH_ery) annotation(Line(points = {{7, -43}, {0.5, -43}, {0.5, -44}, {-5, -44}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(InflowBase.q_out, tissueVeinsCO2.q_in) annotation(Line(points = {{-48, 34}, {10, 34}, {10, -56}, {-4, -56}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(tissueFlow.q_out, tissueVeinsCO2.q_in) annotation(Line(points = {{32, -56}, {-4, -56}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(tissueVeinsCO2.q_out, vein) annotation(Line(points = {{-24, -56}, {-32, -56}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(hepaticArty, tissueFlow.q_in) annotation(Line(points = {{88, -56}, {52, -56}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(tissueVeinsCO2.q_in, portalVein) annotation(Line(points = {{-4, -56}, {24, -56}, {24, -74}, {78, -74}, {78, -76}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
          connect(HepaticArtyBloodFlow, tissueFlow.solventFlow) annotation(Line(points = {{58, -46}, {42, -46}, {42, -50}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(PortalVeinBloodFlow, add.u2) annotation(Line(points = {{46, -28}, {40, -28}, {40, -37.6}, {34.8, -37.6}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(HepaticArtyBloodFlow, add.u1) annotation(Line(points = {{58, -46}, {42, -46}, {42, -42.4}, {34.8, -42.4}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(add.y, tissueVeinsCO2.BloodFlow) annotation(Line(points = {{25.6, -40}, {24, -40}, {24, -48}, {-5, -48}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(InflowBase.desiredFlow, Tissue_CO2FromMetabolism) annotation(Line(points = {{-54, 38}, {-54, 44}, {-68, 44}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(DonnansCoeficient.y, cHCO3_interstitial) annotation(Line(points = {{40.4, 40}, {54, 40}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(tissueVeinsCO2.cHCO3, DonnansCoeficient.u) annotation(Line(points = {{-22, -60}, {-22, -86}, {20, -86}, {20, 40}, {31.2, 40}}, color = {0, 0, 127}, smooth = Smooth.None));
          annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Text(extent=  {{-100, -80}, {100, -100}}, lineColor=  {127, 0, 0}, fillPattern=  FillPattern.Solid, textString=  "(init %initialMass mEq)"), Text(extent=  {{-6, 92}, {80, 34}}, lineColor=  {0, 0, 0}, textString=  "CO"), Text(extent=  {{66, 34}, {86, 62}}, lineColor=  {0, 0, 0}, textString=  "2"), Rectangle(extent=  {{-100, 100}, {100, -100}}, lineColor=  {0, 0, 0})}));
        end TissueCO2_liver;

        model SkeletalMuscleCO2
          extends TissueCO2;
          extends PhysiolibraryOld.Icons.SkeletalMuscle;
        end SkeletalMuscleCO2;

        model BoneCO2
          extends TissueCO2;
          extends PhysiolibraryOld.Icons.Bone;
        end BoneCO2;

        model OtherTissueCO2
          extends TissueCO2;
          extends PhysiolibraryOld.Icons.OtherTissue;
        end OtherTissueCO2;

        model RespiratoryMuscleCO2
          extends TissueCO2;
          extends PhysiolibraryOld.Icons.RespiratoryMuscle;
        end RespiratoryMuscleCO2;

        model FatCO2
          extends TissueCO2;
          extends PhysiolibraryOld.Icons.Fat;
        end FatCO2;

        model SkinCO2
          extends TissueCO2;
          extends PhysiolibraryOld.Icons.Skin;
        end SkinCO2;

        model BrainCO2
          extends TissueCO2;
          extends PhysiolibraryOld.Icons.Brain;
        end BrainCO2;

        model GITractCO2
          extends TissueCO2;
          extends PhysiolibraryOld.Icons.GITract;
        end GITractCO2;

        model LeftHeartCO2
          extends TissueCO2;
          extends PhysiolibraryOld.Icons.LeftHeart;
        end LeftHeartCO2;

        model RightHeartCO2
          extends TissueCO2;
          extends PhysiolibraryOld.Icons.RightHeart;
        end RightHeartCO2;

        model KidneyCO2
          extends TissueCO2;
          extends PhysiolibraryOld.Icons.Kidney;
        end KidneyCO2;
      end TissuesWithInterstitium;

      model ExternalCO2
        extends PhysiolibraryOld.ConcentrationFlow.UnlimitedStorage;
        extends PhysiolibraryOld.Icons.Carbondioxyd;
        annotation(Icon(graphics));
      end ExternalCO2;
      annotation(Documentation(revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr><tr>
                   <td></td>
                   <td>Siggaard Andersen: OSA (2005), University of Copenhagen</td>
                   </tr>
                   </table>
                   </html>"));
    end CO2;

    package AcidBase "Body Acid-Base Balance"
      partial model BloodPhBase
        import Modelica.Math;
        Real betaX(unit = "mEq/l") "buffer value of blood";
        Real betaP(unit = "mEq/l") "buffer value of plasma";
        Real _cTH(unit = "mEq/l")
          "total concentration of tiratable hydrogen ions";
        Real _BE(unit = "mEq/l") "base excess";
        Real _BEox(unit = "mEq/l") "base excess in fully oxygenated blood";
        Real _cTHox(unit = "mEq/l")
          "total concentration of tiratable hydrogen ions in fully oxygenated blood";
        PhysiolibraryOld.Interfaces.RealOutput_ pH(start=7.4) "plasma pH"
          annotation (Placement(transformation(extent={{30,-98},{70,-58}}),
              iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=270,
              origin={-20,-120})));
        PhysiolibraryOld.Interfaces.RealOutput_ pH_ery
          "intracellular erytrocytes pH" annotation (Placement(transformation(
                extent={{-14,-98},{26,-58}}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=270,
              origin={20,-120})));
        PhysiolibraryOld.Interfaces.RealInput_ cHCO3(final unit="mmol/l")
          "concentration of plasma HCO3 ions (default=24.5mmol/l)" annotation (
            Placement(transformation(extent={{50,18},{90,58}}),
              iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=180,
              origin={90,80})));
        PhysiolibraryOld.Interfaces.RealInput_ ctHb(final unit="mmol/l")
          "concentration of total haemoglobin in whole blood (8.4)" annotation (
           Placement(transformation(extent={{50,58},{90,98}}),
              iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=180,
              origin={90,40})));
        parameter Real cHb(unit = "mmol/l") = 43
          "an empirical parameter accounting for erythrocyte plasma distributions = concentration of Hb inside erythrocytes divided by (1-0.57)";
        PhysiolibraryOld.Interfaces.RealInput_ sO2 "oxygen saturation"
          annotation (Placement(transformation(extent={{-100,60},{-60,100}}),
              iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=270,
              origin={60,110})));
        PhysiolibraryOld.Interfaces.RealInput_ ctAlb(final unit="mmol/l")
          "concentration of total plasma albumins(dofault=0.65mmol/l)"
          annotation (Placement(transformation(extent={{52,-26},{92,14}}),
              iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=180,
              origin={90,0})));
        PhysiolibraryOld.Interfaces.RealInput_ ctGlb(final unit="g/l")
          "concentration of total plasma globulins" annotation (Placement(
              transformation(extent={{52,-60},{92,-20}}), iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=180,
              origin={90,-40})));
        PhysiolibraryOld.Interfaces.RealInput_ ctPO4(final unit="mmol/l")
          "concentration of total inorganic phosphate in plasma" annotation (
            Placement(transformation(extent={{54,-92},{94,-52}}),
              iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=180,
              origin={90,-80})));
      equation
        //Van Slyke equation:  - T=37
        _cTH = -(1 - ctHb / cHb) * (cHCO3 - 24.5 + betaX * (pH - 7.4));
        //  _cTH = -(1-(1-0.57)*(0.44))*((cHCO3-24.5)+betaX*(pH-7.4));
        betaX = 2.3 * ctHb + betaP;
        betaP = 8 * ctAlb + 0.075 * ctGlb + 0.309 * ctPO4;
        //  _betaX = 0.11 * plasmaProteinConc(unit="g/l"); //mmol/l
        //Haldane effect:
        _cTH = homotopy(_cTHox - 0.3 * (1 - sO2), _cTHox);
        //base excess
        _BEox = -_cTHox;
        _BE = -_cTH;
        //erythrocytes:
        pH_ery = homotopy(7.19 + 0.77 * (pH - 7.4) + 0.035 * (1 - sO2), 7.19 + 0.77 * (pH - 7.4));
        annotation(preferredView = text, Documentation(info = "<html>
                   <pre>Blood pH calculation by 
                   <i><b>Van Slyke equation</b></i>,
                   <i><b>Haldame</b></i> effect
                   and plasma-<i><b>erythrocytes</b></i> acidity distribution.</pre>
                   </html>", revisions = "<html>
                   <table cellspacing=\"2\" cellpadding=\"0\" border=\"0\"><tr>
                   <td><p>Author:</p></td>
                   <td><p>Marek Matejak</p></td>
                   </tr>
                   <tr>
                   <td><p>Copyright:</p></td>
                   <td><p>In public domains</p></td>
                   </tr>
                   <tr>
                   <td><p>By:</p></td>
                   <td><p>Charles University, Prague</p></td>
                   </tr>
                   <tr>
                   <td><p>Date of:</p></td>
                   <td><p>dec 2009</p></td>
                   </tr>
                   <tr>
                   <td><p>References:</p></td>
                   <td>Siggaard Andersen: OSA (2005), University of Copenhagen</td>
                   </tr>
                   </table>
                   </html>"), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Text(extent=  {{-72, -56}, {76, -92}}, lineColor=  {0, 0, 255}, textString=  "%name"), Rectangle(extent=  {{-100, 100}, {100, -100}}, lineColor=  {0, 0, 255}, fillColor=  {215, 215, 215}, fillPattern=  FillPattern.Solid), Text(extent=  {{-96, -62}, {98, -94}}, lineColor=  {0, 0, 255}, textString=  "%name")}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
      end BloodPhBase;

      package Tissues
        "Acidity of tissue veins, interstitium or intracellular space"
        model TissuesPh_interstitial
          //extends Library.Interfaces.BaseModel;
          SkeletalMuscleInterstitialPh skeletalMuscle annotation(Placement(transformation(extent = {{-54, 66}, {-34, 86}})));
          BoneInterstitialPh bone annotation(Placement(transformation(extent = {{-54, 36}, {-34, 56}})));
          FatInterstitialPh fat annotation(Placement(transformation(extent = {{-54, -54}, {-34, -34}})));
          BrainInterstitialPh brain annotation(Placement(transformation(extent = {{52, 28}, {72, 48}})));
          RightHeartInterstitialPh rightHeart annotation(Placement(transformation(extent = {{52, -92}, {72, -72}})));
          RespiratoryMuscleInterstitialPh respiratoryMuscle annotation(Placement(transformation(extent = {{-54, -24}, {-34, -4}})));
          OtherTissueInterstitialPh otherTissue annotation(Placement(transformation(extent = {{-54, 6}, {-34, 26}})));
          LiverInterstitialPh liver annotation(Placement(transformation(extent = {{52, 60}, {72, 80}})));
          LeftHeartInterstitialPh leftHeart annotation(Placement(transformation(extent = {{52, -62}, {72, -42}})));
          KidneyInterstitialPh kidney annotation(Placement(transformation(extent = {{52, -32}, {72, -12}})));
          GITractInterstitialPh GITract annotation(Placement(transformation(extent = {{52, -2}, {72, 18}})));
          PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
              Placement(transformation(extent={{-108,72},{-68,112}})));
          SkinInterstitialPh skin annotation(Placement(transformation(extent = {{-54, -84}, {-34, -64}})));
        equation
          connect(busConnector.bone_cHCO3_interstitial, bone.cHCO3) annotation(Line(points = {{-88, 92}, {-88, 42}, {-53, 42}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.brain_cHCO3_interstitial, brain.cHCO3) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 34}, {53, 34}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.fat_cHCO3_interstitial, fat.cHCO3) annotation(Line(points = {{-88, 92}, {-88, -48}, {-53, -48}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.GITract_cHCO3_interstitial, GITract.cHCO3) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 4}, {53, 4}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.kidney_cHCO3_interstitial, kidney.cHCO3) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -26}, {53, -26}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.leftHeart_cHCO3_interstitial, leftHeart.cHCO3) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -56}, {53, -56}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.liver_cHCO3_interstitial, liver.cHCO3) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 66}, {53, 66}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.otherTissue_cHCO3_interstitial, otherTissue.cHCO3) annotation(Line(points = {{-88, 92}, {-88, 12}, {-53, 12}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.respiratoryMuscle_cHCO3_interstitial, respiratoryMuscle.cHCO3) annotation(Line(points = {{-88, 92}, {-88, -18}, {-53, -18}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.rightHeart_cHCO3_interstitial, rightHeart.cHCO3) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -86}, {53, -86}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.skin_cHCO3_interstitial, skin.cHCO3) annotation(Line(points = {{-88, 92}, {-88, -78}, {-53, -78}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.skeletalMuscle_cHCO3_interstitial, skeletalMuscle.cHCO3) annotation(Line(points = {{-88, 92}, {-87.5, 92}, {-87.5, 72}, {-53, 72}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.bone_pCO2, bone.pCO2) annotation(Line(points = {{-88, 92}, {-88, 54}, {-53, 54}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.brain_pCO2, brain.pCO2) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 46}, {53, 46}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.fat_pCO2, fat.pCO2) annotation(Line(points = {{-88, 92}, {-88, -36}, {-53, -36}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.GITract_pCO2, GITract.pCO2) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 16}, {53, 16}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.kidney_pCO2, kidney.pCO2) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -14}, {53, -14}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.leftHeart_pCO2, leftHeart.pCO2) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -44}, {53, -44}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.liver_pCO2, liver.pCO2) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 78}, {53, 78}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.otherTissue_pCO2, otherTissue.pCO2) annotation(Line(points = {{-88, 92}, {-88, 24}, {-53, 24}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.respiratoryMuscle_pCO2, respiratoryMuscle.pCO2) annotation(Line(points = {{-88, 92}, {-88, -6}, {-53, -6}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.rightHeart_pCO2, rightHeart.pCO2) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -74}, {53, -74}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.skin_pCO2, skin.pCO2) annotation(Line(points = {{-88, 92}, {-88, -66}, {-53, -66}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.skeletalMuscle_pCO2, skeletalMuscle.pCO2) annotation(Line(points = {{-88, 92}, {-87.5, 92}, {-87.5, 84}, {-53, 84}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.bone_T, bone.T) annotation(Line(points = {{-88, 92}, {-88, 38.8}, {-53, 38.8}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.brain_T, brain.T) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 30.8}, {53, 30.8}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.fat_T, fat.T) annotation(Line(points = {{-88, 92}, {-88, -51.2}, {-53, -51.2}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.GITract_T, GITract.T) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 0.8}, {53, 0.8}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.kidney_T, kidney.T) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -29.2}, {53, -29.2}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.leftHeart_T, leftHeart.T) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -59.2}, {53, -59.2}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.liver_T, liver.T) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 62.8}, {53, 62.8}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.otherTissue_T, otherTissue.T) annotation(Line(points = {{-88, 92}, {-88, 8.800000000000001}, {-53, 8.800000000000001}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.respiratoryMuscle_T, respiratoryMuscle.T) annotation(Line(points = {{-88, 92}, {-88, -21.2}, {-53, -21.2}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.rightHeart_T, rightHeart.T) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -89.2}, {53, -89.2}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.skin_T, skin.T) annotation(Line(points = {{-88, 92}, {-88, -81.2}, {-53, -81.2}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.skeletalMuscle_T, skeletalMuscle.T) annotation(Line(points = {{-88, 92}, {-87.5, 92}, {-87.5, 68.8}, {-53, 68.8}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(bone.pH_interstitial, busConnector.bone_pH_interstitial) annotation(Line(points = {{-38, 34}, {6, 34}, {6, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(brain.pH_interstitial, busConnector.brain_pH_interstitial) annotation(Line(points = {{68, 26}, {6, 26}, {6, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(fat.pH_interstitial, busConnector.fat_pH_interstitial) annotation(Line(points = {{-38, -56}, {6, -56}, {6, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(GITract.pH_interstitial, busConnector.GITract_pH_interstitial) annotation(Line(points = {{68, -4}, {6, -4}, {6, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(kidney.pH_interstitial, busConnector.kidney_pH_interstitial) annotation(Line(points = {{68, -34}, {6, -34}, {6, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(leftHeart.pH_interstitial, busConnector.leftHeart_pH_interstitial) annotation(Line(points = {{68, -64}, {6, -64}, {6, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(liver.pH_interstitial, busConnector.liver_pH_interstitial) annotation(Line(points = {{68, 58}, {6, 58}, {6, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(otherTissue.pH_interstitial, busConnector.otherTissue_pH_interstitial) annotation(Line(points = {{-38, 4}, {6, 4}, {6, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(rightHeart.pH_interstitial, busConnector.rightHeart_pH_interstitial) annotation(Line(points = {{68, -94}, {6, -94}, {6, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(respiratoryMuscle.pH_interstitial, busConnector.respiratoryMuscle_pH_interstitial) annotation(Line(points = {{-38, -26}, {6, -26}, {6, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(skin.pH_interstitial, busConnector.skin_pH_interstitial) annotation(Line(points = {{-38, -86}, {6, -86}, {6, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(skeletalMuscle.pH_interstitial, busConnector.skeletalMuscle_pH_interstitial) annotation(Line(points = {{-38, 64}, {6, 64}, {6, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
          annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Rectangle(extent=  {{-100, 100}, {100, -100}}, lineColor=  {0, 0, 255}, fillColor=  {215, 215, 215}, fillPattern=  FillPattern.Solid), Text(extent=  {{-96, -62}, {98, -94}}, lineColor=  {0, 0, 255}, textString=  "%name"), Text(extent=  {{-88, 6}, {-24, 34}}, lineColor=  {0, 0, 0}, textString=  "IST"), Text(extent=  {{30, 36}, {96, -18}}, lineColor=  {0, 0, 0}, textString=  "pH")}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Documentation(info = "<html>
                   <p>BE_interstitial is base excess in the interstitium of the tissue. The standard value is 0, when strong acid concentration increase, then BE value decrease with the same concentration. </p>
                   <p>Meaning might be interpreted like what amount of hydrogen iont must be added to sollution if the end poit of titration will be pH=7.4 and pCO2=5.3kPa.</p>
                   <p>For any tissue can be simplified with difference of lactate concentration from its normal value.</p>
                   </html>", revisions = "<html>
                   <table cellspacing=\"2\" cellpadding=\"0\" border=\"0\"><tr>
                   <td><p>Author:</p></td>
                   <td><p>Marek Matejak</p></td>
                   </tr>
                   <tr>
                   <td><p>Copyright:</p></td>
                   <td><p>In public domains</p></td>
                   </tr>
                   <tr>
                   <td><p>By:</p></td>
                   <td><p>Charles University, Prague</p></td>
                   </tr>
                   <tr>
                   <td><p>Date of:</p></td>
                   <td><p>2009</p></td>
                   </tr>
                   <tr>
                   <td><p>References:</p></td>
                   <td>Siggaard Andersen: OSA (2005), University of Copenhagen</td>
                   </tr>
                   </table>
                   </html>"));
        end TissuesPh_interstitial;

        model TissuePh_interstitial
          PhysiolibraryOld.Interfaces.RealInput_ cHCO3(final unit="mEq/ml")
            "tissue interstitial bicarbonate concentration" annotation (
              Placement(transformation(extent={{-106,-4},{-90,12}}),
                iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=0,
                origin={-90,-40})));
          PhysiolibraryOld.Interfaces.RealOutput_ pH_interstitial
            "tissue interstitial pH" annotation (Placement(transformation(
                  extent={{24,-16},{44,4}}), iconTransformation(
                extent={{-20,-20},{20,20}},
                rotation=270,
                origin={60,-120})));
          CO2.TissueHCO3 interstitium annotation(Placement(transformation(extent = {{-22, 2}, {-2, 22}})));
          Modelica.Blocks.Math.InverseBlockConstraints inverseBlockConstraints annotation(Placement(transformation(extent = {{-34, -16}, {8, 38}})));
          PhysiolibraryOld.Interfaces.RealInput_ T(final unit="degC")
            "tissue interstitial bicarbonate concentration" annotation (
              Placement(transformation(extent={{62,24},{40,2}}),
                iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=0,
                origin={-90,-72})));
          PhysiolibraryOld.Interfaces.RealInput_ pCO2(final unit="mmHg")
            "tissue interstitial bicarbonate concentration" annotation (
              Placement(transformation(extent={{-56,18},{-38,36}}),
                iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=0,
                origin={-90,80})));
        equation
          connect(interstitium.cHCO3, inverseBlockConstraints.u2) annotation(Line(points = {{-4, 0}, {-4, -8}, {-26, -8}, {-26, 11}, {-29.8, 11}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(interstitium.pH, inverseBlockConstraints.y2) annotation(Line(points = {{-21, 20}, {-24, 20}, {-24, 30}, {2, 30}, {2, 11}, {4.85, 11}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(interstitium.T, T) annotation(Line(points = {{-3, 20}, {30, 20}, {30, 13}, {51, 13}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(inverseBlockConstraints.y1, pH_interstitial) annotation(Line(points = {{9.050000000000001, 11}, {24, 11}, {24, -6}, {34, -6}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(interstitium.pCO2_mmHg, pCO2) annotation(Line(points = {{-21, 16.2}, {-25.5, 16.2}, {-25.5, 27}, {-47, 27}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(cHCO3, inverseBlockConstraints.u1) annotation(Line(points = {{-98, 4}, {-68, 4}, {-68, 11}, {-36.1, 11}}, color = {0, 0, 127}, smooth = Smooth.None));
          annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Rectangle(extent=  {{-100, 100}, {100, -100}}, lineColor=  {0, 0, 0}), Text(extent=  {{34, 102}, {100, 48}}, lineColor=  {0, 0, 0}, textString=  "pH"), Text(extent=  {{-84, 72}, {-20, 100}}, lineColor=  {0, 0, 0}, textString=  "IST")}), Documentation(revisions = "<html>
                   <table cellspacing=\"2\" cellpadding=\"0\" border=\"0\"><tr>
                   <td><p>Author:</p></td>
                   <td><p>Marek Matejak</p></td>
                   </tr>
                   <tr>
                   <td><p>Copyright:</p></td>
                   <td><p>In public domains</p></td>
                   </tr>
                   <tr>
                   <td><p>By:</p></td>
                   <td><p>Charles University, Prague</p></td>
                   </tr>
                   <tr>
                   <td><p>Date of:</p></td>
                   <td><p>2009</p></td>
                   </tr>
                   <tr>
                   <td><p>References:</p></td>
                   <td>Siggaard Andersen: OSA (2005), University of Copenhagen</td>
                   </tr>
                   </table>
                   </html>"));
        end TissuePh_interstitial;

        model TissuesPh_intracellular
          // extends Library.Interfaces.BaseModel;
          SkeletalMuscleIntracellularPh skeletalMuscle annotation(Placement(transformation(extent = {{-54, 64}, {-34, 84}})));
          BoneIntracellularPh bone annotation(Placement(transformation(extent = {{-54, 36}, {-34, 56}})));
          FatIntracellularPh fat annotation(Placement(transformation(extent = {{-54, -54}, {-34, -34}})));
          BrainIntracellularPh brain annotation(Placement(transformation(extent = {{52, 28}, {72, 48}})));
          RightHeartIntracellularPh rightHeart annotation(Placement(transformation(extent = {{52, -92}, {72, -72}})));
          RespiratoryMuscleIntracellularPh respiratoryMuscle annotation(Placement(transformation(extent = {{-54, -24}, {-34, -4}})));
          OtherTissueIntracellularPh otherTissue annotation(Placement(transformation(extent = {{-54, 6}, {-34, 26}})));
          LiverIntracellularPh liver annotation(Placement(transformation(extent = {{52, 60}, {72, 80}})));
          LeftHeartIntracellularPh leftHeart annotation(Placement(transformation(extent = {{52, -62}, {72, -42}})));
          KidneyIntracellularPh kidney annotation(Placement(transformation(extent = {{52, -32}, {72, -12}})));
          GITractIntracellularPh GITract annotation(Placement(transformation(extent = {{52, -2}, {72, 18}})));
          PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
              Placement(transformation(extent={{-108,72},{-68,112}})));
          SkinIntracellularPh skin annotation(Placement(transformation(extent = {{-54, -84}, {-34, -64}})));
        equation
          connect(busConnector.KCell_conc_per_liter, bone.KCell) annotation(Line(points = {{-88, 92}, {-88, 46}, {-53, 46}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.KCell_conc_per_liter, brain.KCell) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 38}, {53, 38}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.KCell_conc_per_liter, fat.KCell) annotation(Line(points = {{-88, 92}, {-88, -44}, {-53, -44}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.KCell_conc_per_liter, GITract.KCell) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 8}, {53, 8}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.KCell_conc_per_liter, kidney.KCell) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -22}, {53, -22}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.KCell_conc_per_liter, leftHeart.KCell) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -52}, {53, -52}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.KCell_conc_per_liter, liver.KCell) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 70}, {53, 70}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.KCell_conc_per_liter, otherTissue.KCell) annotation(Line(points = {{-88, 92}, {-88, 16}, {-53, 16}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.KCell_conc_per_liter, respiratoryMuscle.KCell) annotation(Line(points = {{-88, 92}, {-88, -14}, {-53, -14}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.KCell_conc_per_liter, rightHeart.KCell) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -82}, {53, -82}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.KCell_conc_per_liter, skin.KCell) annotation(Line(points = {{-88, 92}, {-88, -74}, {-53, -74}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.KCell_conc_per_liter, skeletalMuscle.KCell) annotation(Line(points = {{-88, 92}, {-87.5, 92}, {-87.5, 74}, {-53, 74}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.bone_cLactate, bone.cLactate) annotation(Line(points = {{-88, 92}, {-88, 42}, {-53, 42}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.brain_cLactate, brain.cLactate) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 34}, {53, 34}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.fat_cLactate, fat.cLactate) annotation(Line(points = {{-88, 92}, {-88, -48}, {-53, -48}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.GITract_cLactate, GITract.cLactate) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 4}, {53, 4}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.kidney_cLactate, kidney.cLactate) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -26}, {53, -26}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.leftHeart_cLactate, leftHeart.cLactate) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -56}, {53, -56}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.liver_cLactate, liver.cLactate) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 66}, {53, 66}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.otherTissue_cLactate, otherTissue.cLactate) annotation(Line(points = {{-88, 92}, {-88, 12}, {-53, 12}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.respiratoryMuscle_cLactate, respiratoryMuscle.cLactate) annotation(Line(points = {{-88, 92}, {-88, -18}, {-53, -18}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.rightHeart_cLactate, rightHeart.cLactate) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -86}, {53, -86}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.skin_cLactate, skin.cLactate) annotation(Line(points = {{-88, 92}, {-88, -78}, {-53, -78}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.skeletalMuscle_cLactate, skeletalMuscle.cLactate) annotation(Line(points = {{-88, 92}, {-87.5, 92}, {-87.5, 70}, {-53, 70}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.bone_pCO2, bone.pCO2) annotation(Line(points = {{-88, 92}, {-88, 54}, {-53, 54}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.brain_pCO2, brain.pCO2) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 46}, {53, 46}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.fat_pCO2, fat.pCO2) annotation(Line(points = {{-88, 92}, {-88, -36}, {-53, -36}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.GITract_pCO2, GITract.pCO2) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 16}, {53, 16}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.kidney_pCO2, kidney.pCO2) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -14}, {53, -14}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.leftHeart_pCO2, leftHeart.pCO2) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -44}, {53, -44}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.liver_pCO2, liver.pCO2) annotation(Line(points = {{-88, 92}, {6, 92}, {6, 78}, {53, 78}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.otherTissue_pCO2, otherTissue.pCO2) annotation(Line(points = {{-88, 92}, {-88, 24}, {-53, 24}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.respiratoryMuscle_pCO2, respiratoryMuscle.pCO2) annotation(Line(points = {{-88, 92}, {-88, -6}, {-53, -6}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.rightHeart_pCO2, rightHeart.pCO2) annotation(Line(points = {{-88, 92}, {6, 92}, {6, -74}, {53, -74}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.skin_pCO2, skin.pCO2) annotation(Line(points = {{-88, 92}, {-88, -66}, {-53, -66}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.skeletalMuscle_pCO2, skeletalMuscle.pCO2) annotation(Line(points = {{-88, 92}, {-87.5, 92}, {-87.5, 82}, {-53, 82}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(bone.pH, busConnector.bone_pH_intracellular) annotation(Line(points = {{-38, 34}, {6, 34}, {6, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(brain.pH, busConnector.brain_pH_intracellular) annotation(Line(points = {{68, 26}, {6, 26}, {6, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(fat.pH, busConnector.fat_pH_intracellular) annotation(Line(points = {{-38, -56}, {6, -56}, {6, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(GITract.pH, busConnector.GITract_pH_intracellular) annotation(Line(points = {{68, -4}, {6, -4}, {6, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(kidney.pH, busConnector.kidney_pH_intracellular) annotation(Line(points = {{68, -34}, {6, -34}, {6, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(leftHeart.pH, busConnector.leftHeart_pH_intracellular) annotation(Line(points = {{68, -64}, {6, -64}, {6, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(liver.pH, busConnector.liver_pH_intracellular) annotation(Line(points = {{68, 58}, {6, 58}, {6, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(otherTissue.pH, busConnector.otherTissue_pH_intracellular) annotation(Line(points = {{-38, 4}, {6, 4}, {6, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(rightHeart.pH, busConnector.rightHeart_pH_intracellular) annotation(Line(points = {{68, -94}, {6, -94}, {6, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(respiratoryMuscle.pH, busConnector.respiratoryMuscle_pH_intracellular) annotation(Line(points = {{-38, -26}, {6, -26}, {6, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(skin.pH, busConnector.skin_pH_intracellular) annotation(Line(points = {{-38, -86}, {6, -86}, {6, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(skeletalMuscle.pH, busConnector.skeletalMuscle_pH_intracellular) annotation(Line(points = {{-38, 62}, {6, 62}, {6, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
          annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Rectangle(extent=  {{-100, 100}, {100, -100}}, lineColor=  {0, 0, 255}, fillColor=  {215, 215, 215}, fillPattern=  FillPattern.Solid), Text(extent=  {{-96, -62}, {98, -94}}, lineColor=  {0, 0, 255}, textString=  "%name"), Text(extent=  {{-90, 0}, {-26, 28}}, lineColor=  {0, 0, 0}, textString=  "ICF"), Text(extent=  {{28, 30}, {94, -24}}, lineColor=  {0, 0, 0}, textString=  "pH")}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Documentation(info = "<html>
                   <p>BE_interstitial is base excess in the interstitium of the tissue. The standard value is 0, when strong acid concentration increase, then BE value decrease with the same concentration. </p>
                   <p>Meaning might be interpreted like what amount of hydrogen iont must be added to sollution if the end poit of titration will be pH=7.4 and pCO2=5.3kPa.</p>
                   <p>For any tissue can be simplified with difference of lactate concentration from its normal value.</p>
                   </html>", revisions = "<html>
                   <table cellspacing=\"2\" cellpadding=\"0\" border=\"0\"><tr>
                   <td><p>Author:</p></td>
                   <td><p>Marek Matejak</p></td>
                   </tr>
                   <tr>
                   <td><p>Copyright:</p></td>
                   <td><p>In public domains</p></td>
                   </tr>
                   <tr>
                   <td><p>By:</p></td>
                   <td><p>Charles University, Prague</p></td>
                   </tr>
                   <tr>
                   <td><p>Date of:</p></td>
                   <td><p>2009</p></td>
                   </tr>
                   <tr>
                   <td><p>References:</p></td>
                   <td><p>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</p></td>
                   </tr>
                   </table>
                   </html>"));
        end TissuesPh_intracellular;

        model TissuePh_intracellular
          parameter Real CellSID_OtherCations(final unit = "mEq/l") = 12;
          parameter Real CellSID_StrongAnions(final unit = "mEq/l") = 117;
          PhysiolibraryOld.Interfaces.RealInput_ KCell(final unit="mEq/l")
            "tissue interstitial titratable acidity" annotation (Placement(
                transformation(extent={{-94,4},{-54,44}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=0,
                origin={-90,0})));
          PhysiolibraryOld.Interfaces.RealInput_ cLactate(final unit="mEq/l")
            "tissue lactate concentration" annotation (Placement(transformation(
                  extent={{-78,-86},{-62,-70}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=0,
                origin={-90,-40})));
          PhysiolibraryOld.Interfaces.RealOutput_ pH "tissue intracellular pH"
            annotation (Placement(transformation(extent={{66,-42},{86,-22}}),
                iconTransformation(
                extent={{-20,-20},{20,20}},
                rotation=270,
                origin={60,-120})));
          PhysiolibraryOld.Interfaces.RealInput_ pCO2(final unit="mmHg")
            "tissue partial CO2 pressure" annotation (Placement(transformation(
                  extent={{-28,-38},{-10,-20}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=0,
                origin={-90,80})));
          Modelica.Blocks.Math.Add cations annotation(Placement(transformation(extent = {{-28, 8}, {-8, 28}})));
          Modelica.Blocks.Math.Add anions annotation(Placement(transformation(extent = {{-32, -82}, {-12, -62}})));
          Modelica.Blocks.Math.Feedback SID "intracellular" annotation(Placement(transformation(extent = {{-4, 8}, {16, 28}})));
          PhysiolibraryOld.Blocks.ElectrolytesConcentrationConstant_per_l
            electrolytesConcentrationConstant_per_l1(k=CellSID_OtherCations)
            annotation (Placement(transformation(extent={{-76,-12},{-56,8}})));
          PhysiolibraryOld.Blocks.ElectrolytesConcentrationConstant_per_l
            electrolytesConcentrationConstant_per_l2(k=CellSID_StrongAnions)
            annotation (Placement(transformation(extent={{-76,-60},{-56,-40}})));
          Modelica.Blocks.Math.Division division annotation(Placement(transformation(extent = {{32, 2}, {52, 22}})));
          Modelica.Blocks.Math.Log10 log10_1 annotation(Placement(transformation(extent = {{66, 2}, {86, 22}})));
          Modelica.Blocks.Math.Add add1 annotation(Placement(transformation(extent = {{46, -42}, {66, -22}})));
          PhysiolibraryOld.Blocks.Constant const(k=7.15)
            annotation (Placement(transformation(extent={{14,-48},{34,-28}})));
          Modelica.Blocks.Math.Max max annotation(Placement(transformation(extent = {{16, -18}, {24, -10}})));
          PhysiolibraryOld.Blocks.Constant PCO2_min_value(k=0.001)
            annotation (Placement(transformation(extent={{-10,-12},{-2,-4}})));
          PhysiolibraryOld.Blocks.Constant PCO2_min_value1(k=10^(-7.15))
            annotation (Placement(transformation(extent={{28,52},{36,60}})));
          Modelica.Blocks.Math.Max max1 annotation(Placement(transformation(extent = {{54, 46}, {62, 54}})));
        equation
          connect(anions.y, SID.u2) annotation(Line(points = {{-11, -72}, {6, -72}, {6, 10}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(cations.y, SID.u1) annotation(Line(points = {{-7, 18}, {-2, 18}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(electrolytesConcentrationConstant_per_l1.y, cations.u2) annotation(Line(points = {{-55, -2}, {-36, -2}, {-36, 12}, {-30, 12}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(electrolytesConcentrationConstant_per_l2.y, anions.u1) annotation(Line(points = {{-55, -50}, {-42, -50}, {-42, -66}, {-34, -66}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(KCell, cations.u1) annotation(Line(points = {{-74, 24}, {-30, 24}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(cLactate, anions.u2) annotation(Line(points = {{-70, -78}, {-34, -78}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(log10_1.y, add1.u1) annotation(Line(points = {{87, 12}, {92, 12}, {92, -6}, {40, -6}, {40, -26}, {44, -26}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(add1.y, pH) annotation(Line(points = {{67, -32}, {76, -32}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(const.y, add1.u2) annotation(Line(points = {{35, -38}, {44, -38}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(SID.y, division.u1) annotation(Line(points = {{15, 18}, {30, 18}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(max.y, division.u2) annotation(Line(points = {{24.4, -14}, {26, -14}, {26, 6}, {30, 6}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(pCO2, max.u2) annotation(Line(points = {{-19, -29}, {-3.5, -29}, {-3.5, -16.4}, {15.2, -16.4}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(PCO2_min_value.y, max.u1) annotation(Line(points = {{-1.6, -8}, {8.199999999999999, -8}, {8.199999999999999, -11.6}, {15.2, -11.6}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(PCO2_min_value1.y, max1.u1) annotation(Line(points = {{36.4, 56}, {46, 56}, {46, 52.4}, {53.2, 52.4}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(max1.u2, division.y) annotation(Line(points = {{53.2, 47.6}, {53.2, 29.8}, {53, 29.8}, {53, 12}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(max1.y, log10_1.u) annotation(Line(points = {{62.4, 50}, {64, 50}, {64, 12}}, color = {0, 0, 127}, smooth = Smooth.None));
          annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Text(extent=  {{34, 102}, {100, 48}}, lineColor=  {0, 0, 0}, textString=  "pH"), Text(extent=  {{-84, 72}, {-20, 100}}, lineColor=  {0, 0, 0}, textString=  "ICF"), Rectangle(extent=  {{-100, 100}, {100, -100}}, lineColor=  {0, 0, 0})}), Documentation(revisions = "<html>
                   <table cellspacing=\"2\" cellpadding=\"0\" border=\"0\"><tr>
                   <td><p>Author:</p></td>
                   <td><p>Marek Matejak</p></td>
                   </tr>
                   <tr>
                   <td><p>Copyright:</p></td>
                   <td><p>In public domains</p></td>
                   </tr>
                   <tr>
                   <td><p>By:</p></td>
                   <td><p>Charles University, Prague</p></td>
                   </tr>
                   <tr>
                   <td><p>Date of:</p></td>
                   <td><p>2009</p></td>
                   </tr>
                   <tr>
                   <td><p>References:</p></td>
                   <td><p>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</p></td>
                   </tr>
                   </table>
                   </html>"));
        end TissuePh_intracellular;

        model SkeletalMuscleInterstitialPh
          extends TissuePh_interstitial;
          extends PhysiolibraryOld.Icons.SkeletalMuscle;
        end SkeletalMuscleInterstitialPh;

        model BoneInterstitialPh
          extends TissuePh_interstitial;
          extends PhysiolibraryOld.Icons.Bone;
        end BoneInterstitialPh;

        model OtherTissueInterstitialPh
          extends TissuePh_interstitial;
          extends PhysiolibraryOld.Icons.OtherTissue;
        end OtherTissueInterstitialPh;

        model RespiratoryMuscleInterstitialPh
          extends TissuePh_interstitial;
          extends PhysiolibraryOld.Icons.RespiratoryMuscle;
        end RespiratoryMuscleInterstitialPh;

        model FatInterstitialPh
          extends TissuePh_interstitial;
          extends PhysiolibraryOld.Icons.Fat;
        end FatInterstitialPh;

        model SkinInterstitialPh
          extends TissuePh_interstitial;
          extends PhysiolibraryOld.Icons.Skin;
        end SkinInterstitialPh;

        model LiverInterstitialPh
          extends TissuePh_interstitial;
          extends PhysiolibraryOld.Icons.Liver;
        end LiverInterstitialPh;

        model BrainInterstitialPh
          extends TissuePh_interstitial;
          extends PhysiolibraryOld.Icons.Brain;
        end BrainInterstitialPh;

        model GITractInterstitialPh
          extends TissuePh_interstitial;
          extends PhysiolibraryOld.Icons.GITract;
        end GITractInterstitialPh;

        model KidneyInterstitialPh
          extends TissuePh_interstitial;
          extends PhysiolibraryOld.Icons.Kidney;
        end KidneyInterstitialPh;

        model LeftHeartInterstitialPh
          extends TissuePh_interstitial;
          extends PhysiolibraryOld.Icons.LeftHeart;
        end LeftHeartInterstitialPh;

        model RightHeartInterstitialPh
          extends TissuePh_interstitial;
          extends PhysiolibraryOld.Icons.RightHeart;
        end RightHeartInterstitialPh;

        model SkeletalMuscleIntracellularPh
          extends TissuePh_intracellular;
          extends PhysiolibraryOld.Icons.SkeletalMuscle;
          annotation(Diagram(graphics));
        end SkeletalMuscleIntracellularPh;

        model BoneIntracellularPh
          extends TissuePh_intracellular;
          extends PhysiolibraryOld.Icons.Bone;
        end BoneIntracellularPh;

        model OtherTissueIntracellularPh
          extends TissuePh_intracellular;
          extends PhysiolibraryOld.Icons.OtherTissue;
        end OtherTissueIntracellularPh;

        model RespiratoryMuscleIntracellularPh
          extends TissuePh_intracellular;
          extends PhysiolibraryOld.Icons.RespiratoryMuscle;
        end RespiratoryMuscleIntracellularPh;

        model FatIntracellularPh
          extends TissuePh_intracellular;
          extends PhysiolibraryOld.Icons.Fat;
        end FatIntracellularPh;

        model SkinIntracellularPh
          extends TissuePh_intracellular;
          extends PhysiolibraryOld.Icons.Skin;
        end SkinIntracellularPh;

        model LiverIntracellularPh
          extends TissuePh_intracellular;
          extends PhysiolibraryOld.Icons.Liver;
        end LiverIntracellularPh;

        model BrainIntracellularPh
          extends TissuePh_intracellular;
          extends PhysiolibraryOld.Icons.Brain;
        end BrainIntracellularPh;

        model GITractIntracellularPh
          extends TissuePh_intracellular;
          extends PhysiolibraryOld.Icons.GITract;
        end GITractIntracellularPh;

        model KidneyIntracellularPh
          extends TissuePh_intracellular;
          extends PhysiolibraryOld.Icons.Kidney;
        end KidneyIntracellularPh;

        model LeftHeartIntracellularPh
          extends TissuePh_intracellular;
          extends PhysiolibraryOld.Icons.LeftHeart;
        end LeftHeartIntracellularPh;

        model RightHeartIntracellularPh
          extends TissuePh_intracellular;
          extends PhysiolibraryOld.Icons.RightHeart;
        end RightHeartIntracellularPh;
      end Tissues;

      model AcidBase3
        //extends Library.Interfaces.BaseModel;
        extends PhysiolibraryOld.Icons.AcidBase;
        ExtracellularPhMeassure2 artysPH(_BEox(start = -0.177)) annotation(Placement(transformation(extent = {{86, 26}, {58, 54}})));
        ExtracellularPhMeassure2 veinsPH(_cTHox(start = 0), pH(start = 7.37)) annotation(Placement(transformation(extent = {{-56, 26}, {-84, 54}})));
        PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
            Placement(transformation(extent={{-70,68},{-30,108}}),
              iconTransformation(extent={{-20,-18},{20,22}})));
        //initial equation
        //  ArtysPh.pH=7.4;
        ExtracellularPhMeassure2 lungsPH annotation(Placement(transformation(extent = {{28, 26}, {0, 54}})));
        Tissues_NSID.TissuesPh tissues_blood_acidity annotation(Placement(transformation(extent = {{-42, -100}, {-22, -80}})));
        Tissues.TissuesPh_intracellular tissues_intracellular annotation(Placement(transformation(extent = {{10, -100}, {30, -80}})));
        Tissues.TissuesPh_interstitial tissues_interstitial_acidity annotation(Placement(transformation(extent = {{-16, -100}, {4, -80}})));
        Modelica.Blocks.Math.Gain ml2l(k = 0.001) annotation(Placement(transformation(extent = {{52, 6}, {60, 14}})));
        HumMod.Gases.AcidBase.NormalSID normalSID annotation(Placement(transformation(extent = {{-76, -48}, {-98, -24}})));
        PhysiolibraryOld.Blocks.FractConstant sO2(k=100)
          annotation (Placement(transformation(extent={{-108,-10},{-100,-2}})));
        Modelica.Blocks.Math.Feedback BEox annotation(Placement(transformation(extent = {{-36, -18}, {-16, 2}})));
      equation
        connect(busConnector.O2Artys_sO2, artysPH.sO2) annotation(Line(points = {{-50, 88}, {-50, 72}, {44, 72}, {44, 58}, {64, 58}, {64, 55.4}, {63.6, 55.4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 6}, {-6, 6}}));
        connect(busConnector.O2Veins_sO2, veinsPH.sO2) annotation(Line(points = {{-50, 88}, {-50, 72}, {-100, 72}, {-100, 58}, {-78, 58}, {-78, 55.4}, {-78.40000000000001, 55.4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 6}, {-6, 6}}));
        connect(busConnector.ctAlb, artysPH.ctAlb) annotation(Line(points = {{-50, 88}, {-50, 72}, {44, 72}, {44, 40}, {59.4, 40}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.CO2Artys_cHCO3, artysPH.cHCO3) annotation(Line(points = {{-50, 88}, {-50, 72}, {44, 72}, {44, 51.2}, {59.4, 51.2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.ctAlb, veinsPH.ctAlb) annotation(Line(points = {{-50, 88}, {-50, 72}, {-100, 72}, {-100, 40}, {-82.59999999999999, 40}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.CO2Veins_cHCO3, veinsPH.cHCO3) annotation(Line(points = {{-50, 88}, {-50, 72}, {-100, 72}, {-100, 51.2}, {-82.59999999999999, 51.2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(artysPH.pH, busConnector.Artys_pH) annotation(Line(points = {{74.8, 23.2}, {74.8, 14}, {98, 14}, {98, 88}, {-50, 88}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, -8}, {6, -8}}));
        connect(artysPH.pH_ery, busConnector.Artys_pH_ery) annotation(Line(points = {{69.2, 23.2}, {69.2, 8}, {98, 8}, {98, 88}, {-50, 88}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, -13}, {6, -13}}));
        connect(veinsPH.pH, busConnector.Veins_pH) annotation(Line(points = {{-67.2, 23.2}, {-67.2, 14}, {-52, 14}, {-52, 88}, {-50, 88}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, -8}, {6, -8}}));
        connect(veinsPH.pH_ery, busConnector.Veins_pH_ery) annotation(Line(points = {{-72.8, 23.2}, {-72.8, 8}, {-52, 8}, {-52, 88}, {-50, 88}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, -13}, {6, -13}}));
        connect(busConnector.ctGlb, artysPH.ctGlb) annotation(Line(points = {{-50, 88}, {-50, 72}, {44, 72}, {44, 34.4}, {59.4, 34.4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.ctPO4, artysPH.ctPO4) annotation(Line(points = {{-50, 88}, {-50, 72}, {44, 72}, {44, 28.8}, {59.4, 28.8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.ctGlb, veinsPH.ctGlb) annotation(Line(points = {{-50, 88}, {-50, 72}, {-100, 72}, {-100, 34.4}, {-82.59999999999999, 34.4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.ctPO4, veinsPH.ctPO4) annotation(Line(points = {{-50, 88}, {-50, 72}, {-100, 72}, {-100, 28.8}, {-82.59999999999999, 28.8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(artysPH.pH, busConnector.BloodPh_ArtysPh) annotation(Line(points = {{74.8, 23.2}, {74.8, 14}, {98, 14}, {98, 88}, {-50, 88}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.ctAlb, lungsPH.ctAlb) annotation(Line(points = {{-50, 88}, {-14, 88}, {-14, 40}, {1.4, 40}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(lungsPH.pH, busConnector.Lung_pH) annotation(Line(points = {{16.8, 23.2}, {16.8, 12}, {34, 12}, {34, 88}, {-50, 88}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, -8}, {6, -8}}));
        connect(lungsPH.pH_ery, busConnector.Lung_pH_ery) annotation(Line(points = {{11.2, 23.2}, {11.2, 6}, {34, 6}, {34, 88}, {-50, 88}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, -13}, {6, -13}}));
        connect(busConnector.ctGlb, lungsPH.ctGlb) annotation(Line(points = {{-50, 88}, {-14, 88}, {-14, 34.4}, {1.4, 34.4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.ctPO4, lungsPH.ctPO4) annotation(Line(points = {{-50, 88}, {-14, 88}, {-14, 28.8}, {1.4, 28.8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.O2Lung_sO2, lungsPH.sO2) annotation(Line(points = {{-50, 88}, {-14, 88}, {-14, 55.4}, {5.6, 55.4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.CO2Lung_cHCO3, lungsPH.cHCO3) annotation(Line(points = {{-50, 88}, {-14, 88}, {-14, 51.2}, {1.4, 51.2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector, tissues_blood_acidity.busConnector) annotation(Line(points = {{-50, 88}, {-50, -82}, {-40.8, -82}, {-40.8, -83.83329999999999}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(tissues_intracellular.busConnector, busConnector) annotation(Line(points = {{11.2, -80.8}, {10, -82}, {-50, -82}, {-50, 88}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector, tissues_interstitial_acidity.busConnector) annotation(Line(points = {{-50, 88}, {-50, -80.8}, {-14.8, -80.8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(lungsPH.pH, busConnector.lungs_pH_plasma) annotation(Line(points = {{16.8, 23.2}, {16.8, 12}, {34, 12}, {34, 88}, {-50, 88}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(lungsPH.pH_ery, busConnector.lungs_pH_ery) annotation(Line(points = {{11.2, 23.2}, {11.2, 6}, {34, 6}, {34, 88}, {-50, 88}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.ctHb, veinsPH.ctHb) annotation(Line(points = {{-50, 88}, {-50, 72}, {-100, 72}, {-100, 45.6}, {-82.59999999999999, 45.6}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.ctHb, lungsPH.ctHb) annotation(Line(points = {{-50, 88}, {-14, 88}, {-14, 45.6}, {1.4, 45.6}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.ctHb, artysPH.ctHb) annotation(Line(points = {{-50, 88}, {-50, 72}, {44, 72}, {44, 45.6}, {59.4, 45.6}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.BloodVolume, ml2l.u) annotation(Line(points = {{-50, 88}, {44, 88}, {44, 10}, {51.2, 10}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.BloodVol_Hct, normalSID.Hct) annotation(Line(points = {{-50, 88}, {-50, 72}, {-110, 72}, {-110, 6}, {-78.2, 6}, {-78.2, -22.8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.HeatCore_Temp, normalSID.T) annotation(Line(points = {{-50, 88}, {-50, 72}, {-110, 72}, {-110, 6}, {-84.8, 6}, {-84.8, -22.8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.ctHb_ery, normalSID.tHb_E) annotation(Line(points = {{-50, 88}, {-50, 72}, {-110, 72}, {-110, 6}, {-89.2, 6}, {-89.2, -22.8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.ctAlb, normalSID.ctAlb) annotation(Line(points = {{-50, 88}, {-50, 72}, {-110, 72}, {-110, -26.4}, {-96.90000000000001, -26.4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.ctGlb, normalSID.ctGlb) annotation(Line(points = {{-50, 88}, {-50, 72}, {-110, 72}, {-110, -30}, {-96.90000000000001, -30}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.ctPO4, normalSID.ctPO4_E) annotation(Line(points = {{-50, 88}, {-50, 72}, {-110, 72}, {-110, -33.6}, {-96.90000000000001, -33.6}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.ctPO4, normalSID.ctPO4_P) annotation(Line(points = {{-50, 88}, {-50, 72}, {-110, 72}, {-110, -37.44}, {-96.90000000000001, -37.44}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(sO2.y, normalSID.sO2) annotation(Line(points = {{-99.59999999999999, -6}, {-93.59999999999999, -6}, {-93.59999999999999, -22.8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(normalSID.NSID, BEox.u2) annotation(Line(points = {{-73.8, -45.6}, {-68, -45.6}, {-68, -26}, {-26, -26}, {-26, -16}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(BEox.y, busConnector.Blood_BEox) annotation(Line(points = {{-17, -8}, {88, -8}, {88, 88}, {-50, 88}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(busConnector.BloodIons_SID, BEox.u1) annotation(Line(points = {{-50, 88}, {-50, -8}, {-34, -8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(BEox.y, veinsPH.BEox) annotation(Line(points = {{-17, -8}, {-18, -8}, {-18, 60}, {-58.8, 60}, {-58.8, 54}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(BEox.y, lungsPH.BEox) annotation(Line(points = {{-17, -8}, {-18, -8}, {-18, 62}, {25.2, 62}, {25.2, 54}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(BEox.y, artysPH.BEox) annotation(Line(points = {{-17, -8}, {-18, -8}, {-18, 64}, {83.2, 64}, {83.2, 54}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Text(extent=  {{-118, -84}, {124, -118}}, lineColor=  {0, 0, 255}, textString=  "%name")}), Documentation(revisions = "<html>
                   <table cellspacing=\"2\" cellpadding=\"0\" border=\"0\"><tr>
                   <td><p>Author:</p></td>
                   <td><p>Marek Matejak</p></td>
                   </tr>
                   <tr>
                   <td><p>Copyright:</p></td>
                   <td><p>In public domains</p></td>
                   </tr>
                   <tr>
                   <td><p>By:</p></td>
                   <td><p>Charles University, Prague</p></td>
                   </tr>
                   <tr>
                   <td><p>Date of:</p></td>
                   <td><p>2009</p></td>
                   </tr>
                   <tr>
                   <td><p>References:</p></td>
                   <td>Siggaard Andersen: OSA (2005), University of Copenhagen</td>
                   </tr>
                   <tr>
                   <td></td>
                   <td>Noriaki Ikeda: A model of overall regulation of body fluids (1979), Kitasato University</td>
                   </tr>
                   <tr>
                   <td></td>
                   <td><p>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</p></td>
                   </tr>
                   </table>
                   </html>"));
      end AcidBase3;

      package buffers
        model Bicarbonate
          extends BufferInterface;
          PhysiolibraryOld.Interfaces.RealInput pCO2(unit="mmHg") annotation (
              Placement(transformation(extent={{-120,-20},{-80,20}}),
                iconTransformation(extent={{-120,-20},{-80,20}})));
          PhysiolibraryOld.Interfaces.RealInput T(unit="degC") annotation (
              Placement(transformation(extent={{-120,-20},{-80,20}}),
                iconTransformation(extent={{-120,-60},{-80,-20}})));
          Real pCO2_kPa;
          Real pK;
          Real aCO2;
          Real cdCO2;
        equation
          pCO2 =PhysiolibraryOld.NonSIunits.PaTOmmHg*1000*pCO2_kPa;
          //Henderson-Hasselbalch equation:
          pK = 6.1 + (-0.0026) * (T - 37);
          aCO2 = 0.23 * 10 ^ (-0.0092 * (T - 37));
          //solubility depends on temperature
          cdCO2 = aCO2 * pCO2_kPa;
          y = -cdCO2 * 10 ^ (pH - pK);
          //bicarbonate
          annotation(Icon(graphics = {Text(extent=  {{-79, -27}, {79, 27}}, lineColor=  {0, 0, 255}, origin=  {75, 19}, rotation=  90, textString=  "HCO3")}));
        end Bicarbonate;

        model Albumin
          extends BufferInterface;
          PhysiolibraryOld.Interfaces.RealInput tAlb(unit="mmol/l") annotation (
             Placement(transformation(extent={{-120,-20},{-80,20}})));
          Real tAlb_g_per_dl;
          parameter Real Alb_MolarMass(unit = "g/mol") = 66463;
        equation
          tAlb_g_per_dl = tAlb / 1000 * Alb_MolarMass / 10;
          y = -10 * tAlb_g_per_dl * (0.123 * pH - 0.631);
          //where [ Albx- ] is in mEq / L and [ Albumin ] is in g / dL. Therefore, at pH 7.40, the charge contributed by 4.40 g / dL of albumin is approximately -12.3 mEq / L.
          annotation(Documentation(info = "<html>
                   <p>http://www.figge-fencl.org/titrationcurve.html</p>
                   <p>:</p>
                   <p><br/>A least-squares linear regression fit to the Figge-Fencl quantitative physicochemical model (version 3.0) over the pH range of 6.90 to 7.90 yields the following equation for the charge displayed by albumin:</p>
                   <p><br/> [ Albx- ] = -10 x [ Albumin ] x ( 0.123 x pH - 0.631 );</p>
                   <p><br/> where [ Albx- ] is in mEq / L and [ Albumin ] is in g / dL. Therefore, at pH 7.40, the charge contributed by 4.40 g / dL of albumin is approximately -12.3 mEq / L.</p>
                   </html>"), Icon(graphics = {Text(extent=  {{-79, -27}, {79, 27}}, lineColor=  {0, 0, 255}, origin=  {73, 19}, rotation=  90, textString=  "Alb")}));
        end Albumin;

        model Globulins
          extends BufferInterface;
          PhysiolibraryOld.Interfaces.RealInput ctGlb
            annotation (Placement(transformation(extent={{-120,-40},{-80,0}})));
        equation
          //  y=-ctGlb*(0.075/0.81)*(pH-3.6);  //sklon -0.075/0.81 so siggaarda, pri 7.4 chcem -10 aby to pokrilo nastavene SID u Colemana
          y = -ctGlb * (0.075 / 0.77 * (pH - 7.4) + 2.5 / 28);
          //chcem naboj -8.1 mEq/l pre normalnu koncentraciu 28 mg/l a pH=7.4
          annotation(Icon(graphics = {Text(extent=  {{-79, -27}, {79, 27}}, lineColor=  {0, 0, 255}, origin=  {73, 19}, rotation=  90, textString=  "Glb")}));
        end Globulins;

        model Phosphates
          extends BufferInterface;
          PhysiolibraryOld.Interfaces.RealInput tPO4 annotation (Placement(
                transformation(extent={{-120,-20},{-80,20}})));
          parameter Real pKa1 = 2.1;
          parameter Real pKa2 = 6.8;
          parameter Real pKa3 = 12.7;
        equation
          y = -tPO4 * (10 ^ (pKa2 - pH) + 2 + 3 * 10 ^ (pH - pKa3)) / (10 ^ (pKa1 + pKa2 - 2 * pH) + 10 ^ (pKa2 - pH) + 1 + 10 ^ (pH - pKa3));
          annotation(Diagram(graphics), Documentation(info = "<html>
                   <p><b><font style=\"font-size: 12pt; \"><a name=\"internal-source-marker_0.47659245471196454\">C</a>harge for phosphates:</b></p>
                   <p><br/>pKa1=2.1, pKa2=6.8, pKa3=12.7 &nbsp;&nbsp;(wiki: &nbsp;2.12, 7.21, 12.67 at 25&deg;C)</p>
                   <p><br/>tPO4 = [H3PO4] + [H2PO4] + [HPO4] + [PO4]</p>
                   <p><br/>charge(tPO4,pH) = [H2PO4] + 2[HPO4] + 3[PO4]</p>
                   <p><br/>[H2PO4] / [H3PO4] = 10^(pH-pKa1) </p>
                   <p><br/>[HPO4] / [H2PO4] = 10^(pH-pKa2) </p>
                   <p><br/>[PO4] / [HPO4] = 10^(pH-pKa3) </p>
                   </html>"), Icon(graphics = {Text(extent=  {{-79, -27}, {79, 27}}, lineColor=  {0, 0, 255}, origin=  {73, 19}, rotation=  90, textString=  "PO4")}));
        end Phosphates;

        model Haemoglobin
          extends BufferInterface;
          PhysiolibraryOld.Interfaces.RealInput tHb_E
            "total concentration of haemoglobin in erythrocytes"
            annotation (Placement(transformation(extent={{-120,0},{-80,40}})));
          PhysiolibraryOld.Interfaces.RealInput sO2
            "saturation of haemoglobin by O2"
            annotation (Placement(transformation(extent={{-120,-40},{-80,0}})));
          PhysiolibraryOld.Interfaces.RealInput pCO2 "partial pressure of CO2"
            annotation (Placement(transformation(extent={{-120,-80},{-80,-40}})));
          parameter Real betaOxyHb = 3.1
            "buffer value for oxygenated Hb without CO2";
          parameter Real betaDeoxyHb = 3.3
            "buffer value for Hb without O2 and CO2";
          parameter Real pIo = 7.13
            "isoelectric pH for oxygenated Hb without CO2";
          parameter Real pIr = 7.32 "isoelectric pH for Hb without O2 and CO2";
          parameter Real pKzO = 8.08
            "pKa for NH3+ end of oxygenated haemoglobin chain";
          parameter Real pKzR = 7.14
            "pKa for NH3+ end of deoxygenated haemoglobin chain";
          parameter Real pKcO = 4.62
            "10^(pH-pKcO) is the dissociation constatnt for O2HbNH2 + CO2 <-> O2HbNHCOO- + H+ ";
          parameter Real pKcR = 4.62
            "10^(pH-pKcR) is the dissociation constatnt for HbNH2 + CO2 <-> HbNHCOO- + H+ ";
          parameter Real KcR = 10 ^ (-pKcR);
          parameter Real KzR = 10 ^ (-pKzR);
          parameter Real KcO = 10 ^ (-pKcO);
          parameter Real KzO = 10 ^ (-pKzO);
          Real carbaminohaemoglobin;
          Real sCO2;
          Real zOxyHb;
          Real zDeoxyHb;
          Real zOxyCarbaminoHb;
          Real zDeoxyCarbaminoHb;
          Real H = 10 ^ (-pH);
          Real aCO2;
          Real cdCO2;
          PhysiolibraryOld.Interfaces.RealInput T annotation (Placement(
                transformation(extent={{-120,-120},{-80,-80}})));
        equation
          aCO2 = 0.23 * 10 ^ (-0.0092 * (T - 37));
          //solubility depends on temperature
          cdCO2 = aCO2 * pCO2 * 0.001;
          //from mmol to mol
          carbaminohaemoglobin = tHb_E * cdCO2 * (H * H * ((1 - sO2) / (KzO * KcO) + sO2 / (KzR * KcR)) + H * ((1 - sO2) / KcO + sO2 / KcR) + cdCO2) / ((H * H / (KzR * KcR) + H / KcR + cdCO2) * (H * H / (KzO * KcO) + H / KcO + cdCO2));
          //, where cdCO2=free disolved CO2 concentration in erythrocytes in mol/l
          sCO2 = carbaminohaemoglobin / tHb_E;
          y = -tHb_E * (sO2 * (1 - sCO2) * zOxyHb + (1 - sO2) * (1 - sCO2) * zDeoxyHb + sO2 * sCO2 * zOxyCarbaminoHb + (1 - sO2) * sCO2 * zDeoxyCarbaminoHb);
          zOxyHb = betaOxyHb * (pH - pIo);
          zDeoxyHb = betaDeoxyHb * (pH - pIr);
          zOxyCarbaminoHb = zOxyHb + (1 + 2 * 10 ^ (pKzO - pH)) / (1 + 10 ^ (pKzO - pH));
          //= zOxyHb + -[O2HbNH2]/([O2HbNH2]+[O2HbNH3+]) + -2[O2HbNH3+]/([O2HbNH2]+[O2HbNH3+]), where pKZO=8.08
          zDeoxyCarbaminoHb = zDeoxyHb + (1 + 2 * 10 ^ (pKzR - pH)) / (1 + 10 ^ (pKzR - pH));
          //betaOxyHb(pH) * (pH-pIO) + -[HbNH2]/([HbNH2]+[HbNH3+]) + -2[HbNH3+]/([HbNH2]+[HbNH3+]), where pKZR=7.14
          annotation(Icon(graphics = {Text(extent=  {{-79, -27}, {79, 27}}, lineColor=  {0, 0, 255}, origin=  {73, 19}, rotation=  90, textString=  "Hb")}));
        end Haemoglobin;

        partial model BufferInterface
          PhysiolibraryOld.Interfaces.RealInput pH
            annotation (Placement(transformation(extent={{-120,40},{-80,80}})));
          PhysiolibraryOld.Interfaces.RealOutput y(unit="e.mmol/l")
            "charge of buffer" annotation (Placement(transformation(extent={{80,
                    -100},{120,-60}}), iconTransformation(extent={{80,-100},{
                    120,-60}})));
          annotation(Diagram(graphics), Icon(graphics = {Rectangle(extent=  {{-100, 100}, {100, -100}}, lineColor=  {0, 0, 255})}));
        end BufferInterface;
      end buffers;

      model NormalSID
        // extends BloodPhBase;
        PhysiolibraryOld.Interfaces.RealInput_ sO2 "oxygen saturation"
          annotation (Placement(transformation(extent={{-120,-94},{-80,-54}}),
              iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=270,
              origin={60,110})));
        PhysiolibraryOld.Interfaces.RealInput_ ctAlb(final unit="mmol/l")
          "concentration of total plasma albumins(dofault=0.65mmol/l)"
          annotation (Placement(transformation(extent={{-120,72},{-80,112}}),
              iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=180,
              origin={90,80})));
        PhysiolibraryOld.Interfaces.RealInput_ ctGlb(final unit="g/l")
          "concentration of total plasma globulins" annotation (Placement(
              transformation(extent={{-120,42},{-80,82}}), iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=180,
              origin={90,50})));
        PhysiolibraryOld.Interfaces.RealInput_ ctPO4_P(final unit="mmol/l")
          "concentration of total inorganic phosphate in plasma" annotation (
            Placement(transformation(extent={{-120,12},{-80,52}}),
              iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=180,
              origin={90,-12})));
        PhysiolibraryOld.Interfaces.RealOutput NSID annotation (Placement(
              transformation(extent={{80,0},{120,40}}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=180,
              origin={-120,-80})));
        PhysiolibraryOld.Interfaces.RealInput_ Hct "hematocrit" annotation (
            Placement(transformation(extent={{-120,-18},{-80,22}}),
              iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=270,
              origin={-80,110})));
        buffers.Bicarbonate bicarbonate annotation(Placement(transformation(extent = {{-38, 10}, {-18, 30}})));
        buffers.Albumin albumin annotation(Placement(transformation(extent = {{-38, 78}, {-18, 98}})));
        Modelica.Blocks.Math.Sum NSIDP(nin = 4) annotation(Placement(transformation(extent = {{26, 72}, {46, 92}})));
        buffers.Globulins globulins annotation(Placement(transformation(extent = {{-38, 56}, {-18, 76}})));
        buffers.Phosphates phosphates annotation(Placement(transformation(extent = {{-38, 34}, {-18, 54}})));
        buffers.Haemoglobin haemoglobin annotation(Placement(transformation(extent = {{-38, -68}, {-18, -48}})));
        buffers.Phosphates phosphates1 annotation(Placement(transformation(extent = {{-38, -96}, {-18, -76}})));
        Modelica.Blocks.Math.Sum NSIDE(nin = 3) annotation(Placement(transformation(extent = {{14, -80}, {34, -60}})));
        Modelica.Blocks.Math.Feedback Pct annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 0, origin = {26, 56})));
        Modelica.Blocks.Math.Product product1 annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 90, origin = {50, -2})));
        Modelica.Blocks.Math.Product product2 annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 270, origin = {50, 38})));
        Modelica.Blocks.Math.Add add(k1 = -1, k2 = -1) annotation(Placement(transformation(extent = {{70, 10}, {90, 30}})));
        Modelica.Blocks.Sources.Constant const(k = 1) annotation(Placement(transformation(extent = {{-2, 50}, {10, 62}})));
        Modelica.Blocks.Sources.Constant n_pH_P(k = 7.4) annotation(Placement(transformation(extent = {{-82, 44}, {-70, 56}})));
        Modelica.Blocks.Sources.Constant n_pCO2(k = 40) annotation(Placement(transformation(extent = {{-82, 14}, {-70, 26}})));
        PhysiolibraryOld.Interfaces.RealInput_ T "temperature" annotation (
            Placement(transformation(extent={{-120,-40},{-80,0}}),
              iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=270,
              origin={-20,110})));
        buffers.Bicarbonate bicarbonate1 annotation(Placement(transformation(extent = {{-38, -40}, {-18, -20}})));
        Modelica.Blocks.Sources.Constant n_pH_E(k = 7.19)
          "should be calculated, but how?"                                                 annotation(Placement(transformation(extent = {{-86, -42}, {-74, -30}})));
        PhysiolibraryOld.Interfaces.RealInput_ ctPO4_E(final unit="mmol/l")
          "concentration of total inorganic phosphate in erythrocytes"
          annotation (Placement(transformation(extent={{-120,-120},{-80,-80}}),
              iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=180,
              origin={90,20})));
        PhysiolibraryOld.Interfaces.RealInput_ tHb_E
          "haemoglobin concentration in erythrocyte" annotation (Placement(
              transformation(extent={{-120,-68},{-80,-28}}), iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=270,
              origin={20,110})));
      equation
        connect(ctAlb, albumin.tAlb) annotation(Line(points = {{-100, 92}, {-70, 92}, {-70, 88}, {-38, 88}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(bicarbonate.y, NSIDP.u[1]) annotation(Line(points = {{-18, 12}, {-8, 12}, {-8, 80.5}, {24, 80.5}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(albumin.y, NSIDP.u[2]) annotation(Line(points = {{-18, 80}, {-6, 80}, {-6, 81.5}, {24, 81.5}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(globulins.y, NSIDP.u[3]) annotation(Line(points = {{-18, 58}, {-8, 58}, {-8, 82.5}, {24, 82.5}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(phosphates.y, NSIDP.u[4]) annotation(Line(points = {{-18, 36}, {-8, 36}, {-8, 83.5}, {24, 83.5}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Hct, Pct.u2) annotation(Line(points = {{-100, 2}, {26, 2}, {26, 48}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(add.y, NSID) annotation(Line(points = {{91, 20}, {100, 20}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(product1.y, add.u2) annotation(Line(points = {{50, 9}, {50, 14}, {68, 14}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(product2.y, add.u1) annotation(Line(points = {{50, 27}, {50, 26}, {68, 26}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Pct.y, product2.u2) annotation(Line(points = {{35, 56}, {44, 56}, {44, 50}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Hct, product1.u1) annotation(Line(points = {{-100, 2}, {26, 2}, {26, -20}, {44, -20}, {44, -14}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(NSIDE.y, product1.u2) annotation(Line(points = {{35, -70}, {56, -70}, {56, -14}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(NSIDP.y, product2.u1) annotation(Line(points = {{47, 82}, {56, 82}, {56, 50}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(const.y, Pct.u1) annotation(Line(points = {{10.6, 56}, {18, 56}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(n_pH_P.y, albumin.pH) annotation(Line(points = {{-69.40000000000001, 50}, {-62, 50}, {-62, 94}, {-38, 94}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(n_pH_P.y, globulins.pH) annotation(Line(points = {{-69.40000000000001, 50}, {-62, 50}, {-62, 72}, {-38, 72}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(n_pH_P.y, phosphates.pH) annotation(Line(points = {{-69.40000000000001, 50}, {-38, 50}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(n_pH_P.y, bicarbonate.pH) annotation(Line(points = {{-69.40000000000001, 50}, {-62, 50}, {-62, 26}, {-38, 26}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(T, bicarbonate.T) annotation(Line(points = {{-100, -20}, {-56, -20}, {-56, 16}, {-38, 16}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(bicarbonate1.y, NSIDE.u[1]) annotation(Line(points = {{-18, -38}, {-4, -38}, {-4, -71.33329999999999}, {12, -71.33329999999999}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(haemoglobin.y, NSIDE.u[2]) annotation(Line(points = {{-18, -66}, {-4, -66}, {-4, -70}, {12, -70}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(phosphates1.y, NSIDE.u[3]) annotation(Line(points = {{-18, -94}, {-4, -94}, {-4, -68.66670000000001}, {12, -68.66670000000001}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(n_pCO2.y, bicarbonate.pCO2) annotation(Line(points = {{-69.40000000000001, 20}, {-38, 20}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(n_pCO2.y, bicarbonate1.pCO2) annotation(Line(points = {{-69.40000000000001, 20}, {-64, 20}, {-64, -30}, {-38, -30}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(n_pH_E.y, bicarbonate1.pH) annotation(Line(points = {{-73.40000000000001, -36}, {-60, -36}, {-60, -24}, {-38, -24}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(n_pH_E.y, haemoglobin.pH) annotation(Line(points = {{-73.40000000000001, -36}, {-60, -36}, {-60, -52}, {-38, -52}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(n_pH_E.y, phosphates1.pH) annotation(Line(points = {{-73.40000000000001, -36}, {-60, -36}, {-60, -80}, {-38, -80}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(T, bicarbonate1.T) annotation(Line(points = {{-100, -20}, {-56, -20}, {-56, -34}, {-38, -34}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(ctPO4_P, phosphates.tPO4) annotation(Line(points = {{-100, 32}, {-74, 32}, {-74, 34}, {-48, 34}, {-48, 44}, {-38, 44}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(ctPO4_E, phosphates1.tPO4) annotation(Line(points = {{-100, -100}, {-70, -100}, {-70, -86}, {-38, -86}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(tHb_E, haemoglobin.tHb_E) annotation(Line(points = {{-100, -48}, {-70, -48}, {-70, -56}, {-38, -56}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(sO2, haemoglobin.sO2) annotation(Line(points = {{-100, -74}, {-70, -74}, {-70, -60}, {-38, -60}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(n_pCO2.y, haemoglobin.pCO2) annotation(Line(points = {{-69.40000000000001, 20}, {-64, 20}, {-64, -64}, {-38, -64}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(T, haemoglobin.T) annotation(Line(points = {{-100, -20}, {-56, -20}, {-56, -68}, {-38, -68}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(ctGlb, globulins.ctGlb) annotation(Line(points = {{-100, 62}, {-69, 62}, {-69, 64}, {-38, 64}}, color = {0, 0, 127}, smooth = Smooth.None));
        //  NBB = (1-Hct)( [HCO3]P(40mmHg,7.4) + tAlbP*-zAlbP(7.4) + tGlbP*-zGlb(7.4) + tPO4P*-zPO4(7.4) + tORGP*-zORG(7.4) + .. ) + Hct ( [HCO3]E(40mmHg,NpHE) + tHb*-zHb(sO2,sCO2,NpHE) + tPO4E*-zPO4(NpHE) ..)
        //  NBB = 0;//_cTHox;
        annotation(Diagram(graphics), Icon(graphics), Documentation(revisions = "<html>
                   <table cellspacing=\"2\" cellpadding=\"0\" border=\"0\"><tr>
                   <td><p>Author:</p></td>
                   <td><p>Marek Matejak</p></td>
                   </tr>
                   <tr>
                   <td><p>Copyright:</p></td>
                   <td><p>In public domains</p></td>
                   </tr>
                   <tr>
                   <td><p>By:</p></td>
                   <td><p>Charles University, Prague</p></td>
                   </tr>
                   <tr>
                   <td><p>Date of:</p></td>
                   <td><p>2013</p></td>
                   </tr>
                   </table>
                   </html>"));
      end NormalSID;

      model ExtracellularPhMeassure2
        extends HumMod.Gases.AcidBase.BloodPhBase;
        PhysiolibraryOld.Interfaces.RealInput BEox annotation (Placement(
              transformation(extent={{-102,90},{-62,130}}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=270,
              origin={-80,100})));
      equation
        _BEox = BEox;
        //  cTHox.conc*1000 = _cTHox;
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Documentation(revisions = "<html>
                   <table cellspacing=\"2\" cellpadding=\"0\" border=\"0\"><tr>
                   <td><p>Author:</p></td>
                   <td><p>Marek Matejak</p></td>
                   </tr>
                   <tr>
                   <td><p>Copyright:</p></td>
                   <td><p>In public domains</p></td>
                   </tr>
                   <tr>
                   <td><p>By:</p></td>
                   <td><p>Charles University, Prague</p></td>
                   </tr>
                   <tr>
                   <td><p>Date of:</p></td>
                   <td><p>2013</p></td>
                   </tr>
                   <tr>
                   <td><p>References:</p></td>
                   <td>Siggaard Andersen: OSA (2005), University of Copenhagen</td>
                   </tr>
                   </table>
                   </html>"));
      end ExtracellularPhMeassure2;

      package Tissues_NSID
        "Acidity of tissue veins, interstitium or intracellular space"
        model TissuesPh
          //extends Library.Interfaces.BaseModel;
          SkeletalMuscleBloodPh skeletalMuscle annotation(Placement(transformation(extent = {{-54, 66}, {-34, 86}})));
          BoneBloodPh bone annotation(Placement(transformation(extent = {{-54, 36}, {-34, 56}})));
          FatBloodPh fat annotation(Placement(transformation(extent = {{-54, -54}, {-34, -34}})));
          BrainBloodPh brain annotation(Placement(transformation(extent = {{52, 28}, {72, 48}})));
          RightHeartBloodPh rightHeart annotation(Placement(transformation(extent = {{52, -92}, {72, -72}})));
          RespiratoryMuscleBloodPh respiratoryMuscle annotation(Placement(transformation(extent = {{-54, -24}, {-34, -4}})));
          OtherTissueBloodPh otherTissue annotation(Placement(transformation(extent = {{-54, 6}, {-34, 26}})));
          LiverBloodPh liver annotation(Placement(transformation(extent = {{52, 60}, {72, 80}})));
          LeftHeartBloodPh leftHeart annotation(Placement(transformation(extent = {{52, -62}, {72, -42}})));
          KidneyBloodPh kidney annotation(Placement(transformation(extent = {{52, -32}, {72, -12}})));
          GITractBloodPh GITract annotation(Placement(transformation(extent = {{52, -2}, {72, 18}})));
          PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
              Placement(transformation(extent={{-108,74},{-68,114}})));
          SkinBloodPh skin annotation(Placement(transformation(extent = {{-54, -84}, {-34, -64}})));
          Modelica.Blocks.Math.Add cTH_lessLactate(k1 = -1, k2 = -1) annotation(Placement(transformation(extent = {{-92, 114}, {-72, 134}})));
        equation
          connect(busConnector.bone_sO2, bone.sO2) annotation(Line(points = {{-88, 94}, {-88, 57}, {-38, 57}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.brain_sO2, brain.sO2) annotation(Line(points = {{-88, 94}, {6, 94}, {6, 49}, {68, 49}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.fat_sO2, fat.sO2) annotation(Line(points = {{-88, 94}, {-88, -33}, {-38, -33}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.GITract_sO2, GITract.sO2) annotation(Line(points = {{-88, 94}, {6, 94}, {6, 19}, {68, 19}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.kidney_sO2, kidney.sO2) annotation(Line(points = {{-88, 94}, {6, 94}, {6, -11}, {68, -11}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.leftHeart_sO2, leftHeart.sO2) annotation(Line(points = {{-88, 94}, {6, 94}, {6, -41}, {68, -41}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.liver_sO2, liver.sO2) annotation(Line(points = {{-88, 94}, {6, 94}, {6, 81}, {68, 81}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.otherTissue_sO2, otherTissue.sO2) annotation(Line(points = {{-88, 94}, {-88, 27}, {-38, 27}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.respiratoryMuscle_sO2, respiratoryMuscle.sO2) annotation(Line(points = {{-88, 94}, {-88, -3}, {-38, -3}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.rightHeart_sO2, rightHeart.sO2) annotation(Line(points = {{-88, 94}, {6, 94}, {6, -71}, {68, -71}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.skin_sO2, skin.sO2) annotation(Line(points = {{-88, 94}, {-88, -63}, {-38, -63}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.skeletalMuscle_sO2, skeletalMuscle.sO2) annotation(Line(points = {{-88, 94}, {-87.5, 94}, {-87.5, 87}, {-38, 87}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.bone_T, bone.T) annotation(Line(points = {{-88, 94}, {-88, 38.8}, {-53, 38.8}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.brain_T, brain.T) annotation(Line(points = {{-88, 94}, {6, 94}, {6, 30.8}, {53, 30.8}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.fat_T, fat.T) annotation(Line(points = {{-88, 94}, {-88, -51.2}, {-53, -51.2}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.GITract_T, GITract.T) annotation(Line(points = {{-88, 94}, {6, 94}, {6, 0.8}, {53, 0.8}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.kidney_T, kidney.T) annotation(Line(points = {{-88, 94}, {6, 94}, {6, -29.2}, {53, -29.2}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.leftHeart_T, leftHeart.T) annotation(Line(points = {{-88, 94}, {6, 94}, {6, -59.2}, {53, -59.2}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.liver_T, liver.T) annotation(Line(points = {{-88, 94}, {6, 94}, {6, 62.8}, {53, 62.8}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.otherTissue_T, otherTissue.T) annotation(Line(points = {{-88, 94}, {-88, 8.800000000000001}, {-53, 8.800000000000001}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.respiratoryMuscle_T, respiratoryMuscle.T) annotation(Line(points = {{-88, 94}, {-88, -21.2}, {-53, -21.2}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.rightHeart_T, rightHeart.T) annotation(Line(points = {{-88, 94}, {6, 94}, {6, -89.2}, {53, -89.2}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.skin_T, skin.T) annotation(Line(points = {{-88, 94}, {-88, -81.2}, {-53, -81.2}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.skeletalMuscle_T, skeletalMuscle.T) annotation(Line(points = {{-88, 94}, {-87.5, 94}, {-87.5, 68.8}, {-53, 68.8}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(cTH_lessLactate.y, bone.ctHox_lessLactate) annotation(Line(points = {{-71, 124}, {-71, 46}, {-53, 46}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(cTH_lessLactate.y, brain.ctHox_lessLactate) annotation(Line(points = {{-71, 124}, {6, 124}, {6, 38}, {53, 38}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(cTH_lessLactate.y, fat.ctHox_lessLactate) annotation(Line(points = {{-71, 124}, {-71, -44}, {-53, -44}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(cTH_lessLactate.y, GITract.ctHox_lessLactate) annotation(Line(points = {{-71, 124}, {6, 124}, {6, 8}, {53, 8}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(cTH_lessLactate.y, kidney.ctHox_lessLactate) annotation(Line(points = {{-71, 124}, {6, 124}, {6, -22}, {53, -22}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(cTH_lessLactate.y, leftHeart.ctHox_lessLactate) annotation(Line(points = {{-71, 124}, {6, 124}, {6, -52}, {53, -52}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(cTH_lessLactate.y, liver.ctHox_lessLactate) annotation(Line(points = {{-71, 124}, {6, 124}, {6, 70}, {53, 70}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(cTH_lessLactate.y, otherTissue.ctHox_lessLactate) annotation(Line(points = {{-71, 124}, {-71, 16}, {-53, 16}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(cTH_lessLactate.y, respiratoryMuscle.ctHox_lessLactate) annotation(Line(points = {{-71, 124}, {-71, -14}, {-53, -14}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(cTH_lessLactate.y, rightHeart.ctHox_lessLactate) annotation(Line(points = {{-71, 124}, {6, 124}, {6, -82}, {53, -82}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(cTH_lessLactate.y, skin.ctHox_lessLactate) annotation(Line(points = {{-71, 124}, {-71, -74}, {-53, -74}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.bone_cLactate, bone.cLactate) annotation(Line(points = {{-88, 94}, {-88, 50}, {-53, 50}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.brain_cLactate, brain.cLactate) annotation(Line(points = {{-88, 94}, {6, 94}, {6, 42}, {53, 42}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.fat_cLactate, fat.cLactate) annotation(Line(points = {{-88, 94}, {-88, -40}, {-53, -40}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.GITract_cLactate, GITract.cLactate) annotation(Line(points = {{-88, 94}, {6, 94}, {6, 12}, {53, 12}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.kidney_cLactate, kidney.cLactate) annotation(Line(points = {{-88, 94}, {6, 94}, {6, -18}, {53, -18}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.leftHeart_cLactate, leftHeart.cLactate) annotation(Line(points = {{-88, 94}, {6, 94}, {6, -48}, {53, -48}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.liver_cLactate, liver.cLactate) annotation(Line(points = {{-88, 94}, {6, 94}, {6, 74}, {53, 74}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.otherTissue_cLactate, otherTissue.cLactate) annotation(Line(points = {{-88, 94}, {-88, 20}, {-53, 20}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.respiratoryMuscle_cLactate, respiratoryMuscle.cLactate) annotation(Line(points = {{-88, 94}, {-88, -10}, {-53, -10}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.rightHeart_cLactate, rightHeart.cLactate) annotation(Line(points = {{-88, 94}, {6, 94}, {6, -78}, {53, -78}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.skin_cLactate, skin.cLactate) annotation(Line(points = {{-88, 94}, {-88, -70}, {-53, -70}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(busConnector.skeletalMuscle_cLactate, skeletalMuscle.cLactate) annotation(Line(points = {{-88, 94}, {-87.5, 94}, {-87.5, 80}, {-53, 80}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 2}, {-5, 2}}));
          connect(bone.ctHb, busConnector.ctHb) annotation(Line(points = {{-35, 50}, {6, 50}, {6, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(brain.ctHb, busConnector.ctHb) annotation(Line(points = {{71, 42}, {98, 42}, {98, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(fat.ctHb, busConnector.ctHb) annotation(Line(points = {{-35, -40}, {6, -40}, {6, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(GITract.ctHb, busConnector.ctHb) annotation(Line(points = {{71, 12}, {98, 12}, {98, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(kidney.ctHb, busConnector.ctHb) annotation(Line(points = {{71, -18}, {98, -18}, {98, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(leftHeart.ctHb, busConnector.ctHb) annotation(Line(points = {{71, -48}, {98, -48}, {98, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(liver.ctHb, busConnector.ctHb) annotation(Line(points = {{71, 74}, {98, 74}, {98, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(otherTissue.ctHb, busConnector.ctHb) annotation(Line(points = {{-35, 20}, {6, 20}, {6, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(respiratoryMuscle.ctHb, busConnector.ctHb) annotation(Line(points = {{-35, -10}, {6, -10}, {6, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(rightHeart.ctHb, busConnector.ctHb) annotation(Line(points = {{71, -78}, {98, -78}, {98, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(skin.ctHb, busConnector.ctHb) annotation(Line(points = {{-35, -70}, {6, -70}, {6, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(skeletalMuscle.ctHb, busConnector.ctHb) annotation(Line(points = {{-35, 80}, {5.5, 80}, {5.5, 94}, {-88, 94}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(bone.ctAlb, busConnector.ctAlb) annotation(Line(points = {{-35, 46}, {6, 46}, {6, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(brain.ctAlb, busConnector.ctAlb) annotation(Line(points = {{71, 38}, {98, 38}, {98, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(fat.ctAlb, busConnector.ctAlb) annotation(Line(points = {{-35, -44}, {6, -44}, {6, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(GITract.ctAlb, busConnector.ctAlb) annotation(Line(points = {{71, 8}, {98, 8}, {98, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(kidney.ctAlb, busConnector.ctAlb) annotation(Line(points = {{71, -22}, {98, -22}, {98, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(leftHeart.ctAlb, busConnector.ctAlb) annotation(Line(points = {{71, -52}, {98, -52}, {98, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(liver.ctAlb, busConnector.ctAlb) annotation(Line(points = {{71, 70}, {98, 70}, {98, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(otherTissue.ctAlb, busConnector.ctAlb) annotation(Line(points = {{-35, 16}, {6, 16}, {6, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(respiratoryMuscle.ctAlb, busConnector.ctAlb) annotation(Line(points = {{-35, -14}, {6, -14}, {6, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(rightHeart.ctAlb, busConnector.ctAlb) annotation(Line(points = {{71, -82}, {98, -82}, {98, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(skin.ctAlb, busConnector.ctAlb) annotation(Line(points = {{-35, -74}, {6, -74}, {6, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(skeletalMuscle.ctAlb, busConnector.ctAlb) annotation(Line(points = {{-35, 76}, {5.5, 76}, {5.5, 94}, {-88, 94}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(bone.ctGlb, busConnector.ctGlb) annotation(Line(points = {{-35, 42}, {6, 42}, {6, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(brain.ctGlb, busConnector.ctGlb) annotation(Line(points = {{71, 34}, {98, 34}, {98, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(fat.ctGlb, busConnector.ctGlb) annotation(Line(points = {{-35, -48}, {6, -48}, {6, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(GITract.ctGlb, busConnector.ctGlb) annotation(Line(points = {{71, 4}, {98, 4}, {98, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(kidney.ctGlb, busConnector.ctGlb) annotation(Line(points = {{71, -26}, {98, -26}, {98, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(leftHeart.ctGlb, busConnector.ctGlb) annotation(Line(points = {{71, -56}, {98, -56}, {98, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(liver.ctGlb, busConnector.ctGlb) annotation(Line(points = {{71, 66}, {98, 66}, {98, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(otherTissue.ctGlb, busConnector.ctGlb) annotation(Line(points = {{-35, 12}, {6, 12}, {6, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(respiratoryMuscle.ctGlb, busConnector.ctGlb) annotation(Line(points = {{-35, -18}, {6, -18}, {6, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(rightHeart.ctGlb, busConnector.ctGlb) annotation(Line(points = {{71, -86}, {98, -86}, {98, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(skin.ctGlb, busConnector.ctGlb) annotation(Line(points = {{-35, -78}, {6, -78}, {6, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(skeletalMuscle.ctGlb, busConnector.ctGlb) annotation(Line(points = {{-35, 72}, {5.5, 72}, {5.5, 94}, {-88, 94}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(bone.ctPO4, busConnector.ctPO4) annotation(Line(points = {{-35, 38}, {6, 38}, {6, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(brain.ctPO4, busConnector.ctPO4) annotation(Line(points = {{71, 30}, {98, 30}, {98, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(fat.ctPO4, busConnector.ctPO4) annotation(Line(points = {{-35, -52}, {6, -52}, {6, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(GITract.ctPO4, busConnector.ctPO4) annotation(Line(points = {{71, 0}, {98, 0}, {98, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(kidney.ctPO4, busConnector.ctPO4) annotation(Line(points = {{71, -30}, {98, -30}, {98, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(leftHeart.ctPO4, busConnector.ctPO4) annotation(Line(points = {{71, -60}, {98, -60}, {98, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(liver.ctPO4, busConnector.ctPO4) annotation(Line(points = {{71, 62}, {98, 62}, {98, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(otherTissue.ctPO4, busConnector.ctPO4) annotation(Line(points = {{-35, 8}, {6, 8}, {6, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(respiratoryMuscle.ctPO4, busConnector.ctPO4) annotation(Line(points = {{-35, -22}, {6, -22}, {6, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(rightHeart.ctPO4, busConnector.ctPO4) annotation(Line(points = {{71, -90}, {98, -90}, {98, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(skin.ctPO4, busConnector.ctPO4) annotation(Line(points = {{-35, -82}, {6, -82}, {6, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(skeletalMuscle.ctPO4, busConnector.ctPO4) annotation(Line(points = {{-35, 68}, {5.5, 68}, {5.5, 94}, {-88, 94}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(bone.cHCO3, busConnector.bone_cHCO3) annotation(Line(points = {{-35, 54}, {6, 54}, {6, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(brain.cHCO3, busConnector.brain_cHCO3) annotation(Line(points = {{71, 46}, {98, 46}, {98, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(fat.cHCO3, busConnector.fat_cHCO3) annotation(Line(points = {{-35, -36}, {6, -36}, {6, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(GITract.cHCO3, busConnector.GITract_cHCO3) annotation(Line(points = {{71, 16}, {98, 16}, {98, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(kidney.cHCO3, busConnector.kidney_cHCO3) annotation(Line(points = {{71, -14}, {98, -14}, {98, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(leftHeart.cHCO3, busConnector.leftHeart_cHCO3) annotation(Line(points = {{71, -44}, {98, -44}, {98, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(liver.cHCO3, busConnector.liver_cHCO3) annotation(Line(points = {{71, 78}, {98, 78}, {98, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(otherTissue.cHCO3, busConnector.otherTissue_cHCO3) annotation(Line(points = {{-35, 24}, {6, 24}, {6, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(respiratoryMuscle.cHCO3, busConnector.respiratoryMuscle_cHCO3) annotation(Line(points = {{-35, -6}, {6, -6}, {6, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(rightHeart.cHCO3, busConnector.rightHeart_cHCO3) annotation(Line(points = {{71, -74}, {98, -74}, {98, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(skin.cHCO3, busConnector.skin_cHCO3) annotation(Line(points = {{-35, -66}, {6, -66}, {6, 94}, {-88, 94}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(skeletalMuscle.cHCO3, busConnector.skeletalMuscle_cHCO3) annotation(Line(points = {{-35, 84}, {5.5, 84}, {5.5, 94}, {-88, 94}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
          connect(bone.pH_ery, busConnector.bone_pH_ery) annotation(Line(points = {{-42, 34}, {6, 34}, {6, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(brain.pH_ery, busConnector.brain_pH_ery) annotation(Line(points = {{64, 26}, {6, 26}, {6, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(fat.pH_ery, busConnector.fat_pH_ery) annotation(Line(points = {{-42, -56}, {6, -56}, {6, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(GITract.pH_ery, busConnector.GITract_pH_ery) annotation(Line(points = {{64, -4}, {6, -4}, {6, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(kidney.pH_ery, busConnector.kidney_pH_ery) annotation(Line(points = {{64, -34}, {6, -34}, {6, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(leftHeart.pH_ery, busConnector.leftHeart_pH_ery) annotation(Line(points = {{64, -64}, {6, -64}, {6, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(liver.pH_ery, busConnector.liver_pH_ery) annotation(Line(points = {{64, 58}, {6, 58}, {6, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(otherTissue.pH_ery, busConnector.otherTissue_pH_ery) annotation(Line(points = {{-42, 4}, {6, 4}, {6, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(rightHeart.pH_ery, busConnector.rightHeart_pH_ery) annotation(Line(points = {{64, -94}, {6, -94}, {6, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(respiratoryMuscle.pH_ery, busConnector.respiratoryMuscle_pH_ery) annotation(Line(points = {{-42, -26}, {6, -26}, {6, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(skin.pH_ery, busConnector.skin_pH_ery) annotation(Line(points = {{-42, -86}, {6, -86}, {6, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(skeletalMuscle.pH_ery, busConnector.skeletalMuscle_pH_ery) annotation(Line(points = {{-42, 64}, {6, 64}, {6, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(bone.pH, busConnector.bone_pH_plasma) annotation(Line(points = {{-46, 34}, {6, 34}, {6, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(brain.pH, busConnector.brain_pH_plasma) annotation(Line(points = {{60, 26}, {6, 26}, {6, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(fat.pH, busConnector.fat_pH_plasma) annotation(Line(points = {{-46, -56}, {6, -56}, {6, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(GITract.pH, busConnector.GITract_pH_plasma) annotation(Line(points = {{60, -4}, {6, -4}, {6, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(kidney.pH, busConnector.kidney_pH_plasma) annotation(Line(points = {{60, -34}, {6, -34}, {6, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(leftHeart.pH, busConnector.leftHeart_pH_plasma) annotation(Line(points = {{60, -64}, {6, -64}, {6, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(liver.pH, busConnector.liver_pH_plasma) annotation(Line(points = {{60, 58}, {6, 58}, {6, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(otherTissue.pH, busConnector.otherTissue_pH_plasma) annotation(Line(points = {{-46, 4}, {6, 4}, {6, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(rightHeart.pH, busConnector.rightHeart_pH_plasma) annotation(Line(points = {{60, -94}, {6, -94}, {6, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(respiratoryMuscle.pH, busConnector.respiratoryMuscle_pH_plasma) annotation(Line(points = {{-46, -26}, {6, -26}, {6, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(skin.pH, busConnector.skin_pH_plasma) annotation(Line(points = {{-46, -86}, {6, -86}, {6, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(skeletalMuscle.pH, busConnector.skeletalMuscle_pH_plasma) annotation(Line(points = {{-46, 64}, {6, 64}, {6, 94}, {-88, 94}}, color = {0, 0, 127}, smooth = Smooth.None));
          connect(busConnector.Blood_BEox, cTH_lessLactate.u1) annotation(Line(points = {{-88, 94}, {-60, 94}, {-60, 130}, {-94, 130}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
          connect(busConnector.LacPool_Lac_mEq_per_litre, cTH_lessLactate.u2) annotation(Line(points = {{-88, 94}, {-60, 94}, {-60, 118}, {-94, 118}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
          connect(cTH_lessLactate.y, skeletalMuscle.ctHox_lessLactate) annotation(Line(points = {{-71, 124}, {-66, 124}, {-66, 76}, {-53, 76}}, color = {0, 0, 127}, smooth = Smooth.None));
          annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 140}}), graphics = {Rectangle(extent=  {{-100, 100}, {100, -100}}, lineColor=  {0, 0, 255}, fillColor=  {215, 215, 215}, fillPattern=  FillPattern.Solid), Text(extent=  {{-96, -62}, {98, -94}}, lineColor=  {0, 0, 255}, textString=  "%name"), Text(extent=  {{-94, 12}, {-10, 40}}, lineColor=  {0, 0, 0}, textString=  "Blood"), Text(extent=  {{32, 40}, {98, -14}}, lineColor=  {0, 0, 0}, textString=  "pH")}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 140}}), graphics), Documentation(info = "<html>
                   <p>BE_interstitial is base excess in the interstitium of the tissue. The standard value is 0, when strong acid concentration increase, then BE value decrease with the same concentration. </p>
                   <p>Meaning might be interpreted like what amount of hydrogen iont must be added to sollution if the end poit of titration will be pH=7.4 and pCO2=5.3kPa.</p>
                   <p>For any tissue can be simplified with difference of lactate concentration from its normal value.</p>
                   </html>", revisions = "<html>
                   <table cellspacing=\"2\" cellpadding=\"0\" border=\"0\"><tr>
                   <td><p>Author:</p></td>
                   <td><p>Marek Matejak</p></td>
                   </tr>
                   <tr>
                   <td><p>Copyright:</p></td>
                   <td><p>In public domains</p></td>
                   </tr>
                   <tr>
                   <td><p>By:</p></td>
                   <td><p>Charles University, Prague</p></td>
                   </tr>
                   <tr>
                   <td><p>Date of:</p></td>
                   <td><p>dec 2013</p></td>
                   </tr>
                   <tr>
                   <td><p>References:</p></td>
                   <td>Siggaard Andersen: OSA (2005), University of Copenhagen</td>
                   </tr>
                   </table>
                   </html>"));
        end TissuesPh;

        model TissuePh
          extends HumMod.Gases.AcidBase.BloodPhBase;
          PhysiolibraryOld.Interfaces.RealInput_ ctHox_lessLactate(final unit=
                "mEq/l") "titratable acidity of oxygenated blood" annotation (
              Placement(transformation(extent={{-54,62},{-14,102}}),
                iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=0,
                origin={-90,0})));
          PhysiolibraryOld.Interfaces.RealInput_ T(final unit="degC")
            "tissue interstitial bicarbonate concentration" annotation (
              Placement(transformation(extent={{62,24},{40,2}}),
                iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=0,
                origin={-90,-72})));
          PhysiolibraryOld.Interfaces.RealInput_ cLactate(final unit="mEq/l")
            "titratable acidity of oxygenated blood" annotation (Placement(
                transformation(extent={{-6,66},{34,106}}), iconTransformation(
                extent={{-10,-10},{10,10}},
                rotation=0,
                origin={-90,40})));
        equation
          //base excess
          ctHox_lessLactate + cLactate = _cTHox;
          // cTH_interstitial = -(1-((ctHb_ery/3)/43))*((cHCO3_interstitial-24.5)+betaX*(pH_interstitial-7.42));
          annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Text(extent=  {{30, 100}, {96, 46}}, lineColor=  {0, 0, 0}, textString=  "pH"), Text(extent=  {{-96, 72}, {-12, 100}}, lineColor=  {0, 0, 0}, textString=  "Blood")}), Documentation(revisions = "<html>
                   <table cellspacing=\"2\" cellpadding=\"0\" border=\"0\"><tr>
                   <td><p>Author:</p></td>
                   <td><p>Marek Matejak</p></td>
                   </tr>
                   <tr>
                   <td><p>Copyright:</p></td>
                   <td><p>In public domains</p></td>
                   </tr>
                   <tr>
                   <td><p>By:</p></td>
                   <td><p>Charles University, Prague</p></td>
                   </tr>
                   <tr>
                   <td><p>Date of:</p></td>
                   <td><p>2013</p></td>
                   </tr>
                   <tr>
                   <td><p>References:</p></td>
                   <td>Siggaard Andersen: OSA (2005), University of Copenhagen</td>
                   </tr>
                   </table>
                   </html>"));
        end TissuePh;

        model SkeletalMuscleBloodPh
          extends TissuePh;
          extends PhysiolibraryOld.Icons.SkeletalMuscle;
        end SkeletalMuscleBloodPh;

        model BoneBloodPh
          extends TissuePh;
          extends PhysiolibraryOld.Icons.Bone;
        end BoneBloodPh;

        model OtherTissueBloodPh
          extends TissuePh;
          extends PhysiolibraryOld.Icons.OtherTissue;
        end OtherTissueBloodPh;

        model RespiratoryMuscleBloodPh
          extends TissuePh;
          extends PhysiolibraryOld.Icons.RespiratoryMuscle;
        end RespiratoryMuscleBloodPh;

        model FatBloodPh
          extends TissuePh;
          extends PhysiolibraryOld.Icons.Fat;
        end FatBloodPh;

        model SkinBloodPh
          extends TissuePh;
          extends PhysiolibraryOld.Icons.Skin;
        end SkinBloodPh;

        model LiverBloodPh
          extends TissuePh;
          extends PhysiolibraryOld.Icons.Liver;
        end LiverBloodPh;

        model BrainBloodPh
          extends TissuePh;
          extends PhysiolibraryOld.Icons.Brain;
        end BrainBloodPh;

        model GITractBloodPh
          extends TissuePh;
          extends PhysiolibraryOld.Icons.GITract;
        end GITractBloodPh;

        model KidneyBloodPh
          extends TissuePh;
          extends PhysiolibraryOld.Icons.Kidney;
        end KidneyBloodPh;

        model LeftHeartBloodPh
          extends TissuePh;
          extends PhysiolibraryOld.Icons.LeftHeart;
        end LeftHeartBloodPh;

        model RightHeartBloodPh
          extends TissuePh;
          extends PhysiolibraryOld.Icons.RightHeart;
        end RightHeartBloodPh;
      end Tissues_NSID;
      annotation(Documentation(revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr><tr>
                   <td></td>
                   <td>Siggaard Andersen: OSA (2005), University of Copenhagen</td>
                   </tr><tr>
                   <td></td>
                   <td>Noriaki Ikeda: A model of overall regulation of body fluids (1979), Kitasato University</td>
                   </tr>
                   </table>
                   </html>"));
    end AcidBase;

    package RespiratoryRegulations
      model RespiratoryNeuralDrive3
        extends PhysiolibraryOld.Icons.RespiratoryCenter;
        RespiratoryCenter2 afferentPath annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 0, origin = {66, 32})));
        PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
            Placement(transformation(extent={{-80,80},{-60,100}}),
              iconTransformation(extent={{-100,60},{-60,100}})));
        HumMod.Gases.RespiratoryRegulations.PeripheralChemoreceptors peripheralChemoreceptors annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 270, origin = {-26, 38})));
        HumMod.Gases.RespiratoryRegulations.SkeletalMuscleMetaboreflex skeletalMuscleMetaboreflex annotation(Placement(transformation(extent = {{-18, -16}, {2, 4}})));
        HumMod.Gases.RespiratoryRegulations.CentralChemoreceptors centralChemoreceptors annotation(Placement(transformation(extent = {{0, 48}, {20, 68}})));
        RespiratoryCenterEfferent efferentPath annotation(Placement(transformation(extent = {{50, -22}, {70, -2}})));
        /*  Modelica.Blocks.Logical.TerminateSimulation terminateSimulation(
                                                                                                                                                              terminationText="solution reached", condition=false and (
                                                                                                                                                                afferentPath.TotalDrive < efferentPath.TotalDrive))
                                                                                                                                                            annotation (Placement(transformation(extent={{-10,-84},{70,-76}})));

                                                                                                                                                        Physiolibrary.Utilities.ConstantFromFile RespiratoryCenter_RespRate(                                    varName = "RespiratoryCenter-Output.Rate", varValue = 11.7241515181155, initType=Physiolibrary.Utilities.Init.NoInit) 
                                                                                                                                                            "Respiration rate. [1/min]"
                                                                                                                                                        annotation (Placement(transformation(extent={{-92,-78},{-86,-72}})));
                                                                                                                                                        Physiolibrary.Utilities.ConstantFromFile    RespiratoryCenter_MotorNerveActivity(     varName = "RespiratoryCenter-Output.MotorNerveActivity", varValue = 0.943462424759193, initType=Physiolibrary.Utilities.Init.NoInit) 
                                                                                                                                                            "Neural activity from respiratory center to respiratory muscle. []"
                                                                                                                                                        annotation (Placement(transformation(extent={{-92,-88},{-86,-82}})));
                                                                                                                                                        Physiolibrary.Utilities.ConstantFromFile    RespiratoryCenterIntegration_TotalDrive(                                      varName = "RespiratoryCenter-Integration.TotalDrive", varValue = 0.943462424759193, initType=Physiolibrary.Utilities.Init.NoInit) 
                                                                                                                                                            "RespiratoryCenter-Integration.TotalDrive"
                                                                                                                                                        annotation (Placement(transformation(extent={{16,-70},{22,-64}})));
                                                                                                                                                          Physiolibrary.Blocks.Constant Constant(
                                                                                                                                                                                           k=1.04494)
                                                                                                                                                            annotation (Placement(transformation(extent={{24,-84},{32,-76}})));
                                                                                                                                                          Modelica.Blocks.Sources.Clock clock(offset=0.75)
                                                                                                                                                            annotation (Placement(transformation(extent={{-28,-80},{-8,-60}})));
                                                                                                                                                        */
        PhysiolibraryOld.Blocks.Constant Constant(k=1)
          annotation (Placement(transformation(extent={{-60,-40},{-52,-32}})));
        PhysiolibraryOld.Blocks.deprecated_HomotopyStrongComponentBreaker
          homotopyBreak(defaultSlope=0.1, defaultValue=1.02)
          annotation (Placement(transformation(extent={{84,32},{92,40}})));
        Modelica.Blocks.Sources.Clock clock(offset = 0.9, startTime = 0.9) annotation(Placement(transformation(extent = {{-62, -96}, {-42, -76}})));
        Modelica.Blocks.Logical.Switch switch1 annotation(Placement(transformation(extent = {{-4, -76}, {16, -56}})));
        Modelica.Blocks.Sources.BooleanConstant booleanConstant(k = true) annotation(Placement(transformation(extent = {{-92, -70}, {-72, -50}})));
      equation
        // efferentPath.TotalDrive=homotopy(actual=afferentPath.TotalDrive, simplified=1.045922);
        connect(busConnector, afferentPath.busConnector) annotation(Line(points = {{-70, 90}, {-70, 98}, {61.8, 98}, {61.8, 40.2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector, peripheralChemoreceptors.busConnector) annotation(Line(points = {{-70, 90}, {-70, 98}, {-25.8, 98}, {-25.8, 45.6}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(peripheralChemoreceptors.Chemoreceptors_FiringRate, afferentPath.Chemoreceptors_FiringRate) annotation(Line(points = {{-16, 40}, {23, 40}, {23, 38}, {58, 38}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(skeletalMuscleMetaboreflex.NA, afferentPath.Metaboreflex) annotation(Line(points = {{2, -6}, {28, -6}, {28, 34}, {56.2, 34}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.skeletalMuscle_pH_intracellular, skeletalMuscleMetaboreflex.skeletalMuscle_pH) annotation(Line(points = {{-70, 90}, {-70, -6}, {-18, -6}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.GangliaGeneral_NA, peripheralChemoreceptors.GangliaGeneral_NA) annotation(Line(points = {{-70, 90}, {-70, 42}, {-36, 42}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.brain_pH_intracellular, centralChemoreceptors.Brain_pH_intracellular) annotation(Line(points = {{-70, 90}, {-70, 64}, {2, 64}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.O2Artys_PO2, peripheralChemoreceptors.artys_pO2) annotation(Line(points = {{-70, 90}, {-70, 34}, {-36, 34}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.Artys_pH, peripheralChemoreceptors.artys_ph) annotation(Line(points = {{-70, 90}, {-70, 38}, {-36, 38}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(efferentPath.RespRate, busConnector.RespiratoryCenter_RespRate) annotation(Line(points = {{69.40000000000001, -8}, {90, -8}, {90, 96}, {-70, 96}, {-70, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(efferentPath.RespiratoryCenterOutput_MotorNerveActivity, busConnector.RespiratoryCenter_MotorNerveActivity) annotation(Line(points = {{69.59999999999999, -16}, {90, -16}, {90, 90}, {-70, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(efferentPath.busConnector, busConnector) annotation(Line(points = {{55.8, -3.8}, {42, -3.8}, {42, 90}, {-70, 90}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(homotopyBreak.u, afferentPath.TotalDrive) annotation(Line(points = {{83.2, 36}, {75.40000000000001, 36}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(booleanConstant.y, switch1.u2) annotation(Line(points = {{-71, -60}, {-38, -60}, {-38, -66}, {-6, -66}}, color = {255, 0, 255}, smooth = Smooth.None));
        connect(Constant.y, switch1.u1) annotation(Line(points = {{-51.6, -36}, {-28, -36}, {-28, -58}, {-6, -58}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(clock.y, switch1.u3) annotation(Line(points = {{-41, -86}, {-24, -86}, {-24, -74}, {-6, -74}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(centralChemoreceptors.CentralChemoreceptors, afferentPath.CentralChemoreceptors) annotation(Line(points = {{19.4, 62}, {30, 62}, {30, 29}, {58, 29}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(homotopyBreak.y, efferentPath.TotalDrive) annotation(Line(points = {{92.40000000000001, 36}, {98, 36}, {98, 8}, {34, 8}, {34, -10}, {50.2, -10}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Text(extent=  {{-142, -108}, {142, -140}}, lineColor=  {0, 0, 255}, textString=  "%name")}));
      end RespiratoryNeuralDrive3;

      model RespiratoryCenter2
        extends PhysiolibraryOld.Icons.RespiratoryCenter;
        parameter Real RadiationTotalDrive[:, 3] = {{0, 0.0, 0}, {500, 3.5, 0.003}, {1000, 4.0, 0}};
        parameter Real OutputRate[:, 3] = {{0, 0, 12}, {1, 12, 4}, {10, 40, 0}};
        PhysiolibraryOld.Interfaces.RealOutput_ TotalDrive annotation (
            Placement(transformation(extent={{80,-20},{120,20}}),
              iconTransformation(extent={{74,20},{114,60}})));
        PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
            Placement(transformation(extent={{-42,82},{-22,102}}),
              iconTransformation(extent={{-62,62},{-22,102}})));
        PhysiolibraryOld.Interfaces.RealInput_ Chemoreceptors_FiringRate
          annotation (Placement(transformation(extent={{-100,40},{-60,80}}),
              iconTransformation(extent={{-100,40},{-60,80}})));
        PhysiolibraryOld.Curves.Curve Radiation(
          x=RadiationTotalDrive[:, 1],
          y=RadiationTotalDrive[:, 2],
          slope=RadiationTotalDrive[:, 3])
          annotation (Placement(transformation(extent={{-10,12},{10,32}})));
        Modelica.Blocks.Math.Add RespiratoryCenterChemical_TotalDrive(k1 = 0.6, k2 = 0.4) annotation(Placement(transformation(extent = {{36, 52}, {56, 72}})));
        PhysiolibraryOld.Interfaces.RealInput_ Metaboreflex annotation (
            Placement(transformation(extent={{-120,0},{-80,40}}),
              iconTransformation(extent={{-118,0},{-78,40}})));
        Modelica.Blocks.Math.Add RespiratoryCenterExercise_TotalDrive annotation(Placement(transformation(extent = {{26, 18}, {46, 38}})));
        Modelica.Blocks.Math.Add RespiratoryCenterIntegration_TotalDrive annotation(Placement(transformation(extent = {{66, 24}, {86, 44}})));
        PhysiolibraryOld.Interfaces.RealInput_ CentralChemoreceptors
          annotation (Placement(transformation(extent={{-100,66},{-60,106}}),
              iconTransformation(extent={{-100,-50},{-60,-10}})));
      equation
        connect(Radiation.val, RespiratoryCenterExercise_TotalDrive.u2) annotation(Line(points = {{10.2, 22}, {24, 22}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Metaboreflex, RespiratoryCenterExercise_TotalDrive.u1) annotation(Line(points = {{-100, 20}, {-44, 20}, {-44, 34}, {24, 34}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(RespiratoryCenterChemical_TotalDrive.y, RespiratoryCenterIntegration_TotalDrive.u1) annotation(Line(points = {{57, 62}, {60, 62}, {60, 40}, {64, 40}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(RespiratoryCenterExercise_TotalDrive.y, RespiratoryCenterIntegration_TotalDrive.u2) annotation(Line(points = {{47, 28}, {64, 28}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.ExerciseMetabolism_TotalWatts, Radiation.u) annotation(Line(points = {{-32, 92}, {-32, 22}, {-10, 22}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(RespiratoryCenterChemical_TotalDrive.u1, CentralChemoreceptors) annotation(Line(points = {{34, 68}, {-18, 68}, {-18, 86}, {-80, 86}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(RespiratoryCenterIntegration_TotalDrive.y, TotalDrive) annotation(Line(points = {{87, 34}, {94, 34}, {94, 0}, {100, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Chemoreceptors_FiringRate, RespiratoryCenterChemical_TotalDrive.u2) annotation(Line(points = {{-80, 60}, {-23, 60}, {-23, 56}, {34, 56}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Text(extent=  {{-66, 32}, {76, -22}}, lineColor=  {0, 0, 0}, fillColor=  {213, 255, 170}, fillPattern=  FillPattern.Solid, textString=  "%name"), Text(extent=  {{-124, -104}, {124, -130}}, lineColor=  {0, 0, 255}, textString=  "%name")}));
      end RespiratoryCenter2;

      model RespiratoryCenterEfferent
        extends PhysiolibraryOld.Icons.RespiratoryCenter;
        parameter Real RadiationTotalDrive[:, 3] = {{0, 0.0, 0}, {500, 3.5, 0.003}, {1000, 4.0, 0}};
        parameter Real OutputRate[:, 3] = {{0, 0, 12}, {1, 12, 4}, {10, 40, 0}};
        PhysiolibraryOld.Curves.Curve RespiratoryCenterOutput(
          x=OutputRate[:, 1],
          y=OutputRate[:, 2],
          slope=OutputRate[:, 3])
          annotation (Placement(transformation(extent={{-10,-16},{10,4}})));
        PhysiolibraryOld.Interfaces.RealOutput_ RespRate annotation (Placement(
              transformation(extent={{80,-20},{120,20}}), iconTransformation(
                extent={{74,20},{114,60}})));
        PhysiolibraryOld.Interfaces.RealOutput_
          RespiratoryCenterOutput_MotorNerveActivity annotation (Placement(
              transformation(extent={{54,-68},{94,-28}}), iconTransformation(
                extent={{76,-60},{116,-20}})));
        PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
            Placement(transformation(extent={{-42,82},{-22,102}}),
              iconTransformation(extent={{-62,62},{-22,102}})));
        PhysiolibraryOld.Interfaces.RealInput_ TotalDrive(start=1) annotation (
            Placement(transformation(extent={{-120,0},{-80,40}}),
              iconTransformation(extent={{-118,0},{-78,40}})));
        Modelica.Blocks.Math.Product Rate annotation(Placement(transformation(extent = {{62, -10}, {82, 10}})));
        PhysiolibraryOld.Factors.SimpleMultiply FunctionEffect
          annotation (Placement(transformation(extent={{14,-48},{34,-28}})));
        PhysiolibraryOld.Factors.SimpleMultiply AnesthesiaEffect
          annotation (Placement(transformation(extent={{14,-60},{34,-40}})));
      equation
        connect(RespiratoryCenterOutput.val, Rate.u2) annotation(Line(points = {{10.2, -6}, {60, -6}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Rate.y, RespRate) annotation(Line(points = {{83, 0}, {100, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(FunctionEffect.y, AnesthesiaEffect.yBase) annotation(Line(points = {{24, -40}, {24, -48}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(AnesthesiaEffect.y, RespiratoryCenterOutput_MotorNerveActivity) annotation(Line(points = {{24, -52}, {24, -62}, {64, -62}, {64, -48}, {74, -48}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.AnesthesiaTidalVolume, AnesthesiaEffect.u) annotation(Line(points = {{-32, 92}, {-32, -50}, {14.2, -50}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.brain_FunctionEffect, FunctionEffect.u) annotation(Line(points = {{-32, 92}, {-32, -38}, {14.2, -38}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.brain_FunctionEffect, Rate.u1) annotation(Line(points = {{-32, 92}, {-32, 6}, {60, 6}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(TotalDrive, RespiratoryCenterOutput.u) annotation(Line(points = {{-100, 20}, {-56, 20}, {-56, -6}, {-10, -6}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(TotalDrive, FunctionEffect.yBase) annotation(Line(points = {{-100, 20}, {-56, 20}, {-56, -22}, {24, -22}, {24, -36}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Text(extent=  {{-66, 32}, {76, -22}}, lineColor=  {0, 0, 0}, fillColor=  {213, 255, 170}, fillPattern=  FillPattern.Solid, textString=  "%name"), Text(extent=  {{-122, -100}, {126, -126}}, lineColor=  {0, 0, 255}, textString=  "%name")}));
      end RespiratoryCenterEfferent;

      model CentralChemoreceptors
        extends PhysiolibraryOld.Icons.RespiratoryCenter;
        parameter Real data[:, 3] = {{6.6, 0.0, 0}, {6.87, 10.0, 0}, {7.12, 1.0, -8.0}, {7.5, 0.0, 0}};
        PhysiolibraryOld.Interfaces.RealOutput_ CentralChemoreceptors
          annotation (Placement(transformation(extent={{80,-20},{120,20}}),
              iconTransformation(extent={{74,20},{114,60}})));
        PhysiolibraryOld.Blocks.Constant Constant(k=0.6)
          annotation (Placement(transformation(extent={{-2,82},{10,94}})));
        PhysiolibraryOld.Interfaces.RealInput_ Brain_pH_intracellular
          annotation (Placement(transformation(extent={{-100,40},{-60,80}}),
              iconTransformation(extent={{-100,40},{-60,80}})));
        PhysiolibraryOld.Factors.CurveValue splineValue(data={{6.6,0.0,0},{6.87,
              10.0,0},{7.12,1.0,-8.0},{7.5,0.0,0}})
          annotation (Placement(transformation(extent={{2,68},{22,88}})));
        //orginal data from Coleman {{6.60,0.0,0},{6.87,10.0,0},{7.22,1.0,-8.0},{7.50,0.0,0}}) was corrected, becase the normal intracellular pH in neuron cells is 7.16
        Modelica.Blocks.Math.Gain gain(k = 7.12 / 7.09)
          "marekov korekcny faktor medzi Tomom Colemanom(normal value=7.12) a Siggardom Andersnom(normal value=7.09), 7.137/7.095"
                                                                                                              annotation(Placement(transformation(extent = {{-46, 28}, {-26, 48}})));
        PhysiolibraryOld.Curves.Curve curve(
          x=data[:, 1],
          y=data[:, 2],
          slope=data[:, 3])
          annotation (Placement(transformation(extent={{-24,-12},{-4,8}})));
      equation
        connect(Constant.y, splineValue.yBase) annotation(Line(points = {{10.6, 88}, {12, 88}, {12, 80}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Brain_pH_intracellular, gain.u) annotation(Line(points = {{-80, 60}, {-64, 60}, {-64, 38}, {-48, 38}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Brain_pH_intracellular, splineValue.u) annotation(Line(points = {{-80, 60}, {-39, 60}, {-39, 78}, {2.2, 78}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Brain_pH_intracellular, curve.u) annotation(Line(points = {{-80, 60}, {-58, 60}, {-58, -2}, {-24, -2}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(curve.val, CentralChemoreceptors) annotation(Line(points = {{-3.8, -2}, {48, -2}, {48, 0}, {100, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Text(extent=  {{-66, 32}, {76, -22}}, lineColor=  {0, 0, 0}, fillColor=  {213, 255, 170}, fillPattern=  FillPattern.Solid, textString=  "%name"), Text(extent=  {{-118, -104}, {130, -130}}, lineColor=  {0, 0, 255}, textString=  "%name")}));
      end CentralChemoreceptors;

      model PeripheralChemoreceptors
        extends PhysiolibraryOld.Icons.PeripheralChemoreceptors;
        PhysiolibraryOld.Curves.Curve PhEffectCurve(
          x=PhEffect[:, 1],
          y=PhEffect[:, 2],
          slope=PhEffect[:, 3])
          annotation (Placement(transformation(extent={{-24,8},{12,44}})));
        PhysiolibraryOld.Interfaces.RealOutput_ Chemoreceptors_FiringRate
          annotation (Placement(transformation(extent={{88,-18},{112,6}}),
              iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=90,
              origin={-20,100})));
        parameter Real PhEffect[:, 3] = {{7.1, 2, 0}, {7.4, 0.4, -3}, {7.7, 0, 0}};
        //Orginal values from Coleman {{ 7.10,  2.0,  0}, { 7.44,  0.4,  -3.0}, { 7.70,  0.0,  0}} was corrected, because normal arteries pH is not 7.44 but 7.4
        parameter Real PO2Effect[:, 3] = {{30, 10.0, 0}, {60, 2.0, -0.05}, {85, 0.5, -0.005}, {200, 0.2, 0}};
        //Orginal values from Coleman {{  30,  10.0,  0}, {  60,   2.0,  -0.05}, {  94,   0.5,  -0.005}, { 400,   0.2,  0}} was corrected, because normal arteries pO2 is not 94 but 85
        parameter Real PO2Effect_original[:, 3] = {{30, 10.0, 0}, {60, 2.0, -0.05}, {94, 0.5, -0.005}, {200, 0.2, 0}};
        parameter Real SteadyState[:, 3] = {{0, 0, 0}, {1, 1, 0.3}, {10, 2, 0}};
        parameter Real Tau(final quantity = "Time", final unit = "h") = 20;
        PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
            Placement(transformation(extent={{-102,64},{-82,84}}),
              iconTransformation(extent={{-96,-18},{-56,22}})));
        PhysiolibraryOld.Interfaces.RealInput_ GangliaGeneral_NA annotation (
            Placement(transformation(extent={{-74,44},{-48,70}}),
              iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=90,
              origin={-40,-100})));
        HumMod.Nerves.AplhaReceptorsActivityFactor aplhaReceptorsActivityFactor(data = {{0, 0.0, 0}, {1, 0.1, 0.2}, {4, 0.6, 0}}, NEURALK = 0.5, HUMORALK = 0.5) annotation(Placement(transformation(extent = {{-26, 68}, {-6, 88}})));
        PhysiolibraryOld.Blocks.Constant Constant(k=1)
          annotation (Placement(transformation(extent={{-30,90},{-22,98}})));
        PhysiolibraryOld.Curves.Curve PO2EffectCurve(
          x=PO2Effect[:, 1],
          y=PO2Effect[:, 2],
          slope=PO2Effect[:, 3])
          annotation (Placement(transformation(extent={{-24,-38},{12,-2}})));
        Modelica.Blocks.Math.Sum sum(nin = 3) annotation(Placement(transformation(extent = {{32, 0}, {52, 20}})));
        Modelica.Blocks.Math.Product product annotation(Placement(transformation(extent = {{74, -16}, {94, 4}})));
        PhysiolibraryOld.Curves.Curve SteadyStateCurve(
          x=SteadyState[:, 1],
          y=SteadyState[:, 2],
          slope=SteadyState[:, 3]) "ChemoreceptorAcclimation"
          annotation (Placement(transformation(extent={{-62,-96},{-26,-60}})));
        Modelica.Blocks.Math.Feedback feedback annotation(Placement(transformation(extent = {{-8, -88}, {12, -68}})));
        PhysiolibraryOld.Blocks.Integrator integrator(
          stateName="ChemoreceptorAcclimation.Effect",
          k=1/(60*Tau*PhysiolibraryOld.SecPerMin),
          y_start=1.01445) "ChemoreceptorAcclimation.Effect"
          annotation (Placement(transformation(extent={{24,-88},{44,-68}})));
        PhysiolibraryOld.Interfaces.RealInput_ artys_ph annotation (Placement(
              transformation(extent={{-106,16},{-66,56}}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=90,
              origin={0,-100})));
        PhysiolibraryOld.Interfaces.RealInput_ artys_pO2 annotation (Placement(
              transformation(extent={{-106,-20},{-66,20}}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=90,
              origin={40,-100})));
        PhysiolibraryOld.Curves.Curve PO2EffectCurve1(
          x=PO2Effect_original[:, 1],
          y=PO2Effect_original[:, 2],
          slope=PO2Effect_original[:, 3])
          annotation (Placement(transformation(extent={{40,52},{76,88}})));
      equation
        assert(artys_pO2 > 30, "artys_pO2 should be greater then 30 mmHg!");
        connect(Constant.y, aplhaReceptorsActivityFactor.yBase) annotation(Line(points = {{-21.6, 94}, {-16, 94}, {-16, 85}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.AlphaPool_Effect, aplhaReceptorsActivityFactor.AlphaPool_Effect) annotation(Line(points = {{-92, 74}, {-60, 74}, {-60, 84}, {-25.8, 84}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.AlphaBlocade_Effect, aplhaReceptorsActivityFactor.AlphaBlockade_Effect) annotation(Line(points = {{-92, 74}, {-60, 74}, {-60, 78}, {-25.8, 78}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(aplhaReceptorsActivityFactor.GangliaGeneral_NA, GangliaGeneral_NA) annotation(Line(points = {{-25.8, 72}, {-46, 72}, {-46, 57}, {-61, 57}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(PhEffectCurve.val, sum.u[2]) annotation(Line(points = {{12.36, 26}, {26, 26}, {26, 10}, {30, 10}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(aplhaReceptorsActivityFactor.y, sum.u[1]) annotation(Line(points = {{-16, 71}, {-16, 54}, {26, 54}, {26, 8.66667}, {30, 8.66667}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(product.y, Chemoreceptors_FiringRate) annotation(Line(points = {{95, -6}, {100, -6}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(sum.y, product.u1) annotation(Line(points = {{53, 10}, {60, 10}, {60, 0}, {72, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(sum.y, SteadyStateCurve.u) annotation(Line(points = {{53, 10}, {60, 10}, {60, -42}, {-82, -42}, {-82, -78}, {-62, -78}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(integrator.y, product.u2) annotation(Line(points = {{45, -78}, {66, -78}, {66, -12}, {72, -12}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(SteadyStateCurve.val, feedback.u1) annotation(Line(points = {{-25.64, -78}, {-6, -78}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(integrator.y, feedback.u2) annotation(Line(points = {{45, -78}, {56, -78}, {56, -98}, {2, -98}, {2, -86}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(feedback.y, integrator.u) annotation(Line(points = {{11, -78}, {22, -78}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(PhEffectCurve.u, artys_ph) annotation(Line(points = {{-24, 26}, {-50, 26}, {-50, 36}, {-86, 36}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(PO2EffectCurve.u, artys_pO2) annotation(Line(points = {{-24, -20}, {-50, -20}, {-50, 0}, {-86, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(artys_pO2, PO2EffectCurve1.u) annotation(Line(points = {{-86, 0}, {20, 0}, {20, 70}, {40, 70}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(PO2EffectCurve1.val, sum.u[3]) annotation(Line(points = {{76.36, 70}, {88, 70}, {88, 32}, {26, 32}, {26, 11.3333}, {30, 11.3333}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Text(extent=  {{-124, 13}, {124, -13}}, lineColor=  {0, 0, 255}, textString=  "%name", origin=  {122, -9}, rotation=  90)}));
      end PeripheralChemoreceptors;

      model GasEquation
        PhysiolibraryOld.Interfaces.RealInput V1(final unit="ml") annotation (
            Placement(transformation(extent={{-118,42},{-78,82}}),
              iconTransformation(extent={{-100,66},{-72,94}})));
        PhysiolibraryOld.Interfaces.RealInput P1(final unit="mmHg") annotation (
           Placement(transformation(extent={{-118,42},{-78,82}}),
              iconTransformation(extent={{-100,6},{-72,34}})));
        PhysiolibraryOld.Interfaces.RealInput T1(final unit="degC") annotation (
           Placement(transformation(extent={{-118,42},{-78,82}}),
              iconTransformation(extent={{-100,-54},{-72,-26}})));
        PhysiolibraryOld.Interfaces.RealInput P2(final unit="mmHg") annotation (
           Placement(transformation(extent={{-118,42},{-78,82}}),
              iconTransformation(
              extent={{-14,-14},{14,14}},
              rotation=180,
              origin={86,20})));
        PhysiolibraryOld.Interfaces.RealInput T2(final unit="degC") annotation (
           Placement(transformation(extent={{-118,42},{-78,82}}),
              iconTransformation(
              extent={{-14,-14},{14,14}},
              rotation=180,
              origin={86,-40})));
        PhysiolibraryOld.Interfaces.RealOutput V2(final unit="ml") annotation (
            Placement(transformation(extent={{56,54},{96,94}}),
              iconTransformation(extent={{72,66},{100,94}})));
      equation
        P1 * V1 / (T1 + 273.15) = P2 * V2 / (T2 + 273.15);
        annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Rectangle(extent=  {{-100, 100}, {100, -100}}, lineColor=  {0, 0, 0}, fillColor=  {170, 213, 255}, fillPattern=  FillPattern.Solid), Rectangle(extent=  {{0, 100}, {0, -100}}, lineColor=  {0, 0, 0}, fillColor=  {170, 213, 255}, fillPattern=  FillPattern.Solid), Text(extent=  {{-98, 136}, {100, 100}}, lineColor=  {0, 0, 0}, fillColor=  {170, 213, 255}, fillPattern=  FillPattern.Solid, textString=  "%name")}));
      end GasEquation;

      model VaporPressure
        PhysiolibraryOld.Interfaces.RealInput T(final quantity=
              "ThermodynamicTemperature", final unit="degC") annotation (
            Placement(transformation(extent={{-118,42},{-78,82}}),
              iconTransformation(extent={{-100,-14},{-72,14}})));
        PhysiolibraryOld.Interfaces.RealOutput VaporPressure(final unit="mmHg")
          annotation (Placement(transformation(extent={{56,54},{96,94}}),
              iconTransformation(extent={{100,-14},{128,14}})));
      equation
        VaporPressure = if T < 0 then 0 else if T > 100 then 760 else exp(18.6686 - 4030.183 / (T + 235));
        annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Rectangle(extent=  {{-100, 40}, {100, -40}}, lineColor=  {0, 0, 0}, fillColor=  {170, 213, 255}, fillPattern=  FillPattern.Solid)}));
      end VaporPressure;

      model NaturalVentilation2
        extends PhysiolibraryOld.Icons.Ventilation;
        PhysiolibraryOld.Interfaces.RealInput_
          RespiratoryCenterOutput_MotorNerveActivity(final unit="Hz")
          annotation (Placement(transformation(extent={{-88,40},{-48,80}}),
              iconTransformation(extent={{-100,66},{-72,94}})));
        PhysiolibraryOld.Interfaces.RealInput_ Thorax_LungInflation(final unit=
              "1") annotation (Placement(transformation(extent={{-88,-22},{-48,
                  18}}), iconTransformation(extent={{-100,-54},{-72,-26}})));
        PhysiolibraryOld.Interfaces.RealInput_ ExcessLungWater_Volume(final
            unit="1") annotation (Placement(transformation(extent={{-88,-58},{-48,
                  -18}}), iconTransformation(extent={{-100,-94},{-72,-66}})));
        PhysiolibraryOld.Interfaces.RealOutput_ TidalVolume(final unit="ml")
          annotation (Placement(transformation(extent={{52,-48},{92,-8}}),
              iconTransformation(extent={{100,6},{128,34}})));
        PhysiolibraryOld.Interfaces.RealOutput_ DeadSpace(final unit="ml")
          annotation (Placement(transformation(extent={{14,-96},{54,-56}}),
              iconTransformation(extent={{100,-54},{128,-26}})));
        PhysiolibraryOld.Interfaces.RealInput_ RespiratoryMuscleFunctionEffect(
            final unit="ml") annotation (Placement(transformation(extent={{-88,
                  6},{-48,46}}), iconTransformation(extent={{-100,26},{-72,54}})));
        parameter Real DeadSpaceSlope = 0.2;
        parameter Real DeadSpaceMin = 60.0;
        parameter Real[:, 3] DriveOnTidalVolume = {{0, 0, 0}, {1, 450, 400}, {10, 2630, 0}};
        //corrected from {{  0,     0,    0}, {  1,   550,  400}, { 10,  2630,    0}}
        // Real TidalVolumeBasic;
        PhysiolibraryOld.Curves.Curve curve(
          x=DriveOnTidalVolume[:, 1],
          y=DriveOnTidalVolume[:, 2],
          slope=DriveOnTidalVolume[:, 3])
          annotation (Placement(transformation(extent={{-2,32},{18,52}})));
        PhysiolibraryOld.Factors.SimpleMultiply LungInflation
          annotation (Placement(transformation(extent={{16,6},{36,26}})));
        PhysiolibraryOld.Factors.SimpleMultiply FunctionEffect
          annotation (Placement(transformation(extent={{16,16},{36,36}})));
        Modelica.Blocks.Math.Max max annotation(Placement(transformation(extent = {{36, -38}, {56, -18}})));
        Modelica.Blocks.Math.Feedback tidalVol0 annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 270, origin = {26, -2})));
        PhysiolibraryOld.Blocks.VolumeConstant Breathing_TidalVolumeMin(k=0)
          "Breathing.TidalVolumeMin"
          annotation (Placement(transformation(extent={{4,-42},{20,-26}})));
        PhysiolibraryOld.Blocks.VolumeConstant Breathing_DeadSpaceMin(k=
              DeadSpaceMin) "Breathing.DeadSpaceMin"
          annotation (Placement(transformation(extent={{-88,-102},{-58,-72}})));
        PhysiolibraryOld.Blocks.Constant deadSpaceSlope(k=DeadSpaceSlope)
          annotation (Placement(transformation(extent={{-82,-80},{-58,-56}})));
        Modelica.Blocks.Math.Product product annotation(Placement(transformation(extent = {{-30, -72}, {-10, -52}})));
        Modelica.Blocks.Math.Add add annotation(Placement(transformation(extent = {{2, -86}, {22, -66}})));
      equation
        //  u=RespiratoryCenterOutput_MotorNerveActivity; //curve x value
        /*
                                                                                                                                                          TidalVolumeBasic  =
                                                                                                                                                              curve.val
                                                                                                                                                            * Thorax_LungInflation
                                                                                                                                                            * RespiratoryMuscleFunctionEffect;   //val.. curve y value

                                                                                                                                                           TidalVolume  = max(0, TidalVolumeBasic - ExcessLungWater_Volume);
                                                                                                                                                           DeadSpace  =  DeadSpaceSlope * TidalVolume + DeadSpaceMin; */
        connect(RespiratoryCenterOutput_MotorNerveActivity, curve.u) annotation(Line(points = {{-68, 60}, {-16, 60}, {-16, 42}, {-2, 42}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(RespiratoryMuscleFunctionEffect, FunctionEffect.u) annotation(Line(points = {{-68, 26}, {16.2, 26}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Thorax_LungInflation, LungInflation.u) annotation(Line(points = {{-68, -2}, {-32, -2}, {-32, 16}, {16.2, 16}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(curve.val, FunctionEffect.yBase) annotation(Line(points = {{18.2, 42}, {26, 42}, {26, 28}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(FunctionEffect.y, LungInflation.yBase) annotation(Line(points = {{26, 24}, {26, 18}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(LungInflation.y, tidalVol0.u1) annotation(Line(points = {{26, 14}, {26, 6}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(ExcessLungWater_Volume, tidalVol0.u2) annotation(Line(points = {{-68, -38}, {-16, -38}, {-16, -2}, {18, -2}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(tidalVol0.y, max.u1) annotation(Line(points = {{26, -11}, {26, -22}, {34, -22}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Breathing_TidalVolumeMin.y, max.u2) annotation(Line(points = {{20.8, -34}, {34, -34}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(add.y, DeadSpace) annotation(Line(points = {{23, -76}, {34, -76}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(deadSpaceSlope.y, product.u2) annotation(Line(points = {{-56.8, -68}, {-32, -68}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(product.y, add.u1) annotation(Line(points = {{-9, -62}, {-6, -62}, {-6, -70}, {0, -70}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Breathing_DeadSpaceMin.y, add.u2) annotation(Line(points = {{-56.5, -87}, {-28, -87}, {-28, -82}, {0, -82}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(product.u1, TidalVolume) annotation(Line(points = {{-32, -56}, {-42, -56}, {-42, -46}, {68, -46}, {68, -28}, {72, -28}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(max.y, TidalVolume) annotation(Line(points = {{57, -28}, {72, -28}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Text(extent=  {{-120, -108}, {130, -126}}, lineColor=  {0, 0, 255}, textString=  "%name")}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
      end NaturalVentilation2;

      model AlveolarVentilation
        extends PhysiolibraryOld.Icons.Lungs;
        //  parameter Real EnvironmentPressure(final unit="mmHg");
        //  parameter Real EnvironmentTemperature(final unit="degC");
        PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow expired
          annotation (extent=[-10,-110; 10,-90], Placement(transformation(
                extent={{68,18},{88,38}}), iconTransformation(extent={{90,70},{
                  110,90}})));
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow inspired
          annotation (Placement(transformation(extent={{-120,8},{-80,48}}),
              iconTransformation(extent={{-110,70},{-90,90}})));
        PhysiolibraryOld.Interfaces.RealInput_ AlveolarVentilation_STPD
          annotation (Placement(transformation(extent={{-14,44},{0,58}}),
              iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=180,
              origin={80,20})));
        PhysiolibraryOld.ConcentrationFlow.SolventFlowPump solventFlowPump(
            q_out(conc(start=0.13686)))
          annotation (Placement(transformation(extent={{-2,18},{18,38}})));
        PhysiolibraryOld.ConcentrationFlow.Dilution dilution annotation (
            Placement(transformation(
              extent={{-8,8},{12,-12}},
              rotation=0,
              origin={-26,36})));
        PhysiolibraryOld.ConcentrationFlow.SolventFlowPump solventFlowPump1
          annotation (Placement(transformation(extent={{44,18},{64,38}})));
        PhysiolibraryOld.PressureFlow.NegativePressureFlow alveolar annotation (
           extent=[-10,-110; 10,-90], Placement(transformation(extent={{20,-14},
                  {40,6}}), iconTransformation(extent={{-8,-110},{12,-90}})));
        PhysiolibraryOld.ConcentrationFlow.PartialPressure
          gasConcToPartialPressure
          annotation (Placement(transformation(extent={{24,2},{36,14}})));
        PhysiolibraryOld.Interfaces.RealInput_ EnvironmentPressure annotation (
            Placement(transformation(
              extent={{-8.571389999999999,-8.571389999999999},{3.42858,3.42859}},
              rotation=0,
              origin={10.5714,10.5714}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=0,
              origin={-80,-20})));
        PhysiolibraryOld.Interfaces.RealInput_ BronchiDilution annotation (
            Placement(transformation(
              extent={{-10.0004,-10.0004},{4.00021,4.00021}},
              rotation=0,
              origin={-78.00020000000001,73.99979999999999}),
              iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=180,
              origin={80,-40})));
      equation
        connect(inspired, dilution.q_concentrated) annotation(Line(points = {{-100, 28}, {-34, 28}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(dilution.q_diluted, solventFlowPump.q_in) annotation(Line(points = {{-14, 28}, {-2, 28}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(solventFlowPump1.q_out, expired) annotation(Line(points = {{64, 28}, {78, 28}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(solventFlowPump.q_out, solventFlowPump1.q_in) annotation(Line(points = {{18, 28}, {44, 28}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(gasConcToPartialPressure.q_in, solventFlowPump.q_out) annotation(Line(points = {{30, 14}, {30, 28}, {18, 28}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(alveolar, gasConcToPartialPressure.outflow) annotation(Line(points = {{30, -4}, {30, 2}}, color = {0, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(EnvironmentPressure, gasConcToPartialPressure.ambientPressure) annotation(Line(points = {{8, 8}, {27.6, 8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(AlveolarVentilation_STPD, solventFlowPump.solventFlow) annotation(Line(points = {{-7, 51}, {8, 51}, {8, 34}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(AlveolarVentilation_STPD, solventFlowPump1.solventFlow) annotation(Line(points = {{-7, 51}, {54, 51}, {54, 34}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(BronchiDilution, dilution.dilution) annotation(Line(points = {{-81.0003, 70.9997}, {-46, 70.9997}, {-46, 40.8}, {-33.2, 40.8}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Polygon(points=  {{-38, 93}, {40, 80}, {-38, 66}, {-38, 93}}, lineColor=  {0, 0, 127}, fillColor=  {255, 255, 255},
                  fillPattern=                                                                                                    FillPattern.Solid), Text(extent=  {{-92, -90}, {84, -60}}, textString=  "%name", lineColor=  {0, 0, 255})}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
      end AlveolarVentilation;

      model AlveolarVentilation_STPD_
        extends PhysiolibraryOld.Icons.Lungs;
        //  parameter Real EnvironmentPressure(final unit="mmHg");
        //  parameter Real EnvironmentTemperature(final unit="degC");
        PhysiolibraryOld.Interfaces.RealInput_ RespRate annotation (Placement(
              transformation(extent={{-20,74},{-6,88}}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=180,
              origin={80,20})));
        PhysiolibraryOld.Interfaces.RealInput_ TidalVolume annotation (
            Placement(transformation(
              extent={{-18,-18},{10,10}},
              rotation=0,
              origin={-50,-32}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=180,
              origin={80,100})));
        PhysiolibraryOld.Interfaces.RealInput_ DeadSpace annotation (Placement(
              transformation(extent={{-68,-76},{-40,-48}}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=180,
              origin={80,60})));
        PhysiolibraryOld.Interfaces.RealInput_ core_T annotation (Placement(
              transformation(
              extent={{-20,-20},{8,8}},
              rotation=0,
              origin={-48,-80}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=180,
              origin={80,-20})));
        GasEquation tidalVolume(V2(start = 400)) annotation(Placement(transformation(extent = {{-12, -54}, {8, -34}})));
        GasEquation deadVolume(V2(start = 150)) annotation(Placement(transformation(extent = {{-12, -80}, {8, -60}})));
        Modelica.Blocks.Math.Product alveolarVentilation_STPD annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 270, origin = {8, 58})));
        VaporPressure vaporPressure annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 180, origin = {12, 96})));
        Modelica.Blocks.Math.Division vaporPart annotation(Placement(transformation(extent = {{-6, -6}, {6, 6}}, rotation = 270, origin = {-38, 54})));
        PhysiolibraryOld.Blocks.Constant Constant0(k=3176.28)
          annotation (Placement(transformation(extent={{-6,38},{2,46}})));
        Modelica.Blocks.Math.Feedback added_pH2O annotation(Placement(transformation(extent = {{-7, -7}, {7, 7}}, rotation = 270, origin = {-35, 83})));
        VaporPressure vaporPressure1 annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 0, origin = {-86, 74})));
        Modelica.Blocks.Math.Product air_pH2O annotation(Placement(transformation(extent = {{-66, 78}, {-56, 88}})));
        PhysiolibraryOld.Interfaces.RealInput_ AmbientTemperature annotation (
            Placement(transformation(
              extent={{-20,-20},{8,8}},
              rotation=0,
              origin={-108,80}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=0,
              origin={-80,100})));
        PhysiolibraryOld.Interfaces.RealInput_ EnvironmentPressure annotation (
            Placement(transformation(
              extent={{-20,-20},{8,8}},
              rotation=0,
              origin={-78,-4}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=0,
              origin={-80,40})));
        PhysiolibraryOld.Interfaces.RealInput_ EnvironmentRelativeHumidity
          annotation (Placement(transformation(
              extent={{-20,-20},{8,8}},
              rotation=0,
              origin={-88,100}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=0,
              origin={-80,-20})));
        PhysiolibraryOld.Blocks.TemperatureConstant STPD_Temperature(k=0)
          annotation (Placement(transformation(
              extent={{-7,-7},{7,7}},
              rotation=180,
              origin={37,-71})));
        PhysiolibraryOld.Blocks.PressureConstant STPD_Pressure(k=760)
          annotation (Placement(transformation(
              extent={{-7,-7},{7,7}},
              rotation=180,
              origin={37,-53})));
        Modelica.Blocks.Math.Feedback alveolarVolume_STPD annotation(Placement(transformation(extent = {{58, -46}, {78, -26}})));
        Modelica.Blocks.Math.Feedback airPressureWitoutVapor annotation(Placement(transformation(extent = {{-64, 0}, {-44, -20}})));
        PhysiolibraryOld.Interfaces.RealOutput_ AlveolarVentilation_STPD
          annotation (Placement(transformation(extent={{24,28},{38,42}}),
              iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=0,
              origin={100,-60})));
        Modelica.Blocks.Math.Feedback dilution annotation(Placement(transformation(extent = {{-30, 20}, {-10, 0}})));
        PhysiolibraryOld.Blocks.Constant Constant(k=1)
          annotation (Placement(transformation(extent={{-48,6},{-40,14}})));
        PhysiolibraryOld.Interfaces.RealOutput_ BronchiDilution annotation (
            Placement(transformation(extent={{6,4},{18,16}}),
              iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=0,
              origin={100,-100})));
      equation
        connect(TidalVolume, tidalVolume.V1) annotation(Line(points = {{-54, -36}, {-10.6, -36}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(DeadSpace, deadVolume.V1) annotation(Line(points = {{-54, -62}, {-10.6, -62}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(RespRate, alveolarVentilation_STPD.u2) annotation(Line(points = {{-13, 81}, {2, 81}, {2, 70}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(core_T, vaporPressure.T) annotation(Line(points = {{-54, -86}, {94, -86}, {94, 96}, {20.6, 96}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(vaporPressure1.VaporPressure, air_pH2O.u2) annotation(Line(points = {{-74.59999999999999, 74}, {-70, 74}, {-70, 80}, {-67, 80}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(air_pH2O.y, added_pH2O.u2) annotation(Line(points = {{-55.5, 83}, {-56, 84}, {-56, 83}, {-40.6, 83}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(added_pH2O.y, vaporPart.u1) annotation(Line(points = {{-35, 76.7}, {-35, 61.2}, {-34.4, 61.2}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(added_pH2O.u1, vaporPressure.VaporPressure) annotation(Line(points = {{-35, 88.59999999999999}, {-35, 96}, {0.6, 96}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(AmbientTemperature, vaporPressure1.T) annotation(Line(points = {{-114, 74}, {-94.59999999999999, 74}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(EnvironmentRelativeHumidity, air_pH2O.u1) annotation(Line(points = {{-94, 94}, {-70, 94}, {-70, 86}, {-67, 86}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(EnvironmentPressure, vaporPart.u2) annotation(Line(points = {{-84, -10}, {-66, -10}, {-66, 64}, {-41.6, 64}, {-41.6, 61.2}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(STPD_Temperature.y, deadVolume.T2) annotation(Line(points = {{29.3, -71}, {21.65, -71}, {21.65, -74}, {6.6, -74}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(STPD_Temperature.y, tidalVolume.T2) annotation(Line(points = {{29.3, -71}, {22, -71}, {22, -48}, {6.6, -48}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(STPD_Pressure.y, tidalVolume.P2) annotation(Line(points = {{29.3, -53}, {17.65, -53}, {17.65, -42}, {6.6, -42}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(STPD_Pressure.y, deadVolume.P2) annotation(Line(points = {{29.3, -53}, {18, -53}, {18, -68}, {6.6, -68}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(core_T, tidalVolume.T1) annotation(Line(points = {{-54, -86}, {-32, -86}, {-32, -48}, {-10.6, -48}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(core_T, deadVolume.T1) annotation(Line(points = {{-54, -86}, {-32, -86}, {-32, -74}, {-10.6, -74}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(alveolarVolume_STPD.y, alveolarVentilation_STPD.u1) annotation(Line(points = {{77, -36}, {84, -36}, {84, 82}, {14, 82}, {14, 70}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(tidalVolume.V2, alveolarVolume_STPD.u1) annotation(Line(points = {{6.6, -36}, {60, -36}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(alveolarVolume_STPD.u2, deadVolume.V2) annotation(Line(points = {{68, -44}, {68, -62}, {6.6, -62}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(EnvironmentPressure, airPressureWitoutVapor.u1) annotation(Line(points = {{-84, -10}, {-80, -10}, {-80, -12}, {-74, -12}, {-74, -10}, {-62, -10}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(airPressureWitoutVapor.y, tidalVolume.P1) annotation(Line(points = {{-45, -10}, {-28, -10}, {-28, -42}, {-10.6, -42}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(airPressureWitoutVapor.y, deadVolume.P1) annotation(Line(points = {{-45, -10}, {-28, -10}, {-28, -68}, {-10.6, -68}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(added_pH2O.y, airPressureWitoutVapor.u2) annotation(Line(points = {{-35, 76.7}, {-35, 68}, {-54, 68}, {-54, -2}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(AlveolarVentilation_STPD, alveolarVentilation_STPD.y) annotation(Line(points = {{31, 35}, {10, 46}, {8, 47}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Constant.y, dilution.u1) annotation(Line(points = {{-39.6, 10}, {-28, 10}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(vaporPart.y, dilution.u2) annotation(Line(points = {{-38, 47.4}, {-38, 30}, {-20, 30}, {-20, 18}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(dilution.y, BronchiDilution) annotation(Line(points = {{-11, 10}, {12, 10}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Text(extent=  {{-100, -100}, {76, -70}}, textString=  "%name", lineColor=  {0, 0, 255})}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
      end AlveolarVentilation_STPD_;

      model Ventilation
        extends PhysiolibraryOld.Icons.Ventilation;
        PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
            Placement(transformation(extent={{66,-30},{86,-10}}),
              iconTransformation(extent={{80,40},{120,80}})));
        AlveolarVentilation_STPD_ alveolarVentilation annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 0, origin = {-32, -38})));
        NaturalVentilation2 naturalVentilation annotation(Placement(transformation(extent = {{46, 2}, {26, 22}})));
        Modelica.Blocks.Math.Product TotalVentilation annotation(Placement(transformation(extent = {{42, 24}, {48, 30}})));
        RespiratoryNeuralDrive3 respiratoryNeuralDrive2_1 annotation(Placement(transformation(extent = {{-56, 38}, {-22, 72}})));
      equation
        connect(alveolarVentilation.TidalVolume, naturalVentilation.TidalVolume) annotation(Line(points = {{-24, -28}, {2, -28}, {2, 14}, {24.6, 14}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(alveolarVentilation.DeadSpace, naturalVentilation.DeadSpace) annotation(Line(points = {{-24, -32}, {6.3, -32}, {6.3, 8}, {24.6, 8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(naturalVentilation.ExcessLungWater_Volume, busConnector.ExcessLungWater_Volume) annotation(Line(points = {{44.6, 4}, {76, 4}, {76, -20}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(naturalVentilation.Thorax_LungInflation, busConnector.Thorax_LungInflation) annotation(Line(points = {{44.6, 8}, {76, 8}, {76, -20}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(naturalVentilation.RespiratoryMuscleFunctionEffect, busConnector.RespiratoryMuscleFunctionEffect) annotation(Line(points = {{44.6, 16}, {76, 16}, {76, -20}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(naturalVentilation.RespiratoryCenterOutput_MotorNerveActivity, busConnector.RespiratoryCenter_MotorNerveActivity) annotation(Line(points = {{44.6, 20}, {76, 20}, {76, -20}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(alveolarVentilation.core_T, busConnector.core_T) annotation(Line(points = {{-24, -40}, {18, -40}, {18, -20}, {76, -20}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(naturalVentilation.TidalVolume, TotalVentilation.u2) annotation(Line(points = {{24.6, 14}, {4, 14}, {4, 26}, {41.4, 26}, {41.4, 25.2}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.RespiratoryCenter_RespRate, TotalVentilation.u1) annotation(Line(points = {{76, -20}, {76, 44}, {24, 44}, {24, 28.8}, {41.4, 28.8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(TotalVentilation.y, busConnector.BreathingTotalVentilation) annotation(Line(points = {{48.3, 27}, {76, 27}, {76, -20}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(alveolarVentilation.RespRate, busConnector.RespiratoryCenter_RespRate) annotation(Line(points = {{-24, -36}, {18, -36}, {18, -20}, {76, -20}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(busConnector.BarometerPressure, alveolarVentilation.EnvironmentPressure) annotation(Line(points = {{76, -20}, {-72, -20}, {-72, -34}, {-40, -34}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.AmbientTemperature, alveolarVentilation.AmbientTemperature) annotation(Line(points = {{76, -20}, {-72, -20}, {-72, -28}, {-40, -28}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.EnvironmentRelativeHumidity, alveolarVentilation.EnvironmentRelativeHumidity) annotation(Line(points = {{76, -20}, {-72, -20}, {-72, -40}, {-40, -40}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(alveolarVentilation.AlveolarVentilation_STPD, busConnector.AlveolarVentilation_STPD) annotation(Line(points = {{-22, -44}, {76, -44}, {76, -20}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(respiratoryNeuralDrive2_1.busConnector, busConnector) annotation(Line(points = {{-52.6, 68.59999999999999}, {76, 68.59999999999999}, {76, -20}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(alveolarVentilation.BronchiDilution, busConnector.BronchiDilution) annotation(Line(points = {{-22, -48}, {76, -48}, {76, -20}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Text(extent=  {{-120, -108}, {130, -126}}, lineColor=  {0, 0, 255}, textString=  "%name")}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
      end Ventilation;

      model SkeletalMuscleMetaboreflex
        extends PhysiolibraryOld.Icons.SkeletalMuscleAcidity;
        PhysiolibraryOld.Interfaces.RealInput_ skeletalMuscle_pH annotation (
            Placement(transformation(extent={{-120,-20},{-80,20}}),
              iconTransformation(extent={{-110,-10},{-90,10}})));
        PhysiolibraryOld.Curves.Curve NerveActivity(
          x=PhOnNerveActivity[:, 1],
          y=PhOnNerveActivity[:, 2],
          slope=PhOnNerveActivity[:, 3])
          annotation (Placement(transformation(extent={{-10,-18},{26,18}})));
        PhysiolibraryOld.Interfaces.RealOutput_ NA
          annotation (Placement(transformation(extent={{80,-20},{120,20}})));
        parameter Real PhOnNerveActivity[:, 3] = {{6.5, 5.0, 0}, {6.9, 0.0, 0}};
      equation
        connect(NerveActivity.val, NA) annotation(Line(points = {{26.36, 0}, {100, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(skeletalMuscle_pH, NerveActivity.u) annotation(Line(points = {{-100, 0}, {-10, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Text(extent=  {{-128, -106}, {120, -132}}, lineColor=  {0, 0, 255}, textString=  "%name")}));
      end SkeletalMuscleMetaboreflex;
    end RespiratoryRegulations;

    model Gases
      extends PhysiolibraryOld.Icons.Gases;
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{38,-4},{58,16}}),
            iconTransformation(extent={{60,60},{100,100}})));
      O2.O2 oxygen annotation(Placement(transformation(extent = {{-62, -24}, {-42, -4}})));
      CO2.CO2 carbonDioxyd annotation(Placement(transformation(extent = {{-22, -22}, {-2, -2}})));
      AcidBase.AcidBase3 acidBase annotation(Placement(transformation(extent = {{20, -18}, {40, 2}})));
      RespiratoryRegulations.Ventilation ventilation annotation(Placement(transformation(extent = {{-50, 28}, {-30, 48}})));
    equation
      connect(carbonDioxyd.busConnector, busConnector) annotation(Line(points = {{-4, -6}, {-4, 6}, {48, 6}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(oxygen.busConnector, busConnector) annotation(Line(points = {{-44, -6}, {-44, 6}, {48, 6}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(acidBase.busConnector, busConnector) annotation(Line(points = {{30, -7.8}, {30, 6}, {48, 6}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(ventilation.busConnector, busConnector) annotation(Line(points = {{-30, 44}, {-28, 44}, {-28, 6}, {48, 6}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent = {{-122, -106}, {126, -132}}, lineColor = {0, 0, 255}, textString = "%name"), Text(extent = {{-82, 24}, {-8, 58}}, lineColor = {0, 0, 0}, textString = "CO2"), Text(extent = {{6, -64}, {80, -30}}, lineColor = {0, 0, 0}, textString = "O2"), Text(extent = {{-104, -70}, {-30, -36}}, lineColor = {255, 255, 255}, textString = "pH")}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
    end Gases;
    annotation(Documentation(revisions = "<html>
                   <table cellspacing=\"2\" cellpadding=\"0\" border=\"0\"><tr>
                   <td><p>Author:</p></td>
                   <td><p>Marek Matejak</p></td>
                   </tr>
                   <tr>
                   <td><p>Copyright:</p></td>
                   <td><p>In public domains</p></td>
                   </tr>
                   <tr>
                   <td><p>By:</p></td>
                   <td><p>Charles University, Prague</p></td>
                   </tr>
                   <tr>
                   <td><p>Date of:</p></td>
                   <td><p>2009-2013</p></td>
                   </tr>
                   <tr>
                   <td><p>References:</p></td>
                   <td><p>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</p></td>
                   </tr>
                   <tr>
                   <td></td>
                   <td><p><br/><br/>Siggaard Andersen: OSA (2005), University of Copenhagen</p></td>
                   </tr>
                   </table>
                   </html>"), Icon(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics));
  end Gases;

  package Heat "Body Temperature Balance"
    extends PhysiolibraryOld.Icons.HeatLib;
    model TissuesHeat
      extends PhysiolibraryOld.Icons.Tissues;
      tissues.Bone Bone annotation(Placement(transformation(extent = {{64, 30}, {44, 50}})));
      tissues.Fat Fat annotation(Placement(transformation(extent = {{64, -62}, {44, -42}})));
      tissues.Brain Brain annotation(Placement(transformation(extent = {{-58, -2}, {-38, 18}})));
      tissues.RightHeart RightHeart annotation(Placement(transformation(extent = {{-58, 30}, {-38, 50}})));
      tissues.RespiratoryMuscle RespiratoryMuscle annotation(Placement(transformation(extent = {{-58, -30}, {-38, -10}})));
      tissues.OtherTissue OtherTissue annotation(Placement(transformation(extent = {{64, -88}, {44, -68}})));
      tissues.Liver Liver annotation(Placement(transformation(extent = {{64, 58}, {44, 78}})));
      tissues.LeftHeart LeftHeart annotation(Placement(transformation(extent = {{-58, -62}, {-38, -42}})));
      tissues.Kidney Kidney annotation(Placement(transformation(extent = {{64, -32}, {44, -12}})));
      tissues.GITract GITract annotation(Placement(transformation(extent = {{64, -2}, {44, 18}})));
      PhysiolibraryOld.Interfaces.BusConnector busConnector
        annotation (Placement(transformation(extent={{-108,72},{-68,112}})));
    equation
      connect(busConnector.core_T, Brain.BaseT) annotation(Line(points = {{-88, 92}, {-62, 92}, {-62, 8}, {-58, 8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
      connect(busConnector.core_T, RespiratoryMuscle.BaseT) annotation(Line(points = {{-88, 92}, {-62, 92}, {-62, -20}, {-58, -20}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
      connect(busConnector.core_T, LeftHeart.BaseT) annotation(Line(points = {{-88, 92}, {-62, 92}, {-62, -52}, {-58, -52}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
      connect(busConnector.core_T, RightHeart.BaseT) annotation(Line(points = {{-88, 92}, {-62, 92}, {-62, 40}, {-58, 40}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
      connect(Bone.BaseT, busConnector.core_T) annotation(Line(points = {{64, 40}, {68, 40}, {68, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
      connect(Liver.BaseT, busConnector.core_T) annotation(Line(points = {{64, 68}, {68, 68}, {68, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
      connect(Kidney.BaseT, busConnector.core_T) annotation(Line(points = {{64, -22}, {68, -22}, {68, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
      connect(GITract.BaseT, busConnector.core_T) annotation(Line(points = {{64, 8}, {68, 8}, {68, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
      connect(Fat.BaseT, busConnector.core_T) annotation(Line(points = {{64, -52}, {68, -52}, {68, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
      connect(OtherTissue.BaseT, busConnector.core_T) annotation(Line(points = {{64, -78}, {68, -78}, {68, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
      connect(RightHeart.T, busConnector.rightHeart_T) annotation(Line(points = {{-38, 40}, {-34, 40}, {-34, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(Brain.T, busConnector.brain_T) annotation(Line(points = {{-38, 8}, {-34, 8}, {-34, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(RespiratoryMuscle.T, busConnector.respiratoryMuscle_T) annotation(Line(points = {{-38, -20}, {-34, -20}, {-34, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(LeftHeart.T, busConnector.leftHeart_T) annotation(Line(points = {{-38, -52}, {-34, -52}, {-34, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(busConnector.liver_T, Liver.T) annotation(Line(points = {{-88, 92}, {40, 92}, {40, 68}, {44, 68}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.bone_T, Bone.T) annotation(Line(points = {{-88, 92}, {40, 92}, {40, 40}, {44, 40}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.GITract_T, GITract.T) annotation(Line(points = {{-88, 92}, {40, 92}, {40, 8}, {44, 8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.kidney_T, Kidney.T) annotation(Line(points = {{-88, 92}, {40, 92}, {40, -22}, {44, -22}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.fat_T, Fat.T) annotation(Line(points = {{-88, 92}, {40, 92}, {40, -52}, {44, -52}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.otherTissue_T, OtherTissue.T) annotation(Line(points = {{-88, 92}, {40, 92}, {40, -78}, {44, -78}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Documentation(info = "<html>
                   <p>Heat in tissues. Temperatures are in celsius degrees.</p>
                   </html>", revisions = "<html>
                   <p>Marek Matejak, 24.12.2009</p>
                   </html>"));
    end TissuesHeat;

    package tissues
      model TissueTemperature
        PhysiolibraryOld.Interfaces.RealInput_ BaseT(unit="degC")
          annotation (Placement(transformation(extent={{-120,-20},{-80,20}})));
        PhysiolibraryOld.Interfaces.RealOutput_ T(unit="degC")
          annotation (Placement(transformation(extent={{80,-20},{120,20}})));
      equation
        T = BaseT;
        annotation(Diagram(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Text(extent=  {{-148, -98}, {100, -124}}, lineColor=  {0, 0, 255}, textString=  "%name"), Rectangle(extent=  {{-100, 100}, {100, -100}}, lineColor=  {0, 0, 255})}));
      end TissueTemperature;

      model RightHeart
        extends TissueTemperature;
        extends PhysiolibraryOld.Icons.RightHeart;
      end RightHeart;

      model Brain
        extends TissueTemperature;
        extends PhysiolibraryOld.Icons.Brain;
      end Brain;

      model RespiratoryMuscle
        extends TissueTemperature;
        extends PhysiolibraryOld.Icons.RespiratoryMuscle;
      end RespiratoryMuscle;

      model LeftHeart
        extends TissueTemperature;
        extends PhysiolibraryOld.Icons.LeftHeart;
      end LeftHeart;

      model Liver
        extends TissueTemperature;
        extends PhysiolibraryOld.Icons.Liver;
      end Liver;

      model Bone
        extends TissueTemperature;
        extends PhysiolibraryOld.Icons.Bone;
      end Bone;

      model GITract
        extends TissueTemperature;
        extends PhysiolibraryOld.Icons.GITract;
      end GITract;

      model Kidney
        extends TissueTemperature;
        extends PhysiolibraryOld.Icons.Kidney;
      end Kidney;

      model Fat
        extends TissueTemperature;
        extends PhysiolibraryOld.Icons.Fat;
      end Fat;

      model OtherTissue
        extends TissueTemperature;
        extends PhysiolibraryOld.Icons.OtherTissue;
      end OtherTissue;
    end tissues;

    model BladderHeat
      extends PhysiolibraryOld.Icons.Bladder;
      PhysiolibraryOld.HeatFlow.HeatAccumulation Bladder(
        STEADY=false,
        stateName="BladderTemperature.Mass",
        initialHeatMass=0.2*37)
        annotation (Placement(transformation(extent={{6,-80},{26,-60}})));
      //    initialTemperature(displayUnit="degC"),
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{-72,-44},{-52,-24}}),
            iconTransformation(extent={{-104,86},{-84,106}})));
      PhysiolibraryOld.HeatFlow.OutputPump bladderVoid(specificHeat=0.001)
        annotation (Placement(transformation(extent={{54,-72},{66,-60}})));
      PhysiolibraryOld.HeatFlow.PositiveHeatFlow positiveHeatFlow annotation (
          Placement(transformation(extent={{-6,26},{14,46}}),
            iconTransformation(extent={{-6,66},{14,86}})));
    equation
      connect(busConnector.BladderVolume_Mass, Bladder.weight) annotation(Line(points = {{-62, -34}, {-62, -62}, {6, -62}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.BladderVoidFlow, bladderVoid.desiredFlow) annotation(Line(points = {{-62, -34}, {60, -34}, {60, -63.6}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(Bladder.q_in, bladderVoid.q_in) annotation(Line(points = {{16, -70}, {36, -70}, {36, -66}, {56.4, -66}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
      connect(positiveHeatFlow, Bladder.q_in) annotation(Line(points = {{4, 36}, {16, 36}, {16, -70}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics));
    end BladderHeat;

    model GILumenHeat
      extends PhysiolibraryOld.Icons.GILumen;
      PhysiolibraryOld.HeatFlow.HeatAccumulation GILumen(
        specificHeat=1,
        stateName="GILumenTemperature.Mass",
        initialHeatMass=308.09)
        annotation (Placement(transformation(extent={{-50,-82},{-30,-62}})));
      //  initialTemperature(displayUnit="degC") = 310,
      PhysiolibraryOld.HeatFlow.ResistorWithCondParam resistorWithCondParam(
          cond=0.01) annotation (Placement(transformation(
            extent={{-10,-10},{10,10}},
            rotation=90,
            origin={-40,-52})));
      PhysiolibraryOld.HeatFlow.InputPump Intake
        annotation (Placement(transformation(extent={{-84,-90},{-64,-70}})));
      Modelica.Blocks.Math.Gain SpecificHeat(k = 0.001) annotation(Placement(transformation(extent = {{-4, -4}, {4, 4}}, rotation = 270, origin = {-74, -68})));
      Modelica.Blocks.Math.Product tempTOgramIntake annotation(Placement(transformation(extent = {{-78, -56}, {-70, -48}})));
      Modelica.Blocks.Math.Gain mlTOkg(k = 0.001) annotation(Placement(transformation(extent = {{-64, -46}, {-56, -38}})));
      PhysiolibraryOld.HeatFlow.Pump Convection(specificHeat=0.001) annotation (
         Placement(transformation(
            extent={{-10,10},{10,-10}},
            rotation=90,
            origin={-26,-48})));
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{-100,-10},{-80,10}}),
            iconTransformation(extent={{-104,86},{-84,106}})));
      PhysiolibraryOld.HeatFlow.NegativeHeatFlow q_out annotation (Placement(
            transformation(extent={{-46,0},{-6,40}}), iconTransformation(extent=
               {{-10,-10},{10,10}})));
    equation
      connect(GILumen.q_in, resistorWithCondParam.q_in) annotation(Line(points = {{-40, -72}, {-40, -62}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
      connect(Intake.q_out, GILumen.q_in) annotation(Line(points = {{-68, -80}, {-56, -80}, {-56, -72}, {-40, -72}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
      connect(SpecificHeat.y, Intake.desiredFlow) annotation(Line(points = {{-74, -72.40000000000001}, {-74, -76}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(SpecificHeat.u, tempTOgramIntake.y) annotation(Line(points = {{-74, -63.2}, {-74, -58}, {-68, -58}, {-68, -52}, {-69.59999999999999, -52}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.DietGoalH2O_DegK, tempTOgramIntake.u1) annotation(Line(points = {{-90, 0}, {-90, -49.6}, {-78.8, -49.6}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.GILumenVolume_Intake, tempTOgramIntake.u2) annotation(Line(points = {{-90, 0}, {-90, -54.4}, {-78.8, -54.4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(mlTOkg.y, GILumen.weight) annotation(Line(points = {{-55.6, -42}, {-54, -42}, {-54, -64}, {-50, -64}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.GILumenVolume_Mass, mlTOkg.u) annotation(Line(points = {{-90, 0}, {-90, -42}, {-64.8, -42}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(Convection.desiredFlow, busConnector.GILumenVolume_Absorption) annotation(Line(points = {{-22, -48}, {-10, -48}, {-10, -88}, {-90, -88}, {-90, 0}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(GILumen.q_in, Convection.q_in) annotation(Line(points = {{-40, -72}, {-26, -72}, {-26, -54}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
      connect(Convection.q_out, q_out) annotation(Line(points = {{-26, -42}, {-26, 20}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
      connect(resistorWithCondParam.q_out, q_out) annotation(Line(points = {{-40, -42}, {-40, 20}, {-26, 20}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics));
    end GILumenHeat;

    model MuscleHeat
      extends PhysiolibraryOld.Icons.SkeletalMuscle;
      PhysiolibraryOld.HeatFlow.HeatAccumulation skeletalMuscle(
        specificHeat=0.83,
        stateName="HeatSkeletalMuscle.Mass",
        initialHeatMass=7064.94,
        q_in(T(start=310.666)))
        annotation (Placement(transformation(extent={{-8,-8},{12,12}})));
      // initialTemperature=310.166,
      PhysiolibraryOld.HeatFlow.HeatFlux muscleFlux(specificHeat=0.92)
        annotation (Placement(transformation(extent={{20,-8},{40,12}})));
      Modelica.Blocks.Math.Gain ML2KG1(k = 0.001) annotation(Placement(transformation(extent = {{-4, -4}, {4, 4}}, rotation = 270, origin = {30, 18})));
      PhysiolibraryOld.HeatFlow.InputPump Metabolism2
        annotation (Placement(transformation(extent={{-32,-8},{-12,12}})));
      Modelica.Blocks.Math.Gain gain2(k = 0.001) annotation(Placement(transformation(extent = {{-34, 20}, {-26, 28}})));
      Modelica.Blocks.Math.Gain gTOkg1(k = 0.001) annotation(Placement(transformation(extent = {{-40, 6}, {-32, 14}})));
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{-104,36},{-84,56}}),
            iconTransformation(extent={{-104,86},{-84,106}})));
      PhysiolibraryOld.HeatFlow.NegativeHeatFlow q_out annotation (Placement(
            transformation(extent={{10,-70},{50,-30}}), iconTransformation(
              extent={{-10,-10},{10,10}})));
      PhysiolibraryOld.Interfaces.RealInput_
        HypothalamusShivering_NerveActivity annotation (Placement(
            transformation(extent={{-74,56},{-64,66}}), iconTransformation(
              extent={{-100,110},{-80,130}})));
      PhysiolibraryOld.Factors.CurveValue HeatShivering(data={{0.0,0.0,0},{4.0,
            70.0,0}})
        annotation (Placement(transformation(extent={{-40,60},{-20,80}})));
      Modelica.Blocks.Math.Add heat annotation(Placement(transformation(extent = {{-6, 50}, {6, 62}})));
    equation
      connect(ML2KG1.y, muscleFlux.substanceFlow) annotation(Line(points = {{30, 13.6}, {30, 8}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(skeletalMuscle.q_in, muscleFlux.q_in) annotation(Line(points = {{2, 2}, {20, 2}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
      connect(busConnector.skeletalMuscle_BloodFlow, ML2KG1.u) annotation(Line(points = {{-94, 46}, {30, 46}, {30, 22.8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(Metabolism2.q_out, skeletalMuscle.q_in) annotation(Line(points = {{-16, 2}, {2, 2}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
      connect(busConnector.skeletalMuscle_T, skeletalMuscle.T) annotation(Line(points = {{-94, 46}, {-94, -14}, {2, -14}, {2, -8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, -3}, {-6, -3}}));
      connect(gain2.y, Metabolism2.desiredFlow) annotation(Line(points = {{-25.6, 24}, {-22, 24}, {-22, 6}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.skeletalMuscle_SizeMass, gTOkg1.u) annotation(Line(points = {{-94, 46}, {-94, 10}, {-40.8, 10}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(gTOkg1.y, skeletalMuscle.weight) annotation(Line(points = {{-31.6, 10}, {-8, 10}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(muscleFlux.q_out, q_out) annotation(Line(points = {{30, -3}, {30, -3}, {30, -50}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
      connect(HeatShivering.u, HypothalamusShivering_NerveActivity) annotation(Line(points = {{-39.8, 70}, {-50, 70}, {-50, 61}, {-69, 61}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(HeatShivering.y, busConnector.skeletalMuscle_shiveringCals) annotation(Line(points = {{-30, 68}, {-30, 46}, {-94, 46}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(heat.y, gain2.u) annotation(Line(points = {{6.6, 56}, {10, 56}, {10, 36}, {-38, 36}, {-38, 24}, {-34.8, 24}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(HeatShivering.y, heat.u1) annotation(Line(points = {{-30, 68}, {-30, 59.6}, {-7.2, 59.6}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.skeletalMuscle_HeatWithoutTermoregulation, heat.u2) annotation(Line(points = {{-94, 46}, {-52, 46}, {-52, 52.4}, {-7.2, 52.4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.SkeletalMuscle_StructureEffect, HeatShivering.yBase) annotation(Line(points = {{-94, 46}, {-94, 94}, {-30, 94}, {-30, 72}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics));
    end MuscleHeat;

    model SkinHeat2
      extends PhysiolibraryOld.Icons.Skin;
      Modelica.Blocks.Math.Gain gTOkg3(k = 0.001) annotation(Placement(transformation(extent = {{-62, -58}, {-54, -50}})));
      Modelica.Blocks.Math.Gain gain(k = 0.001) annotation(Placement(transformation(extent = {{-4, -50}, {4, -42}})));
      PhysiolibraryOld.HeatFlow.InputPump Metabolism1
        annotation (Placement(transformation(extent={{0,-72},{20,-52}})));
      PhysiolibraryOld.HeatFlow.HeatAccumulation skin(
        specificHeat=0.83,
        stateName="HeatSkin.Mass",
        initialHeatMass=564.432)
        annotation (Placement(transformation(extent={{30,-72},{50,-52}})));
      //initialTemperature=300.731,
      PhysiolibraryOld.HeatFlow.HeatFlux skinFlux(specificHeat=0.92)
        annotation (Placement(transformation(extent={{30,-38},{50,-18}})));
      Modelica.Blocks.Math.Gain ML2KG(k = 0.001) annotation(Placement(transformation(extent = {{-4, -4}, {4, 4}}, rotation = 270, origin = {40, -14})));
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{-82,34},{-62,54}}),
            iconTransformation(extent={{-90,-30},{-70,-10}})));
      PhysiolibraryOld.HeatFlow.PositiveHeatFlow positiveHeatFlow annotation (
          Placement(transformation(extent={{2,-32},{10,-24}}),
            iconTransformation(extent={{-32,-70},{-12,-50}})));
      PhysiolibraryOld.HeatFlow.NegativeHeatFlow q_out annotation (Placement(
            transformation(extent={{72,-82},{112,-42}}), iconTransformation(
              extent={{-30,8},{-10,28}})));
      Modelica.Blocks.Math.Feedback pressureGradient annotation(Placement(transformation(extent = {{-46, -24}, {-26, -4}})));
      Modelica.Blocks.Math.Product bloodFlow annotation(Placement(transformation(extent = {{10, 2}, {30, -18}})));
      PhysiolibraryOld.Factors.SimpleMultiply TermoregulationEffect
        annotation (Placement(transformation(extent={{72,0},{96,24}})));
      PhysiolibraryOld.Interfaces.RealInput_
        HypothalamusSkinFlow_NervesActivity annotation (Placement(
            transformation(extent={{-68,10},{-48,30}}), iconTransformation(
              extent={{-100,-80},{-60,-40}})));
      PhysiolibraryOld.Interfaces.RealOutput_ skin_T annotation (Placement(
            transformation(extent={{38,-94},{58,-74}}), iconTransformation(
              extent={{40,-40},{80,0}})));
      PhysiolibraryOld.Curves.Curve SympsDilateEffect(
        x={0.0,1.0,4.0},
        y={0.3,1.0,8.0},
        slope={0,2.2,0})
        annotation (Placement(transformation(extent={{-32,10},{-12,30}})));
      PhysiolibraryOld.Factors.CurveValue LocalTempVsNA(data={{1.2,1.0,0},{1.5,
            0.0,0}})
        annotation (Placement(transformation(extent={{-20,76},{0,96}})));
      Nerves.AplhaReceptorsActivityFactor AplhaReceptors_Skin(data = {{0.0, 0.3, 0}, {1.0, 0.0, -0.3}, {5.0, -0.9, 0}}) annotation(Placement(transformation(extent = {{-34, 50}, {-14, 70}})));
      PhysiolibraryOld.Factors.CurveValue LocalTempEffect(data={{10.8,-0.8,0},{
            29.0,0.0,0.1},{45.0,4.0,0}})
        annotation (Placement(transformation(extent={{-18,62},{2,82}})));
      PhysiolibraryOld.Blocks.Constant Skin_BasicConductance_1(k=1)
        annotation (Placement(transformation(extent={{-4,94},{-8,90}})));
      PhysiolibraryOld.Blocks.Add add(k=1)
        annotation (Placement(transformation(extent={{32,50},{40,58}})));
      PhysiolibraryOld.Blocks.Add add1(k=1)
        annotation (Placement(transformation(extent={{32,38},{40,46}})));
      PhysiolibraryOld.Factors.SimpleMultiply SympsEffect_Skin
        annotation (Placement(transformation(extent={{74,38},{94,58}})));
      PhysiolibraryOld.Factors.SimpleMultiply LocalTempEffect_Skin
        annotation (Placement(transformation(extent={{74,46},{94,66}})));
    equation
      connect(busConnector.skinSizeMass, gTOkg3.u) annotation(Line(points = {{-72, 44}, {-72, -54}, {-62.8, -54}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(gTOkg3.y, skin.weight) annotation(Line(points = {{-53.6, -54}, {30, -54}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.MetabolismCaloriesUsed_SkinHeat, gain.u) annotation(Line(points = {{-72, 44}, {-72, -46}, {-4.8, -46}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(gain.y, Metabolism1.desiredFlow) annotation(Line(points = {{4.4, -46}, {10, -46}, {10, -58}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Metabolism1.q_out, skin.q_in) annotation(Line(points = {{16, -62}, {40, -62}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
      connect(skinFlux.q_out, skin.q_in) annotation(Line(points = {{40, -33}, {40, -62}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
      connect(ML2KG.y, skinFlux.substanceFlow) annotation(Line(points = {{40, -18.4}, {40, -22}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(skinFlux.q_in, positiveHeatFlow) annotation(Line(points = {{30, -28}, {6, -28}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
      connect(skin.q_in, q_out) annotation(Line(points = {{40, -62}, {92, -62}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
      connect(skin.T, busConnector.skin_T) annotation(Line(points = {{40, -72}, {40, -96}, {-72, -96}, {-72, 44}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(busConnector.SystemicArtys_Pressure, pressureGradient.u1) annotation(Line(points = {{-72, 44}, {-74, 44}, {-74, -14}, {-44, -14}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.SystemicVeins_Pressure, pressureGradient.u2) annotation(Line(points = {{-72, 44}, {-74, 44}, {-74, -22}, {-36, -22}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(pressureGradient.y, bloodFlow.u1) annotation(Line(points = {{-27, -14}, {8, -14}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(bloodFlow.y, ML2KG.u) annotation(Line(points = {{31, -8}, {40, -8}, {40, -9.199999999999999}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(TermoregulationEffect.y, bloodFlow.u2) annotation(Line(points = {{84, 9.6}, {8, 9.6}, {8, -2}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(skin.T, skin_T) annotation(Line(points = {{40, -72}, {40, -84}, {48, -84}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(SympsDilateEffect.val, busConnector.skinFlow_termoregulationEffect) annotation(Line(points = {{-11.8, 20}, {0, 20}, {0, 0}, {-72, 0}, {-72, 44}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(HypothalamusSkinFlow_NervesActivity, SympsDilateEffect.u) annotation(Line(points = {{-58, 20}, {-32, 20}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(SympsDilateEffect.val, TermoregulationEffect.u) annotation(Line(points = {{-11.8, 20}, {0, 20}, {0, 12}, {72.23999999999999, 12}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(LocalTempVsNA.yBase, Skin_BasicConductance_1.y) annotation(Line(points = {{-10, 88}, {-10, 92}, {-8.199999999999999, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(LocalTempEffect.yBase, LocalTempVsNA.y) annotation(Line(points = {{-8, 74}, {-8, 80}, {-10, 80}, {-10, 84}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.skin_T, LocalTempEffect.u) annotation(Line(points = {{-72, 44}, {-72, 72}, {-17.8, 72}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.AlphaPool_Effect, AplhaReceptors_Skin.AlphaPool_Effect) annotation(Line(points = {{-72, 44}, {-72, 66}, {-33.8, 66}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.AlphaBlocade_Effect, AplhaReceptors_Skin.AlphaBlockade_Effect) annotation(Line(points = {{-72, 44}, {-72, 60}, {-33.8, 60}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.GangliaGeneral_NA, AplhaReceptors_Skin.GangliaGeneral_NA) annotation(Line(points = {{-72, 44}, {-72, 54}, {-33.8, 54}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(AplhaReceptors_Skin.yBase, LocalTempVsNA.y) annotation(Line(points = {{-24, 67}, {-24, 80}, {-10, 80}, {-10, 84}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(LocalTempEffect.y, add.u) annotation(Line(points = {{-8, 70}, {-8, 54}, {31.2, 54}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(add1.u, AplhaReceptors_Skin.y) annotation(Line(points = {{31.2, 42}, {-24, 42}, {-24, 53}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(SympsEffect_Skin.u, add1.y) annotation(Line(points = {{74.2, 48}, {56, 48}, {56, 42}, {40.4, 42}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(add.y, LocalTempEffect_Skin.u) annotation(Line(points = {{40.4, 54}, {58, 54}, {58, 56}, {74.2, 56}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.skin_conductanceWithoutTermoregulationEffect, LocalTempEffect_Skin.yBase) annotation(Line(points = {{-72, 44}, {-72, 96}, {84, 96}, {84, 58}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(LocalTempEffect_Skin.y, SympsEffect_Skin.yBase) annotation(Line(points = {{84, 54}, {84, 50}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(SympsEffect_Skin.y, TermoregulationEffect.yBase) annotation(Line(points = {{84, 46}, {84, 14.4}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(HypothalamusSkinFlow_NervesActivity, LocalTempVsNA.u) annotation(Line(points = {{-58, 20}, {-42, 20}, {-42, 86}, {-19.8, 86}}, color = {0, 0, 127}, smooth = Smooth.None));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
    end SkinHeat2;

    model Heat2
      extends PhysiolibraryOld.Icons.Heat;
      //      initialTemperature(displayUnit="degC") = 310.15,
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{-104,86},{-84,106}}),
            iconTransformation(extent={{-104,86},{-84,106}})));
      PhysiolibraryOld.HeatFlow.HeatOutflow HeatInsensibleSkin(
        TempToolsVapor=580.0,
        specificHeat=1,
        q_in(T(start=303.824)))
        annotation (Placement(transformation(extent={{62,-12},{82,8}})));
      PhysiolibraryOld.Blocks.MassFlowConstant_kg massFlowConstant(k=0.00037)
        annotation (Placement(transformation(extent={{54,2},{68,16}})));
      PhysiolibraryOld.HeatFlow.ResistorWithCond conduction
        annotation (Placement(transformation(extent={{74,-60},{94,-40}})));
      PhysiolibraryOld.Factors.CurveValue WindEffect(data={{0.0,1.0,0},{20.0,
            4.0,0}})
        annotation (Placement(transformation(extent={{94,-50},{74,-30}})));
      PhysiolibraryOld.Factors.CurveValue BloodFlowEffect(data={{0,0.8,0},{250,
            1.0,0.001},{8000,8.0,0}})
        annotation (Placement(transformation(extent={{94,-42},{74,-22}})));
      PhysiolibraryOld.Factors.CurveValue ClothesEffect(data={{0.0,4.0,0},{2.0,
            1.0,-1.2},{4.0,0.2,0}})
        annotation (Placement(transformation(extent={{74,-34},{94,-14}})));
      PhysiolibraryOld.Blocks.Constant Constant(k=0.034)
        annotation (Placement(transformation(extent={{74,-20},{82,-12}})));
      PhysiolibraryOld.Blocks.Constant Constant1(k=2)
        annotation (Placement(transformation(extent={{58,-28},{66,-20}})));
      PhysiolibraryOld.HeatFlow.AmbientTemperature ambientTemperature
        annotation (Placement(transformation(extent={{56,-88},{76,-68}})));
      PhysiolibraryOld.HeatFlow.ResistorWithCond radiation
        annotation (Placement(transformation(extent={{26,-88},{46,-68}})));
      PhysiolibraryOld.Factors.CurveValue ClothesEffect1(data={{0.0,4.0,0},{2.0,
            1.0,-1.2},{4.0,0.2,0}})
        annotation (Placement(transformation(extent={{26,-78},{46,-58}})));
      PhysiolibraryOld.Blocks.Constant Constant3(k=0.068)
        annotation (Placement(transformation(extent={{24,-62},{32,-54}})));
      TissuesHeat otherTissuesHeat annotation(Placement(transformation(extent = {{-86, -76}, {-64, -54}})));
      PhysiolibraryOld.HeatFlow.Pump toUrine(specificHeat=0.001, q_in(T(start=
                310.16))) annotation (Placement(transformation(
            extent={{-10,10},{10,-10}},
            rotation=270,
            origin={2,-40})));
      BladderHeat bladderHeat annotation(Placement(transformation(extent = {{-8, -78}, {12, -58}})));
      GILumenHeat gILumenHeat(GILumen(q_in(T(start = 308.099)))) annotation(Placement(transformation(extent = {{-86, -22}, {-66, -2}})));
      SkinHeat2 skinHeat(SympsDilateEffect(iFrom(start = 2)), LocalTempEffect(curve(iFrom(start = 2)))) annotation(Placement(transformation(extent = {{-15, -15}, {15, 15}}, rotation = 270, origin = {25, -5})));
      MuscleHeat muscleHeat annotation(Placement(transformation(extent = {{-54, -74}, {-26, -42}})));
      Nerves.Hypothalamus hypothalamus(TemperatureEffect_(curve(iFrom(start = 2))), HypothalamusSweatingAcclimation1(curve(iFrom(start = 2))), HypothalamusShiveringAcclimation(curve(iFrom(start = 2)))) annotation(Placement(transformation(extent = {{16, 62}, {36, 82}})));
      Skin.SweatGland sweatGland(AcclimationEffect(curve(iFrom(start = 2)))) annotation(Placement(transformation(extent = {{72, 36}, {92, 56}})));
      Lungs lungs annotation(Placement(transformation(extent = {{-40, 18}, {-20, 38}})));
      Core core1 annotation(Placement(transformation(extent = {{-36, -18}, {-16, 2}})));
    equation
      connect(massFlowConstant.y, HeatInsensibleSkin.liquidOutflow) annotation(Line(points = {{68.7, 9}, {72, 9}, {72, 4}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(BloodFlowEffect.y, WindEffect.yBase) annotation(Line(points = {{84, -34}, {84, -38}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(ClothesEffect.y, BloodFlowEffect.yBase) annotation(Line(points = {{84, -26}, {84, -30}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Constant.y, ClothesEffect.yBase) annotation(Line(points = {{82.40000000000001, -16}, {84, -16}, {84, -22}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Constant1.y, ClothesEffect.u) annotation(Line(points = {{66.40000000000001, -24}, {74.2, -24}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.skin_BloodFlow, BloodFlowEffect.u) annotation(Line(points = {{-94, 96}, {98, 96}, {98, -32}, {93.8, -32}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(WindEffect.y, conduction.cond) annotation(Line(points = {{84, -42}, {84, -46}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(conduction.q_out, ambientTemperature.q_in) annotation(Line(points = {{94, -50}, {98, -50}, {98, -78}, {66, -78}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
      connect(Constant1.y, ClothesEffect1.u) annotation(Line(points = {{66.40000000000001, -24}, {70, -24}, {70, -34}, {22, -34}, {22, -68}, {26.2, -68}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(ClothesEffect1.y, radiation.cond) annotation(Line(points = {{36, -70}, {36, -74}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Constant3.y, ClothesEffect1.yBase) annotation(Line(points = {{32.4, -58}, {36, -58}, {36, -66}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(radiation.q_out, ambientTemperature.q_in) annotation(Line(points = {{46, -78}, {66, -78}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
      connect(busConnector, otherTissuesHeat.busConnector) annotation(Line(points = {{-94, 96}, {-94, -54.88}, {-84.68000000000001, -54.88}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(busConnector.CD_H2O_Outflow, toUrine.desiredFlow) annotation(Line(points = {{-94, 96}, {-94, -84}, {-24, -84}, {-24, -40}, {-2, -40}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(toUrine.q_out, bladderHeat.positiveHeatFlow) annotation(Line(points = {{2, -46}, {2, -60.4}, {2.4, -60.4}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
      connect(busConnector, bladderHeat.busConnector) annotation(Line(points = {{-94, 96}, {-94, -84}, {-24, -84}, {-24, -58.4}, {-7.4, -58.4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(gILumenHeat.busConnector, busConnector) annotation(Line(points = {{-85.40000000000001, -2.4}, {-94, -2.4}, {-94, 96}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(skinHeat.q_out, HeatInsensibleSkin.q_in) annotation(Line(points = {{27.7, -2}, {44.85, -2}, {44.85, -2}, {62, -2}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
      connect(skinHeat.q_out, conduction.q_in) annotation(Line(points = {{27.7, -2}, {46, -2}, {46, -50}, {74, -50}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
      connect(skinHeat.q_out, radiation.q_in) annotation(Line(points = {{27.7, -2}, {46, -2}, {46, -50}, {18, -50}, {18, -78}, {26, -78}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
      connect(skinHeat.busConnector, busConnector) annotation(Line(points = {{22, 7}, {22, 18}, {100, 18}, {100, 96}, {-94, 96}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(muscleHeat.busConnector, busConnector) annotation(Line(points = {{-53.16, -42.64}, {-52, -42}, {-94, -42}, {-94, 96}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(busConnector.brain_FunctionEffect, hypothalamus.BrainFunctionEffect) annotation(Line(points = {{-94, 96}, {-76, 96}, {-76, 78}, {16, 78}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(hypothalamus.HypothalamusSkinFlow_NA, skinHeat.HypothalamusSkinFlow_NervesActivity) annotation(Line(points = {{36, 70}, {44, 70}, {44, 22}, {16, 22}, {16, 7}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(skinHeat.skin_T, hypothalamus.HeatSkin_Temp) annotation(Line(points = {{22, -14}, {22, -20}, {-4, -20}, {-4, 68}, {16, 68}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(hypothalamus.HypothalamusSweating_NA, sweatGland.HypothalamusSweating_NA) annotation(Line(points = {{36, 76}, {48, 76}, {48, 40}, {74, 40}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(sweatGland.busConnector, busConnector) annotation(Line(points = {{89, 53}, {98, 53}, {98, 96}, {-94, 96}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(hypothalamus.HypothalamusShivering_NA, muscleHeat.HypothalamusShivering_NerveActivity) annotation(Line(points = {{36, 64}, {40, 64}, {40, 40}, {-56, 40}, {-56, -38.8}, {-52.6, -38.8}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(WindEffect.u, busConnector.Wind_MPH) annotation(Line(points = {{93.8, -40}, {98, -40}, {98, 98}, {-94, 98}, {-94, 96}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(skinHeat.q_out, sweatGland.port_a) annotation(Line(points = {{27.7, -2}, {46, -2}, {46, 36}, {82, 36}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
      connect(sweatGland.port_b, ambientTemperature.q_in) annotation(Line(points = {{82, 56}, {104, 56}, {104, -78}, {66, -78}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
      connect(lungs.busConnector, busConnector) annotation(Line(points = {{-37.2, 27.4}, {-94, 27.4}, {-94, 96}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(lungs.positiveHeatFlow, core1.positiveHeatFlow) annotation(Line(points = {{-31.4, 23.4}, {-31.4, -6.3}, {-25.8, -6.3}, {-25.8, -7.4}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
      connect(core1.positiveHeatFlow, skinHeat.positiveHeatFlow) annotation(Line(points = {{-25.8, -7.4}, {2, -7.4}, {2, -2}, {16, -2}, {16, -1.7}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
      connect(core1.positiveHeatFlow, toUrine.q_in) annotation(Line(points = {{-25.8, -7.4}, {-25.8, -7.7}, {2, -7.7}, {2, -34}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
      connect(core1.positiveHeatFlow, muscleHeat.q_out) annotation(Line(points = {{-25.8, -7.4}, {-25.8, -6}, {-26, -6}, {-26, -22}, {-40, -22}, {-40, -58}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
      connect(core1.positiveHeatFlow, gILumenHeat.q_out) annotation(Line(points = {{-25.8, -7.4}, {-25.9, -7.4}, {-25.9, -12}, {-76, -12}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
      connect(core1.core_T, hypothalamus.HeatCore_Temp) annotation(Line(points = {{-20, -10}, {-12, -10}, {-12, 72}, {16, 72}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(core1.busConnector, busConnector) annotation(Line(points = {{-26, 0.2}, {-60, 0.2}, {-60, 0}, {-94, 0}, {-94, 96}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(lungs.air, ambientTemperature.q_in) annotation(Line(points = {{-31.4, 34.2}, {-31.4, 58}, {104, 58}, {104, -78}, {66, -78}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
      connect(hypothalamus.HypothalamusShivering_NA, busConnector.HypothalamusShivering_NerveActivity) annotation(Line(points = {{36, 64}, {42, 64}, {42, 40}, {-56, 40}, {-56, 96}, {-94, 96}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent = {{-94, -100}, {94, -126}}, lineColor = {0, 0, 255}, textString = "%name")}));
    end Heat2;

    package Skin
      model SweatGland
        extends PhysiolibraryOld.Icons.SweatGland;
        PhysiolibraryOld.Blocks.FlowConstant flowConstant(k=1)
          annotation (Placement(transformation(extent={{62,80},{70,88}})));
        PhysiolibraryOld.Factors.CurveValue NerveEffect(data={{0.0,0.0,0.0},{
              4.0,30.0,0.0}})
          annotation (Placement(transformation(extent={{62,54},{82,74}})));
        PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
            Placement(transformation(extent={{-100,81},{-80,101}}),
              iconTransformation(extent={{60,60},{80,80}})));
        PhysiolibraryOld.Factors.SimpleMultiply FuelEffect
          annotation (Placement(transformation(extent={{62,42},{82,62}})));
        PhysiolibraryOld.Factors.SplineDelayByDay AcclimationEffect(
          Tau=6,
          data={{60,0.5,0.0},{85,1.0,0.05},{100,2.0,0.0}},
          stateName="SweatAcclimation.Effect")
          annotation (Placement(transformation(extent={{62,22},{82,42}})));
        PhysiolibraryOld.Factors.SimpleMultiply SkinFunctionEffect
          annotation (Placement(transformation(extent={{62,2},{82,22}})));
        PhysiolibraryOld.NonSIunits.degC_to_degF degC_to_degF
          annotation (Placement(transformation(extent={{48,28},{56,36}})));
        PhysiolibraryOld.ConcentrationFlow.MassStorageCompartment SweatFuel(
            initialSoluteMass=1, stateName="SweatFuel.Mass")
          annotation (Placement(transformation(extent={{56,-52},{78,-32}})));
        PhysiolibraryOld.ConcentrationFlow.InputPump inputPump
          annotation (Placement(transformation(extent={{34,-52},{54,-32}})));
        PhysiolibraryOld.ConcentrationFlow.OutputPump outputPump
          annotation (Placement(transformation(extent={{82,-52},{102,-32}})));
        Modelica.Blocks.Math.Gain gain(k = 0.0004) annotation(Placement(transformation(extent = {{-4, -4}, {4, 4}}, rotation = 270, origin = {92, -26})));
        PhysiolibraryOld.Factors.CurveValue MassEffect(data={{0.9,1.0,0.0},{1.0,
              0.0,0.0}})
          annotation (Placement(transformation(extent={{34,-38},{54,-18}})));
        PhysiolibraryOld.Blocks.Constant Constant(k=0.004)
          annotation (Placement(transformation(extent={{34,-20},{42,-12}})));
        Modelica.Blocks.Math.Feedback H2OOutflow annotation(Placement(transformation(extent = {{18, -12}, {2, 4}})));
        PhysiolibraryOld.Blocks.FlowConstant H2OReab(k=0)
          annotation (Placement(transformation(extent={{-6,-22},{2,-14}})));
        PhysiolibraryOld.Interfaces.RealInput_ HypothalamusSweating_NA
          annotation (Placement(transformation(extent={{-38,54},{-18,74}}),
              iconTransformation(extent={{-100,-80},{-60,-40}})));
        PhysiolibraryOld.HeatFlow.PositiveHeatFlow port_a annotation (Placement(
              transformation(extent={{-52,-76},{-46,-70}}), iconTransformation(
                extent={{-10,-110},{10,-90}})));
        PhysiolibraryOld.HeatFlow.HeatFlux HeatSweatConvection(specificHeat=1)
          annotation (Placement(transformation(extent={{-30,-84},{-10,-64}})));
        PhysiolibraryOld.HeatFlow.NegativeHeatFlow port_b annotation (Placement(
              transformation(extent={{-24,-104},{-14,-94}}), iconTransformation(
                extent={{-10,90},{10,110}})));
        Modelica.Blocks.Math.Min H2OEvaporation annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 180, origin = {-54, -10})));
        PhysiolibraryOld.HeatFlow.HeatOutflow HeatSweatEvaporation annotation (
            Placement(transformation(
              extent={{-10,10},{10,-10}},
              rotation=180,
              origin={-70,-74})));
        PhysiolibraryOld.Factors.CurveValue BasicEvaporation(data={{0,0,0.0},{
              40,20,0.0}})
          annotation (Placement(transformation(extent={{-94,-22},{-74,-2}})));
        PhysiolibraryOld.Factors.CurveValue WindEffect(data={{0,1.0,0.0},{20,
              1.5,0.0}})
          annotation (Placement(transformation(extent={{-94,-30},{-74,-10}})));
        PhysiolibraryOld.Blocks.Constant Constant1(k=1)
          annotation (Placement(transformation(extent={{-94,-6},{-86,2}})));
        Gases.RespiratoryRegulations.VaporPressure vaporPressure annotation(Placement(transformation(extent = {{-78, 20}, {-58, 40}})));
        Modelica.Blocks.Math.Feedback Gradient annotation(Placement(transformation(extent = {{8, -8}, {-8, 8}}, rotation = 90, origin = {-54, 16})));
        Gases.RespiratoryRegulations.VaporPressure vaporPressure1 annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 0, origin = {-68, 62})));
        Modelica.Blocks.Math.Product air_pH2O annotation(Placement(transformation(extent = {{-54, 56}, {-44, 46}})));
      equation
        connect(flowConstant.y, NerveEffect.yBase) annotation(Line(points = {{70.40000000000001, 84}, {72, 84}, {72, 66}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.skin_FunctionEffect, SkinFunctionEffect.u) annotation(Line(points = {{-90, 91}, {30, 91}, {30, 12}, {62.2, 12}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(AcclimationEffect.y, SkinFunctionEffect.yBase) annotation(Line(points = {{72, 30}, {72, 14}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(NerveEffect.y, FuelEffect.yBase) annotation(Line(points = {{72, 62}, {72, 54}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(FuelEffect.y, AcclimationEffect.yBase) annotation(Line(points = {{72, 50}, {72, 34}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.skin_T, degC_to_degF.degC) annotation(Line(points = {{-90, 91}, {30, 91}, {30, 32}, {47.2, 32}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(degC_to_degF.degF, AcclimationEffect.u) annotation(Line(points = {{56.8, 32}, {62.2, 32}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(SweatFuel.soluteMass, FuelEffect.u) annotation(Line(points = {{67, -49.4}, {67, -58}, {22, -58}, {22, 52}, {62.2, 52}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(inputPump.q_out, SweatFuel.q_out) annotation(Line(points = {{50, -42}, {67, -42}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(SweatFuel.q_out, outputPump.q_in) annotation(Line(points = {{67, -42}, {86, -42}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(gain.y, outputPump.desiredFlow) annotation(Line(points = {{92, -30.4}, {92, -38}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(MassEffect.y, inputPump.desiredFlow) annotation(Line(points = {{44, -30}, {44, -38}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(SweatFuel.soluteMass, MassEffect.u) annotation(Line(points = {{67, -49.4}, {67, -58}, {22, -58}, {22, -28}, {34.2, -28}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Constant.y, MassEffect.yBase) annotation(Line(points = {{42.4, -16}, {44, -16}, {44, -26}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(SkinFunctionEffect.y, H2OOutflow.u1) annotation(Line(points = {{72, 10}, {72, -4}, {16.4, -4}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(H2OReab.y, H2OOutflow.u2) annotation(Line(points = {{2.4, -18}, {10, -18}, {10, -10.4}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(SkinFunctionEffect.y, gain.u) annotation(Line(points = {{72, 10}, {72, -4}, {92, -4}, {92, -21.2}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(NerveEffect.u, HypothalamusSweating_NA) annotation(Line(points = {{62.2, 64}, {20, 64}, {20, 64}, {-28, 64}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(port_a, HeatSweatConvection.q_in) annotation(Line(points = {{-49, -73}, {-41.5, -73}, {-41.5, -74}, {-30, -74}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
        connect(H2OOutflow.y, HeatSweatConvection.substanceFlow) annotation(Line(points = {{2.8, -4}, {-20, -4}, {-20, -68}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(HeatSweatConvection.q_out, port_b) annotation(Line(points = {{-20, -79}, {-20, -99}, {-19, -99}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
        connect(H2OOutflow.y, H2OEvaporation.u2) annotation(Line(points = {{2.8, -4}, {-19.6, -4}, {-19.6, -4}, {-42, -4}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(H2OEvaporation.y, HeatSweatEvaporation.liquidOutflow) annotation(Line(points = {{-65, -10}, {-70, -10}, {-70, -68}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(port_a, HeatSweatEvaporation.q_in) annotation(Line(points = {{-49, -73}, {-54.5, -73}, {-54.5, -74}, {-60, -74}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
        connect(BasicEvaporation.y, WindEffect.yBase) annotation(Line(points = {{-84, -14}, {-84, -18}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Constant1.y, BasicEvaporation.yBase) annotation(Line(points = {{-85.59999999999999, -2}, {-84, -2}, {-84, -10}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(WindEffect.y, H2OEvaporation.u1) annotation(Line(points = {{-84, -22}, {-84, -28}, {-36, -28}, {-36, -16}, {-42, -16}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.Wind_MPH, WindEffect.u) annotation(Line(points = {{-90, 91}, {-100, 91}, {-100, -20}, {-93.8, -20}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(vaporPressure.VaporPressure, Gradient.u1) annotation(Line(points = {{-56.6, 30}, {-54, 30}, {-54, 22.4}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(vaporPressure1.VaporPressure, air_pH2O.u2) annotation(Line(points = {{-56.6, 62}, {-56, 62}, {-56, 54}, {-55, 54}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.EnvironmentRelativeHumidity, air_pH2O.u1) annotation(Line(points = {{-90, 91}, {-100, 91}, {-100, 48}, {-55, 48}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.AmbientTemperature, vaporPressure1.T) annotation(Line(points = {{-90, 91}, {-100, 91}, {-100, 62}, {-76.59999999999999, 62}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(air_pH2O.y, Gradient.u2) annotation(Line(points = {{-43.5, 51}, {-40, 51}, {-40, 16}, {-47.6, 16}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Gradient.y, BasicEvaporation.u) annotation(Line(points = {{-54, 8.800000000000001}, {-54, 6}, {-98, 6}, {-98, -12}, {-93.8, -12}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.skin_T, vaporPressure.T) annotation(Line(points = {{-90, 91}, {-100, 91}, {-100, 30}, {-76.59999999999999, 30}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(H2OOutflow.y, busConnector.SweatDuct_H2OOutflow) annotation(Line(points = {{2.8, -4}, {-34, -4}, {-34, 92}, {-90, 92}, {-90, 91}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Text(extent=  {{-137, -103}, {144, -128}}, lineColor=  {0, 0, 255}, textString=  "%name")}));
      end SweatGland;
    end Skin;

    model Lungs
      extends PhysiolibraryOld.Icons.Lungs;
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{-76,32},{-56,52}}),
            iconTransformation(extent={{-82,-16},{-62,4}})));
      PhysiolibraryOld.HeatFlow.PositiveHeatFlow positiveHeatFlow annotation (
          Placement(transformation(extent={{2,-8},{10,0}}), iconTransformation(
              extent={{-24,-56},{-4,-36}})));
      PhysiolibraryOld.HeatFlow.HeatOutflow lungsVapor(TempToolsVapor=580.0,
          specificHeat=1)
        annotation (Placement(transformation(extent={{62,-14},{82,6}})));
      PhysiolibraryOld.Blocks.MassFlowConstant_kg massFlowConstant1(k=0.00028)
        annotation (Placement(transformation(extent={{46,14},{60,28}})));
      Modelica.Blocks.Math.Feedback gradient annotation(Placement(transformation(extent = {{-32, 74}, {-12, 94}})));
      Gases.RespiratoryRegulations.VaporPressure vaporPressure1 annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 0, origin = {-62, 56})));
      Modelica.Blocks.Math.Product air_pH2O annotation(Placement(transformation(extent = {{-42, 60}, {-32, 70}})));
      Gases.RespiratoryRegulations.VaporPressure vaporPressure2 annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 0, origin = {-52, 84})));
      Modelica.Blocks.Math.Division division annotation(Placement(transformation(extent = {{-2, 46}, {18, 66}})));
      Modelica.Blocks.Math.Product product annotation(Placement(transformation(extent = {{34, 36}, {54, 56}})));
      Modelica.Blocks.Math.Gain K(k = 8e-007) annotation(Placement(transformation(extent = {{64, 36}, {84, 56}})));
      PhysiolibraryOld.HeatFlow.NegativeHeatFlow air annotation (Placement(
            transformation(extent={{-106,-24},{-66,16}}), iconTransformation(
              extent={{-24,52},{-4,72}})));
      PhysiolibraryOld.HeatFlow.ResistorWithCond resistorWithCond
        annotation (Placement(transformation(extent={{-30,-14},{-10,6}})));
      Modelica.Blocks.Math.Gain SpecificHeat_Air(k = 3.1e-007) annotation(Placement(transformation(extent = {{-48, 6}, {-28, 26}})));
    equation
      connect(positiveHeatFlow, lungsVapor.q_in) annotation(Line(points = {{6, -4}, {62, -4}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
      connect(vaporPressure1.VaporPressure, air_pH2O.u2) annotation(Line(points = {{-50.6, 56}, {-46, 56}, {-46, 62}, {-43, 62}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.AmbientTemperature, vaporPressure1.T) annotation(Line(points = {{-66, 42}, {-90, 42}, {-90, 56}, {-70.59999999999999, 56}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.EnvironmentRelativeHumidity, air_pH2O.u1) annotation(Line(points = {{-66, 42}, {-90, 42}, {-90, 68}, {-43, 68}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(vaporPressure2.VaporPressure, gradient.u1) annotation(Line(points = {{-40.6, 84}, {-30, 84}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.core_T, vaporPressure2.T) annotation(Line(points = {{-66, 42}, {-90, 42}, {-90, 84}, {-60.6, 84}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(air_pH2O.y, gradient.u2) annotation(Line(points = {{-31.5, 65}, {-22, 65}, {-22, 76}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(gradient.y, division.u1) annotation(Line(points = {{-13, 84}, {-8, 84}, {-8, 62}, {-4, 62}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.BarometerPressure, division.u2) annotation(Line(points = {{-66, 42}, {-36, 42}, {-36, 50}, {-4, 50}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(division.y, product.u1) annotation(Line(points = {{19, 56}, {26, 56}, {26, 52}, {32, 52}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.BreathingTotalVentilation, product.u2) annotation(Line(points = {{-66, 42}, {-18, 42}, {-18, 40}, {32, 40}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(product.y, K.u) annotation(Line(points = {{55, 46}, {62, 46}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(K.y, lungsVapor.liquidOutflow) annotation(Line(points = {{85, 46}, {92, 46}, {92, 16}, {72, 16}, {72, 2}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(positiveHeatFlow, resistorWithCond.q_out) annotation(Line(points = {{6, -4}, {-10, -4}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
      connect(resistorWithCond.q_in, air) annotation(Line(points = {{-30, -4}, {-86, -4}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
      connect(SpecificHeat_Air.y, resistorWithCond.cond) annotation(Line(points = {{-27, 16}, {-20, 16}, {-20, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.BreathingTotalVentilation, SpecificHeat_Air.u) annotation(Line(points = {{-66, 42}, {-66, 16}, {-50, 16}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      annotation(Diagram(graphics), Icon(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics));
    end Lungs;

    model Core
      extends PhysiolibraryOld.Icons.HeatCore;
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{-82,34},{-62,54}}),
            iconTransformation(extent={{-10,72},{10,92}})));
      PhysiolibraryOld.HeatFlow.PositiveHeatFlow positiveHeatFlow annotation (
          Placement(transformation(extent={{2,-8},{10,0}}), iconTransformation(
              extent={{-8,-4},{12,16}})));
      Modelica.Blocks.Math.Gain gain1(k = 0.001) annotation(Placement(transformation(extent = {{-34, -12}, {-26, -4}})));
      PhysiolibraryOld.HeatFlow.InputPump CoreMetabolism
        annotation (Placement(transformation(extent={{-32,-28},{-12,-8}})));
      PhysiolibraryOld.HeatFlow.HeatAccumulation core(
        specificHeat=0.83,
        stateName="HeatCore.Mass",
        initialHeatMass=10749.4)
        annotation (Placement(transformation(extent={{-6,-54},{14,-34}})));
      Modelica.Blocks.Math.Gain gTOkg4(k = 0.001) annotation(Placement(transformation(extent = {{-26, -40}, {-18, -32}})));
      PhysiolibraryOld.Interfaces.RealOutput_ core_T annotation (Placement(
            transformation(extent={{22,-82},{42,-62}}), iconTransformation(
              extent={{40,-40},{80,0}})));
    equation
      connect(busConnector.MetabolismCaloriesUsed_CoreHeat, gain1.u) annotation(Line(points = {{-72, 44}, {-56, 44}, {-34.8, -8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(gain1.y, CoreMetabolism.desiredFlow) annotation(Line(points = {{-25.6, -8}, {-22, -8}, {-22, -14}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(CoreMetabolism.q_out, core.q_in) annotation(Line(points = {{-16, -18}, {-2, -18}, {-2, -44}, {4, -44}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
      connect(busConnector.WeightCore, gTOkg4.u) annotation(Line(points = {{-72, 44}, {-72, -36}, {-26.8, -36}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(gTOkg4.y, core.weight) annotation(Line(points = {{-17.6, -36}, {-6, -36}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(core.T, busConnector.HeatCore_Temp) annotation(Line(points = {{4, -54}, {-72, -54}, {-72, 44}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(core.q_in, positiveHeatFlow) annotation(Line(points = {{4, -44}, {6, -44}, {6, -4}}, color = {255, 128, 0}, thickness = 1, smooth = Smooth.None));
      connect(core.T, core_T) annotation(Line(points = {{4, -54}, {4, -72}, {32, -72}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(core.T, busConnector.core_T) annotation(Line(points = {{4, -54}, {36, -54}, {36, 44}, {-72, 44}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      annotation(Diagram(graphics), Icon(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics));
    end Core;
    annotation(Documentation(revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr>
                   </table>
                   </html>"), Icon(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics));
  end Heat;

  package Metabolism "Body Nutrients, Metabolism and Heat Systems"
    extends PhysiolibraryOld.Icons.NutrientsMetabolismLib;
    model LiverMetabolism
      import QHP = HumMod;
      extends PhysiolibraryOld.Icons.Liver;
      // extends Library.Interfaces.BaseModel;
      //outer parameter Real EFC_Vol(final unit="ml");
      HumMod.Metabolism.Glycogen glycogen(MINUTE_FLOW_TO_MASS_CONVERSION = 0.001, initialSoluteMass = 120) annotation(Placement(transformation(extent = {{96, 46}, {76, 66}})));
      PhysiolibraryOld.ConcentrationFlow.SoluteFlowPump LM_Glycogenesis
        annotation (Placement(transformation(extent={{4,58},{24,78}})));
      PhysiolibraryOld.ConcentrationFlow.SoluteFlowPump LM_Glycogenolysis
        annotation (Placement(transformation(extent={{24,6},{4,26}})));
      PhysiolibraryOld.ConcentrationFlow.SoluteFlowPump LM_FA_Glucose
        annotation (Placement(transformation(extent={{-20,-34},{-40,-14}})));
      PhysiolibraryOld.ConcentrationFlow.SoluteFlowPump LM_Gluconeogenesis
        annotation (Placement(transformation(extent={{64,-34},{44,-14}})));
      PhysiolibraryOld.ConcentrationFlow.SimpleReaction2 AA_TO_GLU
        annotation (Placement(transformation(extent={{34,-34},{14,-14}})));
      PhysiolibraryOld.ConcentrationFlow.SimpleReaction GLU_TO_FA
        annotation (Placement(transformation(extent={{-46,-34},{-66,-14}})));
      PhysiolibraryOld.Factors.CurveValue InsulinEffect(data={{0,0.0,0.0},{35,
            1.0,0.03},{120,3.0,0.0}})
        annotation (Placement(transformation(extent={{4,80},{24,100}})));
      PhysiolibraryOld.Factors.CurveValue InsulinEffect3(data={{0,0.0,0.0},{50,
            1.0,0.06},{200,3.0,0.0}}, curve(iFrom(start=2)))
        annotation (Placement(transformation(extent={{-20,-18},{-40,2}})));
      PhysiolibraryOld.Factors.CurveValue InsulinEffect4(data={{0,2.5,0.0},{50,
            1.0,-0.005},{500,0.0,0.0}}, curve(iFrom(start=2)))
        annotation (Placement(transformation(extent={{44,-10},{64,10}})));
      PhysiolibraryOld.Blocks.MassFlowConstant massFlowConstant2(k=75)
        annotation (Placement(transformation(extent={{36,88},{26,98}})));
      PhysiolibraryOld.Blocks.MassFlowConstant massFlowConstant3(k=70)
        annotation (Placement(transformation(extent={{-18,-4},{-28,6}})));
      PhysiolibraryOld.Blocks.MassFlowConstant massFlowConstant4(k=30)
        annotation (Placement(transformation(extent={{66,4},{56,14}})));
      PhysiolibraryOld.Factors.SplineValue2 MassEffect(data={{0,3.0,0.0},{100,
            1.0,-0.05},{200,0.0,0.0}}, curve(iFrom(start=2)))
        annotation (Placement(transformation(extent={{24,68},{4,88}})));
      PhysiolibraryOld.Factors.SplineValue2 GlucoseEffect(data={{120,0.0,0.0},{
            130,1.0,0.06},{200,2.0,0.0}})
        annotation (Placement(transformation(extent={{4,76},{24,96}})));
      PhysiolibraryOld.Factors.SimpleMultiply LiverFunctionEffect
        annotation (Placement(transformation(extent={{4,72},{24,92}})));
      PhysiolibraryOld.Factors.CurveValue InsulinEffect1(data={{0,2.0,0.0},{35,
            1.0,-0.02},{120,0.0,0.0}})
        annotation (Placement(transformation(extent={{4,36},{24,56}})));
      PhysiolibraryOld.Blocks.MassFlowConstant massFlowConstant5(k=75)
        annotation (Placement(transformation(extent={{36,44},{26,54}})));
      PhysiolibraryOld.Factors.SplineValue2 MassEffect1(data={{0,0.0,0.0},{100,
            1.0,0.0}})
        annotation (Placement(transformation(extent={{24,16},{4,36}})));
      PhysiolibraryOld.Factors.SplineValue2 GlucoseEffect1(data={{45,2.0,0.0},{
            125,1.0,-0.01},{350,0.3,0.0}})
        annotation (Placement(transformation(extent={{4,28},{24,48}})));
      PhysiolibraryOld.Factors.SimpleMultiply LiverFunctionEffect1
        annotation (Placement(transformation(extent={{4,20},{24,40}})));
      PhysiolibraryOld.Factors.CurveValue GlucagonEffect(data={{170,1.0,0.0},{
            680,2.0,0.0}})
        annotation (Placement(transformation(extent={{4,32},{24,52}})));
      PhysiolibraryOld.Factors.CurveValue EpinephrineEffect(data={{0,0.8,0.0},{
            40,1.0,0.01},{400,10.0,0.02},{1200,20.0,0.0}})
        annotation (Placement(transformation(extent={{24,24},{4,44}})));
      PhysiolibraryOld.Blocks.Constant Constant2(k=0.42)
        annotation (Placement(transformation(extent={{-66,-18},{-58,-10}})));
      PhysiolibraryOld.Blocks.Constant Constant3(k=0.6)
        annotation (Placement(transformation(extent={{32,-18},{26,-12}})));
      PhysiolibraryOld.Factors.CurveValue GlucoseEffect2(data={{120,0.0,0.0},{
            130,1.0,0.05},{200,2.0,0.0}}, curve(iFrom(start=2)))
        annotation (Placement(transformation(extent={{-20,-22},{-40,-2}})));
      PhysiolibraryOld.Factors.SimpleMultiply LiverFunctionEffect2
        annotation (Placement(transformation(extent={{-20,-26},{-40,-6}})));
      PhysiolibraryOld.Factors.CurveValue GlucagonEffect1(data={{170,1.0,0.0},{
            680,2.0,0.0}})
        annotation (Placement(transformation(extent={{44,-14},{64,6}})));
      PhysiolibraryOld.Factors.CurveValue GlucoseEffect3(data={{45,2.0,0.0},{
            125,1.0,-0.008},{340,0.3,0.0}}, curve(iFrom(start=2)))
        annotation (Placement(transformation(extent={{44,-18},{64,2}})));
      PhysiolibraryOld.Factors.CurveValue AminoAcidEffect(
        data={{0,0.0,0.0},{50,1.0,0.02},{200,2.0,0.0}},
        curve(iFrom(start=2)),
        y(start=1.13856),
        u(start=57.2753))
        annotation (Placement(transformation(extent={{92,-8},{72,12}})));
      PhysiolibraryOld.Factors.SimpleMultiply LiverFunctionEffect3
        annotation (Placement(transformation(extent={{44,-26},{64,-6}})));
      PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow Glucose(conc(
            final unit="mg/ml"), q(final unit="mg/min"))
        "extracellular storage" annotation (Placement(transformation(extent={{-62,
                58},{-42,78}}), iconTransformation(extent={{90,-70},{110,-50}})));
      PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow
        triglicerides(conc(final unit="mg/ml"), q(final unit="mg/min"))
        annotation (Placement(transformation(extent={{-92,-16},{-72,4}}),
            iconTransformation(extent={{90,50},{110,70}})));
      PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow Ketoacids(
          conc(final unit="mg/ml"), q(final unit="mg/min"))
        "extracellular storage" annotation (Placement(transformation(extent={{-12,
                -92},{8,-72}}), iconTransformation(extent={{90,-10},{110,10}})));
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{-108,86},{-88,106}}),
            iconTransformation(extent={{-108,-10},{-88,10}})));
      PhysiolibraryOld.ConcentrationFlow.SoluteFlowPump LM_Ketoacids
        annotation (Placement(transformation(extent={{-58,-92},{-38,-72}})));
      PhysiolibraryOld.ConcentrationFlow.SimpleReaction FA_TO_KA annotation (
          Placement(transformation(
            extent={{-10,-10},{10,10}},
            rotation=0,
            origin={-24,-82})));
      PhysiolibraryOld.Blocks.Constant Constant4(k=1.02)
        annotation (Placement(transformation(extent={{-12,-76},{-20,-68}})));
      PhysiolibraryOld.Factors.SimpleMultiply LiverFunctionEffect4
        annotation (Placement(transformation(extent={{-58,-84},{-38,-64}})));
      PhysiolibraryOld.Factors.CurveValue FattyAcidEffect(data={{0,0.5,0.0},{15,
            1.0,0.05},{75,5.0,0.0}}, curve(iFrom(start=2)))
        "effect on fatty acids concentration in mg/dl"
        annotation (Placement(transformation(extent={{-58,-76},{-38,-56}})));
      PhysiolibraryOld.Factors.CurveValue GlucagonEffect2(data={{0,0.5,0.0},{
            170,1.0,0.01},{340,10.0,0.0}})
        annotation (Placement(transformation(extent={{-58,-80},{-38,-60}})));
      PhysiolibraryOld.Blocks.MassFlowConstant massFlowConstant1(k=2.2)
        annotation (Placement(transformation(extent={{-34,-62},{-44,-52}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
        concentrationMeasure(unitsString="mg/dl", toAnotherUnitCoef=100)
        "from mg/ml to mg/dl"
        annotation (Placement(transformation(extent={{-80,-92},{-60,-72}})));
      PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow AminoAcids(
          conc(final unit="mg/ml"), q(final unit="mg/min"))
        "extracellular storage" annotation (Placement(transformation(extent={{
                76,-34},{96,-14}}), iconTransformation(extent={{50,-110},{70,-90}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
        concentrationMeasure1(unitsString="mg/dl", toAnotherUnitCoef=100)
        "from mg/ml to mg/dl"
        annotation (Placement(transformation(extent={{64,-34},{84,-14}})));
      PhysiolibraryOld.ConcentrationFlow.SoluteFlowPump LM_FA_AminoAcids
        annotation (Placement(transformation(extent={{64,-78},{44,-58}})));
      PhysiolibraryOld.ConcentrationFlow.SimpleReaction2 AA_TO_FA
        annotation (Placement(transformation(extent={{38,-78},{18,-58}})));
      PhysiolibraryOld.Factors.CurveValue InsulinEffect2(data={{0,0.0,0.0},{50,
            1.0,0.05},{80,4.0,0.0}}, curve(iFrom(start=2)))
        annotation (Placement(transformation(extent={{64,-62},{44,-42}})));
      PhysiolibraryOld.Blocks.MassFlowConstant massFlowConstant6(k=20)
        annotation (Placement(transformation(extent={{66,-48},{56,-38}})));
      PhysiolibraryOld.Blocks.Constant Constant5(k=0.437)
        annotation (Placement(transformation(extent={{40,-62},{30,-52}})));
      PhysiolibraryOld.Factors.SimpleMultiply LiverFunctionEffect5
        annotation (Placement(transformation(extent={{64,-70},{44,-50}})));
      PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow Urea(conc(
            final unit="mg/ml"), q(final unit="mg/min"))
        "extracellular storage" annotation (Placement(transformation(extent={{-8,
                -42},{12,-22}}), iconTransformation(extent={{-70,-110},{-50,-90}})));
      PhysiolibraryOld.Blocks.Constant Constant6(k=0.3)
        annotation (Placement(transformation(extent={{10,-18},{16,-12}})));
      PhysiolibraryOld.Blocks.Constant Constant7(k=0.3)
        annotation (Placement(transformation(extent={{14,-60},{20,-54}})));
      Glucose_MG_TO_MMOL glucose_MG_TO_MMOL annotation(Placement(transformation(extent = {{42, 88}, {50, 96}})));
      PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow fattyAcids(
          conc(final unit="mg/ml"), q(final unit="mg/min")) annotation (
          Placement(transformation(extent={{-102,-92},{-82,-72}}),
            iconTransformation(extent={{90,90},{110,110}})));
      PhysiolibraryOld.Factors.SimpleMultiply AAEffect
        annotation (Placement(transformation(extent={{64,-22},{44,-2}})));
      PhysiolibraryOld.Blocks.Constant Constant1(k=1)
        annotation (Placement(transformation(extent={{96,12},{88,20}})));
      PhysiolibraryOld.Factors.SimpleMultiply AAEffect1
        annotation (Placement(transformation(extent={{64,-66},{44,-46}})));
    equation
      connect(InsulinEffect.yBase, massFlowConstant2.y) annotation(Line(points = {{14, 92}, {14, 93}, {25.5, 93}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(InsulinEffect4.yBase, massFlowConstant4.y) annotation(Line(points = {{54, 2}, {54, 9}, {55.5, 9}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(InsulinEffect3.yBase, massFlowConstant3.y) annotation(Line(points = {{-30, -6}, {-30, 1}, {-28.5, 1}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(GlucoseEffect.y, LiverFunctionEffect.yBase) annotation(Line(points = {{14, 84}, {14, 84}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(InsulinEffect1.yBase, massFlowConstant5.y) annotation(Line(points = {{14, 48}, {14, 49}, {25.5, 49}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(GlucagonEffect.yBase, InsulinEffect1.y) annotation(Line(points = {{14, 44}, {14, 44}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(EpinephrineEffect.yBase, GlucoseEffect1.y) annotation(Line(points = {{14, 36}, {14, 36}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(EpinephrineEffect.y, LiverFunctionEffect1.yBase) annotation(Line(points = {{14, 32}, {14, 32}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Constant2.y, GLU_TO_FA.coef) annotation(Line(points = {{-57.6, -14}, {-56, -14}, {-56, -20}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Constant3.y, AA_TO_GLU.coef) annotation(Line(points = {{25.7, -15}, {24, -15}, {24, -20}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(InsulinEffect3.y, GlucoseEffect2.yBase) annotation(Line(points = {{-30, -10}, {-30, -10}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(GlucoseEffect2.y, LiverFunctionEffect2.yBase) annotation(Line(points = {{-30, -14}, {-30, -14}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(LiverFunctionEffect2.y, LM_FA_Glucose.soluteFlow) annotation(Line(points = {{-30, -18}, {-30, -18}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(InsulinEffect4.y, GlucagonEffect1.yBase) annotation(Line(points = {{54, -2}, {54, -2}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(GlucagonEffect1.y, GlucoseEffect3.yBase) annotation(Line(points = {{54, -6}, {54, -6}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(LiverFunctionEffect3.y, LM_Gluconeogenesis.soluteFlow) annotation(Line(points = {{54, -18}, {54, -18}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.LiverFunctionEffect, LiverFunctionEffect.u) annotation(Line(points = {{-98, 96}, {-6, 96}, {-6, 82}, {4.2, 82}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.LiverFunctionEffect, LiverFunctionEffect1.u) annotation(Line(points = {{-98, 96}, {-5.9, 96}, {-5.9, 30}, {4.2, 30}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.LiverFunctionEffect, LiverFunctionEffect3.u) annotation(Line(points = {{-98, 96}, {-6, 96}, {-6, -10}, {40, -10}, {40, -16}, {44.2, -16}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.LiverFunctionEffect, LiverFunctionEffect2.u) annotation(Line(points = {{-98, 96}, {-6, 96}, {-6, -16}, {-20.2, -16}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.PortalVein_Glucagon, GlucagonEffect1.u) annotation(Line(points = {{-98, 96}, {-2, 96}, {-2, -4}, {44.2, -4}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(GlucagonEffect.u, busConnector.PortalVein_Glucagon) annotation(Line(points = {{4.2, 42}, {-2, 42}, {-2, 96}, {-98, 96}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(GLU_TO_FA.q_in, LM_FA_Glucose.q_out) annotation(Line(points = {{-46, -24}, {-40, -24}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(AA_TO_GLU.q_in, LM_Gluconeogenesis.q_out) annotation(Line(points = {{34, -24}, {44, -24}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(Constant4.y, FA_TO_KA.coef) annotation(Line(points = {{-20.4, -72}, {-24, -72}, {-24, -78}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(LM_Ketoacids.q_out, FA_TO_KA.q_in) annotation(Line(points = {{-38, -82}, {-34, -82}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(LiverFunctionEffect4.y, LM_Ketoacids.soluteFlow) annotation(Line(points = {{-48, -76}, {-48, -76}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(GlucagonEffect2.y, LiverFunctionEffect4.yBase) annotation(Line(points = {{-48, -72}, {-48, -72}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(FattyAcidEffect.y, GlucagonEffect2.yBase) annotation(Line(points = {{-48, -68}, {-48, -68}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(FattyAcidEffect.yBase, massFlowConstant1.y) annotation(Line(points = {{-48, -64}, {-48, -57}, {-44.5, -57}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.LiverFunctionEffect, LiverFunctionEffect4.u) annotation(Line(points = {{-98, 96}, {-98, -74}, {-57.8, -74}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.PortalVein_Glucagon, GlucagonEffect2.u) annotation(Line(points = {{-98, 96}, {-98, -70}, {-57.8, -70}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(concentrationMeasure.actualConc, FattyAcidEffect.u) annotation(Line(points = {{-70, -78}, {-70, -66}, {-57.8, -66}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.PortalVein_Glucose, GlucoseEffect.u) annotation(Line(points = {{-98, 96}, {-10, 96}, {-10, 86}, {4.2, 86}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.PortalVein_Glucose, GlucoseEffect1.u) annotation(Line(points = {{-98, 96}, {-10, 96}, {-10, 38}, {4.2, 38}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.PortalVein_Glucose, GlucoseEffect3.u) annotation(Line(points = {{-98, 96}, {-10, 96}, {-10, -8}, {44.2, -8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.PortalVein_Glucose, GlucoseEffect2.u) annotation(Line(points = {{-98, 96}, {-10, 96}, {-10, -12}, {-20.2, -12}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(EpinephrineEffect.u, busConnector.EpiPool_Epi) annotation(Line(points = {{23.8, 34}, {100, 34}, {100, 104}, {-98, 104}, {-98, 96}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(Glucose, LM_Glycogenesis.q_in) annotation(Line(points = {{-52, 68}, {4, 68}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(LM_Glycogenolysis.q_out, Glucose) annotation(Line(points = {{4, 16}, {-14, 16}, {-14, 68}, {-52, 68}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(LM_FA_Glucose.q_in, Glucose) annotation(Line(points = {{-20, -24}, {-14, -24}, {-14, 68}, {-52, 68}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(AA_TO_GLU.q_out, Glucose) annotation(Line(points = {{14, -21}, {-14, -21}, {-14, 68}, {-52, 68}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(GLU_TO_FA.q_out, triglicerides) annotation(Line(points = {{-66, -24}, {-82, -24}, {-82, -6}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(Ketoacids, FA_TO_KA.q_out) annotation(Line(points = {{-2, -82}, {-14, -82}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(AminoAcids, LM_Gluconeogenesis.q_in) annotation(Line(points = {{86, -24}, {64, -24}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(AminoAcids, concentrationMeasure1.q_in) annotation(Line(points = {{86, -24}, {74, -24}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(InsulinEffect2.yBase, massFlowConstant6.y) annotation(Line(points = {{54, -50}, {54, -43}, {55.5, -43}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Constant5.y, AA_TO_FA.coef) annotation(Line(points = {{29.5, -57}, {28, -57}, {28, -64}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(LiverFunctionEffect5.y, LM_FA_AminoAcids.soluteFlow) annotation(Line(points = {{54, -62}, {54, -62}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.LiverFunctionEffect, LiverFunctionEffect5.u) annotation(Line(points = {{-98, 96}, {-98, 100}, {100, 100}, {100, -60}, {63.8, -60}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(AA_TO_FA.q_in, LM_FA_AminoAcids.q_out) annotation(Line(points = {{38, -68}, {44, -68}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(AA_TO_FA.q_out, triglicerides) annotation(Line(points = {{18, -65}, {2, -65}, {2, -48}, {-82, -48}, {-82, -6}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(LM_FA_AminoAcids.q_in, AminoAcids) annotation(Line(points = {{64, -68}, {80, -68}, {80, -24}, {86, -24}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(Urea, AA_TO_GLU.q_out2) annotation(Line(points = {{2, -32}, {8, -32}, {8, -26}, {14, -26}, {14, -27}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(AA_TO_FA.q_out2, Urea) annotation(Line(points = {{18, -71}, {8, -71}, {8, -32}, {2, -32}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(AA_TO_GLU.coef2, Constant6.y) annotation(Line(points = {{18, -20}, {18, -15}, {16.3, -15}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(AA_TO_FA.coef2, Constant7.y) annotation(Line(points = {{22, -64}, {22, -57}, {20.3, -57}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(LM_Glycogenesis.soluteFlow, glucose_MG_TO_MMOL.u) annotation(Line(points = {{14, 74}, {38, 74}, {38, 92}, {42, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(glucose_MG_TO_MMOL.y, busConnector.liver_GlucoseToCellStorageFlow) annotation(Line(points = {{50.8, 92}, {60, 92}, {60, 100}, {-98, 100}, {-98, 96}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(busConnector.LM_Insulin_InsulinDelayed, InsulinEffect.u) annotation(Line(points = {{-98, 96}, {-16, 96}, {-16, 90}, {4.2, 90}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(busConnector.LM_Insulin_InsulinDelayed, InsulinEffect1.u) annotation(Line(points = {{-98, 96}, {-16, 96}, {-16, 46}, {4.2, 46}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(busConnector.LM_Insulin_InsulinDelayed, InsulinEffect3.u) annotation(Line(points = {{-98, 96}, {-16, 96}, {-16, -8}, {-20.2, -8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(busConnector.LM_Insulin_InsulinDelayed, InsulinEffect4.u) annotation(Line(points = {{-98, 96}, {-16, 96}, {-16, 0}, {44.2, 0}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(InsulinEffect2.u, busConnector.LM_Insulin_InsulinDelayed) annotation(Line(points = {{63.8, -52}, {100, -52}, {100, 100}, {-98, 100}, {-98, 96}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(fattyAcids, concentrationMeasure.q_in) annotation(Line(points = {{-92, -82}, {-70, -82}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(fattyAcids, LM_Ketoacids.q_in) annotation(Line(points = {{-92, -82}, {-58, -82}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(InsulinEffect.y, GlucoseEffect.yBase) annotation(Line(points = {{14, 88}, {14, 88}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(LiverFunctionEffect.y, MassEffect.yBase) annotation(Line(points = {{14, 80}, {14, 80}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(MassEffect.y, LM_Glycogenesis.soluteFlow) annotation(Line(points = {{14, 76}, {14, 74}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(GlucagonEffect.y, GlucoseEffect1.yBase) annotation(Line(points = {{14, 40}, {14, 40}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(MassEffect1.yBase, LiverFunctionEffect1.y) annotation(Line(points = {{14, 28}, {14, 28}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(MassEffect1.y, LM_Glycogenolysis.soluteFlow) annotation(Line(points = {{14, 24}, {14, 22}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(LM_Glycogenolysis.q_in, glycogen.q_out) annotation(Line(points = {{24, 16}, {56, 16}, {56, 56}, {86, 56}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(LM_Glycogenesis.q_out, glycogen.q_out) annotation(Line(points = {{24, 68}, {56, 68}, {56, 56}, {86, 56}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(concentrationMeasure1.actualConc, AminoAcidEffect.u) annotation(Line(points = {{74, -20}, {74, -14}, {98, -14}, {98, 2}, {91.8, 2}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(glycogen.soluteMass, MassEffect.u) annotation(Line(points = {{86, 48.6}, {86, 24}, {52, 24}, {52, 78}, {23.8, 78}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(glycogen.soluteMass, MassEffect1.u) annotation(Line(points = {{86, 48.6}, {86, 24}, {52, 24}, {52, 26}, {23.8, 26}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(GlucoseEffect3.y, AAEffect.yBase) annotation(Line(points = {{54, -10}, {54, -10}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(LiverFunctionEffect3.yBase, AAEffect.y) annotation(Line(points = {{54, -14}, {54, -14}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Constant1.y, AminoAcidEffect.yBase) annotation(Line(points = {{87.59999999999999, 16}, {82, 16}, {82, 4}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(AminoAcidEffect.y, AAEffect.u) annotation(Line(points = {{82, 0}, {82, -12}, {63.8, -12}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(InsulinEffect2.y, AAEffect1.yBase) annotation(Line(points = {{54, -54}, {54, -54}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(AAEffect1.y, LiverFunctionEffect5.yBase) annotation(Line(points = {{54, -58}, {54, -58}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(AminoAcidEffect.y, AAEffect1.u) annotation(Line(points = {{82, 0}, {82, -56}, {63.8, -56}}, color = {0, 0, 127}, smooth = Smooth.None));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}, grid = {2, 2}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}, grid = {2, 2}), graphics = {Text(extent=  {{-122, 100}, {94, 66}}, lineColor=  {0, 0, 255}, textString=  "%name"), Rectangle(extent=  {{-100, 100}, {100, -100}}, lineColor=  {0, 0, 0})}));
    end LiverMetabolism;

    model Glucose
      extends PhysiolibraryOld.Icons.Glucose;
      //  extends Library.Interfaces.BaseModel;
      //outer parameter Real EFC_Vol(final unit="ml");
      PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment GlucosePool(
          stateName="GlucosePool.Mass", initialSoluteMass=15513)
        annotation (Placement(transformation(extent={{-76,46},{-56,66}})));
      PhysiolibraryOld.ConcentrationFlow.OutputPump Decomposition
        annotation (Placement(transformation(extent={{-92,56},{-72,36}})));
      Modelica.Blocks.Math.Gain K(k = 0.0007) annotation(Placement(transformation(extent = {{-70, 36}, {-76, 42}})));
      PhysiolibraryOld.ConcentrationFlow.SolventFlowPump Glomerulus
        annotation (Placement(transformation(extent={{-34,66},{-14,86}})));
      PhysiolibraryOld.ConcentrationFlow.ConstLimitedReabsorbtion Reabsorbtion
        annotation (Placement(transformation(extent={{2,66},{22,86}})));
      PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow q_out(conc(
            final unit="mg/ml"), q(final unit="mg/min")) annotation (Placement(
            transformation(extent={{-60,26},{-40,46}}), iconTransformation(
              extent={{-10,50},{10,70}})));
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{-100,0},{-80,20}}),
            iconTransformation(extent={{-100,-12},{-80,8}})));
      PhysiolibraryOld.ConcentrationFlow.FlowMeasure flowMeasure
        annotation (Placement(transformation(extent={{50,86},{70,66}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
        concentrationMeasure(unitsString="mg/dl", toAnotherUnitCoef=100)
        annotation (Placement(transformation(extent={{-76,58},{-56,78}})));
      Modelica.Blocks.Math.Add3 YGLS "Ikeda glucose to cells flow" annotation(Placement(transformation(extent = {{-4, -26}, {14, -8}})));
      Modelica.Blocks.Math.Gain MW(k = 1 / 180) annotation(Placement(transformation(extent = {{4, -4}, {-4, 4}}, rotation = 90, origin = {-66, 20})));
      Electrolytes.Bladder bladder(stateVarName = "BladderGlucose.Mass") annotation(Placement(transformation(extent = {{70, 36}, {90, 56}})));
    equation
      connect(Decomposition.q_in, GlucosePool.q_out) annotation(Line(points = {{-88, 46}, {-90, 46}, {-90, 56}, {-66, 56}}, color = {255, 0, 0}, smooth = Smooth.None, thickness = 1));
      connect(K.u, GlucosePool.soluteMass) annotation(Line(points = {{-69.40000000000001, 39}, {-61.7, 39}, {-61.7, 48.2}, {-66, 48.2}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(K.y, Decomposition.desiredFlow) annotation(Line(points = {{-76.3, 39}, {-76.3, 39.5}, {-82, 39.5}, {-82, 42}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Glomerulus.q_out, Reabsorbtion.Inflow) annotation(Line(points = {{-14, 76}, {2, 76}}, color = {255, 0, 0}, smooth = Smooth.None, thickness = 1));
      connect(GlucosePool.q_out, Glomerulus.q_in) annotation(Line(points = {{-66, 56}, {-44.9, 56}, {-44.9, 76}, {-34, 76}}, color = {255, 0, 0}, smooth = Smooth.None, thickness = 1));
      connect(Reabsorbtion.Reabsorbtion, GlucosePool.q_out) annotation(Line(points = {{12, 72}, {12, 56}, {-66, 56}}, color = {255, 0, 0}, smooth = Smooth.None, thickness = 1));
      connect(GlucosePool.q_out, q_out) annotation(Line(points = {{-66, 56}, {-50, 56}, {-50, 36}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(busConnector.ECFV_Vol, GlucosePool.SolventVolume) annotation(Line(points = {{-90, 10}, {-100, 10}, {-100, 62}, {-74, 62}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.Glomerulus_GFR, Glomerulus.solventFlow) annotation(Line(points = {{-90, 10}, {-100, 10}, {-100, 82}, {-24, 82}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(Reabsorbtion.Outflow, flowMeasure.q_in) annotation(Line(points = {{22, 76}, {56, 76}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(busConnector.CD_Glucose_Outflow, flowMeasure.actualFlow) annotation(Line(points = {{-90, 10}, {60, 10}, {60, 71}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(GlucosePool.q_out, concentrationMeasure.q_in) annotation(Line(points = {{-66, 56}, {-60, 56}, {-60, 68}, {-66, 68}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(busConnector.Glucose, concentrationMeasure.actualConc) annotation(Line(points = {{-90, 10}, {-100, 10}, {-100, 72}, {-66, 72}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(YGLS.y, busConnector.GlucoseToCellsFlow) annotation(Line(points = {{14.9, -17}, {20, -16}, {24, -16}, {24, 10}, {-90, 10}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.skeletalMuscle_GlucoseToCellStorageFlow, YGLS.u2) annotation(Line(points = {{-90, 10}, {-90, -17}, {-5.8, -17}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.liver_GlucoseToCellStorageFlow, YGLS.u1) annotation(Line(points = {{-90, 10}, {-90, -9.800000000000001}, {-5.8, -9.800000000000001}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.respiratoryMuscle_GlucoseToCellStorageFlow, YGLS.u3) annotation(Line(points = {{-90, 10}, {-90, -24.2}, {-5.8, -24.2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(MW.u, GlucosePool.soluteMass) annotation(Line(points = {{-66, 24.8}, {-66, 48.2}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(MW.y, busConnector.GlucoseECF_Osmoles) annotation(Line(points = {{-66, 15.6}, {-66, 10}, {-90, 10}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(flowMeasure.q_out, bladder.q_in) annotation(Line(points = {{64, 76}, {80, 76}, {80, 54}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(bladder.busConnector, busConnector) annotation(Line(points = {{88, 54}, {88, 10}, {-90, 10}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Text(extent=  {{-160, -62}, {160, -90}}, lineColor=  {0, 0, 255}, textString=  "%name"), Rectangle(extent=  {{-100, 100}, {100, -100}}, lineColor=  {0, 0, 0})}));
    end Glucose;

    model Proteins
      // extends Library.Interfaces.BaseModel;
      extends PhysiolibraryOld.Icons.Proteins;
      PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment CellProteins(
          stateName="CellProtein.Mass", initialSoluteMass=5549290.0)
        annotation (Placement(transformation(extent={{-52,8},{-32,28}})));
      PhysiolibraryOld.ConcentrationFlow.SoluteFlowPump Degradation
        annotation (Placement(transformation(extent={{-58,-74},{-26,-42}})));
      Modelica.Blocks.Math.Gain K(k = 5.3e-006) annotation(Placement(transformation(extent = {{10, -10}, {-10, 10}}, rotation = 90, origin = {-42, -30})));
      PhysiolibraryOld.ConcentrationFlow.SolventFlowPump Outflow
        annotation (Placement(transformation(extent={{-14,30},{6,50}})));
      PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow aminoAcids(
          conc(final unit="mg/ml"), q(final unit="mg/min")) annotation (
          Placement(transformation(extent={{64,0},{84,20}}), iconTransformation(
              extent={{90,-10},{110,10}})));
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{-88,38},{-68,58}}),
            iconTransformation(extent={{-102,-10},{-82,10}})));
      PhysiolibraryOld.ConcentrationFlow.SolventFlowPump Inflow
        annotation (Placement(transformation(extent={{8,-18},{-12,2}})));
      PhysiolibraryOld.Blocks.Constant Constant(k=0.88)
        annotation (Placement(transformation(extent={{-16,50},{-8,58}})));
      PhysiolibraryOld.Blocks.Constant Constant1(k=464)
        annotation (Placement(transformation(extent={{-16,2},{-8,10}})));
    equation
      connect(Degradation.q_in, CellProteins.q_out) annotation(Line(points = {{-58, -58}, {-70, -58}, {-70, 18}, {-42, 18}}, color = {255, 0, 0}, smooth = Smooth.None, thickness = 1));
      connect(K.u, CellProteins.soluteMass) annotation(Line(points = {{-42, -18}, {-41.7, -18}, {-41.7, 10.2}, {-42, 10.2}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(CellProteins.q_out, Outflow.q_in) annotation(Line(points = {{-42, 18}, {-24.9, 18}, {-24.9, 40}, {-14, 40}}, color = {255, 0, 0}, smooth = Smooth.None, thickness = 1));
      connect(busConnector.ICFV_Vol, CellProteins.SolventVolume) annotation(Line(points = {{-78, 48}, {-80, 48}, {-80, 24}, {-50, 24}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(CellProteins.q_out, Inflow.q_out) annotation(Line(points = {{-42, 18}, {-24, 18}, {-24, -6}, {-12, -6}, {-12, -8}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(Inflow.q_in, aminoAcids) annotation(Line(points = {{8, -8}, {42, -8}, {42, 10}, {74, 10}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(Outflow.q_out, aminoAcids) annotation(Line(points = {{6, 40}, {42, 40}, {42, 10}, {74, 10}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(Constant.y, Outflow.solventFlow) annotation(Line(points = {{-7.6, 54}, {-4, 54}, {-4, 46}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Inflow.solventFlow, Constant1.y) annotation(Line(points = {{-2, -2}, {-2, 6}, {-7.6, 6}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.CellProtein_Mass, CellProteins.soluteMass) annotation(Line(points = {{-78, 48}, {-80, 48}, {-80, 4}, {-42, 4}, {-42, 10.2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, -3}, {-6, -3}}));
      connect(K.y, Degradation.soluteFlow) annotation(Line(points = {{-42, -41}, {-42, -48.4}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Degradation.q_out, aminoAcids) annotation(Line(points = {{-26, -58}, {42, -58}, {42, 10}, {74, 10}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Text(extent=  {{-106, -102}, {106, -124}}, lineColor=  {0, 0, 255}, textString=  "%name"), Rectangle(extent=  {{-100, 100}, {100, -100}}, lineColor=  {0, 0, 0})}));
    end Proteins;

    model Urea
      extends PhysiolibraryOld.Icons.Urea;
      //extends Library.Interfaces.BaseModel;
      PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow
        ureaFromMetabolism(conc(final unit="mg/ml"), q(final unit="mg/min"))
        annotation (Placement(transformation(extent={{-30,54},{-10,74}}),
            iconTransformation(extent={{50,90},{70,110}})));
      PhysiolibraryOld.ConcentrationFlow.Reabsorbtion reabsorbtion
        annotation (Placement(transformation(extent={{-20,-40},{0,-20}})));
      PhysiolibraryOld.ConcentrationFlow.SolventFlowPump CD_Outflow
        annotation (Placement(transformation(extent={{42,-40},{62,-20}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment Medulla(
          stateName="MedullaUrea.Mass", initialSoluteMass=955.045)
        annotation (Placement(transformation(extent={{22,-66},{42,-46}})));
      PhysiolibraryOld.Blocks.FractConstant fractConstant(k=40) annotation (
          Placement(transformation(
            extent={{-5,-5},{5,5}},
            rotation=180,
            origin={-1,-17})));
      PhysiolibraryOld.ConcentrationFlow.SolventFlowPump VasaRecta_Outflow
        annotation (Placement(transformation(extent={{16,-52},{-4,-72}})));
      PhysiolibraryOld.Blocks.Fract2Constant CCEfficiency(k=98)
        annotation (Placement(transformation(extent={{-30,-94},{-18,-82}})));
      Modelica.Blocks.Math.Product product annotation(Placement(transformation(extent = {{-10, -84}, {2, -72}})));
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{-48,60},{-8,100}}),
            iconTransformation(extent={{-100,20},{-60,60}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment Urea(
          stateName="UreaPool.Mass", initialSoluteMass=7206.24)
        annotation (Placement(transformation(extent={{-14,24},{6,44}})));
      PhysiolibraryOld.ConcentrationFlow.SolventFlowPump Glomerulus annotation (
         Placement(transformation(
            extent={{-10,-10},{10,10}},
            rotation=270,
            origin={-36,-8})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment UreaCell(
          stateName="UreaCell.Mass", initialSoluteMass=13288.1)
        annotation (Placement(transformation(extent={{48,24},{68,44}})));
      PhysiolibraryOld.ConcentrationFlow.ResistorWithCondParam DC(cond=910)
        annotation (Placement(transformation(extent={{14,24},{34,44}})));
      PhysiolibraryOld.ConcentrationFlow.FlowMeasure flowMeasure
        annotation (Placement(transformation(extent={{64,-38},{80,-22}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure osmolarityMeasure(
          unitsString="Osmolarity", toAnotherUnitCoef=16.67)
        annotation (Placement(transformation(extent={{44,-66},{64,-46}})));
      Modelica.Blocks.Math.Gain mg2mosm(k = 0.01667) annotation(Placement(transformation(extent = {{-8, 18}, {-16, 26}})));
      Modelica.Blocks.Math.Gain mg2mosm1(k = 0.01667) annotation(Placement(transformation(extent = {{48, 10}, {40, 18}})));
      Electrolytes.Bladder bladder(stateVarName = "BladderUrea.Mass") annotation(Placement(transformation(extent = {{82, -84}, {102, -64}})));
    equation
      connect(reabsorbtion.Outflow, CD_Outflow.q_in) annotation(Line(points = {{0, -30}, {42, -30}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(reabsorbtion.Outflow, Medulla.q_out) annotation(Line(points = {{0, -30}, {32, -30}, {32, -56}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(fractConstant.y, reabsorbtion.ReabsorbedFract) annotation(Line(points = {{-6.5, -17}, {-10, -17}, {-10, -26}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(VasaRecta_Outflow.q_in, Medulla.q_out) annotation(Line(points = {{16, -62}, {24, -62}, {24, -56}, {32, -56}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(CCEfficiency.y2, product.u2) annotation(Line(points = {{-17.4, -91.12}, {-14, -91.12}, {-14, -81.59999999999999}, {-11.2, -81.59999999999999}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(product.y, VasaRecta_Outflow.solventFlow) annotation(Line(points = {{2.6, -78}, {6, -78}, {6, -68}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.CD_H2O_Outflow, CD_Outflow.solventFlow) annotation(Line(points = {{-28, 80}, {-28, 0}, {52, 0}, {52, -24}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.Medulla_Volume, Medulla.SolventVolume) annotation(Line(points = {{-28, 80}, {-28, -50}, {24, -50}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(Glomerulus.q_out, reabsorbtion.Inflow) annotation(Line(points = {{-36, -18}, {-36, -30}, {-20, -30}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(Urea.q_out, Glomerulus.q_in) annotation(Line(points = {{-4, 34}, {-36, 34}, {-36, 2}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(VasaRecta_Outflow.q_out, Urea.q_out) annotation(Line(points = {{-4, -62}, {-54, -62}, {-54, 34}, {-4, 34}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(reabsorbtion.Reabsorbtion, Urea.q_out) annotation(Line(points = {{-10, -34}, {-10, -62}, {-54, -62}, {-54, 34}, {-4, 34}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(ureaFromMetabolism, Urea.q_out) annotation(Line(points = {{-20, 64}, {-4, 64}, {-4, 34}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(busConnector.ICFV_Vol, UreaCell.SolventVolume) annotation(Line(points = {{-28, 80}, {-28, 74}, {28, 74}, {28, 40}, {50, 40}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(Urea.q_out, DC.q_in) annotation(Line(points = {{-4, 34}, {15.4, 34}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(DC.q_out, UreaCell.q_out) annotation(Line(points = {{32.6, 34}, {58, 34}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(busConnector.ECFV_Vol, Urea.SolventVolume) annotation(Line(points = {{-28, 80}, {-28, 40}, {-12, 40}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.VasaRecta_Outflow, product.u1) annotation(Line(points = {{-28, 80}, {-28, -74.40000000000001}, {-11.2, -74.40000000000001}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(CD_Outflow.q_out, flowMeasure.q_in) annotation(Line(points = {{62, -30}, {68.8, -30}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(flowMeasure.actualFlow, busConnector.CD_Urea_Outflow) annotation(Line(points = {{72, -26}, {72, 80}, {-28, 80}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(Medulla.q_out, osmolarityMeasure.q_in) annotation(Line(points = {{32, -56}, {54, -56}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(osmolarityMeasure.actualConc, busConnector.MedullaUrea_Osmolarity) annotation(Line(points = {{54, -52}, {54, -44}, {100, -44}, {100, 80}, {-28, 80}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(Urea.soluteMass, mg2mosm.u) annotation(Line(points = {{-4, 26.2}, {-4, 22}, {-7.2, 22}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.UreaECF_Osmoles, mg2mosm.y) annotation(Line(points = {{-28, 80}, {-28, 22}, {-16.4, 22}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(UreaCell.soluteMass, mg2mosm1.u) annotation(Line(points = {{58, 26.2}, {58, 14}, {48.8, 14}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.UreaICF_Osmoles, mg2mosm1.y) annotation(Line(points = {{-28, 80}, {-28, 14}, {39.6, 14}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(flowMeasure.q_out, bladder.q_in) annotation(Line(points = {{75.2, -30}, {92, -30}, {92, -66}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(bladder.busConnector, busConnector) annotation(Line(points = {{100, -66}, {100, 80}, {-28, 80}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(Glomerulus.solventFlow, busConnector.GlomerulusFiltrate_GFR) annotation(Line(points = {{-30, -8}, {-28, -8}, {-28, 80}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Text(extent=  {{-144, -16}, {176, -44}}, lineColor=  {0, 0, 255}, textString=  "%name"), Rectangle(extent=  {{-100, 100}, {100, -100}}, lineColor=  {0, 0, 0})}));
    end Urea;

    model KetoAcids
      // extends Library.Interfaces.BaseModel;
      extends PhysiolibraryOld.Icons.KetoAcids;
      PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment KAPool(
          stateName="KAPool.Mass", initialSoluteMass=316.7) "mg/ml"
        annotation (Placement(transformation(extent={{-32,14},{-12,34}})));
      PhysiolibraryOld.ConcentrationFlow.InputPump KAPump
        annotation (Placement(transformation(extent={{-74,32},{-54,52}})));
      PhysiolibraryOld.ConcentrationFlow.SolventFlowPump glomerulusKARate
        annotation (Placement(transformation(extent={{-18,-56},{2,-36}})));
      Electrolytes.Phosphate.GlomerulusStrongAnionFiltration glomerulus annotation(Placement(transformation(extent = {{-42, -56}, {-22, -36}})));
      PhysiolibraryOld.ConcentrationFlow.FractReabsorbtion NephronKetoacids(
          MaxReab=30)
        annotation (Placement(transformation(extent={{42,-56},{62,-36}})));
      PhysiolibraryOld.Blocks.Constant Constant(k=1)
        annotation (Placement(transformation(extent={{70,-38},{62,-30}})));
      PhysiolibraryOld.Factors.CurveValue PhEffect(data={{7.0,0.0,0},{7.4,1.0,0}})
        annotation (Placement(transformation(extent={{16,-36},{36,-16}})));
      PhysiolibraryOld.Blocks.Constant Constant1(k=1)
        annotation (Placement(transformation(extent={{38,-22},{30,-14}})));
      PhysiolibraryOld.ConcentrationFlow.OutputPump KADecomposition
        annotation (Placement(transformation(extent={{-50,26},{-70,6}})));
      Modelica.Blocks.Math.Gain K(k = 0.0007) annotation(Placement(transformation(extent = {{-26, 6}, {-32, 12}})));
      PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow q_out(conc(
            final unit="mg/ml"), q(final unit="mg/min")) annotation (Placement(
            transformation(extent={{-88,54},{-48,94}}), iconTransformation(
              extent={{-10,-70},{10,-50}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
        concentrationMeasure(unitsString="mmol/l", toAnotherUnitCoef=
            9.800000000000001) annotation (Placement(transformation(
            extent={{-10,-10},{10,10}},
            rotation=0,
            origin={-8,32})));
      PhysiolibraryOld.ConcentrationFlow.FlowMeasure flowMeasure
        annotation (Placement(transformation(extent={{70,-56},{90,-36}})));
      Modelica.Blocks.Math.Gain gain1(k = 0.0098) annotation(Placement(transformation(extent = {{-10, 12}, {-6, 16}})));
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{-96,82},{-76,102}}),
            iconTransformation(extent={{-100,90},{-80,110}})));
      PhysiolibraryOld.Blocks.MassFlowConstant electrolytesFlowConstant4(k=0)
        annotation (Placement(transformation(extent={{-78,48},{-72,54}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
        concentrationMeasure1(unitsString="mg/dl", toAnotherUnitCoef=100.0)
        annotation (Placement(transformation(
            extent={{-10,-10},{10,10}},
            rotation=0,
            origin={-8,44})));
      PhysiolibraryOld.ConcentrationFlow.FlowMeasure flowMeasure1
        annotation (Placement(transformation(extent={{-40,42},{-20,62}})));
      Modelica.Blocks.Math.Gain MG_TO_MMOL(k = 0.0098) annotation(Placement(transformation(extent = {{-6, -6}, {6, 6}}, rotation = 90, origin = {-30, 68})));
      Electrolytes.Bladder bladder(stateVarName = "BladderKetoacid.Mass") annotation(Placement(transformation(extent = {{78, -100}, {98, -80}})));
    equation
      connect(glomerulus.q_out, glomerulusKARate.q_in) annotation(Line(points = {{-22, -46}, {-18, -46}}, color = {0, 0, 0}, smooth = Smooth.None, thickness = 1));
      connect(glomerulusKARate.q_out, NephronKetoacids.Inflow) annotation(Line(points = {{2, -46}, {42, -46}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
      connect(NephronKetoacids.Effects, Constant.y) annotation(Line(points = {{60, -42}, {60, -34}, {61.6, -34}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Constant1.y, PhEffect.yBase) annotation(Line(points = {{29.6, -18}, {26, -18}, {26, -24}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(KAPool.soluteMass, K.u) annotation(Line(points = {{-22, 16.2}, {-22, 9}, {-25.4, 9}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(K.y, KADecomposition.desiredFlow) annotation(Line(points = {{-32.3, 9}, {-60, 9}, {-60, 12}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(KAPool.q_out, concentrationMeasure.q_in) annotation(Line(points = {{-22, 24}, {-16, 24}, {-16, 32}, {-8, 32}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
      connect(NephronKetoacids.Outflow, flowMeasure.q_in) annotation(Line(points = {{62, -46}, {76, -46}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
      connect(KAPool.soluteMass, gain1.u) annotation(Line(points = {{-22, 16.2}, {-22, 14}, {-10.4, 14}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(KAPool.SolventVolume, busConnector.ECFV_Vol) annotation(Line(points = {{-30, 30}, {-84, 30}, {-84, 92}, {-86, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(PhEffect.u, busConnector.BloodPh_ArtysPh) annotation(Line(points = {{16.2, -26}, {-84, -26}, {-84, 92}, {-86, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.BloodIons_Cations, glomerulus.Cations) annotation(Line(points = {{-86, 92}, {-84, 92}, {-84, -28}, {-38, -28}, {-38, -41}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(gain1.y, busConnector.KAPool_Osmoles) annotation(Line(points = {{-5.8, 14}, {81.09999999999999, 14}, {81.09999999999999, 92}, {-86, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(electrolytesFlowConstant4.y, KAPump.desiredFlow) annotation(Line(points = {{-71.7, 51}, {-64, 51}, {-64, 46}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(flowMeasure.actualFlow, busConnector.CD_KA_Outflow) annotation(Line(points = {{80, -41}, {80, 92}, {-86, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(KAPool.q_out, concentrationMeasure1.q_in) annotation(Line(points = {{-22, 24}, {-16, 24}, {-16, 44}, {-8, 44}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(concentrationMeasure.actualConc, busConnector.KAPool_conc_per_liter) annotation(Line(points = {{-8, 36}, {80, 36}, {80, 92}, {-86, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(KAPump.q_out, flowMeasure1.q_in) annotation(Line(points = {{-58, 42}, {-46, 42}, {-46, 52}, {-34, 52}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(KADecomposition.q_in, flowMeasure1.q_in) annotation(Line(points = {{-54, 16}, {-46, 16}, {-46, 52}, {-34, 52}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(q_out, flowMeasure1.q_in) annotation(Line(points = {{-68, 74}, {-46, 74}, {-46, 52}, {-34, 52}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(flowMeasure1.q_out, KAPool.q_out) annotation(Line(points = {{-26, 52}, {-22, 52}, {-22, 24}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(flowMeasure1.actualFlow, MG_TO_MMOL.u) annotation(Line(points = {{-30, 57}, {-30, 60.8}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(PhEffect.y, NephronKetoacids.Normal) annotation(Line(points = {{26, -28}, {26, -32}, {46, -32}, {46, -42}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(KAPool.q_out, glomerulus.q_in) annotation(Line(points = {{-22, 24}, {6, 24}, {6, -4}, {-62, -4}, {-62, -46}, {-42, -46}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(NephronKetoacids.Reabsorbtion, KAPool.q_out) annotation(Line(points = {{52, -50}, {52, -70}, {-62, -70}, {-62, -4}, {6, -4}, {6, 24}, {-22, 24}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(busConnector.BloodIons_ProteinAnions, glomerulus.ProteinAnions) annotation(Line(points = {{-86, 92}, {-84, 92}, {-84, -28}, {-34, -28}, {-34, -41}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(MG_TO_MMOL.y, busConnector.KA_Change_mmol_per_min) annotation(Line(points = {{-30, 74.59999999999999}, {-30, 92}, {-86, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(flowMeasure.q_out, bladder.q_in) annotation(Line(points = {{84, -46}, {88, -46}, {88, -82}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(bladder.busConnector, busConnector) annotation(Line(points = {{96, -82}, {96, 92}, {-86, 92}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(glomerulusKARate.solventFlow, busConnector.GlomerulusFiltrate_GFR) annotation(Line(points = {{-8, -40}, {-8, -28}, {-84, -28}, {-84, 92}, {-86, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(concentrationMeasure1.actualConc, busConnector.KAPool_mg_per_dl) annotation(Line(points = {{-8, 48}, {-8, 52}, {80, 52}, {80, 92}, {-86, 92}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Text(extent=  {{-80, -18}, {-64, -20}}, lineColor=  {0, 0, 0}, textString=  "StrongAnions")}), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Text(extent=  {{-162, -98}, {158, -126}}, lineColor=  {0, 0, 255}, textString=  "%name"), Rectangle(extent=  {{-100, 100}, {100, -100}}, lineColor=  {0, 0, 0})}));
    end KetoAcids;

    model Lipids
      // extends Library.Interfaces.BaseModel;
      extends PhysiolibraryOld.Icons.Lipids;
      //outer parameter Real EFC_Vol(final unit="ml");
      PhysiolibraryOld.ConcentrationFlow.MassStorageCompartment LipidDeposits(
          stateName="LipidDeposits.Mass", initialSoluteMass=12032.4)
        annotation (Placement(transformation(extent={{98,12},{78,32}})));
      PhysiolibraryOld.ConcentrationFlow.SimpleReaction FA_TO_Lipids
        annotation (Placement(transformation(extent={{50,12},{70,32}})));
      PhysiolibraryOld.ConcentrationFlow.SoluteFlowPump LipidDeposits_Uptake
        annotation (Placement(transformation(extent={{6,32},{26,52}})));
      PhysiolibraryOld.ConcentrationFlow.SoluteFlowPump LipidDeposits_Release
        annotation (Placement(transformation(extent={{26,-18},{6,2}})));
      PhysiolibraryOld.Blocks.MassFlowConstant massFlowConstant2(k=100)
        annotation (Placement(transformation(extent={{32,58},{22,68}})));
      PhysiolibraryOld.Factors.SplineValue2 InsulinEffect(data={{0,0.5,0.0},{20,
            1.0,0.03},{100,2.0,0.0}}, curve(iFrom(start=2)))
        annotation (Placement(transformation(extent={{6,44},{26,64}})));
      PhysiolibraryOld.Factors.SplineValue2 FattyAcidEffect(data={{0,0.0,0.0},{
            15,1.0,0.1},{50,3.0,0.0}}, curve(iFrom(start=2)))
        annotation (Placement(transformation(extent={{6,40},{26,60}})));
      PhysiolibraryOld.Blocks.Constant massFlowConstant5(k=0.009299999999999999)
        annotation (Placement(transformation(extent={{-14,18},{-6,26}})));
      PhysiolibraryOld.Factors.SplineValue2 GlucagonEffect(data={{120,1.0,0.0},
            {200,2.0,0.0}})
        annotation (Placement(transformation(extent={{6,-2},{26,18}})));
      PhysiolibraryOld.Factors.SplineValue2 InsulinEffect_(data={{0,2.0,0.0},{
            20,1.0,-0.04},{100,0.0,0.0}}, curve(iFrom(start=2)))
        annotation (Placement(transformation(extent={{6,2},{26,22}})));
      PhysiolibraryOld.Factors.SplineValue2 EpinephrineEffect(data={{0,0.5,0.0},
            {40,1.0,0.013},{400,4.0,0.0}})
        annotation (Placement(transformation(extent={{6,-6},{26,14}})));
      PhysiolibraryOld.Blocks.Constant Constant1(k=0.001)
        annotation (Placement(transformation(extent={{50,28},{58,36}})));
      PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow FattyAcids(
          conc(final unit="mg/ml"), q(final unit="mg/min"))
        "extracellular storage" annotation (Placement(transformation(extent={{-76,
                -54},{-56,-34}}), iconTransformation(extent={{-10,-10},{10,10}})));
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{-108,86},{-88,106}}),
            iconTransformation(extent={{-90,-48},{-70,-28}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
        concentrationMeasure(unitsString="mg/dl", toAnotherUnitCoef=100)
        "from mg/ml to mg/dl"
        annotation (Placement(transformation(extent={{-16,-18},{4,2}})));
      PhysiolibraryOld.Factors.SimpleMultiply Fraction
        annotation (Placement(transformation(extent={{6,6},{26,26}})));
      PhysiolibraryOld.Factors.SplineValue2 FattyAcidEffect_(data={{0,3.0,0.0},
            {15,1.0,-0.04},{100,0.0,0.0}})
        annotation (Placement(transformation(extent={{6,-10},{26,10}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment Triglyceride(
          stateName="TriglyceridePool.Mass", initialSoluteMass=17000)
        annotation (Placement(transformation(extent={{-56,58},{-76,78}})));
      Modelica.Blocks.Math.Gain K(k = 0.0007) annotation(Placement(transformation(extent = {{-62, 46}, {-56, 52}})));
      PhysiolibraryOld.ConcentrationFlow.OutputPump Decomposition
        annotation (Placement(transformation(extent={{-62,30},{-42,50}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
        concentrationMeasure1(unitsString="mg/dl", toAnotherUnitCoef=100)
        "from mg/ml to mg/dl"
        annotation (Placement(transformation(extent={{-16,32},{4,52}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment FAPool(
          stateName="FAPool.Mass", initialSoluteMass=2400) "mg/ml"
        annotation (Placement(transformation(extent={{0,-64},{20,-44}})));
      PhysiolibraryOld.ConcentrationFlow.OutputPump FADecomposition
        annotation (Placement(transformation(extent={{16,-90},{36,-70}})));
      Modelica.Blocks.Math.Gain K1(k = 0.0007) annotation(Placement(transformation(extent = {{16, -74}, {22, -68}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
        concentrationMeasure2 annotation (Placement(transformation(
            extent={{-10,-10},{10,10}},
            rotation=270,
            origin={24,-48})));
      Modelica.Blocks.Math.Gain gain(k = 3.92, y(final unit = "mmol/l")) annotation(Placement(transformation(extent = {{34, -50}, {38, -46}})));
      PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow
        toTriglicerides(conc(final unit="mg/ml"), q(final unit="mg/min"))
        "from GILumen" annotation (Placement(transformation(extent={{-106,74},{
                -86,94}}), iconTransformation(extent={{-10,-90},{10,-70}})));
      PhysiolibraryOld.ConcentrationFlow.SoluteFlowPump TriglycerideHydrolysis
        annotation (Placement(transformation(
            extent={{-10,-10},{10,10}},
            rotation=270,
            origin={-66,4})));
      PhysiolibraryOld.Factors.CurveValue TriglycerideEffect1(data={{0,0.0,0.0},
            {100,1.0,0.03},{200,3.0,0.0}}, curve(iFrom(start=2))) annotation (
          Placement(transformation(
            extent={{-10,-10},{10,10}},
            rotation=270,
            origin={-56,4})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
        concentrationMeasure3(unitsString="mg/dl", toAnotherUnitCoef=100)
        "from mg/ml to mg/dl" annotation (Placement(transformation(
            extent={{-10,-10},{10,10}},
            rotation=270,
            origin={-66,18})));
      PhysiolibraryOld.ConcentrationFlow.SimpleReaction TRIG_TO_FFA annotation (
         Placement(transformation(
            extent={{10,-10},{-10,10}},
            rotation=90,
            origin={-66,-20})));
      PhysiolibraryOld.Blocks.Constant Constant2(k=0.89)
        annotation (Placement(transformation(extent={{-94,-24},{-86,-16}})));
      PhysiolibraryOld.Blocks.MassFlowConstant massFlowConstant1(k=100)
        annotation (Placement(transformation(extent={{-38,-2},{-48,8}})));
      PhysiolibraryOld.ConcentrationFlow.SimpleReaction FFA_TO_TRIG annotation (
         Placement(transformation(
            extent={{-10,-10},{10,10}},
            rotation=180,
            origin={-78,84})));
      PhysiolibraryOld.Blocks.Constant massFlowConstant3(k=0.0075)
        annotation (Placement(transformation(extent={{-24,26},{-16,34}})));
    equation
      connect(FA_TO_Lipids.q_out, LipidDeposits.q_out) annotation(Line(points = {{70, 22}, {88, 22}}, color = {255, 0, 0}, smooth = Smooth.None, thickness = 1));
      connect(InsulinEffect.y, FattyAcidEffect.yBase) annotation(Line(points = {{16, 52}, {16, 52}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(EpinephrineEffect.yBase, GlucagonEffect.y) annotation(Line(points = {{16, 6}, {16, 6}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Constant1.y, FA_TO_Lipids.coef) annotation(Line(points = {{58.4, 32}, {60, 32}, {60, 26}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(LipidDeposits_Release.q_in, FA_TO_Lipids.q_in) annotation(Line(points = {{26, -8}, {42, -8}, {42, 22}, {50, 22}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(LipidDeposits_Uptake.q_out, FA_TO_Lipids.q_in) annotation(Line(points = {{26, 42}, {42, 42}, {42, 22}, {50, 22}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(FattyAcids, concentrationMeasure.q_in) annotation(Line(points = {{-66, -44}, {-30, -44}, {-30, -8}, {-6, -8}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(massFlowConstant2.y, InsulinEffect.yBase) annotation(Line(points = {{21.5, 63}, {16, 63}, {16, 56}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.Insulin, InsulinEffect.u) annotation(Line(points = {{-98, 96}, {-28, 96}, {-28, 54}, {6.2, 54}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(FattyAcidEffect.y, LipidDeposits_Uptake.soluteFlow) annotation(Line(points = {{16, 48}, {16, 48}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Fraction.y, InsulinEffect_.yBase) annotation(Line(points = {{16, 14}, {16, 14}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.Insulin, InsulinEffect_.u) annotation(Line(points = {{-98, 96}, {-28, 96}, {-28, 12}, {6.2, 12}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(GlucagonEffect.yBase, InsulinEffect_.y) annotation(Line(points = {{16, 10}, {16, 10}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.Glucagon_conc, GlucagonEffect.u) annotation(Line(points = {{-98, 96}, {-28, 96}, {-28, 8}, {6.2, 8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.EpiPool_Epi, EpinephrineEffect.u) annotation(Line(points = {{-98, 96}, {-28, 96}, {-28, 4}, {6.2, 4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(LipidDeposits_Release.soluteFlow, FattyAcidEffect_.y) annotation(Line(points = {{16, -2}, {16, -2}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(EpinephrineEffect.y, FattyAcidEffect_.yBase) annotation(Line(points = {{16, 2}, {16, 2}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(concentrationMeasure.actualConc, FattyAcidEffect_.u) annotation(Line(points = {{-6, -4}, {-6, 0}, {6.2, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(FattyAcids, LipidDeposits_Release.q_out) annotation(Line(points = {{-66, -44}, {-30, -44}, {-30, -8}, {6, -8}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(K.y, Decomposition.desiredFlow) annotation(Line(points = {{-55.7, 49}, {-52, 49}, {-52, 44}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(K.u, Triglyceride.soluteMass) annotation(Line(points = {{-62.6, 49}, {-66, 49}, {-66, 60.2}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Decomposition.q_in, Triglyceride.q_out) annotation(Line(points = {{-58, 40}, {-66, 40}, {-66, 68}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(Triglyceride.SolventVolume, busConnector.ECFV_Vol) annotation(Line(points = {{-58, 74}, {-38, 74}, {-38, 96}, {-98, 96}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(concentrationMeasure1.actualConc, FattyAcidEffect.u) annotation(Line(points = {{-6, 46}, {-6, 50}, {6.2, 50}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(FAPool.SolventVolume, busConnector.ECFV_Vol) annotation(Line(points = {{2, -48}, {-96, -48}, {-96, 96}, {-98, 96}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(FAPool.soluteMass, K1.u) annotation(Line(points = {{10, -61.8}, {10, -71}, {15.4, -71}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(K1.y, FADecomposition.desiredFlow) annotation(Line(points = {{22.3, -71}, {26, -71}, {26, -76}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(concentrationMeasure2.actualConc, gain.u) annotation(Line(points = {{28, -48}, {33.6, -48}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(gain.y, busConnector.FAPool_conc_per_liter) annotation(Line(points = {{38.2, -48}, {99.09999999999999, -48}, {99.09999999999999, 96}, {-98, 96}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(FAPool.q_out, concentrationMeasure2.q_in) annotation(Line(points = {{10, -54}, {16, -54}, {16, -48}, {24, -48}}, color = {200, 0, 0}, smooth = Smooth.None));
      connect(FAPool.q_out, FattyAcids) annotation(Line(points = {{10, -54}, {-30, -54}, {-30, -44}, {-66, -44}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(TriglycerideEffect1.y, TriglycerideHydrolysis.soluteFlow) annotation(Line(points = {{-58, 4}, {-59, 4}, {-59, 4}, {-60, 4}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Triglyceride.q_out, TriglycerideHydrolysis.q_in) annotation(Line(points = {{-66, 68}, {-66, 14}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(Triglyceride.q_out, concentrationMeasure3.q_in) annotation(Line(points = {{-66, 68}, {-66, 18}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(Constant2.y, TRIG_TO_FFA.coef) annotation(Line(points = {{-85.59999999999999, -20}, {-70, -20}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(TRIG_TO_FFA.q_out, FattyAcids) annotation(Line(points = {{-66, -30}, {-66, -44}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(TRIG_TO_FFA.q_in, TriglycerideHydrolysis.q_out) annotation(Line(points = {{-66, -10}, {-66, -6}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(TriglycerideEffect1.yBase, massFlowConstant1.y) annotation(Line(points = {{-54, 4}, {-52.75, 4}, {-52.75, 3}, {-48.5, 3}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(FattyAcids, LipidDeposits_Uptake.q_in) annotation(Line(points = {{-66, -44}, {-30, -44}, {-30, 42}, {6, 42}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(concentrationMeasure1.q_in, FattyAcids) annotation(Line(points = {{-6, 42}, {-30, 42}, {-30, -44}, {-66, -44}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(FFA_TO_TRIG.q_out, toTriglicerides) annotation(Line(points = {{-88, 84}, {-96, 84}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(FFA_TO_TRIG.q_in, Triglyceride.q_out) annotation(Line(points = {{-68, 84}, {-66, 84}, {-66, 68}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(Constant2.y, FFA_TO_TRIG.coef) annotation(Line(points = {{-85.59999999999999, -20}, {-84, -20}, {-84, 80}, {-78, 80}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(FAPool.q_out, FADecomposition.q_in) annotation(Line(points = {{10, -54}, {-2, -54}, {-2, -80}, {20, -80}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(concentrationMeasure3.actualConc, TriglycerideEffect1.u) annotation(Line(points = {{-62, 18}, {-56, 18}, {-56, 13.8}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(LipidDeposits.soluteMass, busConnector.LipidDeposits_Mass) annotation(Line(points = {{88, 14.6}, {88, 6}, {100, 6}, {100, 96}, {-98, 96}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(LipidDeposits.soluteMass, Fraction.yBase) annotation(Line(points = {{88, 14.6}, {88, 6}, {32, 6}, {32, 22}, {16, 22}, {16, 18}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(massFlowConstant3.y, Fraction.u) annotation(Line(points = {{-15.6, 30}, {-4, 30}, {-4, 16}, {6.2, 16}}, color = {0, 0, 127}, smooth = Smooth.None));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}, grid = {2, 2}), graphics = {Text(extent=  {{80, 36}, {90, 34}}, lineColor=  {0, 0, 0}, textString=  "[g]")}), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}, grid = {2, 2}), graphics = {Text(extent=  {{-168, -100}, {152, -128}}, lineColor=  {0, 0, 255}, textString=  "%name"), Rectangle(extent=  {{-100, 100}, {100, -100}}, lineColor=  {0, 0, 0})}));
    end Lipids;

    block Glucose_MG_TO_MMOL "convert glucose units from mg to mmol "
      // extends Modelica.SIunits.Conversions.ConversionIcon;
      PhysiolibraryOld.Interfaces.RealInput_ u annotation (Placement(
            transformation(extent={{-122,-20},{-82,20}}), iconTransformation(
              extent={{-120,-20},{-80,20}})));
      PhysiolibraryOld.Interfaces.RealOutput_ y annotation (Placement(
            transformation(extent={{50,-20},{90,20}}), iconTransformation(
              extent={{100,-20},{140,20}})));
      constant Real MG_TO_MMOL = 5.551;
    equation
      y = MG_TO_MMOL * u;
      annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Rectangle(extent=  {{-100, 100}, {100, -100}}, lineColor=  {191, 0, 0}, fillColor=  {255, 255, 255}, fillPattern=  FillPattern.Solid), Line(points=  {{-90, 0}, {30, 0}}, color=  {191, 0, 0}), Polygon(points=  {{90, 0}, {30, 20}, {30, -20}, {90, 0}}, lineColor=  {191, 0, 0}, fillColor=  {191, 0, 0}, fillPattern=  FillPattern.Solid), Text(extent=  {{-115, 155}, {115, 105}}, textString=  "%name", lineColor=  {0, 0, 255}), Text(extent=  {{-42, -52}, {98, -98}}, lineColor=  {0, 0, 0}, fillColor=  {0, 0, 0}, fillPattern=  FillPattern.Solid, textString=  "mmol"), Text(extent=  {{-98, 98}, {-34, 58}}, lineColor=  {0, 0, 0}, fillColor=  {0, 0, 0}, fillPattern=  FillPattern.Solid, textString=  "mg")}));
    end Glucose_MG_TO_MMOL;

    model Lactate
      extends PhysiolibraryOld.Icons.Lactate;
      // extends Library.Interfaces.BaseModel;
      //outer parameter Real EFC_Vol(final unit="ml");
      PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow Lactate(q(
            final unit="mEq/min"), conc(
          final unit="mEq/ml",
          min=0,
          start=0)) "extracellular storage" annotation (Placement(
            transformation(extent={{-74,-18},{-54,2}}), iconTransformation(
              extent={{-10,-10},{10,10}})));
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{-108,86},{-88,106}}),
            iconTransformation(extent={{-90,-70},{-70,-50}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment Lactate1(
        initialSoluteMass(unit="mmol/ml") = 0,
        stateName="LacPool.Mass",
        soluteMass(start=0, fixed=false))
        annotation (Placement(transformation(extent={{-26,-42},{-6,-22}})));
      PhysiolibraryOld.ConcentrationFlow.FlowMeasure flowMeasure annotation (
          Placement(transformation(
            extent={{-6,-6},{6,6}},
            rotation=270,
            origin={-16,-16})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
        concentrationMeasure(unitsString="mEq/l", toAnotherUnitCoef=1000)
        annotation (Placement(transformation(extent={{-10,-36},{10,-16}})));
      Modelica.Blocks.Math.Gain to_mmol(k = 1) annotation(Placement(transformation(extent = {{-8, -18}, {-4, -14}})));
    equation
      connect(busConnector.ECFV_Vol, Lactate1.SolventVolume) annotation(Line(points = {{-98, 96}, {-34, 96}, {-34, -26}, {-24, -26}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(concentrationMeasure.actualConc, busConnector.LacPool_Lac_mEq_per_litre) annotation(Line(points = {{0, -22}, {72, -22}, {72, 96}, {-98, 96}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(to_mmol.y, busConnector.LactateFromTissues) annotation(Line(points = {{-3.8, -16}, {72, -16}, {72, 96}, {-98, 96}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(flowMeasure.actualFlow, to_mmol.u) annotation(Line(points = {{-13, -16}, {-8.4, -16}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Lactate, flowMeasure.q_in) annotation(Line(points = {{-64, -8}, {-16, -8}, {-16, -13.6}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(Lactate1.soluteMass, busConnector.LacPool_Mass_mEq) annotation(Line(points = {{-16, -39.8}, {-16, -46}, {74, -46}, {74, 96}, {-98, 96}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(Lactate1.q_out, flowMeasure.q_out) annotation(Line(points = {{-16, -32}, {-16, -18.4}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(Lactate1.q_out, concentrationMeasure.q_in) annotation(Line(points = {{-16, -32}, {-16, -26}, {0, -26}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}, grid = {2, 2}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}, grid = {2, 2}), graphics = {Text(extent=  {{-168, -100}, {152, -128}}, lineColor=  {0, 0, 255}, textString=  "%name"), Rectangle(extent=  {{-100, 100}, {100, -100}}, lineColor=  {0, 0, 0})}));
    end Lactate;

    model AminoAcids
      extends PhysiolibraryOld.Icons.AminoAcids;
      // extends Library.Interfaces.BaseModel;
      //outer parameter Real EFC_Vol(final unit="ml");
      PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow AminoAcids(
          conc(final unit="mg/ml"), q(final unit="mg/min"))
        "extracellular storage" annotation (Placement(transformation(extent={{-72,
                -20},{-52,0}}), iconTransformation(extent={{-18,-90},{2,-70}})));
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{-108,86},{-88,106}}),
            iconTransformation(extent={{-90,-10},{-70,10}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment
        AminoAcidsPool(stateName="AAPool.Mass", initialSoluteMass=6617.84)
        annotation (Placement(transformation(extent={{-2,6},{18,26}})));
    equation
      connect(AminoAcids, AminoAcidsPool.q_out) annotation(Line(points = {{-62, -10}, {-28, -10}, {-28, 16}, {8, 16}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(busConnector.ECFV_Vol, AminoAcidsPool.SolventVolume) annotation(Line(points = {{-98, 96}, {-96, 96}, {-96, 22}, {0, 22}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}, grid = {2, 2}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}, grid = {2, 2}), graphics = {Text(extent=  {{-168, -100}, {152, -128}}, lineColor=  {0, 0, 255}, textString=  "%name"), Rectangle(extent=  {{-100, 100}, {100, -100}}, lineColor=  {0, 0, 0})}));
    end AminoAcids;

    model Glycogen
      extends PhysiolibraryOld.ConcentrationFlow.MassStorageCompartment(
                                                                     stateName = "LM_Glycogen.Mass");
      extends PhysiolibraryOld.Icons.Glycogen;
      annotation(Icon(graphics));
    end Glycogen;

    model CellularMetabolism
      extends PhysiolibraryOld.Icons.CellularMetabolism;
      parameter Boolean canBurnFattyAcids = true;
      parameter Real eTOglu_coef(unit = "g/kcal") = 0.2439
        "how much carbohydrates will be produced with one kilocalorie";
      parameter Real eTOlac_coef(unit = "g/kcal") = 0.2538
        "how much lactate will produce one kilocalorie";
      parameter Real eTOfat_coef(unit = "g/kcal") = 0.1075
        "how much fatty acids will produce one kilocalorie";
      parameter Real eTOketo_coef(unit = "g/kcal") = 0.1075
        "how much ketoacids will produce one kilocalorie";
      parameter Real eTOo2_coef(unit = "ml/kcal") = 0.2093
        "how much oxygen will be produced with one kilocalorie";
      parameter Real RQglu(unit = "1") = 1
        "how much CO2 will be produced with one oxygen by glucose burning";
      parameter Real RQlac(unit = "1") = 1
        "how much CO2 will be produced with one oxygen by lactate burning";
      parameter Real RQfat(unit = "1") = 0.7
        "how much CO2 will be produced with one oxygen by fatty acid burning";
      parameter Real RQketo(unit = "1") = 0.7
        "how much CO2 will be produced with one oxygen by keto acid burning";
      parameter Real lacDensity(unit = "g/mmol") = 90.08 "density of lactate";
      parameter Real glu2lac(unit = "mEq/g") = 1.0 / lacDensity
        "how much lactate will produce one gram of glucose";
      parameter Real anaerobic_glu2energy(unit = "kcal/g") = 1.0 / eTOglu_coef - 1.0 / eTOlac_coef
        "how much energy in callories will produce one unit of reactant by anaerobic metabolism";
      // 0.1577
      parameter Real[:, 3] LacFractionData
        "fraction of oxygen to be use for lactate metabolism (depends on lactate concentration)";
      //  parameter Real[:,3] PO2OnAerobicFractionData
      //    "Aerobic Fraction of O2 tissue use depents on pO2";
      parameter Real[:, 3] PO2OnAerobicFractionData = {{2, 0, 0}, {10, 1, 0}}
        "Aerobic Fraction of O2 tissue use depents on pO2";
      PhysiolibraryOld.Curves.Curve LacFraction(
        x=LacFractionData[:, 1],
        y=LacFractionData[:, 2],
        slope=LacFractionData[:, 3]) annotation (Placement(transformation(
            extent={{-10,-10},{10,10}},
            rotation=0,
            origin={-10,52})));
      PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow lactate(q(
            final unit="mEq/min"), conc(final unit="mEq/ml")) "in mEq/ml"
        annotation (Placement(transformation(extent={{46,47},{66,67}}),
            iconTransformation(extent={{-76,90},{-56,110}})));
      PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow glucose(q(
            final unit="mg/min"), conc(final unit="mg/ml")) "in mg/ml"
        annotation (Placement(transformation(extent={{45,-4},{65,16}}),
            iconTransformation(extent={{-110,70},{-90,90}})));
      PhysiolibraryOld.Interfaces.RealOutput_ Tissue_CO2FromMetabolism
        annotation (Placement(transformation(extent={{98,58},{106,66}}),
            iconTransformation(extent={{74,-20},{114,20}})));
      PhysiolibraryOld.Interfaces.RealOutput_ Tissue_MotabolicH2ORate(unit=
            "ml/min") annotation (Placement(transformation(extent={{90,-98},{
                100,-88}}), iconTransformation(
            extent={{-20,-20},{20,20}},
            rotation=270,
            origin={14,-98})));
      PhysiolibraryOld.Interfaces.RealInput_ CalsUse(unit="kcal/min")
        annotation (Placement(transformation(extent={{46,-86},{56,-76}}),
            iconTransformation(
            extent={{-20,-20},{20,20}},
            rotation=270,
            origin={40,100})));
      PhysiolibraryOld.Curves.Curve AerobicFraction(
        x=PO2OnAerobicFractionData[:, 1],
        y=PO2OnAerobicFractionData[:, 2],
        slope=PO2OnAerobicFractionData[:, 3])
        annotation (Placement(transformation(extent={{-80,-20},{-60,0}})));
      PhysiolibraryOld.Interfaces.RealInput_ pO2(unit="mmHg") annotation (
          Placement(transformation(
            extent={{-4.57101,-4.57142},{11.4274,11.4284}},
            rotation=0,
            origin={-93.42700000000001,6.5716}), iconTransformation(
            extent={{-11.4284,-11.4285},{28.5715,28.5715}},
            rotation=0,
            origin={-104.572,-48.5715})));
      //  Real O2Use;
      Real O2UseByGlu;
      Real O2UseByLac;
      Real O2UseByFA;
      //if canBurnFattyAcids;
      Real FAfraction;
      //if canBurnFattyAcids;
      Real O2UseByKA;
      //if not canBurnFattyAcids;
      Real KAfraction;
      // if not canBurnFattyAcids;
      Real Ratio;
      Real AnaerobicCals;
      PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow fattyAcids(q(
            final unit="mg/min"), conc(final unit="mg/ml")) "in mg/ml"
        annotation (Placement(transformation(extent={{45,-60},{65,-40}}),
            iconTransformation(extent={{-110,-10},{-90,10}})));
      parameter Real gly2lac(unit = "mEq/g") = 1.0 / lacDensity
        "how much lactate is produced by one gram of glycogen";
      parameter Real gly2energy(unit = "kcal/g") = anaerobic_glu2energy
        "how much energy in callories is produced by one gram of glycogen";
      PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow glycogen
        "glycogen flow" annotation (Placement(transformation(extent={{4,-50},{
                26,-28}}), iconTransformation(extent={{-110,30},{-90,50}})));
      parameter Real GlycogenAvailability[:, 3] = {{0, 0.0, 0.0}, {50, 1.0, 0.0}};
      PhysiolibraryOld.Curves.Curve GlycogenAvailabilityCurve(
        x=GlycogenAvailability[:, 1],
        y=GlycogenAvailability[:, 2],
        slope=GlycogenAvailability[:, 3])
        annotation (Placement(transformation(extent={{-44,-88},{-14,-58}})));
      PhysiolibraryOld.Interfaces.RealOutput_ O2Use annotation (Placement(
            transformation(extent={{90,-10},{130,30}}), iconTransformation(
            extent={{-20,-20},{20,20}},
            rotation=270,
            origin={-56,-84})));
      PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow ketoAcids(q(
            final unit="mg/min"), conc(final unit="mg/ml")) "in mg/ml"
        annotation (Placement(transformation(extent={{67,-40},{87,-20}}),
            iconTransformation(extent={{-38,90},{-18,110}})));
    equation
      AerobicFraction.u = pO2;
      LacFraction.u = lactate.conc * lacDensity * 100.0;
      //  [mg/dl]
      O2Use = AerobicFraction.val * eTOo2_coef * CalsUse;
      O2UseByLac = LacFraction.val * O2Use;
      if canBurnFattyAcids then
        ketoAcids.q = 0;
        KAfraction = 0;
        O2UseByKA = 0;
        O2UseByFA = FAfraction * O2Use;
        O2UseByGlu + O2UseByLac + O2UseByFA = O2Use;
        FAfraction = (1 - LacFraction.val) * Ratio / (Ratio + 0.026);
        Ratio = fattyAcids.conc / glucose.conc;
        Tissue_CO2FromMetabolism = 0.0446 * (O2UseByGlu * RQglu + O2UseByLac * RQlac + O2UseByFA * RQfat);
        Tissue_MotabolicH2ORate = 0.000176 * CalsUse;
        fattyAcids.q = FAfraction * CalsUse * eTOfat_coef;
      else
        fattyAcids.q = 0;
        FAfraction = 0;
        O2UseByFA = 0;
        O2UseByKA = KAfraction * O2Use;
        O2UseByGlu + O2UseByLac + O2UseByKA = O2Use;
        KAfraction = (1 - LacFraction.val) * Ratio / (Ratio + 0.222);
        Ratio = ketoAcids.conc / glucose.conc;
        Tissue_CO2FromMetabolism = 0.0446 * (O2UseByGlu * RQglu + O2UseByLac * RQlac + O2UseByKA * RQketo);
        Tissue_MotabolicH2ORate = 0.000176 * CalsUse;
        ketoAcids.q = KAfraction * CalsUse * eTOketo_coef;
      end if;
      GlycogenAvailabilityCurve.u = glycogen.conc * 0.001;
      if AerobicFraction.val < 1 then
        // with anaerobic metabolism
        AnaerobicCals = (1 - AerobicFraction.val) * CalsUse;
        //anaerobic callories
        glycogen.q = GlycogenAvailabilityCurve.val * AnaerobicCals;
        anaerobic_glu2energy * (glucose.q - O2UseByGlu / eTOo2_coef * eTOglu_coef) + gly2energy * glycogen.q = AnaerobicCals;
        glucose.q - O2UseByGlu / eTOo2_coef * eTOglu_coef + gly2lac * glycogen.q = lactate.q * lacDensity - LacFraction.val * CalsUse * eTOlac_coef;
      else
        // only aerobic metabolism
        AnaerobicCals = 0.0;
        glycogen.q = 0.0;
        lactate.q * lacDensity = LacFraction.val * CalsUse * eTOlac_coef;
        glucose.q = O2UseByGlu / eTOo2_coef * eTOglu_coef;
      end if;
      annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Documentation(revisions = "<html>
                   <table cellspacing=\"2\" cellpadding=\"0\" border=\"0\"><tr>
                   <td><p>Author:</p></td>
                   <td><p>Marek Matejak</p></td>
                   </tr>
                   <tr>
                   <td><p>Copyright:</p></td>
                   <td><p>In public domains</p></td>
                   </tr>
                   <tr>
                   <td><p>By:</p></td>
                   <td><p>Charles University, Prague</p></td>
                   </tr>
                   <tr>
                   <td><p>Date of:</p></td>
                   <td><p>2012</p></td>
                   </tr>
                   <tr>
                   <td><p>References:</p></td>
                   <td><p>Tom Coleman: HumMod v1.5, University of Mississippi Medical Center</p></td>
                   </tr>
                   <tr>
                   <td></td>
                   <td></td>
                   </tr>
                   <tr>
                   <td></td>
                   <td></td>
                   </tr>
                   </table>
                   </html>"));
    end CellularMetabolism;

    model NutrientsAndMetabolism
      import QHP = HumMod;
      extends PhysiolibraryOld.Icons.NutrientsMetabolism;
      HumMod.Metabolism.TissueMetabolism.Metabolism tissuesMetabolism(glucose(conc(start = 1.05))) annotation(Placement(transformation(extent = {{90, -4}, {50, 36}})));
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{60,60},{100,100}}),
            iconTransformation(extent={{60,60},{100,100}})));
      HumMod.Metabolism.LiverMetabolism liverMetabolism annotation(Placement(transformation(extent = {{-66, -12}, {-26, 28}})));
      HumMod.Metabolism.Glucose glucose annotation(Placement(transformation(extent = {{0, -4}, {20, 16}})));
      HumMod.Metabolism.KetoAcids ketoAcids annotation(Placement(transformation(extent = {{0, 24}, {20, 44}})));
      QHP.Metabolism.Proteins CellProteins annotation(Placement(transformation(extent = {{-46, -80}, {-26, -60}})));
      QHP.Metabolism.GILumen.GILumenLeptinDriven gILumen annotation(Placement(transformation(extent = {{46, -80}, {72, -54}})));
      QHP.Metabolism.Urea urea annotation(Placement(transformation(extent = {{-74, -52}, {-54, -32}})));
      QHP.Metabolism.Lipids lipids annotation(Placement(transformation(extent = {{0, 54}, {20, 74}})));
      Lactate lactate annotation(Placement(transformation(extent = {{2, -30}, {22, -10}})));
      HumMod.Metabolism.AminoAcids aminoAcids annotation(Placement(transformation(extent = {{2, -58}, {22, -38}})));
      QHP.Hormones.Glucagon glucagon annotation(Placement(transformation(extent = {{-58, 78}, {-38, 98}})));
      QHP.Hormones.Insulin insulin annotation(Placement(transformation(extent = {{-88, 78}, {-68, 98}})));
      QHP.Hormones.Thyrotropin thyrotropin annotation(Placement(transformation(extent = {{-92, 54}, {-72, 74}})));
      QHP.Hormones.Thyroxine thyroxine annotation(Placement(transformation(extent = {{-58, 54}, {-38, 74}})));
      QHP.Hormones.Leptin leptin annotation(Placement(transformation(extent = {{-92, 28}, {-72, 48}})));
    equation
      connect(tissuesMetabolism.busConnector, busConnector) annotation(Line(points = {{86.40000000000001, 30.5455}, {96, 30.5455}, {96, 80}, {80, 80}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(liverMetabolism.busConnector, busConnector) annotation(Line(points = {{-65.59999999999999, 8}, {-86, 8}, {-86, -92}, {96, -92}, {96, 80}, {80, 80}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(busConnector, glucose.busConnector) annotation(Line(points = {{80, 80}, {-4, 80}, {-4, 5.8}, {1, 5.8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(glucose.q_out, tissuesMetabolism.glucose) annotation(Line(points = {{10, 12}, {28, 12}, {28, 12.3636}, {50, 12.3636}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(ketoAcids.q_out, tissuesMetabolism.ketoAcids) annotation(Line(points = {{10, 28}, {28, 28}, {28, 19.6364}, {50, 19.6364}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(liverMetabolism.Glucose, glucose.q_out) annotation(Line(points = {{-26, -4}, {-8, -4}, {-8, 12}, {10, 12}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(busConnector, gILumen.busConnector) annotation(Line(points = {{80, 80}, {96, 80}, {96, -92}, {42, -92}, {42, -58.16}, {50.16, -58.16}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(ketoAcids.q_out, liverMetabolism.Ketoacids) annotation(Line(points = {{10, 28}, {-10, 28}, {-10, 8}, {-26, 8}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(urea.ureaFromMetabolism, liverMetabolism.Urea) annotation(Line(points = {{-58, -32}, {-58, -12}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(urea.busConnector, busConnector) annotation(Line(points = {{-72, -38}, {-86, -38}, {-86, -92}, {96, -92}, {96, 80}, {80, 80}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(ketoAcids.busConnector, busConnector) annotation(Line(points = {{1, 44}, {-4, 44}, {-4, 80}, {80, 80}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(CellProteins.busConnector, busConnector) annotation(Line(points = {{-45.2, -70}, {-56, -70}, {-56, -92}, {96, -92}, {96, 80}, {80, 80}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(busConnector, lipids.busConnector) annotation(Line(points = {{80, 80}, {-4, 80}, {-4, 60.2}, {2, 60.2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(lipids.FattyAcids, tissuesMetabolism.fattyAcids) annotation(Line(points = {{10, 64}, {40, 64}, {40, 28.7273}, {50, 28.7273}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(lactate.busConnector, busConnector) annotation(Line(points = {{4, -26}, {-4, -26}, {-4, 80}, {80, 80}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(lactate.Lactate, tissuesMetabolism.lactate) annotation(Line(points = {{12, -20}, {40, -20}, {40, 3.27273}, {50, 3.27273}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(aminoAcids.busConnector, busConnector) annotation(Line(points = {{4, -48}, {-4, -48}, {-4, 80}, {80, 80}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(gILumen.Protein_Absorption, aminoAcids.AminoAcids) annotation(Line(points = {{72, -59.2}, {74, -59.2}, {74, -48}, {34, -48}, {34, -56}, {11.2, -56}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(aminoAcids.AminoAcids, liverMetabolism.AminoAcids) annotation(Line(points = {{11.2, -56}, {-34, -56}, {-34, -12}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(aminoAcids.AminoAcids, CellProteins.aminoAcids) annotation(Line(points = {{11.2, -56}, {-8, -56}, {-8, -70}, {-26, -70}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(gILumen.Carbohydrates_Absorption, tissuesMetabolism.GILumenCarbohydrates) annotation(Line(points = {{72, -74.8}, {84, -74.8}, {84, -4}, {82, -4}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(lipids.toTriglicerides, gILumen.Fat_Absorption) annotation(Line(points = {{10, 56}, {78, 56}, {78, -67}, {72, -67}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(lipids.toTriglicerides, liverMetabolism.triglicerides) annotation(Line(points = {{10, 56}, {-14, 56}, {-14, 20}, {-26, 20}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(lipids.FattyAcids, liverMetabolism.fattyAcids) annotation(Line(points = {{10, 64}, {-20, 64}, {-20, 28}, {-26, 28}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(insulin.Insulin, glucagon.Insulin) annotation(Line(points = {{-68, 88}, {-62, 88}, {-62, 94}, {-56, 94}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector, glucagon.busConnector) annotation(Line(points = {{80, 80}, {-56, 80}, {-56, 82}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(busConnector, insulin.busConnector) annotation(Line(points = {{80, 80}, {-86, 80}, {-86, 82}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(busConnector, thyroxine.busConnector) annotation(Line(points = {{80, 80}, {-56, 80}, {-56, 72}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(busConnector, thyrotropin.busConnector) annotation(Line(points = {{80, 80}, {-98, 80}, {-98, 58}, {-90, 58}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(thyrotropin.TSH, thyroxine.TSH) annotation(Line(points = {{-72, 64}, {-66, 64}, {-66, 66}, {-56, 66}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(thyroxine.Thyroxine, thyrotropin.Thyroxine) annotation(Line(points = {{-38, 64}, {-34, 64}, {-34, 78}, {-94, 78}, {-94, 72}, {-90, 72}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector, leptin.busConnector) annotation(Line(points = {{80, 80}, {-98, 80}, {-98, 32}, {-90, 32}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(insulin.LM_Insulin_InsulinDelayed, busConnector.LM_Insulin_InsulinDelayed) annotation(Line(points = {{-68, 84}, {8, 84}, {8, 80}, {80, 80}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent = {{-180, -96}, {190, -128}}, lineColor = {0, 0, 255}, textString = "%name")}));
    end NutrientsAndMetabolism;

    package GILumen
      model GILumenLeptinDriven
        extends PhysiolibraryOld.Icons.GILumen;
        PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment
          Carbohydrates(initialSoluteMass=1976.32, stateName=
              "GILumenCarbohydrates.Mass")
          annotation (Placement(transformation(extent={{0,38},{20,58}})));
        PhysiolibraryOld.ConcentrationFlow.SoluteFlowPump Absorbtion
          annotation (Placement(transformation(
              extent={{-6,6},{6,-6}},
              rotation=90,
              origin={14,66})));
        PhysiolibraryOld.ConcentrationFlow.InputPump Diet
          annotation (Placement(transformation(extent={{-18,58},{2,38}})));
        PhysiolibraryOld.Factors.CurveValue AbsorptionSaturation(data={{0,0,0.0},
              {1900,150,0.08},{6000,600,0.0}}) annotation (Placement(
              transformation(
              extent={{-10,10},{10,-10}},
              rotation=90,
              origin={26,66})));
        PhysiolibraryOld.Blocks.Constant Constant(k=1)
          annotation (Placement(transformation(extent={{34,64},{30,68}})));
        PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment Fat(
            initialSoluteMass=2041.83, stateName="GILumenFat.Mass")
          annotation (Placement(transformation(extent={{0,-92},{20,-72}})));
        PhysiolibraryOld.ConcentrationFlow.SoluteFlowPump Absorbtion1
          annotation (Placement(transformation(
              extent={{-6,6},{6,-6}},
              rotation=90,
              origin={14,-64})));
        PhysiolibraryOld.ConcentrationFlow.InputPump Diet1
          annotation (Placement(transformation(extent={{-18,-72},{2,-92}})));
        PhysiolibraryOld.Factors.SimpleMultiply AbsorptionSaturation1
          annotation (Placement(transformation(
              extent={{-10,10},{10,-10}},
              rotation=90,
              origin={26,-64})));
        PhysiolibraryOld.Blocks.Constant Constant1(k=0.03)
          annotation (Placement(transformation(extent={{38,-68},{30,-60}})));
        PhysiolibraryOld.Interfaces.BusConnector busConnector
          annotation (Placement(transformation(extent={{-88,48},{-48,88}})));
        PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow
          Carbohydrates_Absorption(conc(final unit="mg/ml"), q(final unit=
                "mg/min")) annotation (Placement(transformation(extent={{38,72},
                  {58,92}}), iconTransformation(extent={{90,-70},{110,-50}})));
        PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow
          Fat_Absorption(conc(final unit="mg/ml"), q(final unit="mg/min"))
          annotation (Placement(transformation(extent={{42,-60},{62,-40}}),
              iconTransformation(extent={{90,-10},{110,10}})));
        PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment Protein(
            initialSoluteMass=1637.19, stateName="GILumenProtein.Mass")
          annotation (Placement(transformation(extent={{0,-28},{20,-8}})));
        PhysiolibraryOld.ConcentrationFlow.SoluteFlowPump Absorbtion2
          annotation (Placement(transformation(
              extent={{-6,6},{6,-6}},
              rotation=90,
              origin={14,0})));
        PhysiolibraryOld.ConcentrationFlow.InputPump Diet2
          annotation (Placement(transformation(extent={{-18,-8},{2,-28}})));
        PhysiolibraryOld.Factors.SimpleMultiply AbsorptionSaturation2
          annotation (Placement(transformation(
              extent={{-10,10},{10,-10}},
              rotation=90,
              origin={26,0})));
        PhysiolibraryOld.Blocks.Constant Constant2(k=0.05)
          annotation (Placement(transformation(extent={{38,-4},{30,4}})));
        PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow
          Protein_Absorption(conc(final unit="mg/ml"), q(final unit="mg/min"))
          annotation (Placement(transformation(extent={{42,4},{62,24}}),
              iconTransformation(extent={{90,50},{110,70}})));
        PhysiolibraryOld.Factors.CurveValue LeptinEffect(data={{0,3.0,0},{8,1.0,
              -0.04},{50,0.0,0}})
          annotation (Placement(transformation(extent={{-44,-58},{-24,-38}})));
        PhysiolibraryOld.Blocks.Constant Constant3(k=751/9.300000000000001*1000)
          annotation (Placement(transformation(extent={{-44,-44},{-36,-36}})));
        PhysiolibraryOld.Blocks.Constant Constant4(k=1/1440)
          annotation (Placement(transformation(extent={{-64,-60},{-56,-52}})));
        PhysiolibraryOld.Factors.SimpleMultiply DietFeedingFraction
          annotation (Placement(transformation(extent={{-44,-66},{-24,-46}})));
        PhysiolibraryOld.Factors.CurveValue LeptinEffect1(data={{0,3.0,0},{8,
              1.0,-0.04},{50,0.0,0}})
          annotation (Placement(transformation(extent={{-40,2},{-20,22}})));
        PhysiolibraryOld.Blocks.Constant Constant5(k=500/4.35*1000)
          annotation (Placement(transformation(extent={{-40,16},{-32,24}})));
        PhysiolibraryOld.Blocks.Constant Constant6(k=1/1440)
          annotation (Placement(transformation(extent={{-60,0},{-52,8}})));
        PhysiolibraryOld.Factors.SimpleMultiply DietFeedingFraction1
          annotation (Placement(transformation(extent={{-40,-6},{-20,14}})));
        PhysiolibraryOld.Factors.CurveValue LeptinEffect2(data={{0,3.0,0},{8,
              1.0,-0.04},{50,0.0,0}})
          annotation (Placement(transformation(extent={{-26,70},{-6,90}})));
        PhysiolibraryOld.Blocks.Constant Constant7(k=900/4.1*1000)
          annotation (Placement(transformation(extent={{-26,84},{-18,92}})));
        PhysiolibraryOld.Blocks.Constant Constant8(k=1/1440)
          annotation (Placement(transformation(extent={{-46,68},{-38,76}})));
        PhysiolibraryOld.Factors.SimpleMultiply DietFeedingFraction2
          annotation (Placement(transformation(extent={{-26,62},{-6,82}})));
        PhysiolibraryOld.Blocks.Constant Constant9(k=25)
          annotation (Placement(transformation(extent={{-52,-96},{-44,-88}})));
      equation
        connect(Carbohydrates.q_out, Absorbtion.q_in) annotation(Line(points = {{10, 48}, {14, 48}, {14, 60}}, color = {255, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(Diet.q_out, Carbohydrates.q_out) annotation(Line(points = {{-2, 48}, {10, 48}}, color = {255, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(Carbohydrates.soluteMass, AbsorptionSaturation.u) annotation(Line(points = {{10, 40.2}, {10, 32}, {26, 32}, {26, 56.2}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(AbsorptionSaturation.y, Absorbtion.soluteFlow) annotation(Line(points = {{24, 66}, {17.6, 66}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(AbsorptionSaturation.yBase, Constant.y) annotation(Line(points = {{28, 66}, {29.8, 66}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Fat.q_out, Absorbtion1.q_in) annotation(Line(points = {{10, -82}, {14, -82}, {14, -70}}, color = {255, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(Diet1.q_out, Fat.q_out) annotation(Line(points = {{-2, -82}, {10, -82}}, color = {255, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(Fat.soluteMass, AbsorptionSaturation1.u) annotation(Line(points = {{10, -89.8}, {10, -98}, {26, -98}, {26, -73.8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(AbsorptionSaturation1.y, Absorbtion1.soluteFlow) annotation(Line(points = {{24, -64}, {17.6, -64}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(AbsorptionSaturation1.yBase, Constant1.y) annotation(Line(points = {{28, -64}, {29.6, -64}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.GILumenVolume_Mass, Fat.SolventVolume) annotation(Line(points = {{-68, 68}, {-68, -76}, {2, -76}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.GILumenVolume_Mass, Carbohydrates.SolventVolume) annotation(Line(points = {{-68, 68}, {-68, 54}, {2, 54}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(Absorbtion1.q_out, Fat_Absorption) annotation(Line(points = {{14, -58}, {14, -50}, {52, -50}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(Absorbtion.q_out, Carbohydrates_Absorption) annotation(Line(points = {{14, 72}, {14, 82}, {48, 82}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(Protein.q_out, Absorbtion2.q_in) annotation(Line(points = {{10, -18}, {14, -18}, {14, -6}}, color = {255, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(Diet2.q_out, Protein.q_out) annotation(Line(points = {{-2, -18}, {10, -18}}, color = {255, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(Protein.soluteMass, AbsorptionSaturation2.u) annotation(Line(points = {{10, -25.8}, {10, -34}, {26, -34}, {26, -9.800000000000001}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(AbsorptionSaturation2.y, Absorbtion2.soluteFlow) annotation(Line(points = {{24, 1.22465e-016}, {20, 1.22465e-016}, {20, -2.20436e-016}, {17.6, -2.20436e-016}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(AbsorptionSaturation2.yBase, Constant2.y) annotation(Line(points = {{28, -1.22465e-016}, {28, 0}, {29.6, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.GILumenVolume_Mass, Protein.SolventVolume) annotation(Line(points = {{-68, 68}, {-68, -12}, {2, -12}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(Absorbtion2.q_out, Protein_Absorption) annotation(Line(points = {{14, 6}, {14, 14}, {52, 14}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(busConnector.FA_Absorbtion, AbsorptionSaturation1.y) annotation(Line(points = {{-68, 68}, {-68, -64}, {24, -64}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.Leptin, LeptinEffect.u) annotation(Line(points = {{-68, 68}, {-68, -48}, {-43.8, -48}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(Constant3.y, LeptinEffect.yBase) annotation(Line(points = {{-35.6, -40}, {-34, -40}, {-34, -46}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Constant4.y, DietFeedingFraction.u) annotation(Line(points = {{-55.6, -56}, {-43.8, -56}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(LeptinEffect.y, DietFeedingFraction.yBase) annotation(Line(points = {{-34, -50}, {-32, -50}, {-32, -54}, {-34, -54}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.Leptin, LeptinEffect1.u) annotation(Line(points = {{-68, 68}, {-68, 12}, {-39.8, 12}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(Constant5.y, LeptinEffect1.yBase) annotation(Line(points = {{-31.6, 20}, {-30, 20}, {-30, 14}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Constant6.y, DietFeedingFraction1.u) annotation(Line(points = {{-51.6, 4}, {-39.8, 4}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(LeptinEffect1.y, DietFeedingFraction1.yBase) annotation(Line(points = {{-30, 10}, {-30, 6}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.Leptin, LeptinEffect2.u) annotation(Line(points = {{-68, 68}, {-68, 80}, {-25.8, 80}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(Constant7.y, LeptinEffect2.yBase) annotation(Line(points = {{-17.6, 88}, {-16, 88}, {-16, 82}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Constant8.y, DietFeedingFraction2.u) annotation(Line(points = {{-37.6, 72}, {-25.8, 72}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(LeptinEffect2.y, DietFeedingFraction2.yBase) annotation(Line(points = {{-16, 78}, {-16, 74}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(DietFeedingFraction2.y, Diet.desiredFlow) annotation(Line(points = {{-16, 70}, {-16, 42}, {-8, 42}, {-8, 44}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(DietFeedingFraction1.y, Diet2.desiredFlow) annotation(Line(points = {{-30, 2}, {-30, -24}, {-8, -24}, {-8, -22}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(DietFeedingFraction.y, Diet1.desiredFlow) annotation(Line(points = {{-34, -58}, {-34, -84}, {-8, -84}, {-8, -86}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Text(extent=  {{-168, -106}, {152, -134}}, lineColor=  {0, 0, 255}, textString=  "%name"), Rectangle(extent=  {{-100, 100}, {100, -100}}, lineColor=  {0, 0, 0})}));
      end GILumenLeptinDriven;
    end GILumen;

    package TissueMetabolism "Metabolism Reactions in Tissues"
      partial model TissueMetabolismBase
        extends PhysiolibraryOld.Icons.MetabolismPart;
        parameter Real initialTissueO2(final unit = "ml") = 4;
        //pO2*solubility*LiquidVolume
        parameter Real O2solubility(final unit = "ml/mmHg") = 3e-005;
        parameter Real O2fromBloodtoTissueConductance(final unit = "ml/(min.mmHg)") = 1000000;
        parameter Real initialLactateMass(final unit = "mEq") = 0;
        parameter Real NormalCalsUsed(final unit = "cal/min");
        parameter Real DC(final unit = "(mEq/min)/(mEq/ml)");
        parameter Real[:, 3] PO2OnAerobicFractionData = {{2, 0, 0}, {10, 1, 0}}
          "Aerobic Fraction of O2 tissue use depents on pO2";
        PhysiolibraryOld.Interfaces.RealInput_ LiquidVol(final unit="ml")
          "sum of interstitial and intracellular tissue water" annotation (
            Placement(transformation(extent={{-6,15},{4,25}}),
              iconTransformation(extent={{-100,30},{-80,50}})));
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow lactate(
            conc(final unit="mEq/ml"), q(final unit="mEq/min")) annotation (
            Placement(transformation(extent={{-103,22},{-83,42}}),
              iconTransformation(extent={{90,10},{110,30}})));
        PhysiolibraryOld.Factors.SimpleMultiply Thyroid
          annotation (Placement(transformation(extent={{60,74},{80,94}})));
        PhysiolibraryOld.Factors.CurveValue HeatMetabolism_Skin(data={{10,0.0,0},
              {37,1.0,0.12},{40,1.5,0},{46,0.0,0}}, curve(iFrom(start=2)))
          annotation (Placement(transformation(extent={{60,70},{80,90}})));
        PhysiolibraryOld.Factors.SimpleMultiply StructureEffect
          annotation (Placement(transformation(extent={{60,66},{80,86}})));
        PhysiolibraryOld.Blocks.CaloriesFlowConstant caloriesConstant(k=
              NormalCalsUsed)
          annotation (Placement(transformation(extent={{59,87},{67,95}})));
        PhysiolibraryOld.Interfaces.RealInput_ T(final unit="degC")
          "temperature" annotation (Placement(transformation(extent={{32,72},{
                  42,82}}), iconTransformation(extent={{-100,-10},{-80,10}})));
        PhysiolibraryOld.Interfaces.RealInput_ Structure_Effect(final unit="1")
          annotation (Placement(transformation(extent={{32,64},{42,74}}),
              iconTransformation(extent={{-100,10},{-80,30}})));
        PhysiolibraryOld.Interfaces.RealInput_ ThyroidEffect(final unit="1")
          annotation (Placement(transformation(extent={{32,81},{42,91}}),
              iconTransformation(extent={{-100,-30},{-80,-10}})));
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow glucose(
            conc(final unit="mg/ml"), q(final unit="mg/min")) annotation (
            Placement(transformation(extent={{-102,-44},{-82,-24}}),
              iconTransformation(extent={{90,90},{110,110}})));
        PhysiolibraryOld.Interfaces.RealInput_ BloodFlow(final unit="ml/min")
          "blood flow through all tissue capilaries cross-section" annotation (
            Placement(transformation(extent={{-91,3},{-82,12}}),
              iconTransformation(extent={{-100,70},{-80,90}})));
        Modelica.Blocks.Math.Product PlasmaFlow1 annotation(Placement(transformation(extent = {{-78, -5}, {-70, 3}})));
        Modelica.Blocks.Math.Gain CalToO2(k = 0.2093) annotation(Placement(transformation(extent = {{4, -4}, {-4, 4}}, rotation = 90, origin = {88, 18})));
        PhysiolibraryOld.Interfaces.RealInput_ BloodVol_PVCrit(final unit="1")
          "part of plasma in blood" annotation (Placement(transformation(extent=
                 {{-94,-9},{-84,1}}), iconTransformation(extent={{-100,90},{-80,
                  110}})));
        PhysiolibraryOld.Interfaces.RealInput_ pO2(final unit="mmHg")
          "tissue venous O2 partial pressure" annotation (Placement(
              transformation(
              extent={{-5,-5},{5,5}},
              rotation=0,
              origin={32,-66}), iconTransformation(extent={{-100,50},{-80,70}})));
        Modelica.Blocks.Math.Sum TotalCaloriesUse annotation(Placement(transformation(extent = {{-4.5, -4.5}, {3.5, 3.5}}, rotation = 270, origin = {71.5, 45.5})));
        PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
          concentrationMeasure(unitsString="mEq/l", toAnotherUnitCoef=1000)
          annotation (Placement(transformation(extent={{10,4},{30,24}})));
        PhysiolibraryOld.Interfaces.RealOutput_ cLactate(unit="mEq/l")
          annotation (Placement(transformation(extent={{32,28},{44,40}}),
              iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=270,
              origin={-30,-100})));
        PhysiolibraryOld.Interfaces.RealOutput_ Tissue_CO2FromMetabolism(unit=
              "ml/min") annotation (Placement(transformation(extent={{90,-66},{
                  102,-54}}), iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=270,
              origin={-50,-100})));
        PhysiolibraryOld.Interfaces.RealOutput_ Fuel_FractUseDelay annotation (
            Placement(transformation(extent={{-46,-6},{-34,6}}),
              iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=270,
              origin={-70,-100})));
        PhysiolibraryOld.Interfaces.RealOutput_ O2Use(unit="ml/min")
          annotation (Placement(transformation(extent={{58,-100},{70,-88}}),
              iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=270,
              origin={-10,-100})));
        PhysiolibraryOld.Interfaces.RealOutput_ O2Need(unit="ml/min")
          annotation (Placement(transformation(extent={{92,6},{104,18}}),
              iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=270,
              origin={10,-100})));
        PhysiolibraryOld.Interfaces.RealOutput_ LactateFromMetabolism(unit=
              "mEq/min", start=0) annotation (Placement(transformation(extent={
                  {34,0},{46,12}}), iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=270,
              origin={30,-100})));
        PhysiolibraryOld.Interfaces.RealOutput_ H2OFromMetabolism(unit="ml/min")
          annotation (Placement(transformation(extent={{78,-86},{90,-74}}),
              iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=270,
              origin={50,-100})));
        PhysiolibraryOld.ConcentrationFlow.FlowMeasure flowMeasure annotation (
            Placement(transformation(
              extent={{-8,-8},{8,8}},
              rotation=180,
              origin={36,14})));
        PhysiolibraryOld.Blocks.Min min(nin=2)
          annotation (Placement(transformation(extent={{-52,-4},{-44,4}})));
        PhysiolibraryOld.Interfaces.RealOutput_ TotalCalsUsed(unit="cal/min")
          annotation (Placement(transformation(extent={{90,32},{102,44}}),
              iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=270,
              origin={70,-100})));
        Modelica.Blocks.Math.Sum PartCaloriesUse annotation(Placement(transformation(extent = {{-4.5, -4.5}, {3.5, 3.5}}, rotation = 270, origin = {71.5, 59.5})));
        NutrientDelivery lactateDelivery annotation(Placement(transformation(extent = {{-80, 42}, {-60, 22}})));
      equation
        connect(Thyroid.y, HeatMetabolism_Skin.yBase) annotation(Line(points = {{70, 82}, {70, 82}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(HeatMetabolism_Skin.y, StructureEffect.yBase) annotation(Line(points = {{70, 78}, {70, 78}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(caloriesConstant.y, Thyroid.yBase) annotation(Line(points = {{67.40000000000001, 91}, {70, 91}, {70, 86}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(T, HeatMetabolism_Skin.u) annotation(Line(points = {{37, 77}, {49, 77}, {49, 80}, {60.2, 80}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Structure_Effect, StructureEffect.u) annotation(Line(points = {{37, 69}, {52, 69}, {52, 76}, {60.2, 76}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Thyroid.u, ThyroidEffect) annotation(Line(points = {{60.2, 84}, {50, 84}, {50, 86}, {37, 86}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(PlasmaFlow1.u1, BloodFlow) annotation(Line(points = {{-78.8, 1.4}, {-81.84999999999999, 1.4}, {-81.84999999999999, 7.5}, {-86.5, 7.5}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(BloodVol_PVCrit, PlasmaFlow1.u2) annotation(Line(points = {{-89, -4}, {-88.5, -4}, {-88.5, -3.4}, {-78.8, -3.4}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(TotalCaloriesUse.y, CalToO2.u) annotation(Line(points = {{71, 41.6}, {71, 38}, {88, 38}, {88, 22.8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(concentrationMeasure.actualConc, cLactate) annotation(Line(points = {{20, 18}, {20, 34}, {38, 34}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(CalToO2.y, O2Need) annotation(Line(points = {{88, 13.6}, {88, 12}, {98, 12}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(flowMeasure.actualFlow, LactateFromMetabolism) annotation(Line(points = {{36, 10}, {36, 6}, {40, 6}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(min.y, Fuel_FractUseDelay) annotation(Line(points = {{-43.6, 0}, {-40, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(TotalCaloriesUse.y, TotalCalsUsed) annotation(Line(points = {{71, 41.6}, {71, 38}, {96, 38}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(PartCaloriesUse.y, TotalCaloriesUse.u[1]) annotation(Line(points = {{71, 55.6}, {71, 53.8}, {71, 53.8}, {71, 50.8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(StructureEffect.y, PartCaloriesUse.u[1]) annotation(Line(points = {{70, 74}, {70, 69.40000000000001}, {70, 64.8}, {71, 64.8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(PlasmaFlow1.y, lactateDelivery.solventFlow) annotation(Line(points = {{-69.59999999999999, -1}, {-70, -1}, {-70, 26}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(lactateDelivery.q_out, lactate) annotation(Line(points = {{-60, 32}, {-56, 32}, {-56, 14}, {-93, 14}, {-93, 32}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(lactate, lactateDelivery.q_in) annotation(Line(points = {{-93, 32}, {-80, 32}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(lactateDelivery.neededFlow, concentrationMeasure.q_in) annotation(Line(points = {{-70, 37}, {-20, 37}, {-20, 14}, {20, 14}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(lactateDelivery.neededFlow, flowMeasure.q_out) annotation(Line(points = {{-70, 37}, {-20, 37}, {-20, 14}, {32.8, 14}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}, grid = {2, 2}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}, grid = {2, 2}), graphics));
      end TissueMetabolismBase;

      model TissueMetabolism
        extends TissueMetabolismBase;
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow fattyAcids(
            conc(final unit="mg/ml"), q(final unit="mg/min")) annotation (
            Placement(transformation(extent={{-103,-80},{-83,-60}}),
              iconTransformation(extent={{90,-70},{110,-50}})));
        HumMod.Metabolism.CellularMetabolism cellularMetabolism(LacFractionData = {{10, 0, 0}, {100, 0.3, 0}}) annotation(Placement(transformation(extent = {{62, -76}, {92, -46}})));
        NutrientDelivery fattyAcidsDelivery annotation(Placement(transformation(extent = {{-74, -80}, {-54, -60}})));
        NutrientDelivery glucoseDelivery annotation(Placement(transformation(extent = {{-70, -44}, {-50, -24}})));
        PhysiolibraryOld.ConcentrationFlow.UnlimitedStorage unlimitedStorage(
            concentration=0)
          annotation (Placement(transformation(extent={{0,-78},{20,-58}})));
        PhysiolibraryOld.ConcentrationFlow.UnlimitedStorage unlimitedStorage1(
            concentration=0)
          annotation (Placement(transformation(extent={{64,-22},{84,-2}})));
      equation
        connect(cellularMetabolism.Tissue_CO2FromMetabolism, Tissue_CO2FromMetabolism) annotation(Line(points = {{91.09999999999999, -61}, {96, -61}, {96, -60}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(flowMeasure.q_in, cellularMetabolism.lactate) annotation(Line(points = {{39.2, 14}, {56, 14}, {56, -46}, {67.09999999999999, -46}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(cellularMetabolism.Tissue_MotabolicH2ORate, H2OFromMetabolism) annotation(Line(points = {{79.09999999999999, -75.7}, {84, -80}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(TotalCaloriesUse.y, cellularMetabolism.CalsUse) annotation(Line(points = {{71, 41.6}, {71, 38}, {96, 38}, {96, -36}, {83, -36}, {83, -46}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(fattyAcids, fattyAcidsDelivery.q_in) annotation(Line(points = {{-93, -70}, {-74, -70}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(PlasmaFlow1.y, fattyAcidsDelivery.solventFlow) annotation(Line(points = {{-69.59999999999999, -1}, {-64, -1}, {-64, -64}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(PlasmaFlow1.y, glucoseDelivery.solventFlow) annotation(Line(points = {{-69.59999999999999, -1}, {-60, -1}, {-60, -28}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(glucose, glucoseDelivery.q_in) annotation(Line(points = {{-92, -34}, {-70, -34}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(glucoseDelivery.q_out, glucose) annotation(Line(points = {{-50, -34}, {-40, -34}, {-40, -22}, {-92, -22}, {-92, -34}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(fattyAcidsDelivery.q_out, fattyAcids) annotation(Line(points = {{-54, -70}, {-40, -70}, {-40, -60}, {-93, -60}, {-93, -70}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(glucoseDelivery.FuelFractUseDelay, min.u[2]) annotation(Line(points = {{-66, -41}, {-66, -46}, {-56, -46}, {-56, 0.4}, {-52.8, 0.4}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(glucoseDelivery.neededFlow, cellularMetabolism.glucose) annotation(Line(points = {{-60, -39}, {-60, -49}, {62, -49}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(fattyAcidsDelivery.neededFlow, cellularMetabolism.fattyAcids) annotation(Line(points = {{-64, -75}, {-64, -90}, {56, -90}, {56, -61}, {62, -61}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(fattyAcidsDelivery.FuelFractUseDelay, min.u[1]) annotation(Line(points = {{-70, -77}, {-70, -84}, {-56, -84}, {-56, -0.4}, {-52.8, -0.4}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(unlimitedStorage.q_out, cellularMetabolism.glycogen) annotation(Line(points = {{10.2, -68}, {24, -68}, {24, -55}, {62, -55}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(pO2, cellularMetabolism.pO2) annotation(Line(points = {{32, -66}, {32, -67}, {62.5999, -67}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(cellularMetabolism.O2Use, O2Use) annotation(Line(points = {{68.59999999999999, -73.59999999999999}, {68.59999999999999, -82.8}, {64, -82.8}, {64, -94}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(cellularMetabolism.ketoAcids, unlimitedStorage1.q_out) annotation(Line(points = {{72.8, -46}, {74, -46}, {74, -12}, {74.2, -12}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}, grid = {2, 2}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}, grid = {2, 2}), graphics));
      end TissueMetabolism;

      model SkeletalMuscleMetabolism
        extends TissueMetabolismBase(TotalCaloriesUse(nin = 3), HeatMetabolism_Skin(data = {{10.0, 0.0, 0}, {37.1, 1.0, 0.12}, {40.0, 1.5, 0}, {46.0, 0.0, 0}}), PartCaloriesUse(nin = 3));
        //   Lactate(stateName="SkeletalMuscle-Lactate.Mass"),
        extends PhysiolibraryOld.Icons.SkeletalMuscle;
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow fattyAcids(
            conc(final unit="mg/ml"), q(final unit="mg/min")) annotation (
            Placement(transformation(extent={{-103,-78},{-83,-58}}),
              iconTransformation(extent={{90,-70},{110,-50}})));
        HumMod.Metabolism.CellularMetabolism cellularMetabolism(LacFractionData = {{10, 0, 0}, {100, 0.3, 0}}, GlycogenAvailabilityCurve(iFrom(start = 2))) annotation(Placement(transformation(extent = {{60, -76}, {92, -44}})));
        PhysiolibraryOld.Blocks.CaloriesFlowConstant Posture_Cals(k=19)
          annotation (Placement(transformation(extent={{-3,84},{7,94}})));
        PhysiolibraryOld.Blocks.FractConstant fractConstant(k=30)
          annotation (Placement(transformation(extent={{-40,57},{-30,67}})));
        Modelica.Blocks.Math.Division TotalCals annotation(Placement(transformation(extent = {{-13, 57}, {-5, 65}})));
        PhysiolibraryOld.Interfaces.RealInput_ ExerciseMetabolism_MotionCals(
            final unit="cal/min") annotation (Placement(transformation(extent={
                  {-32,62},{-22,72}}), iconTransformation(extent={{-100,-70},{-80,
                  -50}})));
        PhysiolibraryOld.ConcentrationFlow.MassStorageCompartment glycogen(
          q_out(conc(unit="mg"), q(unit="mg/min")),
          stateName="SkeletalMuscle-Glycogen.Mass",
          MINUTE_FLOW_TO_MASS_CONVERSION=0.001,
          initialSoluteMass(unit="g") = 500,
          STEADY=false,
          soluteMass(unit="g"))
          annotation (Placement(transformation(extent={{32,-42},{52,-22}})));
        PhysiolibraryOld.ConcentrationFlow.SoluteFlowPump synthesis
          annotation (Placement(transformation(extent={{-4,-42},{16,-22}})));
        PhysiolibraryOld.Blocks.MassFlowConstant massFlowConstant(k=20)
          annotation (Placement(transformation(extent={{-6,-10},{4,0}})));
        PhysiolibraryOld.Factors.SplineValue2 GlucoseEffect(data={{0,0.0,0.0},{
              100,1.0,0.01},{300,3.0,0.0}}, curve(iFrom(start=2)))
          annotation (Placement(transformation(extent={{-4,-32},{16,-12}})));
        PhysiolibraryOld.Factors.SplineValue2 Space(data={{0,4.0,0.0},{400,1.0,
              -0.015},{500,0.0,0.0}}, curve(iFrom(start=3)))
          annotation (Placement(transformation(extent={{16,-24},{-4,-4}})));
        PhysiolibraryOld.Factors.DelayedToSpline InsulinEffect(
          initialValue=20,
          data={{0,0.0,0.0},{20,1.0,0.2},{100,20.0,0.0}},
          curve(iFrom(start=2)),
          integrator(stateName="SkeletalMuscle-Insulin.[InsulinDelayed]"),
          adaptationSignalName="SkeletalMuscle-Insulin.[InsulinDelayed]")
          annotation (Placement(transformation(extent={{-4,-28},{16,-8}})));
        PhysiolibraryOld.Interfaces.RealInput_ Insulin(final unit="uU/ml")
          "tissue venous O2 partial pressure" annotation (Placement(
              transformation(
              extent={{-5,-5},{5,5}},
              rotation=0,
              origin={-16,-18}), iconTransformation(extent={{-100,-50},{-80,-30}})));
        PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
          concentrationMeasure3(unitsString="mg/dl", toAnotherUnitCoef=100)
          annotation (Placement(transformation(
              extent={{-10,-10},{10,10}},
              rotation=0,
              origin={-14,-32})));
        PhysiolibraryOld.Interfaces.RealOutput_ GlucoseToCellsStorageFlow(unit=
              "mmol/min") "glucose to muscle cells" annotation (Placement(
              transformation(extent={{32,-16},{44,-4}}), iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=270,
              origin={-90,-100})));
        Glucose_MG_TO_MMOL glucose_MG_TO_MMOL annotation(Placement(transformation(extent = {{24, -14}, {32, -6}})));
        NutrientDelivery fattyAcidsDelivery annotation(Placement(transformation(extent = {{-76, -78}, {-56, -58}})));
        NutrientDelivery glucoseDelivery annotation(Placement(transformation(extent = {{-72, -44}, {-52, -24}})));
        PhysiolibraryOld.ConcentrationFlow.UnlimitedStorage unlimitedStorage1(
            concentration=0)
          annotation (Placement(transformation(extent={{64,-26},{84,-6}})));
        PhysiolibraryOld.Interfaces.RealOutput_
          skeletalMuscle_HeatWithoutTermoregulation(unit="kcal/min")
          "Skeletal muscle termal energy flow without shivering effect. (Used in termoragulation to calculate whole thermal energy flow from muscle connected with hypothalamus shivering drive.) [Cal/min]"
          annotation (Placement(transformation(extent={{88,48},{100,60}}),
              iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=270,
              origin={90,-100})));
        Modelica.Blocks.Math.Feedback HeatCals annotation(Placement(transformation(extent = {{0, 54}, {12, 66}})));
        PhysiolibraryOld.Interfaces.RealInput_ ShiveringCals annotation (
            Placement(transformation(extent={{-86,46},{-76,56}}),
              iconTransformation(extent={{-100,110},{-80,130}})));
      equation
        connect(TotalCaloriesUse.y, cellularMetabolism.CalsUse) annotation(Line(points = {{71, 41.6}, {71, 38}, {94, 38}, {94, -44}, {82.40000000000001, -44}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(ExerciseMetabolism_MotionCals, TotalCals.u1) annotation(Line(points = {{-27, 67}, {-16, 67}, {-16, 63.4}, {-13.8, 63.4}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(fractConstant.y, TotalCals.u2) annotation(Line(points = {{-29.5, 62}, {-28, 62}, {-28, 58.6}, {-13.8, 58.6}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(synthesis.q_out, glycogen.q_out) annotation(Line(points = {{16, -32}, {42, -32}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(glycogen.q_out, cellularMetabolism.glycogen) annotation(Line(points = {{42, -32}, {52, -32}, {52, -53.6}, {60, -53.6}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(GlucoseEffect.y, synthesis.soluteFlow) annotation(Line(points = {{6, -24}, {6, -26}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Space.yBase, massFlowConstant.y) annotation(Line(points = {{6, -12}, {6, -5}, {4.5, -5}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(InsulinEffect.y, GlucoseEffect.yBase) annotation(Line(points = {{6, -20}, {6, -20}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(InsulinEffect.yBase, Space.y) annotation(Line(points = {{6, -16}, {6, -16}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(InsulinEffect.u, Insulin) annotation(Line(points = {{-3.8, -18}, {-16, -18}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(concentrationMeasure3.actualConc, GlucoseEffect.u) annotation(Line(points = {{-14, -28}, {-14, -22}, {-3.8, -22}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(cellularMetabolism.Tissue_CO2FromMetabolism, Tissue_CO2FromMetabolism) annotation(Line(points = {{91.04000000000001, -60}, {96, -60}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(glucose_MG_TO_MMOL.y, GlucoseToCellsStorageFlow) annotation(Line(points = {{32.8, -10}, {38, -10}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(GlucoseEffect.y, glucose_MG_TO_MMOL.u) annotation(Line(points = {{6, -24}, {20, -24}, {20, -10}, {24, -10}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(flowMeasure.q_in, cellularMetabolism.lactate) annotation(Line(points = {{39.2, 14}, {56, 14}, {56, -44}, {65.44, -44}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(H2OFromMetabolism, cellularMetabolism.Tissue_MotabolicH2ORate) annotation(Line(points = {{84, -80}, {78, -80}, {78, -76}, {78.23999999999999, -75.68000000000001}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(glucoseDelivery.neededFlow, synthesis.q_in) annotation(Line(points = {{-62, -39}, {-62, -54}, {-8, -54}, {-8, -32}, {-4, -32}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(glucoseDelivery.neededFlow, concentrationMeasure3.q_in) annotation(Line(points = {{-62, -39}, {-62, -54}, {-8, -54}, {-8, -32}, {-14, -32}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(glucoseDelivery.neededFlow, cellularMetabolism.glucose) annotation(Line(points = {{-62, -39}, {-62, -47.2}, {60, -47.2}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(fattyAcids, fattyAcidsDelivery.q_in) annotation(Line(points = {{-93, -68}, {-76, -68}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(PlasmaFlow1.y, fattyAcidsDelivery.solventFlow) annotation(Line(points = {{-69.59999999999999, -1}, {-66, -1}, {-66, -62}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(fattyAcidsDelivery.neededFlow, cellularMetabolism.fattyAcids) annotation(Line(points = {{-66, -73}, {-66, -80}, {54, -80}, {54, -60}, {60, -60}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(PlasmaFlow1.y, glucoseDelivery.solventFlow) annotation(Line(points = {{-69.59999999999999, -1}, {-62, -1}, {-62, -28}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(glucose, glucoseDelivery.q_in) annotation(Line(points = {{-92, -34}, {-72, -34}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(glucoseDelivery.q_out, glucose) annotation(Line(points = {{-52, -34}, {-42, -34}, {-42, -24}, {-92, -24}, {-92, -34}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(fattyAcidsDelivery.q_out, fattyAcids) annotation(Line(points = {{-56, -68}, {-42, -68}, {-42, -58}, {-93, -58}, {-93, -68}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(glucoseDelivery.FuelFractUseDelay, min.u[2]) annotation(Line(points = {{-68, -41}, {-68, -44}, {-58, -44}, {-58, 0.4}, {-52.8, 0.4}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(fattyAcidsDelivery.FuelFractUseDelay, min.u[1]) annotation(Line(points = {{-72, -75}, {-72, -92}, {-58, -92}, {-58, -0.4}, {-52.8, -0.4}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(glycogen.soluteMass, Space.u) annotation(Line(points = {{42, -39.4}, {42, -46}, {22, -46}, {22, -14}, {15.8, -14}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(pO2, cellularMetabolism.pO2) annotation(Line(points = {{32, -66}, {46.32, -66}, {46.32, -66.40000000000001}, {60.6399, -66.40000000000001}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(cellularMetabolism.O2Use, O2Use) annotation(Line(points = {{67.04000000000001, -73.44}, {67.04000000000001, -84.72}, {64, -84.72}, {64, -94}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(cellularMetabolism.ketoAcids, unlimitedStorage1.q_out) annotation(Line(points = {{71.52, -44}, {72, -44}, {72, -16}, {74.2, -16}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(Posture_Cals.y, PartCaloriesUse.u[3]) annotation(Line(points = {{7.5, 89}, {18, 89}, {18, 66}, {60, 66}, {60, 72}, {71, 72}, {71, 64.8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(ExerciseMetabolism_MotionCals, TotalCaloriesUse.u[3]) annotation(Line(points = {{-27, 67}, {-20, 67}, {-20, 52}, {71, 52}, {71, 50.8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(TotalCals.y, HeatCals.u1) annotation(Line(points = {{-4.6, 61}, {-1.3, 61}, {-1.3, 60}, {1.2, 60}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(HeatCals.y, PartCaloriesUse.u[2]) annotation(Line(points = {{11.4, 60}, {62, 60}, {62, 70}, {71, 70}, {71, 64.8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(ExerciseMetabolism_MotionCals, HeatCals.u2) annotation(Line(points = {{-27, 67}, {-20, 67}, {-20, 52}, {6, 52}, {6, 55.2}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(PartCaloriesUse.y, skeletalMuscle_HeatWithoutTermoregulation) annotation(Line(points = {{71, 55.6}, {83.5, 55.6}, {83.5, 54}, {94, 54}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(ShiveringCals, TotalCaloriesUse.u[2]) annotation(Line(points = {{-81, 51}, {-3.5, 51}, {-3.5, 50.8}, {71, 50.8}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}, grid = {2, 2}), graphics = {Text(extent=  {{-6, 80}, {16, 82}}, lineColor=  {0, 0, 255}, textString=  "Posture_Cals")}), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}, grid = {2, 2}), graphics));
      end SkeletalMuscleMetabolism;

      model RespiratoryMuscle
        extends HumMod.Metabolism.TissueMetabolism.TissueMetabolismBase(TotalCaloriesUse(nin = 4), HeatMetabolism_Skin(data = {{10.0, 0.0, 0}, {37.1, 1.0, 0.12}, {40.0, 1.5, 0}, {46.0, 0.0, 0}}));
        //    ,Lactate(stateName="RespiratoryMuscle-Lactate.Mass")
        extends PhysiolibraryOld.Icons.RespiratoryMuscle;
        PhysiolibraryOld.Blocks.CaloriesFlowConstant Shivering_Cals(k=0)
          annotation (Placement(transformation(extent={{-36,38},{-26,48}})));
        PhysiolibraryOld.Blocks.CaloriesFlowConstant motionCals(k=5)
          annotation (Placement(transformation(extent={{-38,66},{-26,78}})));
        PhysiolibraryOld.Blocks.CaloriesFlowConstant heatCals(k=16)
          annotation (Placement(transformation(extent={{-38,52},{-26,64}})));
        PhysiolibraryOld.ConcentrationFlow.MassStorageCompartment glycogen(
          stateName="RespiratoryMuscle-Glycogen.Mass",
          MINUTE_FLOW_TO_MASS_CONVERSION=0.001,
          q_out(q(unit="mg/min"), conc(unit="g")),
          initialSoluteMass(unit="g") = 46,
          STEADY=false,
          soluteMass(unit="g"))
          annotation (Placement(transformation(extent={{30,-40},{50,-20}})));
        PhysiolibraryOld.ConcentrationFlow.SoluteFlowPump synthesis
          annotation (Placement(transformation(extent={{2,-40},{22,-20}})));
        PhysiolibraryOld.Blocks.MassFlowConstant massFlowConstant(k=20)
          annotation (Placement(transformation(extent={{0,-10},{10,0}})));
        PhysiolibraryOld.Factors.CurveValue GlucoseEffect(data={{0,0.0,0.0},{
              100,1.0,0.01},{300,3.0,0.0}}, curve(iFrom(start=2)))
          annotation (Placement(transformation(extent={{2,-32},{22,-12}})));
        PhysiolibraryOld.Factors.CurveValue Space(data={{0,4.0,0.0},{40,1.0,-0.15},
              {46,0.0,0.0}}, curve(iFrom(start=2)))
          annotation (Placement(transformation(extent={{22,-24},{2,-4}})));
        PhysiolibraryOld.Factors.DelayedToSpline InsulinEffect(
          initialValue=20,
          data={{0,0.0,0.0},{20,1.0,0.2},{100,20.0,0.0}},
          curve(iFrom(start=2)),
          integrator(stateName="RespiratoryMuscle-Insulin.[InsulinDelayed]"),
          adaptationSignalName="RespiratoryMuscle-Insulin.[InsulinDelayed]")
          annotation (Placement(transformation(extent={{2,-28},{22,-8}})));
        PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
          concentrationMeasure3(unitsString="mg/dl", toAnotherUnitCoef=100)
          annotation (Placement(transformation(
              extent={{-10,-10},{10,10}},
              rotation=0,
              origin={-14,-30})));
        PhysiolibraryOld.Interfaces.RealInput_ Insulin(final unit="uU/ml")
          "tissue venous O2 partial pressure" annotation (Placement(
              transformation(
              extent={{-5,-5},{5,5}},
              rotation=0,
              origin={-16,-18}), iconTransformation(extent={{-100,-50},{-80,-30}})));
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow fattyAcids(
            conc(final unit="mg/ml"), q(final unit="mg/min")) annotation (
            Placement(transformation(extent={{-101,-78},{-81,-58}}),
              iconTransformation(extent={{90,-70},{110,-50}})));
        HumMod.Metabolism.CellularMetabolism cellularMetabolism(LacFractionData = {{10, 0, 0}, {100, 0.3, 0}}, GlycogenAvailability = {{0, 0, 0}, {5, 1, 0}}, GlycogenAvailabilityCurve(iFrom(start = 2))) annotation(Placement(transformation(extent = {{60, -76}, {92, -44}})));
        Glucose_MG_TO_MMOL glucose_MG_TO_MMOL annotation(Placement(transformation(extent = {{28, -14}, {36, -6}})));
        PhysiolibraryOld.Interfaces.RealOutput_ GlucoseToCellsStorageFlow(unit=
              "mmol/min") "glucose to muscle cells" annotation (Placement(
              transformation(extent={{36,-16},{48,-4}}), iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=270,
              origin={-90,-100})));
        NutrientDelivery fattyAcidsDelivery annotation(Placement(transformation(extent = {{-78, -78}, {-58, -58}})));
        NutrientDelivery glucoseDelivery annotation(Placement(transformation(extent = {{-70, -44}, {-50, -24}})));
        PhysiolibraryOld.Interfaces.RealOutput_ MotionCals_(unit="cal/min")
          annotation (Placement(transformation(extent={{2,66},{14,78}}),
              iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=270,
              origin={90,-100})));
        PhysiolibraryOld.ConcentrationFlow.UnlimitedStorage unlimitedStorage1(
            concentration=0)
          annotation (Placement(transformation(extent={{62,-30},{82,-10}})));
      equation
        connect(Shivering_Cals.y, TotalCaloriesUse.u[4]) annotation(Line(points = {{-25.5, 43}, {-16, 42}, {-6, 42}, {-6, 56}, {71, 56}, {71, 50.8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(motionCals.y, TotalCaloriesUse.u[2]) annotation(Line(points = {{-25.4, 72}, {-6, 72}, {-6, 56}, {71, 56}, {71, 50.8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(heatCals.y, TotalCaloriesUse.u[3]) annotation(Line(points = {{-25.4, 58}, {-6, 58}, {-6, 56}, {71, 56}, {71, 50.8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(synthesis.q_out, glycogen.q_out) annotation(Line(points = {{22, -30}, {40, -30}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(glycogen.q_out, cellularMetabolism.glycogen) annotation(Line(points = {{40, -30}, {52, -30}, {52, -53.6}, {60, -53.6}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(GlucoseEffect.y, synthesis.soluteFlow) annotation(Line(points = {{12, -24}, {12, -24}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Space.yBase, massFlowConstant.y) annotation(Line(points = {{12, -12}, {12, -5}, {10.5, -5}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(InsulinEffect.y, GlucoseEffect.yBase) annotation(Line(points = {{12, -20}, {12, -20}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(InsulinEffect.yBase, Space.y) annotation(Line(points = {{12, -16}, {12, -16}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(InsulinEffect.u, Insulin) annotation(Line(points = {{2.2, -18}, {-16, -18}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(concentrationMeasure3.actualConc, GlucoseEffect.u) annotation(Line(points = {{-14, -26}, {-14, -22}, {2.2, -22}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(TotalCaloriesUse.y, cellularMetabolism.CalsUse) annotation(Line(points = {{71, 41.6}, {71, 38}, {96, 38}, {96, -36}, {82, -36}, {82, -44}, {82.40000000000001, -44}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(cellularMetabolism.Tissue_CO2FromMetabolism, Tissue_CO2FromMetabolism) annotation(Line(points = {{91.04000000000001, -60}, {96, -60}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(glucose_MG_TO_MMOL.y, GlucoseToCellsStorageFlow) annotation(Line(points = {{36.8, -10}, {42, -10}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(GlucoseEffect.y, glucose_MG_TO_MMOL.u) annotation(Line(points = {{12, -24}, {24, -24}, {24, -10}, {28, -10}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(flowMeasure.q_in, cellularMetabolism.lactate) annotation(Line(points = {{39.2, 14}, {56, 14}, {56, -44}, {65.44, -44}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(H2OFromMetabolism, cellularMetabolism.Tissue_MotabolicH2ORate) annotation(Line(points = {{84, -80}, {78, -80}, {78, -76}, {78.23999999999999, -75.68000000000001}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(fattyAcids, fattyAcidsDelivery.q_in) annotation(Line(points = {{-91, -68}, {-78, -68}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(PlasmaFlow1.y, fattyAcidsDelivery.solventFlow) annotation(Line(points = {{-69.59999999999999, -1}, {-68, -1}, {-68, -62}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(fattyAcidsDelivery.neededFlow, cellularMetabolism.fattyAcids) annotation(Line(points = {{-68, -73}, {-68, -80}, {52, -80}, {52, -60}, {60, -60}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(glucoseDelivery.neededFlow, synthesis.q_in) annotation(Line(points = {{-60, -39}, {-60, -54}, {-4, -54}, {-4, -30}, {2, -30}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(glucoseDelivery.neededFlow, concentrationMeasure3.q_in) annotation(Line(points = {{-60, -39}, {-60, -54}, {-4, -54}, {-4, -30}, {-14, -30}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(glucoseDelivery.neededFlow, cellularMetabolism.glucose) annotation(Line(points = {{-60, -39}, {-60, -47.2}, {60, -47.2}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(PlasmaFlow1.y, glucoseDelivery.solventFlow) annotation(Line(points = {{-69.59999999999999, -1}, {-60, -1}, {-60, -28}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(glucose, glucoseDelivery.q_in) annotation(Line(points = {{-92, -34}, {-70, -34}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(glucoseDelivery.q_out, glucose) annotation(Line(points = {{-50, -34}, {-40, -34}, {-40, -24}, {-92, -24}, {-92, -34}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(fattyAcidsDelivery.q_out, fattyAcids) annotation(Line(points = {{-58, -68}, {-40, -68}, {-40, -58}, {-91, -58}, {-91, -68}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(glucoseDelivery.FuelFractUseDelay, min.u[2]) annotation(Line(points = {{-66, -41}, {-66, -46}, {-56, -46}, {-56, 0.4}, {-52.8, 0.4}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(fattyAcidsDelivery.FuelFractUseDelay, min.u[1]) annotation(Line(points = {{-74, -75}, {-74, -90}, {-56, -90}, {-56, -0.4}, {-52.8, -0.4}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(motionCals.y, MotionCals_) annotation(Line(points = {{-25.4, 72}, {8, 72}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(glycogen.soluteMass, Space.u) annotation(Line(points = {{40, -37.4}, {40, -46}, {26, -46}, {26, -14}, {21.8, -14}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(pO2, cellularMetabolism.pO2) annotation(Line(points = {{32, -66}, {46.32, -66}, {46.32, -66.40000000000001}, {60.6399, -66.40000000000001}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(cellularMetabolism.O2Use, O2Use) annotation(Line(points = {{67.04000000000001, -73.44}, {67.04000000000001, -83.72}, {64, -83.72}, {64, -94}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(cellularMetabolism.ketoAcids, unlimitedStorage1.q_out) annotation(Line(points = {{71.52, -44}, {71.52, -32}, {72.2, -32}, {72.2, -20}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        annotation(Icon(graphics), Diagram(graphics = {Text(extent=  {{-24, 46}, {-4, 46}}, lineColor=  {0, 0, 255}, textString=  "Shivering_Cals"), Text(extent=  {{-24, 74}, {-4, 74}}, lineColor=  {0, 0, 255}, textString=  "Motion_Cals"), Text(extent=  {{-24, 60}, {-4, 60}}, lineColor=  {0, 0, 255}, textString=  "Heat_Cals")}));
      end RespiratoryMuscle;

      model Brain
        extends HumMod.Metabolism.TissueMetabolism.TissueMetabolismBase;
        //  (Lactate(     stateName="Brain-Lactate.Mass"));
        extends PhysiolibraryOld.Icons.Brain;
        HumMod.Metabolism.CellularMetabolism cellularMetabolism(LacFractionData = {{10, 0, 0}, {100, 0.3, 0}}, canBurnFattyAcids = false) annotation(Placement(transformation(extent = {{59, -75}, {90, -44}})));
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow ketoAcids(
            conc(final unit="mg/ml"), q(final unit="mg/min")) annotation (
            Placement(transformation(extent={{-104,-76},{-84,-56}}),
              iconTransformation(extent={{90,-70},{110,-50}})));
        NutrientDelivery ketoAcidsDelivery annotation(Placement(transformation(extent = {{-75, -76}, {-55, -56}})));
        NutrientDelivery glucoseDelivery annotation(Placement(transformation(extent = {{-72, -44}, {-52, -24}})));
        PhysiolibraryOld.ConcentrationFlow.UnlimitedStorage unlimitedStorage(
            concentration=0)
          annotation (Placement(transformation(extent={{-2,-64},{18,-44}})));
        PhysiolibraryOld.ConcentrationFlow.UnlimitedStorage unlimitedStorage1(
            concentration=0)
          annotation (Placement(transformation(extent={{-24,-78},{-4,-58}})));
      equation
        connect(TotalCaloriesUse.y, cellularMetabolism.CalsUse) annotation(Line(points = {{71, 41.6}, {71, 34}, {98, 34}, {98, -36}, {80, -36}, {80, -44}, {80.7, -44}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(cellularMetabolism.Tissue_CO2FromMetabolism, Tissue_CO2FromMetabolism) annotation(Line(points = {{89.06999999999999, -59.5}, {94, -59.5}, {94, -60}, {96, -60}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(flowMeasure.q_in, cellularMetabolism.lactate) annotation(Line(points = {{39.2, 14}, {55, 14}, {55, -44}, {64.27, -44}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(H2OFromMetabolism, cellularMetabolism.Tissue_MotabolicH2ORate) annotation(Line(points = {{84, -80}, {77, -80}, {77, -76}, {76.67, -76}, {76.67, -74.69}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(glucoseDelivery.neededFlow, cellularMetabolism.glucose) annotation(Line(points = {{-62, -39}, {-62, -47}, {59, -47}, {59, -47.1}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(ketoAcidsDelivery.solventFlow, PlasmaFlow1.y) annotation(Line(points = {{-65, -60}, {-65, -1}, {-69.59999999999999, -1}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(ketoAcids, ketoAcidsDelivery.q_in) annotation(Line(points = {{-94, -66}, {-75, -66}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(ketoAcidsDelivery.neededFlow, cellularMetabolism.ketoAcids) annotation(Line(points = {{-65, -71}, {-65, -88}, {-30, -88}, {-30, -37}, {70, -37}, {70, -44}, {70.16, -44}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(PlasmaFlow1.y, glucoseDelivery.solventFlow) annotation(Line(points = {{-69.59999999999999, -1}, {-62, -1}, {-62, -28}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(glucose, glucoseDelivery.q_in) annotation(Line(points = {{-92, -34}, {-72, -34}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(glucoseDelivery.q_out, glucose) annotation(Line(points = {{-52, -34}, {-40, -34}, {-40, -23}, {-92, -23}, {-92, -34}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(ketoAcidsDelivery.q_out, ketoAcids) annotation(Line(points = {{-55, -66}, {-39, -66}, {-39, -57}, {-94, -57}, {-94, -66}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(glucoseDelivery.FuelFractUseDelay, min.u[2]) annotation(Line(points = {{-68, -41}, {-69, -41}, {-69, -45}, {-56, -45}, {-56, 0.4}, {-52.8, 0.4}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(ketoAcidsDelivery.FuelFractUseDelay, min.u[1]) annotation(Line(points = {{-71, -73}, {-71, -90}, {-56, -90}, {-56, -0.4}, {-52.8, -0.4}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(pO2, cellularMetabolism.pO2) annotation(Line(points = {{32, -66}, {45, -66}, {45, -65.7}, {59.6199, -65.7}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(cellularMetabolism.O2Use, O2Use) annotation(Line(points = {{65.81999999999999, -72.52}, {65.81999999999999, -83.76000000000001}, {64, -83.76000000000001}, {64, -94}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(unlimitedStorage.q_out, cellularMetabolism.glycogen) annotation(Line(points = {{8.199999999999999, -54}, {49, -54}, {49, -53.3}, {59, -53.3}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(unlimitedStorage1.q_out, cellularMetabolism.fattyAcids) annotation(Line(points = {{-13.8, -68}, {23, -68}, {23, -59.5}, {59, -59.5}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}, grid = {1, 1}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}, grid = {1, 1}), graphics));
      end Brain;

      model Kidney
        extends HumMod.Metabolism.TissueMetabolism.TissueMetabolism(TotalCaloriesUse(nin = 4));
        //, Lactate(stateName="Kidney-Lactate.Mass"));
        extends PhysiolibraryOld.Icons.Kidney;
        PhysiolibraryOld.Interfaces.RealInput_ PT_Na_Reab(final quantity="flow",
            final unit="mEq/min") annotation (Placement(transformation(extent={
                  {-38,55},{-28,65}}), iconTransformation(extent={{-100,-70},{-80,
                  -50}})));
        PhysiolibraryOld.Interfaces.RealInput_ LH_Na_Reab(final quantity="flow",
            final unit="mEq/min") annotation (Placement(transformation(extent={
                  {-38,47},{-28,57}}), iconTransformation(extent={{-100,110},{-80,
                  130}})));
        PhysiolibraryOld.Interfaces.RealInput_ DT_Na_Reab(final quantity="flow",
            final unit="mEq/min") annotation (Placement(transformation(extent={
                  {-38,39},{-28,49}}), iconTransformation(extent={{-100,-50},{-80,
                  -30}})));
        Modelica.Blocks.Math.Gain CalPerNa(k = 3.6) "CalPerNa+(Meq/Min)" annotation(Placement(transformation(extent = {{-19, 58}, {-15, 62}})));
        Modelica.Blocks.Math.Gain CalPerNa1(k = 3.6) "CalPerNa+(Meq/Min)" annotation(Placement(transformation(extent = {{-19, 42}, {-15, 46}})));
        Modelica.Blocks.Math.Gain CalPerNa2(k = 3.6) "CalPerNa+(Meq/Min)" annotation(Placement(transformation(extent = {{-19, 50}, {-15, 54}})));
      equation
        connect(CalPerNa.y, TotalCaloriesUse.u[2]) annotation(Line(points = {{-14.8, 60}, {71, 60}, {71, 50.8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(CalPerNa1.y, TotalCaloriesUse.u[3]) annotation(Line(points = {{-14.8, 44}, {14, 44}, {14, 60}, {71, 60}, {71, 50.8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(CalPerNa2.y, TotalCaloriesUse.u[4]) annotation(Line(points = {{-14.8, 52}, {15, 52}, {15, 60}, {71, 60}, {71, 50.8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(CalPerNa.u, PT_Na_Reab) annotation(Line(points = {{-19.4, 60}, {-33, 60}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(LH_Na_Reab, CalPerNa2.u) annotation(Line(points = {{-33, 52}, {-19.4, 52}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(DT_Na_Reab, CalPerNa1.u) annotation(Line(points = {{-33, 44}, {-19.4, 44}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}, grid = {1, 1}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}, grid = {1, 1}), graphics));
      end Kidney;

      model HeartMuscle
        extends HumMod.Metabolism.TissueMetabolism.TissueMetabolism(TotalCaloriesUse(nin = 3));
        parameter Real MotionCals(final unit = "cal/min");
        parameter Real HeatCals(final unit = "cal/min");
        PhysiolibraryOld.Blocks.CaloriesFlowConstant motionCals(k=MotionCals)
          annotation (Placement(transformation(extent={{-42,60},{-30,72}})));
        PhysiolibraryOld.Blocks.CaloriesFlowConstant heatCals(k=HeatCals)
          annotation (Placement(transformation(extent={{-44,38},{-32,50}})));
      equation
        connect(motionCals.y, TotalCaloriesUse.u[2]) annotation(Line(points = {{-29.4, 66}, {-8, 66}, {-8, 56}, {71, 56}, {71, 50.8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(heatCals.y, TotalCaloriesUse.u[3]) annotation(Line(points = {{-31.4, 44}, {-4, 44}, {-4, 50.8}, {71, 50.8}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Icon(graphics), Diagram(graphics));
      end HeartMuscle;

      model GITract
        extends TissueMetabolismBase;
        //(Lactate(stateName="GITract-Lactate.Mass"));
        extends PhysiolibraryOld.Icons.GITract;
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow fattyAcids(
            conc(final unit="mg/ml"), q(final unit="mg/min")) annotation (
            Placement(transformation(extent={{-103,-80},{-83,-60}}),
              iconTransformation(extent={{90,-70},{110,-50}})));
        HumMod.Metabolism.CellularMetabolism cellularMetabolism(LacFractionData = {{10, 0, 0}, {100, 0.3, 0}}) annotation(Placement(transformation(extent = {{62, -76}, {92, -46}})));
        NutrientDelivery fattyAcidsDelivery annotation(Placement(transformation(extent = {{-74, -80}, {-54, -60}})));
        NutrientDelivery glucoseDelivery annotation(Placement(transformation(extent = {{-70, -44}, {-50, -24}})));
        PhysiolibraryOld.ConcentrationFlow.FlowMeasure flowMeasure1 annotation (
           Placement(transformation(
              extent={{-8,-8},{8,8}},
              rotation=180,
              origin={28,-54})));
        PhysiolibraryOld.ConcentrationFlow.FlowMeasure flowMeasure2 annotation (
           Placement(transformation(
              extent={{-8,-8},{8,8}},
              rotation=180,
              origin={28,-82})));
        PhysiolibraryOld.Interfaces.RealOutput_ GIT_GluUse(unit="mg/min")
          annotation (Placement(transformation(extent={{34,-80},{46,-68}}),
              iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=90,
              origin={36,100})));
        PhysiolibraryOld.Interfaces.RealOutput_ GIT_FatUse(unit="mg/min")
          annotation (Placement(transformation(extent={{30,-96},{42,-84}}),
              iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=90,
              origin={16,100})));
        PhysiolibraryOld.ConcentrationFlow.UnlimitedStorage unlimitedStorage1(
            concentration=0)
          annotation (Placement(transformation(extent={{62,-14},{82,6}})));
        PhysiolibraryOld.ConcentrationFlow.UnlimitedStorage unlimitedStorage2(
            concentration=0)
          annotation (Placement(transformation(extent={{0,-48},{20,-28}})));
      equation
        connect(cellularMetabolism.Tissue_CO2FromMetabolism, Tissue_CO2FromMetabolism) annotation(Line(points = {{91.09999999999999, -61}, {96, -61}, {96, -60}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(flowMeasure.q_in, cellularMetabolism.lactate) annotation(Line(points = {{39.2, 14}, {56, 14}, {56, -46}, {67.09999999999999, -46}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(cellularMetabolism.Tissue_MotabolicH2ORate, H2OFromMetabolism) annotation(Line(points = {{79.09999999999999, -75.7}, {84, -80}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(TotalCaloriesUse.y, cellularMetabolism.CalsUse) annotation(Line(points = {{71, 41.6}, {71, 38}, {96, 38}, {96, -36}, {83, -36}, {83, -46}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(fattyAcids, fattyAcidsDelivery.q_in) annotation(Line(points = {{-93, -70}, {-74, -70}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(PlasmaFlow1.y, fattyAcidsDelivery.solventFlow) annotation(Line(points = {{-69.59999999999999, -1}, {-64, -1}, {-64, -64}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(PlasmaFlow1.y, glucoseDelivery.solventFlow) annotation(Line(points = {{-69.59999999999999, -1}, {-60, -1}, {-60, -28}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(glucose, glucoseDelivery.q_in) annotation(Line(points = {{-92, -34}, {-70, -34}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(glucoseDelivery.FuelFractUseDelay, min.u[2]) annotation(Line(points = {{-66, -41}, {-66, -44}, {-56, -44}, {-56, 0.4}, {-52.8, 0.4}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(fattyAcidsDelivery.q_out, fattyAcids) annotation(Line(points = {{-54, -70}, {-46, -70}, {-46, -60}, {-93, -60}, {-93, -70}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(glucoseDelivery.q_out, glucose) annotation(Line(points = {{-50, -34}, {-44, -34}, {-44, -22}, {-92, -22}, {-92, -34}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(flowMeasure1.q_in, cellularMetabolism.glucose) annotation(Line(points = {{31.2, -54}, {49.6, -54}, {49.6, -49}, {62, -49}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(glucoseDelivery.neededFlow, flowMeasure1.q_out) annotation(Line(points = {{-60, -39}, {-60, -54}, {24.8, -54}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(flowMeasure2.q_in, cellularMetabolism.fattyAcids) annotation(Line(points = {{31.2, -82}, {50, -82}, {50, -61}, {62, -61}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(fattyAcidsDelivery.neededFlow, flowMeasure2.q_out) annotation(Line(points = {{-64, -75}, {-64, -82}, {24.8, -82}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(flowMeasure1.actualFlow, GIT_GluUse) annotation(Line(points = {{28, -58}, {28, -74}, {40, -74}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(flowMeasure2.actualFlow, GIT_FatUse) annotation(Line(points = {{28, -86}, {28, -90}, {36, -90}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(fattyAcidsDelivery.FuelFractUseDelay, min.u[1]) annotation(Line(points = {{-70, -77}, {-70, -88}, {-56, -88}, {-56, -0.4}, {-52.8, -0.4}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(pO2, cellularMetabolism.pO2) annotation(Line(points = {{32, -66}, {47.3, -66}, {47.3, -67}, {62.5999, -67}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(cellularMetabolism.O2Use, O2Use) annotation(Line(points = {{68.59999999999999, -73.59999999999999}, {68.59999999999999, -82.8}, {64, -82.8}, {64, -94}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(cellularMetabolism.ketoAcids, unlimitedStorage1.q_out) annotation(Line(points = {{72.8, -46}, {72, -46}, {72, -4}, {72.2, -4}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(cellularMetabolism.glycogen, unlimitedStorage2.q_out) annotation(Line(points = {{62, -55}, {52, -55}, {52, -58}, {42, -58}, {42, -38}, {10.2, -38}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}, grid = {2, 2}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}, grid = {2, 2}), graphics));
      end GITract;

      model Liver
        extends TissueMetabolismBase;
        //(Lactate(stateName="Liver-Lactate.Mass"));
        extends PhysiolibraryOld.Icons.Liver;
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow fattyAcids(
            conc(final unit="mg/ml"), q(final unit="mg/min")) annotation (
            Placement(transformation(extent={{-103,-80},{-83,-60}}),
              iconTransformation(extent={{90,-70},{110,-50}})));
        HumMod.Metabolism.CellularMetabolism cellularMetabolism(LacFractionData = {{10, 0, 0}, {100, 0.3, 0}}, Ratio(start = 0.08699999999999999), glucose(conc(start = 1.43))) annotation(Placement(transformation(extent = {{62, -76}, {92, -46}})));
        NutrientDelivery_Fat fattyAcidsDelivery(neededFlow(q(start = 125.166135276543))) annotation(Placement(transformation(extent = {{-74, -80}, {-54, -60}})));
        NutrientDelivery_2 glucoseDelivery(delivery(start = 991.319)) annotation(Placement(transformation(extent = {{-72, -44}, {-52, -24}})));
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow
          GILumenCarbohydrates(conc(final unit="mg/ml"), q(final unit="mg/min"))
          annotation (Placement(transformation(extent={{-96,-58},{-76,-38}}),
              iconTransformation(extent={{-30,90},{-10,110}})));
        PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
          concentrationMeasure1(unitsString="mg/dl", toAnotherUnitCoef=100)
          annotation (Placement(transformation(
              extent={{-10,-10},{10,10}},
              rotation=270,
              origin={-32,-46})));
        PhysiolibraryOld.Interfaces.RealOutput_ PortalVeinGlucose(unit="mg/dl")
          annotation (Placement(transformation(extent={{-28,-52},{-16,-40}}),
              iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=90,
              origin={-50,100})));
        PhysiolibraryOld.Interfaces.RealOutput_ PortalVeinFat(unit="mg/dl")
          annotation (Placement(transformation(extent={{-26,-88},{-14,-76}}),
              iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=90,
              origin={14,100})));
        PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
          concentrationMeasure2(unitsString="mg/dl", toAnotherUnitCoef=100)
          annotation (Placement(transformation(
              extent={{-10,-10},{10,10}},
              rotation=270,
              origin={-32,-82})));
        PhysiolibraryOld.Interfaces.RealInput_ GITract_GlucoseUsed(final unit=
              "mg/min") "glucose to GIT metabolism flow" annotation (Placement(
              transformation(
              extent={{-5,-5},{5,5}},
              rotation=180,
              origin={-31,-18}), iconTransformation(extent={{-100,-52},{-80,-32}})));
        PhysiolibraryOld.Interfaces.RealInput_ GITract_FatUsed(final unit=
              "mg/min") "fat to GIT metabolism flow" annotation (Placement(
              transformation(
              extent={{-5,-5},{5,5}},
              rotation=180,
              origin={-31,-60}), iconTransformation(extent={{-100,-74},{-80,-54}})));
        PhysiolibraryOld.Interfaces.RealInput_ FatAbsorbtion(final unit=
              "mg/min") "from GILumen" annotation (Placement(transformation(
              extent={{-5,-5},{5,5}},
              rotation=180,
              origin={-31,-54}), iconTransformation(extent={{-100,-94},{-80,-74}})));
        PhysiolibraryOld.Interfaces.RealInput_ HepaticArtyBloodFlow(final unit=
              "ml/min")
          "blood flow through all tissue capilaries cross-section" annotation (
            Placement(transformation(extent={{-91,53},{-82,62}}),
              iconTransformation(extent={{-36,56},{-16,76}})));
        Modelica.Blocks.Math.Product PlasmaFlow2 annotation(Placement(transformation(extent = {{-70, 47}, {-62, 55}})));
        PhysiolibraryOld.ConcentrationFlow.UnlimitedStorage unlimitedStorage1(
            concentration=0)
          annotation (Placement(transformation(extent={{62,-14},{82,6}})));
        PhysiolibraryOld.ConcentrationFlow.UnlimitedStorage unlimitedStorage2(
            concentration=0)
          annotation (Placement(transformation(extent={{2,-80},{22,-60}})));
      equation
        connect(cellularMetabolism.Tissue_CO2FromMetabolism, Tissue_CO2FromMetabolism) annotation(Line(points = {{91.09999999999999, -61}, {96, -61}, {96, -60}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(flowMeasure.q_in, cellularMetabolism.lactate) annotation(Line(points = {{39.2, 14}, {56, 14}, {56, -46}, {67.09999999999999, -46}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(cellularMetabolism.Tissue_MotabolicH2ORate, H2OFromMetabolism) annotation(Line(points = {{79.09999999999999, -75.7}, {84, -80}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(TotalCaloriesUse.y, cellularMetabolism.CalsUse) annotation(Line(points = {{71, 41.6}, {71, 38}, {96, 38}, {96, -36}, {83, -36}, {83, -46}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(glucoseDelivery.neededFlow, cellularMetabolism.glucose) annotation(Line(points = {{-62, -39}, {-62, -52}, {62, -52}, {62, -49}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(fattyAcids, fattyAcidsDelivery.q_in) annotation(Line(points = {{-93, -70}, {-74, -70}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(PlasmaFlow1.y, fattyAcidsDelivery.solventFlow) annotation(Line(points = {{-69.59999999999999, -1}, {-64, -1}, {-64, -64}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(fattyAcidsDelivery.neededFlow, cellularMetabolism.fattyAcids) annotation(Line(points = {{-64, -75}, {-64, -94}, {56, -94}, {56, -61}, {62, -61}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(PlasmaFlow1.y, glucoseDelivery.solventFlow) annotation(Line(points = {{-69.59999999999999, -1}, {-62, -1}, {-62, -28}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(glucose, glucoseDelivery.q_in) annotation(Line(points = {{-92, -34}, {-72, -34}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(glucoseDelivery.FuelFractUseDelay, min.u[2]) annotation(Line(points = {{-68, -41}, {-68, -44}, {-58, -44}, {-58, 0.4}, {-52.8, 0.4}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(concentrationMeasure1.actualConc, PortalVeinGlucose) annotation(Line(points = {{-28, -46}, {-22, -46}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(concentrationMeasure2.actualConc, PortalVeinFat) annotation(Line(points = {{-28, -82}, {-20, -82}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(glucoseDelivery.neededFlow, concentrationMeasure1.q_in) annotation(Line(points = {{-62, -39}, {-62, -46}, {-32, -46}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(glucoseDelivery.q_out, glucose) annotation(Line(points = {{-52, -34}, {-42, -34}, {-42, -24}, {-92, -24}, {-92, -34}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(fattyAcidsDelivery.q_out, fattyAcids) annotation(Line(points = {{-54, -70}, {-42, -70}, {-42, -62}, {-93, -62}, {-93, -70}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(fattyAcidsDelivery.neededFlow, concentrationMeasure2.q_in) annotation(Line(points = {{-64, -75}, {-64, -82}, {-32, -82}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(GITract_GlucoseUsed, glucoseDelivery.GITUsed) annotation(Line(points = {{-31, -18}, {-54, -18}, {-54, -28}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(GITract_FatUsed, fattyAcidsDelivery.GITUsed) annotation(Line(points = {{-31, -60}, {-56, -60}, {-56, -64}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(fattyAcidsDelivery.FatAbsorbtion, FatAbsorbtion) annotation(Line(points = {{-60, -64}, {-60, -54}, {-31, -54}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(fattyAcidsDelivery.FuelFractUseDelay, min.u[1]) annotation(Line(points = {{-70, -77}, {-70, -88}, {-58, -88}, {-58, -0.4}, {-52.8, -0.4}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(BloodVol_PVCrit, PlasmaFlow2.u2) annotation(Line(points = {{-89, -4}, {-80.5, -4}, {-80.5, 48.6}, {-70.8, 48.6}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(HepaticArtyBloodFlow, PlasmaFlow2.u1) annotation(Line(points = {{-86.5, 57.5}, {-79.25, 57.5}, {-79.25, 53.4}, {-70.8, 53.4}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(PlasmaFlow2.y, glucoseDelivery.HepaticArty) annotation(Line(points = {{-61.6, 51}, {-48, 51}, {-48, -14}, {-70, -14}, {-70, -28}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(GILumenCarbohydrates, glucoseDelivery.fromGILumen) annotation(Line(points = {{-86, -48}, {-80, -48}, {-80, -38}, {-72, -38}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(cellularMetabolism.ketoAcids, unlimitedStorage1.q_out) annotation(Line(points = {{72.8, -46}, {72, -46}, {72, -4}, {72.2, -4}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(pO2, cellularMetabolism.pO2) annotation(Line(points = {{32, -66}, {46, -66}, {46, -67}, {62.5999, -67}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(cellularMetabolism.O2Use, O2Use) annotation(Line(points = {{68.59999999999999, -73.59999999999999}, {68.59999999999999, -83.8}, {64, -83.8}, {64, -94}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(unlimitedStorage2.q_out, cellularMetabolism.glycogen) annotation(Line(points = {{12.2, -70}, {22, -70}, {22, -56}, {62, -56}, {62, -55}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}, grid = {2, 2}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}, grid = {2, 2}), graphics));
      end Liver;

      model Skin
        extends TissueMetabolism(HeatMetabolism_Skin(data = {{10.0, 0.0, 0}, {29.5, 1.0, 0.12}, {40.0, 1.5, 0}, {46.0, 0.0, 0}}));
        //(Lactate(stateName="Skin-Lactate.Mass"));
        extends PhysiolibraryOld.Icons.Skin;
      end Skin;

      model Bone
        extends TissueMetabolism;
        //(Lactate(stateName="Bone-Lactate.Mass"));
        extends PhysiolibraryOld.Icons.Bone;
      end Bone;

      model Fat
        extends TissueMetabolism;
        //(Lactate(stateName="Fat-Lactate.Mass"));
        extends PhysiolibraryOld.Icons.Fat;
      end Fat;

      model OtherTissue
        extends TissueMetabolism;
        //(Lactate(stateName="OtherTissue-Lactate.Mass"));
        extends PhysiolibraryOld.Icons.OtherTissue;
      end OtherTissue;

      model Metabolism
        import QHP = HumMod;
        extends PhysiolibraryOld.Icons.Tissues;
        HumMod.Metabolism.TissueMetabolism.Bone bone(DC = 180, initialTissueO2 = 4.57, NormalCalsUsed = 69.8614) annotation(Placement(transformation(extent = {{66, 88}, {40, 114}})));
        //initialLactateMass=3.00477
        HumMod.Metabolism.TissueMetabolism.Brain brain(DC = 180, PO2OnAerobicFractionData = {{2.0, 0.0, 0}, {20.0, 1.0, 0}}, NormalCalsUsed = 193.709) annotation(Placement(transformation(extent = {{-60, 86}, {-32, 114}})));
        //initialLactateMass=0.850703,
        HumMod.Metabolism.TissueMetabolism.Fat fat(DC = 270, initialTissueO2 = 21.87, NormalCalsUsed = 29.9658) annotation(Placement(transformation(extent = {{66, -54}, {40, -28}})));
        //   initialLactateMass=2.73208,
        HumMod.Metabolism.TissueMetabolism.GITract gITract(DC = 180, initialTissueO2 = 1.826, NormalCalsUsed = 92.7945) annotation(Placement(transformation(extent = {{66, -22}, {40, 4}})));
        //    initialLactateMass=0.934802)
        HumMod.Metabolism.TissueMetabolism.Kidney kidney(DC = 20, PO2OnAerobicFractionData = {{2.0, 0.0, 0}, {20.0, 1.0, 0}}, initialTissueO2 = 0.48, NormalCalsUsed = 36.8312) annotation(Placement(transformation(extent = {{66, 10}, {40, 36}})));
        //    initialLactateMass=0.187607)
        HumMod.Metabolism.TissueMetabolism.Liver liver(DC = 100, PO2OnAerobicFractionData = {{2.0, 0.0, 0}, {10.0, 1.0, 0}}, initialTissueO2 = 2.96, NormalCalsUsed = 147.338) annotation(Placement(transformation(extent = {{66, 44}, {40, 70}})));
        //   initialLactateMass=1.13373)
        HumMod.Metabolism.TissueMetabolism.OtherTissue otherTissue(DC = 270, initialTissueO2 = 5.05, NormalCalsUsed = 39.1075) annotation(Placement(transformation(extent = {{66, -88}, {40, -62}})));
        //    initialLactateMass=2.66855)
        HumMod.Metabolism.TissueMetabolism.RespiratoryMuscle respiratoryMuscle(DC = 270, initialTissueO2 = 0.57, NormalCalsUsed = 6.27882) annotation(Placement(transformation(extent = {{-60, 52}, {-32, 80}})));
        //    initialLactateMass=2.66976)
        HumMod.Metabolism.TissueMetabolism.RightHeartMuscle rightHeart(MotionCals = 5, HeatCals = 17, DC = 3, initialTissueO2 = 0.02, NormalCalsUsed = 2.34779) annotation(Placement(transformation(extent = {{-60, 14}, {-32, 42}})));
        //    ,Lactate(stateName="RightHeart-Lactate.Mass")
        //    initialLactateMass=2.8e-002,
        HumMod.Metabolism.TissueMetabolism.LeftHeartMuscle leftHeart(MotionCals = 24, HeatCals = 87, DC = 18, initialTissueO2 = 0.115, NormalCalsUsed = 15.7067) annotation(Placement(transformation(extent = {{-60, -20}, {-32, 8}})));
        //    ,Lactate(stateName="LeftHeart-Lactate.Mass")
        //    initialLactateMass=0.169817,
        HumMod.Metabolism.TissueMetabolism.SkeletalMuscleMetabolism skeletalMuscle(DC = 1875, PO2OnAerobicFractionData = {{0.0, 0.0, 0}, {15.0, 0.2, 0.04}, {20.0, 1.0, 0}}, initialTissueO2 = 52.363, NormalCalsUsed = 145.228) annotation(Placement(transformation(extent = {{-58, -58}, {-30, -30}})));
        //    initialLactateMass=23.7503)
        HumMod.Metabolism.TissueMetabolism.Skin skin(DC = 270, PO2OnAerobicFractionData = {{2.0, 0.0, 0}, {20.0, 1.0, 0}}, initialTissueO2 = 1.84, HeatMetabolism_Skin(data = {{10.0, 0.0, 0}, {29.5, 1.0, 0.12}, {40.0, 1.5, 0}, {46.0, 0.0, 0}}), NormalCalsUsed = 31.2457) annotation(Placement(transformation(extent = {{-60, -96}, {-32, -68}})));
        //    initialLactateMass=1.64965)
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow glucose(
            conc(final unit="mg/ml"), q(final unit="mg/min")) annotation (
            Placement(transformation(extent={{-12,2},{8,22}}),
              iconTransformation(extent={{90,-20},{110,0}})));
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow fattyAcids(
            conc(final unit="mg/ml"), q(final unit="mg/min")) annotation (
            Placement(transformation(extent={{-10,-16},{10,4}}),
              iconTransformation(extent={{90,70},{110,90}})));
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow ketoAcids(
            conc(final unit="mg/ml"), q(final unit="mg/min")) annotation (
            Placement(transformation(extent={{-10,76},{10,96}}),
              iconTransformation(extent={{90,20},{110,40}})));
        PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
            Placement(transformation(extent={{-92,106},{-72,126}}),
              iconTransformation(extent={{-92,80},{-72,100}})));
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow
          GILumenCarbohydrates(conc(final unit="mg/ml"), q(final unit="mg/min"))
          annotation (Placement(transformation(extent={{70,72},{90,92}}),
              iconTransformation(extent={{-70,-110},{-50,-90}})));
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow lactate(
            conc(final unit="mEq/ml"), q(final unit="mEq/min")) annotation (
            Placement(transformation(extent={{-10,56},{10,76}}),
              iconTransformation(extent={{90,-70},{110,-50}})));
        Modelica.Blocks.Math.Feedback Heat annotation(Placement(transformation(extent = {{-5, -5}, {5, 5}}, rotation = 180, origin = {-77, -61})));
        Modelica.Blocks.Math.Sum MetabolicH2ORate(nin = 12) annotation(Placement(transformation(extent = {{80, -96}, {88, -88}})));
        Modelica.Blocks.Math.Sum CoreHeat(nin = 11) annotation(Placement(transformation(extent = {{80, -102}, {88, -94}})));
        Modelica.Blocks.Math.Sum MotionCals(nin = 3) annotation(Placement(transformation(extent = {{-6, -88}, {2, -80}})));
        Modelica.Blocks.Math.Gain gain(k = -1) annotation(Placement(transformation(extent = {{8, -86}, {12, -82}})));
      equation
        connect(brain.glucose, glucose) annotation(Line(points = {{-32, 114}, {-28, 114}, {-28, 12}, {-2, 12}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(respiratoryMuscle.glucose, glucose) annotation(Line(points = {{-32, 80}, {-28, 80}, {-28, 12}, {-2, 12}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(rightHeart.glucose, glucose) annotation(Line(points = {{-32, 42}, {-28, 42}, {-28, 12}, {-2, 12}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(leftHeart.glucose, glucose) annotation(Line(points = {{-32, 8}, {-28, 8}, {-28, 12}, {-2, 12}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(skeletalMuscle.glucose, glucose) annotation(Line(points = {{-30, -30}, {-28, -30}, {-28, 12}, {-2, 12}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(skin.glucose, glucose) annotation(Line(points = {{-32, -68}, {-28, -68}, {-28, 12}, {-2, 12}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(bone.glucose, glucose) annotation(Line(points = {{40, 114}, {24, 114}, {24, 12}, {-2, 12}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(kidney.glucose, glucose) annotation(Line(points = {{40, 36}, {24, 36}, {24, 12}, {-2, 12}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(gITract.glucose, glucose) annotation(Line(points = {{40, 4}, {24, 4}, {24, 12}, {-2, 12}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(fat.glucose, glucose) annotation(Line(points = {{40, -28}, {24, -28}, {24, 12}, {-2, 12}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(otherTissue.glucose, glucose) annotation(Line(points = {{40, -62}, {24, -62}, {24, 12}, {-2, 12}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(brain.lactate, lactate) annotation(Line(points = {{-32, 102.8}, {-24, 102.8}, {-24, 66}, {0, 66}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(respiratoryMuscle.lactate, lactate) annotation(Line(points = {{-32, 68.8}, {-24, 68.8}, {-24, 66}, {0, 66}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(leftHeart.lactate, lactate) annotation(Line(points = {{-32, -3.2}, {-24, -3.2}, {-24, 66}, {0, 66}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(rightHeart.lactate, lactate) annotation(Line(points = {{-32, 30.8}, {-24, 30.8}, {-24, 66}, {0, 66}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(skeletalMuscle.lactate, lactate) annotation(Line(points = {{-30, -41.2}, {-24, -41.2}, {-24, 66}, {0, 66}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(skin.lactate, lactate) annotation(Line(points = {{-32, -79.2}, {-24, -79.2}, {-24, 66}, {0, 66}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(bone.lactate, lactate) annotation(Line(points = {{40, 103.6}, {20, 103.6}, {20, 66}, {0, 66}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(liver.lactate, lactate) annotation(Line(points = {{40, 59.6}, {20, 59.6}, {20, 66}, {0, 66}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(kidney.lactate, lactate) annotation(Line(points = {{40, 25.6}, {20, 25.6}, {20, 66}, {0, 66}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(gITract.lactate, lactate) annotation(Line(points = {{40, -6.4}, {20, -6.4}, {20, 66}, {0, 66}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(fat.lactate, lactate) annotation(Line(points = {{40, -38.4}, {20, -38.4}, {20, 66}, {0, 66}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(otherTissue.lactate, lactate) annotation(Line(points = {{40, -72.40000000000001}, {20, -72.40000000000001}, {20, 66}, {0, 66}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(respiratoryMuscle.fattyAcids, fattyAcids) annotation(Line(points = {{-32, 57.6}, {-20, 57.6}, {-20, -6}, {0, -6}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(rightHeart.fattyAcids, fattyAcids) annotation(Line(points = {{-32, 19.6}, {-20, 19.6}, {-20, -6}, {0, -6}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(leftHeart.fattyAcids, fattyAcids) annotation(Line(points = {{-32, -14.4}, {-20, -14.4}, {-20, -6}, {0, -6}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(skeletalMuscle.fattyAcids, fattyAcids) annotation(Line(points = {{-30, -52.4}, {-20, -52.4}, {-20, -6}, {0, -6}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(skin.fattyAcids, fattyAcids) annotation(Line(points = {{-32, -90.40000000000001}, {-20, -90.40000000000001}, {-20, -6}, {0, -6}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(bone.fattyAcids, fattyAcids) annotation(Line(points = {{40, 93.2}, {16, 93.2}, {16, -6}, {0, -6}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(kidney.fattyAcids, fattyAcids) annotation(Line(points = {{40, 15.2}, {16, 15.2}, {16, -6}, {0, -6}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(gITract.fattyAcids, fattyAcids) annotation(Line(points = {{40, -16.8}, {16, -16.8}, {16, -6}, {0, -6}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(fat.fattyAcids, fattyAcids) annotation(Line(points = {{40, -48.8}, {16, -48.8}, {16, -6}, {0, -6}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(otherTissue.fattyAcids, fattyAcids) annotation(Line(points = {{40, -82.8}, {16, -82.8}, {16, -6}, {0, -6}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
        connect(busConnector.Brain_LiquidVol, brain.LiquidVol) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 105.6}, {-58.6, 105.6}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
        connect(busConnector.RespiratoryMuscle_LiquidVol, respiratoryMuscle.LiquidVol) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 71.59999999999999}, {-58.6, 71.59999999999999}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
        connect(busConnector.RightHeart_LiquidVol, rightHeart.LiquidVol) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 33.6}, {-58.6, 33.6}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
        connect(busConnector.LeftHeart_LiquidVol, leftHeart.LiquidVol) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -0.4}, {-58.6, -0.4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
        connect(busConnector.SkeletalMuscle_LiquidVol, skeletalMuscle.LiquidVol) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -38.4}, {-56.6, -38.4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
        connect(bone.LiquidVol, busConnector.Bone_LiquidVol) annotation(Line(points = {{64.7, 106.2}, {68, 106.2}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
        connect(liver.LiquidVol, busConnector.Liver_LiquidVol) annotation(Line(points = {{64.7, 62.2}, {68, 62.2}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
        connect(gITract.LiquidVol, busConnector.GITract_LiquidVol) annotation(Line(points = {{64.7, -3.8}, {68, -3.8}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
        connect(fat.LiquidVol, busConnector.Fat_LiquidVol) annotation(Line(points = {{64.7, -35.8}, {68, -35.8}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
        connect(otherTissue.LiquidVol, busConnector.OtherTissue_LiquidVol) annotation(Line(points = {{64.7, -69.8}, {68, -69.8}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
        connect(kidney.LiquidVol, busConnector.Kidney_LiquidVol) annotation(Line(points = {{64.7, 28.2}, {68, 28.2}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
        connect(busConnector.Skin_LiquidVol, skin.LiquidVol) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -76.40000000000001}, {-58.6, -76.40000000000001}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
        connect(busConnector.LeftHeart_BloodFlow, leftHeart.BloodFlow) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 5.2}, {-58.6, 5.2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
        connect(busConnector.RightHeart_BloodFlow, rightHeart.BloodFlow) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 39.2}, {-58.6, 39.2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
        connect(busConnector.Brain_BloodFlow, brain.BloodFlow) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 111.2}, {-58.6, 111.2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
        connect(busConnector.RespiratoryMuscle_BloodFlow, respiratoryMuscle.BloodFlow) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 77.2}, {-58.6, 77.2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
        connect(busConnector.SkeletalMuscle_BloodFlow, skeletalMuscle.BloodFlow) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -32.8}, {-56.6, -32.8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
        connect(busConnector.Skin_BloodFlow, skin.BloodFlow) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -70.8}, {-58.6, -70.8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
        connect(bone.BloodFlow, busConnector.Bone_BloodFlow) annotation(Line(points = {{64.7, 111.4}, {68, 111.4}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
        connect(kidney.BloodFlow, busConnector.Kidney_BloodFlow) annotation(Line(points = {{64.7, 33.4}, {68, 33.4}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
        connect(gITract.BloodFlow, busConnector.GITract_BloodFlow) annotation(Line(points = {{64.7, 1.4}, {68, 1.4}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
        connect(fat.BloodFlow, busConnector.Fat_BloodFlow) annotation(Line(points = {{64.7, -30.6}, {68, -30.6}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
        connect(otherTissue.BloodFlow, busConnector.OtherTissue_BloodFlow) annotation(Line(points = {{64.7, -64.59999999999999}, {68, -64.59999999999999}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
        connect(bone.Structure_Effect, busConnector.Bone_StructureEffect) annotation(Line(points = {{64.7, 103.6}, {68, 103.6}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
        connect(liver.Structure_Effect, busConnector.Liver_StructureEffect) annotation(Line(points = {{64.7, 59.6}, {68, 59.6}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
        connect(kidney.Structure_Effect, busConnector.Kidney_StructureEffect) annotation(Line(points = {{64.7, 25.6}, {68, 25.6}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
        connect(gITract.Structure_Effect, busConnector.GITract_StructureEffect) annotation(Line(points = {{64.7, -6.4}, {68, -6.4}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
        connect(fat.Structure_Effect, busConnector.Fat_StructureEffect) annotation(Line(points = {{64.7, -38.4}, {68, -38.4}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
        connect(otherTissue.Structure_Effect, busConnector.OtherTissue_StructureEffect) annotation(Line(points = {{64.7, -72.40000000000001}, {68, -72.40000000000001}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
        connect(busConnector.Skin_StructureEffect, skin.Structure_Effect) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -79.2}, {-58.6, -79.2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
        connect(busConnector.SkeletalMuscle_StructureEffect, skeletalMuscle.Structure_Effect) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -41.2}, {-56.6, -41.2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
        connect(busConnector.LeftHeart_StructureEffect, leftHeart.Structure_Effect) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -3.2}, {-58.6, -3.2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
        connect(busConnector.RightHeart_StructureEffect, rightHeart.Structure_Effect) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 30.8}, {-58.6, 30.8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
        connect(busConnector.RespiratoryMuscle_StructureEffect, respiratoryMuscle.Structure_Effect) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 68.8}, {-58.6, 68.8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
        connect(busConnector.Brain_StructureEffect, brain.Structure_Effect) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 102.8}, {-58.6, 102.8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
        connect(kidney.PT_Na_Reab, busConnector.PT_Na_Reab) annotation(Line(points = {{64.7, 15.2}, {68, 15.2}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
        connect(kidney.LH_Na_Reab, busConnector.LH_Na_Reab) annotation(Line(points = {{64.7, 38.6}, {68, 38.6}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
        connect(kidney.DT_Na_Reab, busConnector.DT_Na_Reab) annotation(Line(points = {{64.7, 17.8}, {68, 17.8}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
        connect(busConnector.ExerciseMetabolism_MotionCals, skeletalMuscle.ExerciseMetabolism_MotionCals) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -52.4}, {-56.6, -52.4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
        connect(busConnector.BloodVol_PVCrit, brain.BloodVol_PVCrit) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 114}, {-58.6, 114}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.BloodVol_PVCrit, respiratoryMuscle.BloodVol_PVCrit) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 80}, {-58.6, 80}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.BloodVol_PVCrit, rightHeart.BloodVol_PVCrit) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 42}, {-58.6, 42}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.BloodVol_PVCrit, leftHeart.BloodVol_PVCrit) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 8}, {-58.6, 8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.BloodVol_PVCrit, skeletalMuscle.BloodVol_PVCrit) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -30}, {-56.6, -30}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.BloodVol_PVCrit, skin.BloodVol_PVCrit) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -68}, {-58.6, -68}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.BloodVol_PVCrit, bone.BloodVol_PVCrit) annotation(Line(points = {{-82, 116}, {68, 116}, {68, 114}, {64.7, 114}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.BloodVol_PVCrit, liver.BloodVol_PVCrit) annotation(Line(points = {{-82, 116}, {68, 116}, {68, 70}, {64.7, 70}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(gITract.BloodVol_PVCrit, busConnector.BloodVol_PVCrit) annotation(Line(points = {{64.7, 4}, {68, 4}, {68, 116}, {-82, 116}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(otherTissue.BloodVol_PVCrit, busConnector.BloodVol_PVCrit) annotation(Line(points = {{64.7, -62}, {68, -62}, {68, 116}, {-82, 116}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(fat.BloodVol_PVCrit, busConnector.BloodVol_PVCrit) annotation(Line(points = {{64.7, -28}, {68, -28}, {68, 116}, {-82, 116}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.BloodVol_PVCrit, kidney.BloodVol_PVCrit) annotation(Line(points = {{-82, 116}, {68, 116}, {68, 36}, {64.7, 36}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.ThyroidEffect, brain.ThyroidEffect) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 97.2}, {-58.6, 97.2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.ThyroidEffect, respiratoryMuscle.ThyroidEffect) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 63.2}, {-58.6, 63.2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.ThyroidEffect, rightHeart.ThyroidEffect) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 25.2}, {-58.6, 25.2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.ThyroidEffect, leftHeart.ThyroidEffect) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -8.800000000000001}, {-58.6, -8.800000000000001}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.ThyroidEffect, skeletalMuscle.ThyroidEffect) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -46.8}, {-56.6, -46.8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.ThyroidEffect, skin.ThyroidEffect) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -84.8}, {-58.6, -84.8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.ThyroidEffect, bone.ThyroidEffect) annotation(Line(points = {{-82, 116}, {68, 116}, {68, 98.40000000000001}, {64.7, 98.40000000000001}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.ThyroidEffect, liver.ThyroidEffect) annotation(Line(points = {{-82, 116}, {68, 116}, {68, 54.4}, {64.7, 54.4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(gITract.ThyroidEffect, busConnector.ThyroidEffect) annotation(Line(points = {{64.7, -11.6}, {68, -11.6}, {68, 116}, {-82, 116}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(otherTissue.ThyroidEffect, busConnector.ThyroidEffect) annotation(Line(points = {{64.7, -77.59999999999999}, {68, -77.59999999999999}, {68, 116}, {-82, 116}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(fat.ThyroidEffect, busConnector.ThyroidEffect) annotation(Line(points = {{64.7, -43.6}, {68, -43.6}, {68, 116}, {-82, 116}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.ThyroidEffect, kidney.ThyroidEffect) annotation(Line(points = {{-82, 116}, {68, 116}, {68, 20.4}, {64.7, 20.4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(bone.pO2, busConnector.Bone_PO2) annotation(Line(points = {{64.7, 108.8}, {68, 108.8}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
        connect(liver.pO2, busConnector.Liver_PO2) annotation(Line(points = {{64.7, 64.8}, {68, 64.8}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
        connect(kidney.pO2, busConnector.Kidney_PO2) annotation(Line(points = {{64.7, 30.8}, {68, 30.8}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
        connect(gITract.pO2, busConnector.GITract_PO2) annotation(Line(points = {{64.7, -1.2}, {68, -1.2}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
        connect(fat.pO2, busConnector.Fat_PO2) annotation(Line(points = {{64.7, -33.2}, {68, -33.2}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
        connect(otherTissue.pO2, busConnector.OtherTissue_PO2) annotation(Line(points = {{64.7, -67.2}, {68, -67.2}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
        connect(busConnector.Skin_PO2, skin.pO2) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -73.59999999999999}, {-58.6, -73.59999999999999}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
        connect(busConnector.SkeletalMuscle_PO2, skeletalMuscle.pO2) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -35.6}, {-56.6, -35.6}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
        connect(busConnector.LeftHeart_PO2, leftHeart.pO2) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 2.4}, {-58.6, 2.4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
        connect(busConnector.RightHeart_PO2, rightHeart.pO2) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 36.4}, {-58.6, 36.4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
        connect(busConnector.RespiratoryMuscle_PO2, respiratoryMuscle.pO2) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 74.40000000000001}, {-58.6, 74.40000000000001}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
        connect(busConnector.Brain_PO2, brain.pO2) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 108.4}, {-58.6, 108.4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
        connect(bone.T, busConnector.bone_T) annotation(Line(points = {{64.7, 101}, {68, 101}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
        connect(liver.T, busConnector.liver_T) annotation(Line(points = {{64.7, 57}, {68, 57}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
        connect(kidney.T, busConnector.kidney_T) annotation(Line(points = {{64.7, 23}, {68, 23}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
        connect(gITract.T, busConnector.GITract_T) annotation(Line(points = {{64.7, -9}, {68, -9}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
        connect(fat.T, busConnector.fat_T) annotation(Line(points = {{64.7, -41}, {68, -41}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
        connect(otherTissue.T, busConnector.otherTissue_T) annotation(Line(points = {{64.7, -75}, {68, -75}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 0}, {5, 0}}));
        connect(busConnector.skin_T, skin.T) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -82}, {-58.6, -82}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
        connect(busConnector.skeletalMuscle_T, skeletalMuscle.T) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -44}, {-56.6, -44}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
        connect(busConnector.leftHeart_T, leftHeart.T) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -6}, {-58.6, -6}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
        connect(busConnector.rightHeart_T, rightHeart.T) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 28}, {-58.6, 28}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
        connect(busConnector.respiratoryMuscle_T, respiratoryMuscle.T) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 66}, {-58.6, 66}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
        connect(busConnector.brain_T, brain.T) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 100}, {-58.6, 100}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-5, 0}, {-5, 0}}));
        connect(bone.cLactate, busConnector.bone_cLactate) annotation(Line(points = {{56.9, 88}, {68, 88}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(liver.cLactate, busConnector.liver_cLactate) annotation(Line(points = {{56.9, 44}, {68, 44}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(kidney.cLactate, busConnector.kidney_cLactate) annotation(Line(points = {{56.9, 10}, {68, 10}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(gITract.cLactate, busConnector.GITract_cLactate) annotation(Line(points = {{56.9, -22}, {68, -22}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(fat.cLactate, busConnector.fat_cLactate) annotation(Line(points = {{56.9, -54}, {68, -54}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(otherTissue.cLactate, busConnector.otherTissue_cLactate) annotation(Line(points = {{56.9, -88}, {68, -88}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.skin_cLactate, skin.cLactate) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -96}, {-50.2, -96}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.skeletalMuscle_cLactate, skeletalMuscle.cLactate) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -58}, {-48.2, -58}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.leftHeart_cLactate, leftHeart.cLactate) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -20}, {-50.2, -20}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.rightHeart_cLactate, rightHeart.cLactate) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 14}, {-50.2, 14}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.respiratoryMuscle_cLactate, respiratoryMuscle.cLactate) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 52}, {-50.2, 52}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.brain_cLactate, brain.cLactate) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 86}, {-50.2, 86}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(bone.Tissue_CO2FromMetabolism, busConnector.bone_CO2FromMetabolism) annotation(Line(points = {{59.5, 88}, {68, 88}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(liver.Tissue_CO2FromMetabolism, busConnector.liver_CO2FromMetabolism) annotation(Line(points = {{59.5, 44}, {68, 44}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(kidney.Tissue_CO2FromMetabolism, busConnector.kidney_CO2FromMetabolism) annotation(Line(points = {{59.5, 10}, {68, 10}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(gITract.Tissue_CO2FromMetabolism, busConnector.GITract_CO2FromMetabolism) annotation(Line(points = {{59.5, -22}, {68, -22}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(fat.Tissue_CO2FromMetabolism, busConnector.fat_CO2FromMetabolism) annotation(Line(points = {{59.5, -54}, {68, -54}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(otherTissue.Tissue_CO2FromMetabolism, busConnector.otherTissue_CO2FromMetabolism) annotation(Line(points = {{59.5, -88}, {68, -88}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.skin_CO2FromMetabolism, skin.Tissue_CO2FromMetabolism) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -96}, {-53, -96}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.skeletalMuscle_CO2FromMetabolism, skeletalMuscle.Tissue_CO2FromMetabolism) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -58}, {-51, -58}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.leftHeart_CO2FromMetabolism, leftHeart.Tissue_CO2FromMetabolism) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -20}, {-53, -20}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.rightHeart_CO2FromMetabolism, rightHeart.Tissue_CO2FromMetabolism) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 14}, {-53, 14}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.respiratoryMuscle_CO2FromMetabolism, respiratoryMuscle.Tissue_CO2FromMetabolism) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 52}, {-53, 52}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.brain_CO2FromMetabolism, brain.Tissue_CO2FromMetabolism) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 86}, {-53, 86}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(bone.LactateFromMetabolism, busConnector.bone_LactateFromMetabolism) annotation(Line(points = {{49.1, 88}, {68, 88}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(liver.LactateFromMetabolism, busConnector.liver_LactateFromMetabolism) annotation(Line(points = {{49.1, 44}, {68, 44}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(kidney.LactateFromMetabolism, busConnector.kidney_LactateFromMetabolism) annotation(Line(points = {{49.1, 10}, {68, 10}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(gITract.LactateFromMetabolism, busConnector.GITract_LactateFromMetabolism) annotation(Line(points = {{49.1, -22}, {68, -22}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(fat.LactateFromMetabolism, busConnector.fat_LactateFromMetabolism) annotation(Line(points = {{49.1, -54}, {68, -54}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(otherTissue.LactateFromMetabolism, busConnector.otherTissue_LactateFromMetabolism) annotation(Line(points = {{49.1, -88}, {68, -88}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.skin_LactateFromMetabolism, skin.LactateFromMetabolism) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -96}, {-41.8, -96}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.skeletalMuscle_LactateFromMetabolism, skeletalMuscle.LactateFromMetabolism) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -58}, {-39.8, -58}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.leftHeart_LactateFromMetabolism, leftHeart.LactateFromMetabolism) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -20}, {-41.8, -20}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.rightHeart_LactateFromMetabolism, rightHeart.LactateFromMetabolism) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 14}, {-41.8, 14}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.respiratoryMuscle_LactateFromMetabolism, respiratoryMuscle.LactateFromMetabolism) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 52}, {-41.8, 52}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.brain_LactateFromMetabolism, brain.LactateFromMetabolism) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 86}, {-41.8, 86}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(bone.O2Use, busConnector.bone_O2Use) annotation(Line(points = {{54.3, 88}, {68, 88}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(liver.O2Use, busConnector.liver_O2Use) annotation(Line(points = {{54.3, 44}, {68, 44}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(kidney.O2Use, busConnector.kidney_O2Use) annotation(Line(points = {{54.3, 10}, {68, 10}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(gITract.O2Use, busConnector.GITract_O2Use) annotation(Line(points = {{54.3, -22}, {68, -22}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(fat.O2Use, busConnector.fat_O2Use) annotation(Line(points = {{54.3, -54}, {68, -54}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(otherTissue.O2Use, busConnector.otherTissue_O2Use) annotation(Line(points = {{54.3, -88}, {68, -88}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.skin_O2Use, skin.O2Use) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -96}, {-47.4, -96}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.skeletalMuscle_O2Use, skeletalMuscle.O2Use) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -58}, {-45.4, -58}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.leftHeart_O2Use, leftHeart.O2Use) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -20}, {-47.4, -20}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.rightHeart_O2Use, rightHeart.O2Use) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 14}, {-47.4, 14}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.respiratoryMuscle_O2Use, respiratoryMuscle.O2Use) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 52}, {-47.4, 52}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.brain_O2Use, brain.O2Use) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 86}, {-47.4, 86}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(bone.O2Need, busConnector.Bone_O2Need) annotation(Line(points = {{51.7, 88}, {68, 88}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(liver.O2Need, busConnector.Liver_O2Need) annotation(Line(points = {{51.7, 44}, {68, 44}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(kidney.O2Need, busConnector.Kidney_O2Need) annotation(Line(points = {{51.7, 10}, {68, 10}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(gITract.O2Need, busConnector.GITract_O2Need) annotation(Line(points = {{51.7, -22}, {68, -22}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(fat.O2Need, busConnector.Fat_O2Need) annotation(Line(points = {{51.7, -54}, {68, -54}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(otherTissue.O2Need, busConnector.OtherO2Need) annotation(Line(points = {{51.7, -88}, {68, -88}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.Skin_O2Need, skin.O2Need) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -96}, {-44.6, -96}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.SkeletalMuscle_O2Need, skeletalMuscle.O2Need) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -58}, {-42.6, -58}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.LeftHeart_O2Need, leftHeart.O2Need) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -20}, {-44.6, -20}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.RightHeart_O2Need, rightHeart.O2Need) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 14}, {-44.6, 14}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.RespiratoryMuscle_O2Need, respiratoryMuscle.O2Need) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 52}, {-44.6, 52}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.Brain_O2Need, brain.O2Need) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 86}, {-44.6, 86}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(bone.Fuel_FractUseDelay, busConnector.bone_Fuel_FractUseDelay) annotation(Line(points = {{62.1, 88}, {68, 88}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(liver.Fuel_FractUseDelay, busConnector.liver_Fuel_FractUseDelay) annotation(Line(points = {{62.1, 44}, {68, 44}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(kidney.Fuel_FractUseDelay, busConnector.kidney_Fuel_FractUseDelay) annotation(Line(points = {{62.1, 10}, {68, 10}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(gITract.Fuel_FractUseDelay, busConnector.GITract_Fuel_FractUseDelay) annotation(Line(points = {{62.1, -22}, {68, -22}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(fat.Fuel_FractUseDelay, busConnector.fat_Fuel_FractUseDelay) annotation(Line(points = {{62.1, -54}, {68, -54}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(otherTissue.Fuel_FractUseDelay, busConnector.otherTissue_Fuel_FractUseDelay) annotation(Line(points = {{62.1, -88}, {68, -88}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.skin_Fuel_FractUseDelay, skin.Fuel_FractUseDelay) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -96}, {-55.8, -96}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.skeletalMuscle_Fuel_FractUseDelay, skeletalMuscle.Fuel_FractUseDelay) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -58}, {-53.8, -58}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.leftHeart_Fuel_FractUseDelay, leftHeart.Fuel_FractUseDelay) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -20}, {-55.8, -20}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.rightHeart_Fuel_FractUseDelay, rightHeart.Fuel_FractUseDelay) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 14}, {-55.8, 14}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.respiratoryMuscle_Fuel_FractUseDelay, respiratoryMuscle.Fuel_FractUseDelay) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 52}, {-55.8, 52}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.brain_Fuel_FractUseDelay, brain.Fuel_FractUseDelay) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 86}, {-55.8, 86}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(brain.ketoAcids, ketoAcids) annotation(Line(points = {{-32, 91.59999999999999}, {0, 91.59999999999999}, {0, 86}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(busConnector.Insulin, skeletalMuscle.Insulin) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -49.6}, {-56.6, -49.6}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 1}, {-6, 1}}));
        connect(busConnector.Insulin, respiratoryMuscle.Insulin) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 60.4}, {-58.6, 60.4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.skeletalMuscle_GlucoseToCellStorageFlow, skeletalMuscle.GlucoseToCellsStorageFlow) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -58}, {-56.6, -58}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(busConnector.respiratoryMuscle_GlucoseToCellStorageFlow, respiratoryMuscle.GlucoseToCellsStorageFlow) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, 52}, {-58.6, 52}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(skin.TotalCalsUsed, busConnector.MetabolismCaloriesUsed_SkinHeat) annotation(Line(points = {{-36.2, -96}, {-62, -96}, {-62, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(skeletalMuscle.TotalCalsUsed, Heat.u1) annotation(Line(points = {{-34.2, -58}, {-36, -58}, {-36, -61}, {-73, -61}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.ExerciseMetabolism_MotionCals, Heat.u2) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -56}, {-77, -56}, {-77, -57}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(Heat.y, busConnector.MetabolismCaloriesUsed_SkeletalMuscleHeat) annotation(Line(points = {{-81.5, -61}, {-86, -61}, {-86, -66}, {-62, -66}, {-62, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(MetabolicH2ORate.y, busConnector.MetabolicH2O_Rate) annotation(Line(points = {{88.40000000000001, -92}, {94, -92}, {94, -82}, {68, -82}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(bone.H2OFromMetabolism, MetabolicH2ORate.u[1]) annotation(Line(points = {{46.5, 88}, {68, 88}, {68, -92.7333}, {79.2, -92.7333}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(liver.H2OFromMetabolism, MetabolicH2ORate.u[2]) annotation(Line(points = {{46.5, 44}, {68, 44}, {68, -92.59999999999999}, {79.2, -92.59999999999999}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(kidney.H2OFromMetabolism, MetabolicH2ORate.u[3]) annotation(Line(points = {{46.5, 10}, {68, 10}, {68, -92.4667}, {79.2, -92.4667}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(gITract.H2OFromMetabolism, MetabolicH2ORate.u[4]) annotation(Line(points = {{46.5, -22}, {68, -22}, {68, -92.33329999999999}, {79.2, -92.33329999999999}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(fat.H2OFromMetabolism, MetabolicH2ORate.u[5]) annotation(Line(points = {{46.5, -54}, {68, -54}, {68, -92.2}, {79.2, -92.2}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(otherTissue.H2OFromMetabolism, MetabolicH2ORate.u[6]) annotation(Line(points = {{46.5, -88}, {68, -88}, {68, -92.0667}, {79.2, -92.0667}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(MetabolicH2ORate.u[7], skin.H2OFromMetabolism) annotation(Line(points = {{79.2, -91.9333}, {-62, -91.9333}, {-62, -96}, {-39, -96}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(MetabolicH2ORate.u[8], skeletalMuscle.H2OFromMetabolism) annotation(Line(points = {{79.2, -91.8}, {-62, -91.8}, {-62, -58}, {-37, -58}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(MetabolicH2ORate.u[9], leftHeart.H2OFromMetabolism) annotation(Line(points = {{79.2, -91.66670000000001}, {-62, -91.66670000000001}, {-62, -20}, {-39, -20}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(MetabolicH2ORate.u[10], rightHeart.H2OFromMetabolism) annotation(Line(points = {{79.2, -91.5333}, {-62, -91.5333}, {-62, 14}, {-39, 14}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(MetabolicH2ORate.u[11], respiratoryMuscle.H2OFromMetabolism) annotation(Line(points = {{79.2, -91.40000000000001}, {-62, -91.40000000000001}, {-62, 52}, {-39, 52}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(MetabolicH2ORate.u[12], brain.H2OFromMetabolism) annotation(Line(points = {{79.2, -91.2667}, {-62, -91.2667}, {-62, 86}, {-39, 86}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(liver.GILumenCarbohydrates, GILumenCarbohydrates) annotation(Line(points = {{55.6, 70}, {56, 70}, {56, 82}, {80, 82}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(liver.PortalVeinGlucose, busConnector.PortalVein_Glucose) annotation(Line(points = {{59.5, 70}, {60, 70}, {60, 74}, {36, 74}, {36, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(liver.glucose, glucose) annotation(Line(points = {{40, 70}, {24, 70}, {24, 12}, {-2, 12}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(liver.fattyAcids, fattyAcids) annotation(Line(points = {{40, 49.2}, {16, 49.2}, {16, -6}, {0, -6}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(gITract.GIT_GluUse, liver.GITract_GlucoseUsed) annotation(Line(points = {{48.32, 4}, {48, 4}, {48, 6}, {80, 6}, {80, 51.54}, {64.7, 51.54}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(gITract.GIT_FatUse, liver.GITract_FatUsed) annotation(Line(points = {{50.92, 4}, {82, 4}, {82, 48.68}, {64.7, 48.68}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(liver.FatAbsorbtion, busConnector.FA_Absorbtion) annotation(Line(points = {{64.7, 46.08}, {68, 46.08}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(CoreHeat.y, busConnector.MetabolismCaloriesUsed_CoreHeat) annotation(Line(points = {{88.40000000000001, -98}, {94, -98}, {94, -88}, {68, -88}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(bone.TotalCalsUsed, CoreHeat.u[1]) annotation(Line(points = {{43.9, 88}, {68, 88}, {68, -98.7273}, {79.2, -98.7273}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(liver.TotalCalsUsed, CoreHeat.u[2]) annotation(Line(points = {{43.9, 44}, {68, 44}, {68, -98.5818}, {79.2, -98.5818}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(kidney.TotalCalsUsed, CoreHeat.u[3]) annotation(Line(points = {{43.9, 10}, {68, 10}, {68, -98.43640000000001}, {79.2, -98.43640000000001}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(gITract.TotalCalsUsed, CoreHeat.u[4]) annotation(Line(points = {{43.9, -22}, {68, -22}, {68, -98.29089999999999}, {79.2, -98.29089999999999}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(fat.TotalCalsUsed, CoreHeat.u[5]) annotation(Line(points = {{43.9, -54}, {68, -54}, {68, -98.1455}, {79.2, -98.1455}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(otherTissue.TotalCalsUsed, CoreHeat.u[6]) annotation(Line(points = {{43.9, -88}, {68, -88}, {68, -98}, {79.2, -98}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(CoreHeat.u[7], leftHeart.TotalCalsUsed) annotation(Line(points = {{79.2, -97.8545}, {-62, -97.8545}, {-62, -20}, {-36.2, -20}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(CoreHeat.u[8], rightHeart.TotalCalsUsed) annotation(Line(points = {{79.2, -97.70910000000001}, {-62, -97.70910000000001}, {-62, 14}, {-36.2, 14}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(CoreHeat.u[9], respiratoryMuscle.TotalCalsUsed) annotation(Line(points = {{79.2, -97.56359999999999}, {-62, -97.56359999999999}, {-62, 52}, {-36.2, 52}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(CoreHeat.u[10], brain.TotalCalsUsed) annotation(Line(points = {{79.2, -97.4182}, {-62, -97.4182}, {-62, 86}, {-36.2, 86}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(rightHeart.MotionCals_, MotionCals.u[1]) annotation(Line(points = {{-33.4, 14}, {-12, 14}, {-12, -84.5333}, {-6.8, -84.5333}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(leftHeart.MotionCals_, MotionCals.u[2]) annotation(Line(points = {{-33.4, -20}, {-12, -20}, {-12, -84}, {-6.8, -84}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(respiratoryMuscle.MotionCals_, MotionCals.u[3]) annotation(Line(points = {{-33.4, 52}, {-12, 52}, {-12, -83.4667}, {-6.8, -83.4667}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(MotionCals.y, gain.u) annotation(Line(points = {{2.4, -84}, {7.6, -84}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(gain.y, CoreHeat.u[11]) annotation(Line(points = {{12.2, -84}, {20, -84}, {20, -97.2727}, {79.2, -97.2727}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(liver.BloodFlow, busConnector.Liver_BloodFlow) annotation(Line(points = {{64.7, 67.40000000000001}, {68, 67.40000000000001}, {68, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(liver.HepaticArtyBloodFlow, busConnector.HepaticArty_BloodFlow) annotation(Line(points = {{56.38, 65.58}, {56.38, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(skeletalMuscle.skeletalMuscle_HeatWithoutTermoregulation, busConnector.skeletalMuscle_HeatWithoutTermoregulation) annotation(Line(points = {{-31.4, -58}, {-30, -58}, {-30, -64}, {-62, -64}, {-62, 116}, {-82, 116}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(busConnector.skeletalMuscle_shiveringCals, skeletalMuscle.ShiveringCals) annotation(Line(points = {{-82, 116}, {-62, 116}, {-62, -27.2}, {-56.6, -27.2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 120}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 120}}), graphics = {Text(extent=  {{-166, 136}, {154, 108}}, lineColor=  {0, 0, 255}, textString=  "%name"), Bitmap(extent=  {{28, 120}, {98, 44}}, fileName=  "icons/ohen.png")}));
      end Metabolism;

      model NutrientDelivery
        PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow q_out
          annotation (extent=[-10,-110; 10,-90], Placement(transformation(
                extent={{90,-10},{110,10}})));
        PhysiolibraryOld.Interfaces.RealInput_ solventFlow
          annotation (extent=[-10,50; 10,70], rotation=-90);
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow q_in
          annotation (Placement(transformation(extent={{-120,-20},{-80,20}}),
              iconTransformation(extent={{-110,-10},{-90,10}})));
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow neededFlow
          annotation (Placement(transformation(extent={{24,-110},{44,-90}}),
              iconTransformation(extent={{-10,-60},{10,-40}})));
        PhysiolibraryOld.ConcentrationFlow.SolventFlowPump toCapylaries
          annotation (Placement(transformation(extent={{-90,-10},{-70,10}})));
        FuelDeficit fuelDeficit annotation(Placement(transformation(extent = {{-10, -52}, {10, -32}})));
        PhysiolibraryOld.ConcentrationFlow.FlowMeasure flowMeasure
          annotation (Placement(transformation(extent={{-44,10},{-24,-10}})));
        PhysiolibraryOld.Interfaces.RealOutput_ FuelFractUseDelay annotation (
            Placement(transformation(extent={{-80,-60},{-66,-46}}),
              iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=270,
              origin={-60,-70})));
      equation
        connect(solventFlow, toCapylaries.solventFlow) annotation(Line(points = {{0, 60}, {0, 28}, {-80, 28}, {-80, 6}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(q_in, toCapylaries.q_in) annotation(Line(points = {{-100, 0}, {-90, 0}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(fuelDeficit.neededFlow, neededFlow) annotation(Line(points = {{10, -42}, {34, -42}, {34, -100}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(toCapylaries.q_out, flowMeasure.q_in) annotation(Line(points = {{-70, 0}, {-38, 0}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(flowMeasure.q_out, fuelDeficit.delivered) annotation(Line(points = {{-30, 0}, {0, 0}, {0, -32}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(flowMeasure.actualFlow, fuelDeficit.maximalDeliveryFlow) annotation(Line(points = {{-34, -5}, {-34, -36}, {-10, -36}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(fuelDeficit.FractUseDelay, FuelFractUseDelay) annotation(Line(points = {{0, -52}, {0, -53}, {-73, -53}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(flowMeasure.q_out, q_out) annotation(Line(points = {{-30, 0}, {100, 0}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Rectangle(extent=  {{-100, -50}, {100, 50}}, lineColor=  {0, 0, 127}, fillColor=  {255, 255, 255}, fillPattern=  FillPattern.Solid), Polygon(points=  {{-80, 25}, {80, 0}, {-80, -25}, {-80, 25}}, lineColor=  {0, 0, 127}, fillColor=  {255, 255, 255}, fillPattern=  FillPattern.Solid), Text(extent=  {{10, -84}, {240, -48}}, textString=  "%name", lineColor=  {0, 0, 255})}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Documentation(revisions = "<html>
                   <p><i>2009-2010</i></p>
                   <p>Marek Matejak, Charles University, Prague, Czech Republic </p>
                   </html>"), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
      end NutrientDelivery;

      model FuelDeficit
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow delivered
          "delivery flow is limited" annotation (Placement(transformation(
                extent={{-38,72},{2,112}}), iconTransformation(extent={{-10,90},
                  {10,110}})));
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow neededFlow
          "needed solute mass flow have to be achieved" annotation (Placement(
              transformation(extent={{88,-28},{108,-8}}), iconTransformation(
                extent={{90,-10},{110,10}})));
        PhysiolibraryOld.Interfaces.RealInput_ maximalDeliveryFlow
          "maximal flow limit of delivered connector" annotation (Placement(
              transformation(extent={{-120,40},{-80,80}}), iconTransformation(
                extent={{-120,40},{-80,80}})));
        PhysiolibraryOld.Interfaces.RealOutput_ FractUseDelay(start=1)
          "less than 1 if neededFlow is grater than delivered flow" annotation (
           Placement(transformation(
              extent={{-20,-20},{20,20}},
              rotation=270,
              origin={0,-100})));
        parameter Real Zero = 0.1;
      equation
        delivered.conc = neededFlow.conc;
        if not initial() and (-neededFlow.q) > maximalDeliveryFlow and (-neededFlow.q) > Zero then
          delivered.q = maximalDeliveryFlow;
          FractUseDelay * (-neededFlow.q) = delivered.q;
        else
          delivered.q + neededFlow.q = 0;
          FractUseDelay = 1;
        end if;
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
      end FuelDeficit;

      model LeftHeartMuscle
        extends HeartMuscle;
        extends PhysiolibraryOld.Icons.LeftHeart;
        PhysiolibraryOld.Interfaces.RealOutput_ MotionCals_(unit="cal/min")
          annotation (Placement(transformation(extent={{-6,60},{6,72}}),
              iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=270,
              origin={90,-100})));
      equation
        connect(motionCals.y, MotionCals_) annotation(Line(points = {{-29.4, 66}, {0, 66}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Icon(graphics), Diagram(graphics));
      end LeftHeartMuscle;

      model RightHeartMuscle
        extends HeartMuscle;
        extends PhysiolibraryOld.Icons.RightHeart;
        PhysiolibraryOld.Interfaces.RealOutput_ MotionCals_(unit="cal/min")
          annotation (Placement(transformation(extent={{-2,60},{10,72}}),
              iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=270,
              origin={90,-100})));
      equation
        connect(motionCals.y, MotionCals_) annotation(Line(points = {{-29.4, 66}, {4, 66}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Icon(graphics));
      end RightHeartMuscle;

      model FuelDeficit2
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow delivered
          "delivery flow is limited" annotation (Placement(transformation(
                extent={{-38,72},{2,112}}), iconTransformation(extent={{-10,90},
                  {10,110}})));
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow neededFlow
          "needed solute mass flow have to be achieved" annotation (Placement(
              transformation(extent={{88,-28},{108,-8}}), iconTransformation(
                extent={{90,-10},{110,10}})));
        PhysiolibraryOld.Interfaces.RealInput_ maximalDeliveryFlow
          "maximal flow limit of delivered connector" annotation (Placement(
              transformation(extent={{-120,40},{-80,80}}), iconTransformation(
                extent={{-120,40},{-80,80}})));
        PhysiolibraryOld.Interfaces.RealOutput_ FractUseDelay
          "less than 1 if neededFlow is grater than delivered flow" annotation (
           Placement(transformation(
              extent={{-20,-20},{20,20}},
              rotation=270,
              origin={0,-100})));
        parameter Real Zero = 1e-010;
        PhysiolibraryOld.Interfaces.RealInput_ concChange
          "aditional change of delivered concentration" annotation (Placement(
              transformation(extent={{-120,0},{-80,40}}), iconTransformation(
                extent={{-120,-80},{-80,-40}})));
      equation
        delivered.conc + concChange = neededFlow.conc;
        if (-neededFlow.q) > maximalDeliveryFlow then
          delivered.q = maximalDeliveryFlow;
          FractUseDelay = delivered.q / (-neededFlow.q);
        else
          delivered.q + neededFlow.q = 0;
          FractUseDelay = 1;
        end if;
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
      end FuelDeficit2;

      model NutrientDelivery_Fat
        PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow q_out
          annotation (extent=[-10,-110; 10,-90], Placement(transformation(
                extent={{90,-10},{110,10}})));
        PhysiolibraryOld.Interfaces.RealInput_ solventFlow
          annotation (extent=[-10,50; 10,70], rotation=-90);
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow q_in
          annotation (Placement(transformation(extent={{-120,-20},{-80,20}}),
              iconTransformation(extent={{-110,-10},{-90,10}})));
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow neededFlow
          annotation (Placement(transformation(extent={{24,-110},{44,-90}}),
              iconTransformation(extent={{-10,-60},{10,-40}})));
        PhysiolibraryOld.ConcentrationFlow.SolventFlowPump toCapylaries
          annotation (Placement(transformation(extent={{-90,-10},{-70,10}})));
        FuelDeficit2 fuelDeficit annotation(Placement(transformation(extent = {{-10, -52}, {10, -32}})));
        PhysiolibraryOld.ConcentrationFlow.FlowMeasure flowMeasure
          annotation (Placement(transformation(extent={{-44,10},{-24,-10}})));
        PhysiolibraryOld.Interfaces.RealOutput_ FuelFractUseDelay annotation (
            Placement(transformation(extent={{-80,-60},{-66,-46}}),
              iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=270,
              origin={-60,-70})));
        PhysiolibraryOld.Interfaces.RealInput_ GITUsed "GITract concumption"
          annotation (Placement(transformation(extent={{-94,-50},{-74,-30}}),
              iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=270,
              origin={80,60})));
        Modelica.Blocks.Math.Feedback feedback annotation(Placement(transformation(extent = {{-54, -40}, {-42, -28}})));
        Modelica.Blocks.Math.Division division annotation(Placement(transformation(extent = {{-32, -50}, {-22, -40}})));
        PhysiolibraryOld.Interfaces.RealInput_ FatAbsorbtion
          "fat from GILumen absorbtion" annotation (Placement(transformation(
                extent={{-94,-36},{-74,-16}}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=270,
              origin={40,60})));
      equation
        connect(solventFlow, toCapylaries.solventFlow) annotation(Line(points = {{0, 60}, {0, 28}, {-80, 28}, {-80, 6}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(q_in, toCapylaries.q_in) annotation(Line(points = {{-100, 0}, {-90, 0}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(fuelDeficit.neededFlow, neededFlow) annotation(Line(points = {{10, -42}, {34, -42}, {34, -100}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(toCapylaries.q_out, flowMeasure.q_in) annotation(Line(points = {{-70, 0}, {-38, 0}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(flowMeasure.q_out, fuelDeficit.delivered) annotation(Line(points = {{-30, 0}, {0, 0}, {0, -32}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(flowMeasure.actualFlow, fuelDeficit.maximalDeliveryFlow) annotation(Line(points = {{-34, -5}, {-34, -36}, {-10, -36}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(fuelDeficit.FractUseDelay, FuelFractUseDelay) annotation(Line(points = {{0, -52}, {0, -53}, {-73, -53}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(flowMeasure.q_out, q_out) annotation(Line(points = {{-30, 0}, {100, 0}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(GITUsed, feedback.u2) annotation(Line(points = {{-84, -40}, {-49, -40}, {-49, -38.8}, {-48, -38.8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(feedback.y, division.u1) annotation(Line(points = {{-42.6, -34}, {-38, -34}, {-38, -42}, {-33, -42}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(solventFlow, division.u2) annotation(Line(points = {{0, 60}, {0, 28}, {-40, 28}, {-40, -48}, {-33, -48}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(division.y, fuelDeficit.concChange) annotation(Line(points = {{-21.5, -45}, {-15.75, -45}, {-15.75, -48}, {-10, -48}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(FatAbsorbtion, feedback.u1) annotation(Line(points = {{-84, -26}, {-68, -26}, {-68, -34}, {-52.8, -34}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Rectangle(extent=  {{-100, -50}, {100, 50}}, lineColor=  {0, 0, 127}, fillColor=  {255, 255, 255}, fillPattern=  FillPattern.Solid), Polygon(points=  {{-80, 25}, {80, 0}, {-80, -25}, {-80, 25}}, lineColor=  {0, 0, 127}, fillColor=  {255, 255, 255}, fillPattern=  FillPattern.Solid), Text(extent=  {{10, -84}, {240, -48}}, textString=  "%name", lineColor=  {0, 0, 255})}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Documentation(revisions = "<html>
                   <p><i>2009-2010</i></p>
                   <p>Marek Matejak, Charles University, Prague, Czech Republic </p>
                   </html>"), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
      end NutrientDelivery_Fat;

      model NutrientDelivery_2
        PhysiolibraryOld.ConcentrationFlow.NegativeConcentrationFlow q_out
          "Base plasma pool of glucose, outflow of glucose to plasma pool from tissue"
          annotation (extent=[-10,-110; 10,-90], Placement(transformation(
                extent={{90,-10},{110,10}})));
        PhysiolibraryOld.Interfaces.RealInput_ solventFlow
          "Portal vein plus hepatic artery plasma flow"
          annotation (extent=[-10,50; 10,70], rotation=-90);
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow q_in
          "Base plasma pool of glucose, delivery of glucose minus absorbtion from GI lumen"
          annotation (Placement(transformation(extent={{-120,-20},{-80,20}}),
              iconTransformation(extent={{-110,-10},{-90,10}})));
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow neededFlow
          "Glucose flow to metabolism, its concentration in tissue" annotation (
           Placement(transformation(extent={{24,-110},{44,-90}}),
              iconTransformation(extent={{-10,-60},{10,-40}})));
        PhysiolibraryOld.Interfaces.RealOutput_ FuelFractUseDelay
          "1 if enough glucose delivery" annotation (Placement(transformation(
                extent={{-80,-60},{-66,-46}}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=270,
              origin={-60,-70})));
        PhysiolibraryOld.Interfaces.RealInput_ GITUsed
          "Negative GITract consumption" annotation (Placement(transformation(
                extent={{-94,-50},{-74,-30}}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=270,
              origin={80,60})));
        PhysiolibraryOld.ConcentrationFlow.PositiveConcentrationFlow
          fromGILumen
          "Absorbtion flow of glucose from gastro intestinal lumen and GIT glucose concentration"
          annotation (Placement(transformation(extent={{-92,-28},{-72,-8}}),
              iconTransformation(extent={{-110,-50},{-90,-30}})));
        PhysiolibraryOld.Interfaces.RealInput_ HepaticArty
          "Hepatic artery plasma flow" annotation (Placement(transformation(
                extent={{-96,44},{-76,64}}), iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=270,
              origin={-80,60})));
        Real consumption;
        //  Real fromGILumen_conc;
        Real delivery(start = 300);
      equation
        //  delivered.conc  = neededFlow.conc + concChange;
        if (-neededFlow.q) > delivery then
          consumption = delivery;
          FuelFractUseDelay = consumption / (-neededFlow.q);
        else
          consumption + neededFlow.q = 0;
          FuelFractUseDelay = 1;
        end if;
        delivery = q_in.q + fromGILumen.q + GITUsed;
        consumption = q_in.q + q_out.q + fromGILumen.q;
        neededFlow.conc * solventFlow = -q_out.q;
        q_in.q = q_in.conc * solventFlow;
        //calculation of glucose concentration in gartro intestinal tract:  fromGILumen.conc
        q_in.conc = fromGILumen.conc;
        //  fromGILumen.q + q_in.conc * (solventFlow-HepaticArty) + GITUsed = fromGILumen.conc * (solventFlow-HepaticArty);
        annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Rectangle(extent=  {{-100, -50}, {100, 50}}, lineColor=  {0, 0, 127}, fillColor=  {255, 255, 255}, fillPattern=  FillPattern.Solid), Polygon(points=  {{-80, 25}, {80, 0}, {-80, -25}, {-80, 25}}, lineColor=  {0, 0, 127}, fillColor=  {255, 255, 255}, fillPattern=  FillPattern.Solid), Text(extent=  {{10, -84}, {240, -48}}, textString=  "%name", lineColor=  {0, 0, 255})}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Documentation(revisions = "<html>
                   <p><i>2012</i></p>
                   <p>Marek Matejak, Charles University, Prague, Czech Republic </p>
                   </html>"), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
      end NutrientDelivery_2;
      annotation(Documentation(revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>2009</td>
                   </tr>
                   </table>
                   </html>"));
    end TissueMetabolism;
    annotation(Documentation(revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr>
                   </table>
                   </html>"), Icon(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics));
  end Metabolism;

  package Hormones "Hormones"
    extends PhysiolibraryOld.Icons.HormonesLib;
    model Insulin
      extends PhysiolibraryOld.Icons.Pancreas;
      // outer parameter Real ECF_Vol(final unit="ml");
      PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment InsulinPool(
          stateName="InsulinPool.Mass", initialSoluteMass=324)
        "0.021 mU/ml * 15000 ml  = 307 mU .. all initial extracellular insulin"
        annotation (Placement(transformation(extent={{-86,-26},{-66,-6}})));
      PhysiolibraryOld.ConcentrationFlow.SoluteFlowPump secretion
        annotation (Placement(transformation(extent={{32,-14},{12,6}})));
      PhysiolibraryOld.ConcentrationFlow.InputPump synthesis
        annotation (Placement(transformation(extent={{90,-14},{70,6}})));
      PhysiolibraryOld.ConcentrationFlow.OutputPump clearance
        annotation (Placement(transformation(extent={{-54,-16},{-34,-36}})));
      PhysiolibraryOld.ConcentrationFlow.FlowConcentrationMeasure
        PortalVeinConcentration
        annotation (Placement(transformation(extent={{-66,2},{-46,22}})));
      PhysiolibraryOld.ConcentrationFlow.MassStorageCompartment InsulinStorage(
          stateName="InsulinStorage.Mass", initialSoluteMass=1954.91)
        annotation (Placement(transformation(
            extent={{-10,10},{10,-10}},
            rotation=180,
            origin={52,-4})));
      Modelica.Blocks.Math.Gain gain(k = 0.0571413755) annotation(Placement(transformation(extent = {{-64, -42}, {-58, -36}})));
      PhysiolibraryOld.Factors.CurveValue KAEffect(data={{0.0,0.6,0},{0.5,1.0,
            0.05},{50.0,2.0,0}}, curve(iFrom(start=2)))
        annotation (Placement(transformation(extent={{12,0},{32,20}})));
      PhysiolibraryOld.Factors.CurveValue MassEffect(data={{0,200,0},{2000,17,-0.02},
            {3000,0,0}})
        annotation (Placement(transformation(extent={{70,64},{90,84}})));
      PhysiolibraryOld.Blocks.Constant hormoneFlowConstant(k=1)
        annotation (Placement(transformation(extent={{88,78},{82,84}})));
      PhysiolibraryOld.Factors.CurveValueWithLinearSimplificationByHomotopy
        GlucoseEffect(
        data={{0,0.0,0},{105,1.0,0.01},{600,50.0,0}},
        defaultU=105,
        defaultSlope=0.01,
        defaultValue=1,
        curve(iFrom(start=2)))
        annotation (Placement(transformation(extent={{12,4},{32,24}})));
      PhysiolibraryOld.Factors.SimpleMultiply FunctionEffect
        annotation (Placement(transformation(extent={{12,-4},{32,16}})));
      PhysiolibraryOld.Factors.SimpleMultiply BasicFraction
        annotation (Placement(transformation(extent={{32,8},{12,28}})));
      PhysiolibraryOld.Blocks.Constant Constant(k=0.008500000000000001)
        annotation (Placement(transformation(extent={{48,12},{36,24}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
        concentrationMeasure(unitsString="uU/l", toAnotherUnitCoef=1)
        annotation (Placement(transformation(
            extent={{-10,-10},{10,10}},
            rotation=0,
            origin={-80,10})));
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{-108,30},{-88,50}}),
            iconTransformation(extent={{-90,-70},{-70,-50}})));
      PhysiolibraryOld.Interfaces.RealOutput_ Insulin(quantity="Concentration",
          final unit="uU/ml") annotation (Placement(transformation(extent={{-88,
                -70},{-68,-50}}), iconTransformation(extent={{80,-20},{120,20}})));
      Modelica.Blocks.Math.Gain mU_per_l(k = 10 ^ 3) "from mU/ml to mU/l" annotation(Placement(transformation(extent = {{-40, 8}, {-32, 16}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
        concentrationMeasure1(unitsString="uU/ml", toAnotherUnitCoef=1000)
        annotation (Placement(transformation(
            extent={{-10,-10},{10,10}},
            rotation=0,
            origin={-84,2})));
      PhysiolibraryOld.Blocks.Integrator integrator(
        k=1/20/PhysiolibraryOld.SecPerMin,
        stateName="InsulinSynthesis.Rate",
        y_start=18.1363) annotation (Placement(transformation(
            extent={{-10,-10},{10,10}},
            rotation=270,
            origin={80,24})));
      Modelica.Blocks.Math.Feedback feedback annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 270, origin = {80, 56})));
      PhysiolibraryOld.Blocks.Integrator integrator1(
        k=1/40/PhysiolibraryOld.SecPerMin,
        stateName="LM_Insulin.[InsulinDelayed]",
        y_start=57) annotation (Placement(transformation(
            extent={{-5,-5},{5,5}},
            rotation=270,
            origin={25,-63})));
      Modelica.Blocks.Math.Feedback feedback1 annotation(Placement(transformation(extent = {{-7, -7}, {7, 7}}, rotation = 270, origin = {25, -45})));
      PhysiolibraryOld.Interfaces.RealOutput_ LM_Insulin_InsulinDelayed(
          quantity="Concentration", unit="uU/ml") annotation (Placement(
            transformation(extent={{52,-86},{72,-66}}), iconTransformation(
              extent={{80,-60},{120,-20}})));
    equation
      connect(InsulinPool.soluteMass, gain.u) annotation(Line(points = {{-76, -23.8}, {-76, -39}, {-64.59999999999999, -39}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(gain.y, clearance.desiredFlow) annotation(Line(points = {{-57.7, -39}, {-44, -39}, {-44, -30}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(InsulinStorage.soluteMass, MassEffect.u) annotation(Line(points = {{52, -11.4}, {52, 74}, {70.2, 74}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(hormoneFlowConstant.y, MassEffect.yBase) annotation(Line(points = {{81.7, 81}, {80, 81}, {80, 76}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(secretion.soluteFlow, FunctionEffect.y) annotation(Line(points = {{22, 2}, {22, 4}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(FunctionEffect.yBase, KAEffect.y) annotation(Line(points = {{22, 8}, {22, 8}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(KAEffect.yBase, GlucoseEffect.y) annotation(Line(points = {{22, 12}, {22, 12}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(GlucoseEffect.yBase, BasicFraction.y) annotation(Line(points = {{22, 16}, {22, 16}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Constant.y, BasicFraction.u) annotation(Line(points = {{35.4, 18}, {31.8, 18}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(InsulinStorage.soluteMass, BasicFraction.yBase) annotation(Line(points = {{52, -11.4}, {52, 40}, {22, 40}, {22, 20}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(PortalVeinConcentration.AdditionalSoluteFlow, FunctionEffect.y) annotation(Line(points = {{-56, 6}, {-56, 4}, {22, 4}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.Glucose, GlucoseEffect.u) annotation(Line(points = {{-98, 40}, {4, 40}, {4, 14}, {12.2, 14}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.GITractFunctionEffect, FunctionEffect.u) annotation(Line(points = {{-98, 40}, {4.1, 40}, {4.1, 6}, {12.2, 6}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(InsulinPool.q_out, PortalVeinConcentration.q_in) annotation(Line(points = {{-76, -16}, {-76, 12}, {-66, 12}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(InsulinPool.q_out, secretion.q_out) annotation(Line(points = {{-76, -16}, {-58, -16}, {-58, -4}, {12, -4}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(secretion.q_in, InsulinStorage.q_out) annotation(Line(points = {{32, -4}, {52, -4}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(InsulinStorage.q_out, synthesis.q_out) annotation(Line(points = {{52, -4}, {74, -4}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(clearance.q_in, InsulinPool.q_out) annotation(Line(points = {{-50, -26}, {-58, -26}, {-58, -16}, {-76, -16}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(concentrationMeasure.q_in, InsulinPool.q_out) annotation(Line(points = {{-80, 10}, {-76, 10}, {-76, -16}}, color = {200, 0, 0}, smooth = Smooth.None, thickness = 1));
      connect(busConnector.PortalVein_PlasmaFlow, PortalVeinConcentration.SolventFlow) annotation(Line(points = {{-98, 40}, {-56, 40}, {-56, 18}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-3, 3}, {-3, 3}}));
      connect(busConnector.ECFV_Vol, InsulinPool.SolventVolume) annotation(Line(points = {{-98, 40}, {-98, -10}, {-84, -10}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(mU_per_l.y, busConnector.PortalVein_Insulin) annotation(Line(points = {{-31.6, 12}, {-26, 12}, {-26, 40}, {-98, 40}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(PortalVeinConcentration.Conc, mU_per_l.u) annotation(Line(points = {{-45.8, 12}, {-40.8, 12}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(concentrationMeasure1.actualConc, Insulin) annotation(Line(points = {{-84, 6}, {-84, 10}, {-90, 10}, {-90, -60}, {-78, -60}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(InsulinPool.q_out, concentrationMeasure1.q_in) annotation(Line(points = {{-76, -16}, {-80, -16}, {-80, 2}, {-84, 2}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(concentrationMeasure1.actualConc, busConnector.Insulin) annotation(Line(points = {{-84, 6}, {-84, 40}, {-98, 40}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(feedback.y, integrator.u) annotation(Line(points = {{80, 47}, {80, 36}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(integrator.y, feedback.u2) annotation(Line(points = {{80, 13}, {80, 4}, {62, 4}, {62, 56}, {72, 56}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(MassEffect.y, feedback.u1) annotation(Line(points = {{80, 72}, {80, 64}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(integrator.y, synthesis.desiredFlow) annotation(Line(points = {{80, 13}, {80, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(feedback1.y, integrator1.u) annotation(Line(points = {{25, -51.3}, {24, -52}, {25, -52}, {25, -57}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(integrator1.y, feedback1.u2) annotation(Line(points = {{25, -68.5}, {25, -76}, {10, -76}, {10, -45}, {19.4, -45}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(mU_per_l.y, feedback1.u1) annotation(Line(points = {{-31.6, 12}, {-26, 12}, {-26, -30}, {25, -30}, {25, -39.4}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.KAPool_mg_per_dl, KAEffect.u) annotation(Line(points = {{-98, 40}, {4, 40}, {4, 10}, {12.2, 10}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(integrator1.y, LM_Insulin_InsulinDelayed) annotation(Line(points = {{25, -68.5}, {25, -76}, {62, -76}}, color = {0, 0, 127}, smooth = Smooth.None));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-100, 80}, {100, 100}}, lineColor=  {0, 0, 255}, textString=  "%name")}));
    end Insulin;

    model Glucagon
      extends PhysiolibraryOld.Icons.Pancreas;
      // outer parameter Real ECF_Vol(final unit="ml");
      Modelica.Blocks.Math.Gain gain(k = 0.05) annotation(Placement(transformation(extent = {{-44, -32}, {-38, -26}})));
      PhysiolibraryOld.ConcentrationFlow.OutputPump clearance
        annotation (Placement(transformation(extent={{-34,-6},{-14,-26}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment GlucagonPool(
          stateName="GlucagonPool.Mass", initialSoluteMass=990.792)
        "66.2 pg/ml * 15000 ml * 0.001 ng/pg = 993 ng .. all initial extracellular glucagon"
        annotation (Placement(transformation(extent={{-66,-16},{-46,4}})));
      PhysiolibraryOld.ConcentrationFlow.FlowConcentrationMeasure
        PortalVeinConcentration
        annotation (Placement(transformation(extent={{-54,8},{-34,28}})));
      PhysiolibraryOld.ConcentrationFlow.InputPump synthesis
        annotation (Placement(transformation(extent={{78,-16},{58,4}})));
      PhysiolibraryOld.Blocks.HormoneFlowConstant_nG hormoneFlowConstant_pG(k=
            50) annotation (Placement(transformation(extent={{80,18},{72,26}})));
      PhysiolibraryOld.Factors.CurveValue InsulinEffect(data={{0,6.0,0},{7,1.3,
            -0.02},{20,1.0,-0.006},{100,0.6,0}}, curve(iFrom(start=3)))
        annotation (Placement(transformation(extent={{78,0},{58,20}})));
      PhysiolibraryOld.Factors.CurveValue GlucoseEffect(data={{0,2.5,0},{70,1.1,
            -0.005},{110,1.0,-0.001},{400,0.6,0}}, curve(iFrom(start=2)))
        annotation (Placement(transformation(extent={{58,4},{78,24}})));
      PhysiolibraryOld.Factors.SimpleMultiply FunctionEffect
        annotation (Placement(transformation(extent={{58,-4},{78,16}})));
      Modelica.Blocks.Math.Gain gain1(k = 0.001) annotation(Placement(transformation(extent = {{-76, 0}, {-72, 4}})));
      Modelica.Blocks.Math.Gain gain2(k = 0.001) annotation(Placement(transformation(extent = {{-52, 28}, {-48, 32}})));
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{-98,68},{-78,88}}),
            iconTransformation(extent={{-90,-70},{-70,-50}})));
      PhysiolibraryOld.Interfaces.RealInput_ Insulin(unit="uU/ml") annotation (
          Placement(transformation(extent={{58,34},{78,54}}),
            iconTransformation(extent={{-100,40},{-60,80}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
        concentrationMeasure(unitsString="ng/l") annotation (Placement(
            transformation(
            extent={{-10,-10},{10,10}},
            rotation=0,
            origin={-60,8})));
      PhysiolibraryOld.Interfaces.RealOutput_ Glucagon(quantity="Concentration",
          final unit="ng/l") annotation (Placement(transformation(extent={{-78,
                -60},{-58,-40}}), iconTransformation(extent={{80,-20},{120,20}})));
    equation
      connect(GlucagonPool.soluteMass, gain.u) annotation(Line(points = {{-56, -13.8}, {-56, -29}, {-44.6, -29}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(gain.y, clearance.desiredFlow) annotation(Line(points = {{-37.7, -29}, {-24, -29}, {-24, -20}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(clearance.q_in, GlucagonPool.q_out) annotation(Line(points = {{-30, -16}, {-38, -16}, {-38, -6}, {-56, -6}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(GlucagonPool.q_out, PortalVeinConcentration.q_in) annotation(Line(points = {{-56, -6}, {-54, -6}, {-54, 18}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(PortalVeinConcentration.Conc, busConnector.PortalVein_Glucagon) annotation(Line(points = {{-33.8, 18}, {4.1, 18}, {4.1, 78}, {-88, 78}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(PortalVeinConcentration.AdditionalSoluteFlow, FunctionEffect.y) annotation(Line(points = {{-44, 12}, {-44, 2}, {68, 2}, {68, 4}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.GITractFunctionEffect, FunctionEffect.u) annotation(Line(points = {{-88, 78}, {12.1, 78}, {12.1, 6}, {58.2, 6}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.Glucose, GlucoseEffect.u) annotation(Line(points = {{-88, 78}, {12, 78}, {12, 14}, {58.2, 14}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(InsulinEffect.yBase, GlucoseEffect.y) annotation(Line(points = {{68, 12}, {68, 12}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(InsulinEffect.y, FunctionEffect.yBase) annotation(Line(points = {{68, 8}, {68, 8}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(synthesis.desiredFlow, FunctionEffect.y) annotation(Line(points = {{68, -2}, {68, 4}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(hormoneFlowConstant_pG.y, GlucoseEffect.yBase) annotation(Line(points = {{71.59999999999999, 22}, {68, 22}, {68, 16}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(synthesis.q_out, GlucagonPool.q_out) annotation(Line(points = {{62, -6}, {-56, -6}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(busConnector.ECFV_Vol, gain1.u) annotation(Line(points = {{-88, 78}, {-93.2, 78}, {-93.2, 2}, {-76.40000000000001, 2}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(gain1.y, GlucagonPool.SolventVolume) annotation(Line(points = {{-71.8, 2}, {-67.90000000000001, 2}, {-67.90000000000001, 0}, {-64, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(gain2.y, PortalVeinConcentration.SolventFlow) annotation(Line(points = {{-47.8, 30}, {-44, 30}, {-44, 24}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(gain2.u, busConnector.PortalVein_PlasmaFlow) annotation(Line(points = {{-52.4, 30}, {-65.2, 30}, {-65.2, 78}, {-88, 78}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(Insulin, InsulinEffect.u) annotation(Line(points = {{68, 44}, {90, 44}, {90, 10}, {77.8, 10}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(GlucagonPool.q_out, concentrationMeasure.q_in) annotation(Line(points = {{-56, -6}, {-54, -6}, {-54, 8}, {-60, 8}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(concentrationMeasure.actualConc, Glucagon) annotation(Line(points = {{-60, 12}, {-60, 18}, {-80, 18}, {-80, -50}, {-68, -50}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.Glucagon_conc, concentrationMeasure.actualConc) annotation(Line(points = {{-88, 78}, {-88, 14}, {-60, 14}, {-60, 12}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-100, 80}, {100, 100}}, lineColor=  {0, 0, 255}, textString=  "%name")}));
    end Glucagon;

    model ADH
      extends PhysiolibraryOld.Icons.Hypophysis;
      // outer parameter Real ECF_Vol(final unit="ml");
      PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment ADHPool(
          stateName="ADHPool.Mass", initialSoluteMass=2.2251*0.001*
            14361.0097207699)
        "2pg/ml * 15000 ml * 0.001 ng/pg = 30 ng .. all initial extracellular insulin"
        annotation (Placement(transformation(extent={{-86,-26},{-66,-6}})));
      PhysiolibraryOld.ConcentrationFlow.SoluteFlowPump secretion
        annotation (Placement(transformation(extent={{-24,-14},{-44,6}})));
      PhysiolibraryOld.ConcentrationFlow.InputPump synthesis
        annotation (Placement(transformation(extent={{98,-14},{78,6}})));
      PhysiolibraryOld.ConcentrationFlow.SolventOutflowPump Liver_clearance(K=
            0.0005)
        annotation (Placement(transformation(extent={{-34,-42},{-14,-22}})));
      PhysiolibraryOld.Factors.CurveValue NeuralEffect(data={{0.5,0.4,0},{1.0,
            1.0,0.4},{1.2,2.0,5.0},{1.5,20.0,0}})
        annotation (Placement(transformation(extent={{-44,0},{-24,20}})));
      PhysiolibraryOld.Blocks.HormoneFlowConstant_nG hormoneFlowConstant(k=3.2)
        annotation (Placement(transformation(extent={{96,14},{90,20}})));
      PhysiolibraryOld.Factors.CurveValue OsmEffect(data={{0.243,0.0,0},{0.253,
            1.0,180},{0.263,5.0,0}})
        annotation (Placement(transformation(extent={{-44,4},{-24,24}})));
      PhysiolibraryOld.Factors.SimpleMultiply BasicFraction
        annotation (Placement(transformation(extent={{-24,8},{-44,28}})));
      PhysiolibraryOld.Blocks.Constant BaseK(k=0.001)
        annotation (Placement(transformation(extent={{-8,12},{-20,24}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
        concentrationMeasure(unitsString="ng/l") annotation (Placement(
            transformation(
            extent={{-10,-10},{10,10}},
            rotation=0,
            origin={-80,0})));
      Modelica.Blocks.Math.Gain gain2(k = 0.001) annotation(Placement(transformation(extent = {{-2, -2}, {2, 2}}, rotation = 270, origin = {-92, -6})));
      PhysiolibraryOld.ConcentrationFlow.SolventOutflowPump Kidney_clearance(K=
            0.00059)
        annotation (Placement(transformation(extent={{-34,-70},{-14,-50}})));
      PhysiolibraryOld.ConcentrationFlow.SolventOutflowPump Other_clearance(K=
            0.00108)
        annotation (Placement(transformation(extent={{-34,-100},{-14,-80}})));
      PhysiolibraryOld.ConcentrationFlow.MassStorageCompartment SlowMass(
          initialSoluteMass=15782.3, stateName="ADHSlowMass.Mass") annotation (
          Placement(transformation(
            extent={{-10,10},{10,-10}},
            rotation=180,
            origin={56,-4})));
      PhysiolibraryOld.ConcentrationFlow.MassStorageCompartment FastMass(
          initialSoluteMass=2632.19, stateName="ADHFastMass.Mass") annotation (
          Placement(transformation(
            extent={{-10,10},{10,-10}},
            rotation=180,
            origin={6,-4})));
      PhysiolibraryOld.Factors.CurveValue Feedback(data={{0,4.0,0},{17000,1.0,-0.0003},
            {20000,0.0,0}})
        annotation (Placement(transformation(extent={{78,0},{98,20}})));
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{-88,78},{-68,98}}),
            iconTransformation(extent={{-90,-70},{-70,-50}})));
      PhysiolibraryOld.Interfaces.RealOutput_ ADH(quantity="Concentration",
          final unit="nG/l") annotation (Placement(transformation(extent={{-76,
                28},{-56,48}}), iconTransformation(extent={{80,-20},{120,20}})));
      PhysiolibraryOld.Blocks.Log10AsEffect log10_1
        annotation (Placement(transformation(extent={{-68,52},{-48,72}})));
      PhysiolibraryOld.ConcentrationFlow.SoluteFlowPump fluxDown
        annotation (Placement(transformation(extent={{28,6},{38,16}})));
      PhysiolibraryOld.ConcentrationFlow.SoluteFlowPump fluxUp
        annotation (Placement(transformation(extent={{38,-14},{28,-24}})));
      Modelica.Blocks.Math.Gain gain1(k = 0.0043) annotation(Placement(transformation(extent = {{-5, -5}, {5, 5}}, rotation = 270, origin = {33, 25})));
      Modelica.Blocks.Math.Gain gain3(k = 0.001) annotation(Placement(transformation(extent = {{-5, -5}, {5, 5}}, rotation = 90, origin = {33, -35})));
      PhysiolibraryOld.Blocks.Integrator integrator1(
        k=1/20/PhysiolibraryOld.SecPerMin,
        y_start=2.27115,
        stateName="NephronADH.[ADHDelayed]") annotation (Placement(
            transformation(
            extent={{-5,-5},{5,5}},
            rotation=270,
            origin={41,67})));
      Modelica.Blocks.Math.Feedback feedback1 annotation(Placement(transformation(extent = {{-7, -7}, {7, 7}}, rotation = 270, origin = {41, 85})));
      PhysiolibraryOld.Interfaces.RealOutput_ NephronADH(quantity=
            "Concentration", unit="ng/l") annotation (Placement(transformation(
              extent={{68,44},{88,64}}), iconTransformation(extent={{80,-60},{
                120,-20}})));
    equation
      connect(NeuralEffect.yBase, OsmEffect.y) annotation(Line(points = {{-34, 12}, {-34, 12}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(OsmEffect.yBase, BasicFraction.y) annotation(Line(points = {{-34, 16}, {-34, 16}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(BaseK.y, BasicFraction.u) annotation(Line(points = {{-20.6, 18}, {-24.2, 18}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.Osmreceptors, OsmEffect.u) annotation(Line(points = {{-78, 88}, {-96, 88}, {-96, 14}, {-43.8, 14}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.SympsCNS_PituitaryNA, NeuralEffect.u) annotation(Line(points = {{-78, 88}, {-94.90000000000001, 88}, {-94.90000000000001, 10}, {-43.8, 10}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(ADHPool.q_out, secretion.q_out) annotation(Line(points = {{-76, -16}, {-58, -16}, {-58, -4}, {-44, -4}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(Liver_clearance.q_in, ADHPool.q_out) annotation(Line(points = {{-34, -32}, {-58, -32}, {-58, -16}, {-76, -16}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(concentrationMeasure.q_in, ADHPool.q_out) annotation(Line(points = {{-80, 0}, {-75.2, 0}, {-75.2, -16}, {-76, -16}}, color = {200, 0, 0}, smooth = Smooth.None));
      connect(concentrationMeasure.actualConc, busConnector.ADH) annotation(Line(points = {{-80, 4}, {-81, 4}, {-81, 88}, {-78, 88}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(gain2.y, ADHPool.SolventVolume) annotation(Line(points = {{-92, -8.199999999999999}, {-84, -8.199999999999999}, {-84, -10}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.ECFV_Vol, gain2.u) annotation(Line(points = {{-78, 88}, {-92, 88}, {-92, -3.6}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(ADHPool.q_out, Kidney_clearance.q_in) annotation(Line(points = {{-76, -16}, {-58, -16}, {-58, -60}, {-34, -60}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(ADHPool.q_out, Other_clearance.q_in) annotation(Line(points = {{-76, -16}, {-58, -16}, {-58, -90}, {-34, -90}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(NeuralEffect.y, secretion.soluteFlow) annotation(Line(points = {{-34, 8}, {-34, 2}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(secretion.q_in, FastMass.q_out) annotation(Line(points = {{-24, -4}, {6, -4}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(SlowMass.q_out, synthesis.q_out) annotation(Line(points = {{56, -4}, {82, -4}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(FastMass.soluteMass, BasicFraction.yBase) annotation(Line(points = {{6, -11.4}, {6, -16}, {-4, -16}, {-4, 28}, {-34, 28}, {-34, 20}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Feedback.y, synthesis.desiredFlow) annotation(Line(points = {{88, 8}, {88, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Feedback.yBase, hormoneFlowConstant.y) annotation(Line(points = {{88, 12}, {88, 17}, {89.7, 17}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(SlowMass.soluteMass, Feedback.u) annotation(Line(points = {{56, -11.4}, {56, -16}, {78, -16}, {78, 10}, {78.2, 10}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(concentrationMeasure.actualConc, ADH) annotation(Line(points = {{-80, 4}, {-80, 38}, {-66, 38}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(concentrationMeasure.actualConc, log10_1.u) annotation(Line(points = {{-80, 4}, {-80, 62}, {-70, 62}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(log10_1.y, busConnector.ADHPool_Log10Conc) annotation(Line(points = {{-47, 62}, {-24, 62}, {-24, 88}, {-78, 88}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(busConnector.Kidney_BloodFlow, Kidney_clearance.solventFlow) annotation(Line(points = {{-78, 88}, {-96, 88}, {-96, -54}, {-24, -54}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.OtherTissue_BloodFlow, Other_clearance.solventFlow) annotation(Line(points = {{-78, 88}, {-96, 88}, {-96, -84}, {-24, -84}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(gain1.y, fluxDown.soluteFlow) annotation(Line(points = {{33, 19.5}, {33, 14}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(FastMass.soluteMass, gain1.u) annotation(Line(points = {{6, -11.4}, {6, 38}, {33, 38}, {33, 31}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(gain3.y, fluxUp.soluteFlow) annotation(Line(points = {{33, -29.5}, {33, -22}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(gain3.u, SlowMass.soluteMass) annotation(Line(points = {{33, -41}, {33, -46}, {56, -46}, {56, -11.4}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(fluxDown.q_out, SlowMass.q_out) annotation(Line(points = {{38, 11}, {46, 11}, {46, -4}, {56, -4}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(fluxUp.q_in, SlowMass.q_out) annotation(Line(points = {{38, -19}, {46, -19}, {46, -4}, {56, -4}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(FastMass.q_out, fluxDown.q_in) annotation(Line(points = {{6, -4}, {24, -4}, {24, 11}, {28, 11}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(FastMass.q_out, fluxUp.q_out) annotation(Line(points = {{6, -4}, {24, -4}, {24, -19}, {28, -19}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(feedback1.y, integrator1.u) annotation(Line(points = {{41, 78.7}, {40, 78}, {41, 78}, {41, 73}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(integrator1.y, feedback1.u2) annotation(Line(points = {{41, 61.5}, {41, 54}, {26, 54}, {26, 85}, {35.4, 85}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(concentrationMeasure.actualConc, feedback1.u1) annotation(Line(points = {{-80, 4}, {-80, 46}, {10, 46}, {10, 96}, {41, 96}, {41, 90.59999999999999}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(integrator1.y, NephronADH) annotation(Line(points = {{41, 61.5}, {41, 54}, {78, 54}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(integrator1.y, busConnector.NephronADH) annotation(Line(points = {{41, 61.5}, {41, 54}, {-4, 54}, {-4, 88}, {-78, 88}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(busConnector.GITract_BloodFlow, Liver_clearance.solventFlow) annotation(Line(points = {{-78, 88}, {-96, 88}, {-96, -26}, {-24, -26}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent = {{-82, 48}, {-66, 42}}, lineColor = {0, 0, 0}, textString = "ng/l")}), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent = {{-112, 120}, {122, 98}}, lineColor = {0, 0, 255}, textString = "%name")}));
    end ADH;

    model Aldosterone
      extends PhysiolibraryOld.Icons.AdrenalGland;
      PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment AldoPool(
          initialSoluteMass=13477.9, stateName="AldoPool.Mass")
        " 0.33 pmol/ml * 43000 ml = 14190.0 ng .. all initial extracellular insulin"
        annotation (Placement(transformation(extent={{-50,-26},{-30,-6}})));
      PhysiolibraryOld.ConcentrationFlow.InputPump adrenalCortex
        annotation (Placement(transformation(extent={{66,-14},{46,6}})));
      PhysiolibraryOld.ConcentrationFlow.SolventOutflowPump Clearance(K=0.78)
        annotation (Placement(transformation(extent={{2,-42},{22,-22}})));
      PhysiolibraryOld.Factors.CurveValue KEffect(data={{3.0,0.3,0},{4.4,1.0,
            1.0},{6.0,3.0,0}})
        annotation (Placement(transformation(extent={{46,0},{66,20}})));
      PhysiolibraryOld.Blocks.HormoneFlowConstant_pmol hormoneFlowConstant(k=
            330.0)
        annotation (Placement(transformation(extent={{68,26},{60,34}})));
      PhysiolibraryOld.Factors.CurveValue A2Effect(data={{0.0,0.4,0},{1.3,1.0,
            1.0},{4.0,4.0,0}})
        annotation (Placement(transformation(extent={{46,4},{66,24}})));
      PhysiolibraryOld.Factors.SimpleMultiply FunctionEffect
        annotation (Placement(transformation(extent={{46,8},{66,28}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
        concentrationMeasure(unitsString="pmol/l", toAnotherUnitCoef=1000)
        annotation (Placement(transformation(
            extent={{-10,-10},{10,10}},
            rotation=0,
            origin={-44,-2})));
      PhysiolibraryOld.ConcentrationFlow.OutputPump Degradation
        annotation (Placement(transformation(extent={{0,-68},{20,-48}})));
      Modelica.Blocks.Math.Gain DegradeK(k = 0.0007) annotation(Placement(transformation(extent = {{-3, -3}, {3, 3}}, rotation = 0, origin = {-3, -49})));
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{-100,80},{-80,100}}),
            iconTransformation(extent={{-90,-70},{-70,-50}})));
      PhysiolibraryOld.Interfaces.RealInput_ A2Pool_Log10Conc annotation (
          Placement(transformation(extent={{-28,4},{-8,24}}),
            iconTransformation(extent={{-100,40},{-60,80}})));
      PhysiolibraryOld.Interfaces.RealOutput_ Aldo(quantity="Concentration",
          final unit="pmol/l") annotation (Placement(transformation(extent={{-46,
                34},{-26,54}}), iconTransformation(extent={{80,-20},{120,20}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure TO_ng_per_dl(
          unitsString="ng/dl", toAnotherUnitCoef=36)
        "conversion from \"pmol/ml\" to \"ng/dl\"" annotation (Placement(
            transformation(
            extent={{-10,-10},{10,10}},
            rotation=0,
            origin={-50,16})));
      PhysiolibraryOld.Blocks.Integrator AldoDelayed(
        k=1/(3*60)/PhysiolibraryOld.SecPerMin,
        stateName="NephronAldo.[AldoDelayed]",
        y_start=11) annotation (Placement(transformation(
            extent={{-5,-5},{5,5}},
            rotation=270,
            origin={-57,-57})));
      Modelica.Blocks.Math.Feedback feedback1 annotation(Placement(transformation(extent = {{-7, -7}, {7, 7}}, rotation = 270, origin = {-57, -39})));
      PhysiolibraryOld.Interfaces.RealOutput_ NephronAldo(quantity=
            "Concentration", final unit="ngl/dl") annotation (Placement(
            transformation(extent={{-56,-92},{-36,-72}}), iconTransformation(
              extent={{80,-60},{120,-20}})));
    equation
      connect(KEffect.yBase, A2Effect.y) annotation(Line(points = {{56, 12}, {56, 12}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(A2Effect.yBase, FunctionEffect.y) annotation(Line(points = {{56, 16}, {56, 16}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(AldoPool.q_out, adrenalCortex.q_out) annotation(Line(points = {{-40, -16}, {-22, -16}, {-22, -4}, {50, -4}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(Clearance.q_in, AldoPool.q_out) annotation(Line(points = {{2, -32}, {-22, -32}, {-22, -16}, {-40, -16}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(concentrationMeasure.q_in, AldoPool.q_out) annotation(Line(points = {{-44, -2}, {-39.2, -2}, {-39.2, -16}, {-40, -16}}, color = {200, 0, 0}, smooth = Smooth.None));
      connect(concentrationMeasure.actualConc, busConnector.Aldo) annotation(Line(points = {{-44, 2}, {-90, 2}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(AldoPool.q_out, Degradation.q_in) annotation(Line(points = {{-40, -16}, {-22, -16}, {-22, -58}, {4, -58}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(busConnector.BodyH2O_Vol, AldoPool.SolventVolume) annotation(Line(points = {{-90, 90}, {-90, -10}, {-48, -10}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.Liver_BloodFlow, Clearance.solventFlow) annotation(Line(points = {{-90, 90}, {12, 90}, {12, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(AldoPool.soluteMass, DegradeK.u) annotation(Line(points = {{-40, -23.8}, {-40, -49}, {-6.6, -49}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(FunctionEffect.u, busConnector.OtherTissueFunctionEffect) annotation(Line(points = {{46.2, 18}, {12, 18}, {12, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(adrenalCortex.desiredFlow, KEffect.y) annotation(Line(points = {{56, 0}, {56, 8}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(FunctionEffect.yBase, hormoneFlowConstant.y) annotation(Line(points = {{56, 20}, {56, 30}, {59.6, 30}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Degradation.desiredFlow, DegradeK.y) annotation(Line(points = {{10, -54}, {10, -49}, {0.3, -49}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(A2Pool_Log10Conc, A2Effect.u) annotation(Line(points = {{-18, 14}, {46.2, 14}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(concentrationMeasure.actualConc, Aldo) annotation(Line(points = {{-44, 2}, {-44, 44}, {-36, 44}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.AldoPool_Aldo, concentrationMeasure.actualConc) annotation(Line(points = {{-90, 90}, {-90, 2}, {-44, 2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(TO_ng_per_dl.q_in, AldoPool.q_out) annotation(Line(points = {{-50, 16}, {-39.2, 16}, {-39.2, -16}, {-40, -16}}, color = {200, 0, 0}, smooth = Smooth.None));
      connect(busConnector.Aldo_conc_in_nG_per_dl, TO_ng_per_dl.actualConc) annotation(Line(points = {{-90, 90}, {-90, 20}, {-50, 20}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(feedback1.y, AldoDelayed.u) annotation(Line(points = {{-57, -45.3}, {-58, -46}, {-57, -46}, {-57, -51}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(AldoDelayed.y, feedback1.u2) annotation(Line(points = {{-57, -62.5}, {-57, -66}, {-72, -66}, {-72, -39}, {-62.6, -39}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(AldoDelayed.y, NephronAldo) annotation(Line(points = {{-57, -62.5}, {-57, -82}, {-46, -82}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(TO_ng_per_dl.actualConc, feedback1.u1) annotation(Line(points = {{-50, 20}, {-50, 36}, {-57, 36}, {-57, -33.4}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.NephronAldo_conc_in_nG_per_dl, AldoDelayed.y) annotation(Line(points = {{-90, 90}, {-90, -66}, {-57, -66}, {-57, -62.5}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(KEffect.u, busConnector.KPool_conc_per_liter) annotation(Line(points = {{46.2, 10}, {12, 90}, {-90, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-116, 104}, {118, 82}}, lineColor=  {0, 0, 255}, textString=  "%name")}));
    end Aldosterone;

    model ANP
      extends PhysiolibraryOld.Icons.Heart;
      // outer parameter Real ECF_Vol(final unit="ml");
      PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment ANPPool(
          initialSoluteMass=285.895, stateName="ANPPool.Mass")
        "default = 20 pmol/l"
        annotation (Placement(transformation(extent={{-30,-42},{-10,-22}})));
      PhysiolibraryOld.ConcentrationFlow.InputPump secretion
        annotation (Placement(transformation(extent={{48,-54},{28,-34}})));
      PhysiolibraryOld.Factors.CurveValue LAPEffect(data={{0.0,0.0,0},{8.0,1.0,
            0.4},{20.0,10.0,0}})
        annotation (Placement(transformation(extent={{56,60},{76,80}})));
      PhysiolibraryOld.Blocks.HormoneFlowConstant_pmol hormoneFlowConstant(k=41)
        annotation (Placement(transformation(extent={{22,82},{14,90}})));
      PhysiolibraryOld.Factors.CurveValue RAPEffect(data={{0.0,0.0,0},{4.0,1.0,
            0.4},{20.0,10.0,0}})
        annotation (Placement(transformation(extent={{0,60},{20,80}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
        concentrationMeasure(unitsString="pmol/l", toAnotherUnitCoef=1000)
        annotation (Placement(transformation(
            extent={{-10,-10},{10,10}},
            rotation=0,
            origin={-26,-16})));
      PhysiolibraryOld.ConcentrationFlow.OutputPump Degradation
        annotation (Placement(transformation(extent={{12,-86},{32,-66}})));
      Modelica.Blocks.Math.Gain DegradeK(k = 0.223) annotation(Placement(transformation(extent = {{-3, -3}, {3, 3}}, rotation = 0, origin = {7, -65})));
      PhysiolibraryOld.Blocks.HormoneFlowConstant_pmol hormoneFlowConstant1(k=
            26) annotation (Placement(transformation(extent={{78,82},{70,90}})));
      Modelica.Blocks.Math.Add SteadyState annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 270, origin = {38, 42})));
      PhysiolibraryOld.Blocks.Integrator integrator(
        k=1/20/PhysiolibraryOld.SecPerMin,
        y_start=67,
        stateName="ANPSecretion.NaturalRate") annotation (Placement(
            transformation(
            extent={{-10,-10},{10,10}},
            rotation=270,
            origin={38,-14})));
      Modelica.Blocks.Math.Feedback feedback annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 270, origin = {38, 18})));
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{-104,84},{-84,104}}),
            iconTransformation(extent={{-90,-70},{-70,-50}})));
      PhysiolibraryOld.Interfaces.RealOutput_ ANP(quantity="Concentration",
          final unit="pmol/l") annotation (Placement(transformation(extent={{-24,
                2},{-4,22}}), iconTransformation(extent={{80,-20},{120,20}})));
      PhysiolibraryOld.Blocks.Log10AsEffect log10_1
        annotation (Placement(transformation(extent={{-32,6},{-44,18}})));
      PhysiolibraryOld.Blocks.Log10AsEffect log10_2
        annotation (Placement(transformation(extent={{-52,-88},{-64,-76}})));
      PhysiolibraryOld.Blocks.Integrator integrator1(
        k=1/20/PhysiolibraryOld.SecPerMin,
        y_start=20,
        stateName="NephronANP.[ANPDelayed]") annotation (Placement(
            transformation(
            extent={{-5,-5},{5,5}},
            rotation=270,
            origin={-35,-65})));
      Modelica.Blocks.Math.Feedback feedback1 annotation(Placement(transformation(extent = {{-7, -7}, {7, 7}}, rotation = 270, origin = {-35, -47})));
      PhysiolibraryOld.Interfaces.RealOutput_ NephronANP_Log10Conc annotation (
          Placement(transformation(extent={{-94,-64},{-74,-44}}),
            iconTransformation(extent={{80,-60},{120,-20}})));
    equation
      connect(ANPPool.q_out, secretion.q_out) annotation(Line(points = {{-20, -32}, {-2, -32}, {-2, -44}, {32, -44}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(concentrationMeasure.q_in, ANPPool.q_out) annotation(Line(points = {{-26, -16}, {-19.2, -16}, {-19.2, -32}, {-20, -32}}, color = {200, 0, 0}, smooth = Smooth.None));
      connect(ANPPool.q_out, Degradation.q_in) annotation(Line(points = {{-20, -32}, {-2, -32}, {-2, -76}, {16, -76}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(ANPPool.soluteMass, DegradeK.u) annotation(Line(points = {{-20, -39.8}, {-20, -65}, {3.4, -65}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Degradation.desiredFlow, DegradeK.y) annotation(Line(points = {{22, -72}, {22, -65}, {10.3, -65}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(hormoneFlowConstant1.y, LAPEffect.yBase) annotation(Line(points = {{69.59999999999999, 86}, {66, 86}, {66, 72}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(hormoneFlowConstant.y, RAPEffect.yBase) annotation(Line(points = {{13.6, 86}, {10, 86}, {10, 72}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(RAPEffect.y, SteadyState.u2) annotation(Line(points = {{10, 68}, {10, 60}, {32, 60}, {32, 54}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(LAPEffect.y, SteadyState.u1) annotation(Line(points = {{66, 68}, {66, 60}, {44, 60}, {44, 54}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(feedback.y, integrator.u) annotation(Line(points = {{38, 9}, {38, -2}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(integrator.y, feedback.u2) annotation(Line(points = {{38, -25}, {38, -34}, {14, -34}, {14, 18}, {30, 18}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(SteadyState.y, feedback.u1) annotation(Line(points = {{38, 31}, {38, 26}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(integrator.y, secretion.desiredFlow) annotation(Line(points = {{38, -25}, {38, -40}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(concentrationMeasure.actualConc, ANP) annotation(Line(points = {{-26, -12}, {-26, 12}, {-14, 12}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(concentrationMeasure.actualConc, log10_1.u) annotation(Line(points = {{-26, -12}, {-26, 12}, {-30.8, 12}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.NephronANP_Log10Conc, log10_2.y) annotation(Line(points = {{-94, 94}, {-94, -82}, {-64.59999999999999, -82}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.ANPPool_Log10Conc, log10_1.y) annotation(Line(points = {{-94, 94}, {-94, 12}, {-44.6, 12}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.ANP, concentrationMeasure.actualConc) annotation(Line(points = {{-94, 94}, {-94, -8}, {-26, -8}, {-26, -12}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.rightAtrium_TMP, RAPEffect.u) annotation(Line(points = {{-94, 94}, {-32, 94}, {-32, 70}, {0.2, 70}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.leftAtrium_TMP, LAPEffect.u) annotation(Line(points = {{-94, 94}, {32, 94}, {32, 70}, {56.2, 70}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.ECFV_Vol, ANPPool.SolventVolume) annotation(Line(points = {{-94, 94}, {-94, -26}, {-28, -26}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(feedback1.y, integrator1.u) annotation(Line(points = {{-35, -53.3}, {-36, -54}, {-35, -54}, {-35, -59}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(integrator1.y, feedback1.u2) annotation(Line(points = {{-35, -70.5}, {-35, -74}, {-50, -74}, {-50, -47}, {-40.6, -47}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(integrator1.y, log10_2.u) annotation(Line(points = {{-35, -70.5}, {-35, -82}, {-50.8, -82}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(concentrationMeasure.actualConc, feedback1.u1) annotation(Line(points = {{-26, -12}, {-26, -8}, {-35, -8}, {-35, -41.4}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(log10_2.y, NephronANP_Log10Conc) annotation(Line(points = {{-64.59999999999999, -82}, {-94, -82}, {-94, -54}, {-84, -54}}, color = {0, 0, 127}, smooth = Smooth.None));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-120, 94}, {114, 72}}, lineColor=  {0, 0, 255}, textString=  "%name")}));
    end ANP;

    package Catechols "Epinephrine and Norepinephrine"
      model Epinephrine
        extends PhysiolibraryOld.Icons.AdrenalGland;
        // outer parameter Real ECF_Vol(final unit="ml");
        PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment EpiPool(
            initialSoluteMass=571.7910000000001, stateName="EpiPool.Mass")
          "0.040 ng/ml * 15000 ml =  600 ng "
          annotation (Placement(transformation(extent={{-82,-54},{-62,-34}})));
        PhysiolibraryOld.ConcentrationFlow.InputPump secretion
          annotation (Placement(transformation(extent={{48,-54},{28,-34}})));
        PhysiolibraryOld.Blocks.HormoneFlowConstant_nG hormoneFlowConstant(k=
              375)
          annotation (Placement(transformation(extent={{50,-10},{42,-2}})));
        PhysiolibraryOld.Factors.CurveValue AdrenalNerveEffect(data={{2.0,1.0,0},
              {8.0,20.0,0}})
          annotation (Placement(transformation(extent={{28,-32},{48,-12}})));
        PhysiolibraryOld.Interfaces.RealInput OtherTissueFunctionEffect
          annotation (Placement(transformation(extent={{0,-36},{8,-28}}),
              iconTransformation(extent={{-100,40},{-80,60}})));
        PhysiolibraryOld.Interfaces.RealInput ECFV_Vol(final quantity="Volume",
            final unit="ml") annotation (Placement(transformation(extent={{-98,
                  -30},{-90,-22}}), iconTransformation(extent={{-100,80},{-80,
                  100}})));
        PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
          concentrationMeasure(unitsString="pg/ml", toAnotherUnitCoef=1000)
          annotation (Placement(transformation(
              extent={{-10,-10},{10,10}},
              rotation=0,
              origin={-76,-26})));
        PhysiolibraryOld.Interfaces.RealOutput Epinephrine(final quantity=
              "Concentration", final unit="pg/ml") annotation (Placement(
              transformation(extent={{-82,-20},{-90,-12}}), iconTransformation(
                extent={{100,-10},{120,10}})));
        PhysiolibraryOld.Interfaces.RealInput AdrenalNerve_NA(final quantity=
              "Frequency", final unit="Hz") annotation (Placement(
              transformation(extent={{6,-26},{14,-18}}), iconTransformation(
                extent={{-100,0},{-80,20}})));
        PhysiolibraryOld.ConcentrationFlow.SolventOutflowPump Clearance(K=1)
          annotation (Placement(transformation(extent={{-28,-96},{-8,-76}})));
        PhysiolibraryOld.Blocks.FlowConstant flowConstant(k=9400)
          annotation (Placement(transformation(extent={{-30,-76},{-22,-68}})));
        PhysiolibraryOld.Factors.SimpleMultiply FunctionEffect
          annotation (Placement(transformation(extent={{28,-42},{48,-22}})));
      equation
        connect(EpiPool.q_out, secretion.q_out) annotation(Line(points = {{-72, -44}, {32, -44}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(concentrationMeasure.q_in, EpiPool.q_out) annotation(Line(points = {{-76, -26}, {-71.2, -26}, {-71.2, -44}, {-72, -44}}, color = {200, 0, 0}, smooth = Smooth.None));
        connect(concentrationMeasure.actualConc, Epinephrine) annotation(Line(points = {{-76, -22}, {-76, -16}, {-86, -16}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(ECFV_Vol, EpiPool.SolventVolume) annotation(Line(points = {{-94, -26}, {-88, -26}, {-88, -38}, {-80, -38}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(AdrenalNerve_NA, AdrenalNerveEffect.u) annotation(Line(points = {{10, -22}, {28.2, -22}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(hormoneFlowConstant.y, AdrenalNerveEffect.yBase) annotation(Line(points = {{41.6, -6}, {38, -6}, {38, -20}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(EpiPool.q_out, Clearance.q_in) annotation(Line(points = {{-72, -44}, {-42, -44}, {-42, -86}, {-28, -86}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(flowConstant.y, Clearance.solventFlow) annotation(Line(points = {{-21.6, -72}, {-18, -72}, {-18, -80}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(OtherTissueFunctionEffect, FunctionEffect.u) annotation(Line(points = {{4, -32}, {28.2, -32}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(AdrenalNerveEffect.y, FunctionEffect.yBase) annotation(Line(points = {{38, -24}, {38, -30}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(FunctionEffect.y, secretion.desiredFlow) annotation(Line(points = {{38, -34}, {38, -40}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
      end Epinephrine;

      model Norepinephrine
        extends PhysiolibraryOld.Icons.AdrenalGland;
        // outer parameter Real ECF_Vol(final unit="ml");
        PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment NEPool(
            initialSoluteMass=3430.74, stateName="NEPool.Mass")
          "0.240 ng/ml * 15000 ml =  3600 ng "
          annotation (Placement(transformation(extent={{-82,-54},{-62,-34}})));
        PhysiolibraryOld.ConcentrationFlow.InputPump secretion
          annotation (Placement(transformation(extent={{48,-54},{28,-34}})));
        PhysiolibraryOld.Blocks.HormoneFlowConstant_nG hormoneFlowConstant(k=
              220)
          annotation (Placement(transformation(extent={{50,-10},{42,-2}})));
        PhysiolibraryOld.Factors.CurveValue AdrenalNerveEffect(data={{2.0,1.0,0},
              {8.0,20.0,0}})
          annotation (Placement(transformation(extent={{28,-32},{48,-12}})));
        PhysiolibraryOld.Interfaces.RealInput OtherTissueFunctionEffect
          annotation (Placement(transformation(extent={{0,-36},{8,-28}}),
              iconTransformation(extent={{-100,-40},{-80,-20}})));
        PhysiolibraryOld.Interfaces.RealInput ECFV_Vol(final quantity="Volume",
            final unit="ml") annotation (Placement(transformation(extent={{-98,
                  -30},{-90,-22}}), iconTransformation(extent={{-100,80},{-80,
                  100}})));
        PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
          concentrationMeasure(unitsString="pg/ml", toAnotherUnitCoef=1000)
          annotation (Placement(transformation(
              extent={{-10,-10},{10,10}},
              rotation=0,
              origin={-78,-20})));
        PhysiolibraryOld.Interfaces.RealOutput Norepinephrine(final quantity=
              "Concentration", final unit="pg/ml") annotation (Placement(
              transformation(extent={{-80,-16},{-88,-8}}), iconTransformation(
                extent={{100,-10},{120,10}})));
        PhysiolibraryOld.Interfaces.RealInput AdrenalNerve_NA(final quantity=
              "Frequency", final unit="Hz") annotation (Placement(
              transformation(extent={{6,-26},{14,-18}}), iconTransformation(
                extent={{-100,40},{-80,60}})));
        PhysiolibraryOld.ConcentrationFlow.SolventOutflowPump Clearance(K=1)
          annotation (Placement(transformation(extent={{-28,-96},{-8,-76}})));
        PhysiolibraryOld.Blocks.FlowConstant flowConstant(k=4500)
          annotation (Placement(transformation(extent={{-30,-76},{-22,-68}})));
        PhysiolibraryOld.Factors.SimpleMultiply FunctionEffect
          annotation (Placement(transformation(extent={{28,-42},{48,-22}})));
        PhysiolibraryOld.ConcentrationFlow.InputPump Spillover
          annotation (Placement(transformation(extent={{50,18},{30,38}})));
        PhysiolibraryOld.Blocks.Constant hormoneFlowConstant1(k=570.0)
          annotation (Placement(transformation(extent={{52,50},{44,58}})));
        PhysiolibraryOld.Factors.SimpleMultiply SpilloverK
          annotation (Placement(transformation(extent={{30,28},{50,48}})));
        PhysiolibraryOld.Interfaces.RealInput GangliaGeneral_NA(final quantity=
              "Frequency", final unit="Hz") annotation (Placement(
              transformation(extent={{8,34},{16,42}}), iconTransformation(
                extent={{-100,0},{-80,20}})));
      equation
        connect(NEPool.q_out, secretion.q_out) annotation(Line(points = {{-72, -44}, {32, -44}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(concentrationMeasure.q_in, NEPool.q_out) annotation(Line(points = {{-78, -20}, {-71.2, -20}, {-71.2, -44}, {-72, -44}}, color = {200, 0, 0}, smooth = Smooth.None));
        connect(concentrationMeasure.actualConc, Norepinephrine) annotation(Line(points = {{-78, -16}, {-78, -12}, {-84, -12}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(ECFV_Vol, NEPool.SolventVolume) annotation(Line(points = {{-94, -26}, {-88, -26}, {-88, -38}, {-80, -38}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(AdrenalNerve_NA, AdrenalNerveEffect.u) annotation(Line(points = {{10, -22}, {28.2, -22}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(hormoneFlowConstant.y, AdrenalNerveEffect.yBase) annotation(Line(points = {{41.6, -6}, {38, -6}, {38, -20}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(NEPool.q_out, Clearance.q_in) annotation(Line(points = {{-72, -44}, {-42, -44}, {-42, -86}, {-28, -86}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(flowConstant.y, Clearance.solventFlow) annotation(Line(points = {{-21.6, -72}, {-18, -72}, {-18, -80}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(OtherTissueFunctionEffect, FunctionEffect.u) annotation(Line(points = {{4, -32}, {28.2, -32}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(AdrenalNerveEffect.y, FunctionEffect.yBase) annotation(Line(points = {{38, -24}, {38, -30}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(FunctionEffect.y, secretion.desiredFlow) annotation(Line(points = {{38, -34}, {38, -40}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(NEPool.q_out, Spillover.q_out) annotation(Line(points = {{-72, -44}, {-21, -44}, {-21, 28}, {34, 28}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
        connect(GangliaGeneral_NA, SpilloverK.u) annotation(Line(points = {{12, 38}, {30.2, 38}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(hormoneFlowConstant1.y, SpilloverK.yBase) annotation(Line(points = {{43.6, 54}, {40, 54}, {40, 40}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(SpilloverK.y, Spillover.desiredFlow) annotation(Line(points = {{40, 36}, {40, 32}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
      end Norepinephrine;

      model Catechols
        extends PhysiolibraryOld.Icons.AdrenalGland;
        PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
            Placement(transformation(extent={{-88,78},{-68,98}}),
              iconTransformation(extent={{-90,-70},{-70,-50}})));
        Epinephrine epinephrine annotation(Placement(transformation(extent = {{-30, 46}, {-10, 66}})));
        Norepinephrine norepinephrine annotation(Placement(transformation(extent = {{-30, 14}, {-10, 34}})));
        PhysiolibraryOld.Interfaces.RealOutput_ EpinephrineConc(quantity=
              "Concentration", final unit="pg/ml") annotation (Placement(
              transformation(extent={{38,46},{58,66}}), iconTransformation(
                extent={{80,-40},{120,0}})));
        PhysiolibraryOld.Interfaces.RealOutput_ NorepinephrineConc(quantity=
              "Concentration", final unit="pg/ml") annotation (Placement(
              transformation(extent={{38,14},{58,34}}), iconTransformation(
                extent={{80,0},{120,40}})));
        PhysiolibraryOld.Blocks.Log10AsEffect log10_1
          annotation (Placement(transformation(extent={{10,-66},{30,-46}})));
        Modelica.Blocks.Math.Add3 AlphaTotal(k1 = 0.021, k2 = 0.125, k3 = 5) annotation(Placement(transformation(extent = {{-28, -66}, {-8, -46}})));
        PhysiolibraryOld.Blocks.Constant Desglymidodrine(k=0)
          annotation (Placement(transformation(extent={{-62,-68},{-54,-60}})));
        Modelica.Blocks.Math.Add BetaTotal(k1 = 0.021, k2 = 0.125) annotation(Placement(transformation(extent = {{-24, -32}, {-8, -16}})));
        PhysiolibraryOld.Blocks.Constant Constant(k=1)
          annotation (Placement(transformation(extent={{32,-66},{40,-58}})));
        PhysiolibraryOld.Blocks.Constant Constant1(k=1)
          annotation (Placement(transformation(extent={{26,-34},{34,-26}})));
        PhysiolibraryOld.Blocks.Log10AsEffect log10_2
          annotation (Placement(transformation(extent={{4,-34},{24,-14}})));
      equation
        connect(busConnector.ECFV_Vol, epinephrine.ECFV_Vol) annotation(Line(points = {{-78, 88}, {-78, 65}, {-29, 65}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.ECFV_Vol, norepinephrine.ECFV_Vol) annotation(Line(points = {{-78, 88}, {-78, 33}, {-29, 33}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.AdrenalNerve_NA, epinephrine.AdrenalNerve_NA) annotation(Line(points = {{-78, 88}, {-78, 57}, {-29, 57}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.OtherTissueFunctionEffect, epinephrine.OtherTissueFunctionEffect) annotation(Line(points = {{-78, 88}, {-78, 61}, {-29, 61}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.OtherTissueFunctionEffect, norepinephrine.OtherTissueFunctionEffect) annotation(Line(points = {{-78, 88}, {-78, 21}, {-29, 21}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.AdrenalNerve_NA, norepinephrine.AdrenalNerve_NA) annotation(Line(points = {{-78, 88}, {-78, 29}, {-29, 29}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(busConnector.GangliaGeneral_NA, norepinephrine.GangliaGeneral_NA) annotation(Line(points = {{-78, 88}, {-78, 25}, {-29, 25}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
        connect(epinephrine.Epinephrine, busConnector.EpiPool_Epi) annotation(Line(points = {{-9, 56}, {28, 56}, {28, 88}, {-78, 88}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(norepinephrine.Norepinephrine, busConnector.NEPool_NE) annotation(Line(points = {{-9, 24}, {28, 24}, {28, 88}, {-78, 88}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(norepinephrine.Norepinephrine, NorepinephrineConc) annotation(Line(points = {{-9, 24}, {48, 24}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(epinephrine.Epinephrine, EpinephrineConc) annotation(Line(points = {{-9, 56}, {48, 56}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(log10_1.y, busConnector.AlphaPool_Effect) annotation(Line(points = {{31, -56}, {78, -56}, {78, 90}, {-78, 90}, {-78, 88}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(AlphaTotal.y, log10_1.u) annotation(Line(points = {{-7, -56}, {8, -56}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(AlphaTotal.u1, norepinephrine.Norepinephrine) annotation(Line(points = {{-30, -48}, {-36, -48}, {-36, -2}, {-4, -2}, {-4, 24}, {-9, 24}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(epinephrine.Epinephrine, AlphaTotal.u2) annotation(Line(points = {{-9, 56}, {16, 56}, {16, 2}, {-40, 2}, {-40, -56}, {-30, -56}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Desglymidodrine.y, AlphaTotal.u3) annotation(Line(points = {{-53.6, -64}, {-30, -64}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(BetaTotal.u1, norepinephrine.Norepinephrine) annotation(Line(points = {{-25.6, -19.2}, {-36, -19.2}, {-36, -2}, {-4, -2}, {-4, 24}, {-9, 24}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(BetaTotal.u2, epinephrine.Epinephrine) annotation(Line(points = {{-25.6, -28.8}, {-40, -28.8}, {-40, 2}, {16, 2}, {16, 56}, {-9, 56}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(BetaTotal.y, log10_2.u) annotation(Line(points = {{-7.2, -24}, {2, -24}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(log10_2.y, busConnector.BetaPool_Effect) annotation(Line(points = {{25, -24}, {78, -24}, {78, 88}, {-78, 88}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
        connect(Constant.y, busConnector.AlphaBlocade_Effect) annotation(Line(points = {{40.4, -62}, {78, -62}, {78, 88}, {-78, 88}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Constant1.y, busConnector.BetaBlocade_Effect) annotation(Line(points = {{34.4, -30}, {78, -30}, {78, 88}, {-78, 88}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-100, 80}, {100, 100}}, lineColor=  {0, 0, 255}, textString=  "%name")}));
      end Catechols;
      annotation(Documentation(revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr>
                   </table>
                   </html>"));
    end Catechols;

    model EPO
      extends PhysiolibraryOld.Icons.Kidney;
      // outer parameter Real ECF_Vol(final unit="ml");
      PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment EPOPool(
          stateName="EPOPool.Mass", initialSoluteMass=0.02*14361.0097207699*0.4)
        "default = 6.7 U/L = 0.0067 U/ml ; may be it is better to set 0.020, then is red cells count more in steady state"
        annotation (Placement(transformation(extent={{-84,-60},{-64,-40}})));
      PhysiolibraryOld.ConcentrationFlow.InputPump secretion
        annotation (Placement(transformation(extent={{76,-54},{56,-34}})));
      PhysiolibraryOld.Factors.SimpleMultiply CountEffect
        annotation (Placement(transformation(extent={{56,24},{76,44}})));
      PhysiolibraryOld.Blocks.Constant hormoneFlowConstant(k=1)
        annotation (Placement(transformation(extent={{-4,40},{-12,48}})));
      PhysiolibraryOld.Factors.CurveValue PO2Effect(data={{0.0,4.0,0},{35.0,0.0,
            -0.14},{60.0,-1.0,0}})
        annotation (Placement(transformation(extent={{-24,14},{-4,34}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
        concentrationMeasure(unitsString="U/l", toAnotherUnitCoef=1000)
        annotation (Placement(transformation(
            extent={{-10,-10},{10,10}},
            rotation=0,
            origin={-76,-32})));
      PhysiolibraryOld.ConcentrationFlow.OutputPump Clearance
        annotation (Placement(transformation(extent={{-30,-98},{-10,-78}})));
      Modelica.Blocks.Math.Gain K(k = 0.00555) annotation(Placement(transformation(extent = {{-3, -3}, {3, 3}}, rotation = 0, origin = {-35, -77})));
      PhysiolibraryOld.Blocks.HormoneFlowConstant_U hormoneFlowConstant1(k=0.67)
        annotation (Placement(transformation(extent={{82,42},{70,54}})));
      Modelica.Blocks.Math.Gain VODIST(k = 0.4) annotation(Placement(transformation(extent = {{-6, -6}, {6, 6}}, rotation = 0, origin = {-66, -2})));
      PhysiolibraryOld.Blocks.Pow avg1
        annotation (Placement(transformation(extent={{-8,10},{0,18}})));
      PhysiolibraryOld.Factors.SimpleMultiply FunctionEffect
        annotation (Placement(transformation(extent={{56,14},{76,34}})));
      PhysiolibraryOld.Factors.SimpleMultiply PO2Effect_
        annotation (Placement(transformation(extent={{56,4},{76,24}})));
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{-88,78},{-68,98}}),
            iconTransformation(extent={{-90,-70},{-70,-50}})));
      PhysiolibraryOld.Interfaces.RealOutput_ Erythropoetin(quantity=
            "Concentration", final unit="mU/ml") annotation (Placement(
            transformation(extent={{-50,-28},{-30,-8}}), iconTransformation(
              extent={{80,-20},{120,20}})));
      PhysiolibraryOld.Blocks.Log10AsEffect log10_1
        annotation (Placement(transformation(extent={{-46,46},{-26,66}})));
    equation
      connect(EPOPool.q_out, secretion.q_out) annotation(Line(points={{-74,-50},
              {-8,-50},{-8,-44},{60,-44}},                                                      color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(concentrationMeasure.q_in, EPOPool.q_out) annotation(Line(points={{-76,-32},
              {-71.2,-32},{-71.2,-50},{-74,-50}},                                                                                      color = {200, 0, 0}, smooth = Smooth.None));
      connect(concentrationMeasure.actualConc, busConnector.EPO) annotation(Line(points = {{-76, -28}, {-77, -28}, {-77, 88}, {-78, 88}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(EPOPool.q_out, Clearance.q_in) annotation(Line(points={{-74,-50},
              {-54,-50},{-54,-88},{-26,-88}},                                                                           color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(EPOPool.soluteMass, K.u) annotation(Line(points={{-74,-57.8},{-74,
              -77},{-38.6,-77}},                                                                          color = {0, 0, 127}, smooth = Smooth.None));
      connect(Clearance.desiredFlow, K.y) annotation(Line(points = {{-20, -84}, {-20, -77}, {-31.7, -77}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.KidneyO2_TubulePO2, PO2Effect.u) annotation(Line(points = {{-78, 88}, {-64.90000000000001, 88}, {-64.90000000000001, 24}, {-23.8, 24}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.Kidney_NephronCount_Total_xNormal, CountEffect.u) annotation(Line(points = {{-78, 88}, {5.1, 88}, {5.1, 34}, {56.2, 34}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(hormoneFlowConstant1.y, CountEffect.yBase) annotation(Line(points = {{69.40000000000001, 48}, {66, 48}, {66, 36}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(hormoneFlowConstant.y, PO2Effect.yBase) annotation(Line(points={{-12.4,
              44},{-14,44},{-14,26}},                                                                               color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.ECFV_Vol, VODIST.u) annotation(Line(points = {{-78, 88}, {-76.59999999999999, 88}, {-76.59999999999999, -2}, {-73.2, -2}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(avg1.u, PO2Effect.y) annotation(Line(points = {{-8.800000000000001, 14}, {-14, 14}, {-14, 22}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(CountEffect.y, FunctionEffect.yBase) annotation(Line(points = {{66, 32}, {66, 26}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(FunctionEffect.y, PO2Effect_.yBase) annotation(Line(points = {{66, 22}, {66, 16}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(PO2Effect_.y, secretion.desiredFlow) annotation(Line(points = {{66, 12}, {66, -40}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(avg1.y, PO2Effect_.u) annotation(Line(points = {{0.4, 14}, {56.2, 14}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(FunctionEffect.u, busConnector.KidneyFunctionEffect) annotation(Line(points = {{56.2, 24}, {5.1, 24}, {5.1, 88}, {-78, 88}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(concentrationMeasure.actualConc, Erythropoetin) annotation(Line(points = {{-76, -28}, {-76, -18}, {-40, -18}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(concentrationMeasure.actualConc, log10_1.u) annotation(Line(points = {{-76, -28}, {-76, -18}, {-54, -18}, {-54, 56}, {-48, 56}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(log10_1.y, busConnector.EPOPool_Log10Conc) annotation(Line(points = {{-25, 56}, {-6, 56}, {-6, 88}, {-78, 88}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(VODIST.y, EPOPool.SolventVolume) annotation(Line(points={{-59.4,
              -2},{-56,-2},{-56,-14},{-94,-14},{-94,-44},{-82,-44}},                                                                              color = {0, 0, 127}, smooth = Smooth.None));
      annotation(Diagram(coordinateSystem(preserveAspectRatio=false,  extent={{-100,
                -100},{100,100}}),                                                                          graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-116, 104}, {118, 82}}, lineColor=  {0, 0, 255}, textString=  "%name")}));
    end EPO;

    model Thyroxine
      extends PhysiolibraryOld.Icons.ThyroidGland;
      // outer parameter Real ECF_Vol(final unit="ml");
      PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment ThyroidPool(
          stateName="ThyroidPool.Mass", initialSoluteMass=1168.05)
        "default = 8 uG/dl"
        annotation (Placement(transformation(extent={{-82,-54},{-62,-34}})));
      PhysiolibraryOld.ConcentrationFlow.InputPump secretion
        annotation (Placement(transformation(extent={{76,-54},{56,-34}})));
      PhysiolibraryOld.Blocks.HormoneFlowConstant_uG hormoneFlowConstant(k=0.05)
        annotation (Placement(transformation(extent={{80,-24},{68,-12}})));
      PhysiolibraryOld.Factors.CurveValue TSHEffect(data={{0.0,0.0,0},{4.0,1.0,
            0.4},{30.0,10.0,0}})
        annotation (Placement(transformation(extent={{56,-40},{76,-20}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
        concentrationMeasure(unitsString="ug/dl", toAnotherUnitCoef=100)
        annotation (Placement(transformation(
            extent={{-10,-10},{10,10}},
            rotation=0,
            origin={-76,-30})));
      PhysiolibraryOld.ConcentrationFlow.OutputPump Clearance
        annotation (Placement(transformation(extent={{-30,-98},{-10,-78}})));
      Modelica.Blocks.Math.Gain K(k = 4.1e-005) annotation(Placement(transformation(extent = {{-3, -3}, {3, 3}}, rotation = 0, origin = {-35, -77})));
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{-88,78},{-68,98}}),
            iconTransformation(extent={{-90,70},{-70,90}})));
      PhysiolibraryOld.Interfaces.RealInput_ TSH(quantity="Concentration",
          final unit="uU/ml") "thyrotropin" annotation (Placement(
            transformation(extent={{4,-40},{24,-20}}), iconTransformation(
              extent={{-100,0},{-60,40}})));
      PhysiolibraryOld.Interfaces.RealOutput_ Thyroxine(quantity=
            "Concentration", final unit="ug/ml") annotation (Placement(
            transformation(extent={{-50,-18},{-30,2}}), iconTransformation(
              extent={{80,-20},{120,20}})));
      PhysiolibraryOld.Curves.Curve curve(
        x={0,8,40},
        y={0.7,1.0,1.5},
        slope={0,0.4,0})
        annotation (Placement(transformation(extent={{-54,18},{-34,38}})));
    equation
      connect(ThyroidPool.q_out, secretion.q_out) annotation(Line(points = {{-72, -44}, {60, -44}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(concentrationMeasure.q_in, ThyroidPool.q_out) annotation(Line(points = {{-76, -30}, {-71.2, -30}, {-71.2, -44}, {-72, -44}}, color = {200, 0, 0}, smooth = Smooth.None));
      connect(concentrationMeasure.actualConc, busConnector.ThyroidPool_conc) annotation(Line(points = {{-76, -26}, {-77, -26}, {-77, 88}, {-78, 88}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(ThyroidPool.q_out, Clearance.q_in) annotation(Line(points = {{-72, -44}, {-54, -44}, {-54, -88}, {-26, -88}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(ThyroidPool.soluteMass, K.u) annotation(Line(points = {{-72, -51.8}, {-72, -77}, {-38.6, -77}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Clearance.desiredFlow, K.y) annotation(Line(points = {{-20, -84}, {-20, -77}, {-31.7, -77}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(hormoneFlowConstant.y, TSHEffect.yBase) annotation(Line(points = {{67.40000000000001, -18}, {66, -18}, {66, -28}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(secretion.desiredFlow, TSHEffect.y) annotation(Line(points = {{66, -40}, {66, -32}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(TSH, TSHEffect.u) annotation(Line(points = {{14, -30}, {56.2, -30}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.ECFV_Vol, ThyroidPool.SolventVolume) annotation(Line(points = {{-78, 88}, {-94, 88}, {-94, -38}, {-80, -38}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(concentrationMeasure.actualConc, Thyroxine) annotation(Line(points = {{-76, -26}, {-76, -8}, {-40, -8}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(curve.val, busConnector.ThyroidEffect) annotation(Line(points = {{-33.8, 28}, {0, 28}, {0, 88}, {-78, 88}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(concentrationMeasure.actualConc, curve.u) annotation(Line(points = {{-76, -26}, {-76, 28}, {-54, 28}}, color = {0, 0, 127}, smooth = Smooth.None));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-124, 114}, {118, 90}}, lineColor=  {0, 0, 255}, textString=  "%name")}));
    end Thyroxine;

    model Thyrotropin
      extends PhysiolibraryOld.Icons.Hypophysis;
      // outer parameter Real ECF_Vol(final unit="ml");
      PhysiolibraryOld.Blocks.ConcentrationConstant_uU_per_ml
        hormoneFlowConstant(k=4)
        annotation (Placement(transformation(extent={{2,32},{-10,44}})));
      PhysiolibraryOld.Factors.CurveValue ThyroxineEffect(data={{0.0,8.0,0},{
            8.0,1.0,-0.2},{20.0,0.0,0}}, curve(iFrom(start=2)))
        annotation (Placement(transformation(extent={{-24,14},{-4,34}})));
      PhysiolibraryOld.Factors.SimpleMultiply HypothalamusTSH
        annotation (Placement(transformation(extent={{-4,4},{-24,24}})));
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{-88,78},{-68,98}}),
            iconTransformation(extent={{-90,-70},{-70,-50}})));
      PhysiolibraryOld.Interfaces.RealOutput_ TSH(quantity="Concentration",
          final unit="uU/ml") "thyrotropin" annotation (Placement(
            transformation(extent={{12,-32},{32,-12}}), iconTransformation(
              extent={{80,-20},{120,20}})));
      PhysiolibraryOld.Interfaces.RealInput_ Thyroxine(quantity="Concentration",
          final unit="ug/ml") annotation (Placement(transformation(extent={{-68,
                14},{-48,34}}), iconTransformation(extent={{-100,60},{-60,100}})));
      PhysiolibraryOld.Factors.CurveValue TemperatureEffect_(data={{-2.0,4.0,0},
            {0.0,1.0,-1.0},{2.0,0.2,0}})
        annotation (Placement(transformation(extent={{56,16},{36,36}})));
      Modelica.Blocks.Math.Feedback feedback annotation(Placement(transformation(extent = {{76, 20}, {64, 32}})));
      PhysiolibraryOld.Blocks.TemperatureConstant temperatureConstant(k=37)
        annotation (Placement(transformation(extent={{90,12},{82,20}})));
    equation
      connect(hormoneFlowConstant.y, ThyroxineEffect.yBase) annotation(Line(points = {{-10.6, 38}, {-14, 38}, {-14, 26}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(ThyroxineEffect.y, HypothalamusTSH.yBase) annotation(Line(points = {{-14, 22}, {-14, 16}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(HypothalamusTSH.y, TSH) annotation(Line(points = {{-14, 12}, {-14, -22}, {22, -22}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Thyroxine, ThyroxineEffect.u) annotation(Line(points = {{-58, 24}, {-23.8, 24}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.brain_FunctionEffect, TemperatureEffect_.yBase) annotation(Line(points = {{-78, 88}, {46, 88}, {46, 28}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(TemperatureEffect_.u, feedback.y) annotation(Line(points = {{55.8, 26}, {64.59999999999999, 26}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(feedback.u1, busConnector.HeatCore_Temp) annotation(Line(points = {{74.8, 26}, {82, 26}, {82, 88}, {-78, 88}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(feedback.u2, temperatureConstant.y) annotation(Line(points = {{70, 21.2}, {70, 16}, {81.59999999999999, 16}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(TemperatureEffect_.y, HypothalamusTSH.u) annotation(Line(points = {{46, 24}, {46, 14}, {-4.2, 14}}, color = {0, 0, 127}, smooth = Smooth.None));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-118, 122}, {116, 100}}, lineColor=  {0, 0, 255}, textString=  "%name")}));
    end Thyrotropin;

    model Renin
      extends PhysiolibraryOld.Icons.Kidney;
      // outer parameter Real ECF_Vol(final unit="ml");
      PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment ReninPool(
          initialSoluteMass=17153.7, stateName="ReninPool.Mass")
        " 2 GU/ml * 0.6 * 15000 ml =  18000 GU "
        annotation (Placement(transformation(extent={{-82,-54},{-62,-34}})));
      PhysiolibraryOld.ConcentrationFlow.SoluteFlowPump secretion
        annotation (Placement(transformation(extent={{12,-54},{-8,-34}})));
      PhysiolibraryOld.Factors.SimpleMultiply CountEffect
        annotation (Placement(transformation(extent={{36,62},{56,82}})));
      PhysiolibraryOld.Blocks.Constant hormoneFlowConstant(k=0.0033)
        annotation (Placement(transformation(extent={{-20,-10},{-12,-2}})));
      PhysiolibraryOld.Factors.CurveValue TGFEffect(data={{0.0,8.0,0},{0.5,2.0,
            -4.0},{1.0,1.0,-1.0},{3.0,0.5,0}})
        annotation (Placement(transformation(extent={{12,-22},{-8,-2}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
        concentrationMeasure(unitsString="GU/ml") annotation (Placement(
            transformation(
            extent={{-10,-10},{10,10}},
            rotation=0,
            origin={-62,-32})));
      PhysiolibraryOld.ConcentrationFlow.OutputPump Clearance
        annotation (Placement(transformation(extent={{-30,-98},{-10,-78}})));
      Modelica.Blocks.Math.Gain K(k = 0.0161) annotation(Placement(transformation(extent = {{-3, -3}, {3, 3}}, rotation = 0, origin = {-35, -59})));
      PhysiolibraryOld.Blocks.HormoneFlowConstant_GU hormoneFlowConstant1(k=290)
        annotation (Placement(transformation(extent={{62,76},{50,88}})));
      Modelica.Blocks.Math.Gain VODIST(k = 0.6) annotation(Placement(transformation(extent = {{-6, -6}, {6, 6}}, rotation = 0, origin = {-68, -2})));
      PhysiolibraryOld.Factors.SimpleMultiply FunctionEffect
        annotation (Placement(transformation(extent={{36,56},{56,76}})));
      PhysiolibraryOld.Factors.SimpleMultiply BaseFraction
        annotation (Placement(transformation(extent={{-8,-16},{12,4}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment ReninFree(
          initialSoluteMass=87000, stateName="ReninFree.Mass") annotation (
          Placement(transformation(
            extent={{-10,10},{10,-10}},
            rotation=180,
            origin={36,-44})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment ReninGranules(
          initialSoluteMass=870000.0, stateName="ReninGranules.Mass")
        annotation (Placement(transformation(
            extent={{-10,10},{10,-10}},
            rotation=180,
            origin={86,-44})));
      PhysiolibraryOld.ConcentrationFlow.InputPump synthesis
        annotation (Placement(transformation(extent={{56,-30},{36,-10}})));
      PhysiolibraryOld.Blocks.Constant Constant(k=1)
        "only a normalized volume to normal value of ReginFree solute volume"
        annotation (Placement(transformation(extent={{52,-34},{46,-28}})));
      PhysiolibraryOld.Blocks.Constant Constant1(k=10)
        "only a normalized volume to normal value of ReginFree solute volume"
        annotation (Placement(transformation(extent={{86,-34},{92,-28}})));
      PhysiolibraryOld.Factors.CurveValue TGFEffect1(data={{0.0,10.0,0},{0.6,
            2.0,-4.0},{1.0,1.0,-1.0},{2.0,0.3,0}})
        annotation (Placement(transformation(extent={{56,34},{36,54}})));
      PhysiolibraryOld.Blocks.Integrator integrator(
        k=1/60/PhysiolibraryOld.SecPerMin,
        y_start=290,
        stateName="ReninSynthesis.Rate") annotation (Placement(transformation(
            extent={{-10,-10},{10,10}},
            rotation=270,
            origin={46,6})));
      Modelica.Blocks.Math.Feedback feedback annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 270, origin = {46, 28})));
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{-88,80},{-68,100}}),
            iconTransformation(extent={{-90,-70},{-70,-50}})));
      PhysiolibraryOld.Interfaces.RealOutput_ ReninPool_PRA(quantity=
            "Concentration", final unit="GU/ml") "ReninPool.[PRA]" annotation (
          Placement(transformation(extent={{-98,-80},{-78,-60}}),
            iconTransformation(extent={{80,-20},{120,20}})));
      Nerves.BetaReceptorsActivityFactor betaReceptorsActivityFactor annotation(Placement(transformation(extent = {{-12, 14}, {8, 34}})));
      PhysiolibraryOld.Factors.CurveValue NaEffect(data={{0,0.0,0.0},{48,1.0,
            0.03},{100,2.0,0.0}})
        annotation (Placement(transformation(extent={{82,54},{62,74}})));
      PhysiolibraryOld.Factors.CurveValue ANPEffect(data={{0.0,1.2,0.0},{1.3,
            1.0,-0.3},{2.7,0.8,0.0}})
        annotation (Placement(transformation(extent={{82,50},{62,70}})));
      PhysiolibraryOld.Factors.CurveValue A2Effect(data={{0.0,0.9,0.0},{1.3,1.0,
            0.1},{2.5,2.0,2.0},{3.5,5.0,0.0}})
        annotation (Placement(transformation(extent={{82,46},{62,66}})));
      PhysiolibraryOld.Factors.CurveValue FurosemideEffect(data={{0.0,1.0,0.0},
            {1.3,0.2,0.0}})
        annotation (Placement(transformation(extent={{82,42},{62,62}})));
      PhysiolibraryOld.Blocks.Constant Constant2(k=1)
        annotation (Placement(transformation(extent={{62,68},{68,74}})));
      PhysiolibraryOld.Factors.CurveValue SympsEffect(data={{0.0,0.5,0},{1.0,
            1.0,1.0},{3.0,4.0,0}})
        annotation (Placement(transformation(extent={{-8,-34},{12,-14}})));
      PhysiolibraryOld.Blocks.Constant Constant3(k=1)
        annotation (Placement(transformation(extent={{-12,36},{-6,42}})));
      PhysiolibraryOld.Factors.CurveValue SympsEffect1(data={{0.0,0.5,0},{1.0,
            1.0,1.0},{2.5,4.0,0}})
        annotation (Placement(transformation(extent={{36,44},{56,64}})));
      PhysiolibraryOld.ConcentrationFlow.SoluteFlowPump fluxReninFree
        annotation (Placement(transformation(extent={{60,-44},{70,-34}})));
      PhysiolibraryOld.ConcentrationFlow.SoluteFlowPump fluxReninGranules
        annotation (Placement(transformation(extent={{70,-46},{60,-56}})));
      Modelica.Blocks.Math.Gain gain1(k = 0.01) annotation(Placement(transformation(extent = {{-5, -5}, {5, 5}}, rotation = 270, origin = {65, -27})));
      Modelica.Blocks.Math.Gain gain3(k = 0.001) annotation(Placement(transformation(extent = {{-5, -5}, {5, 5}}, rotation = 90, origin = {65, -63})));
    equation
      connect(ReninPool.q_out, secretion.q_out) annotation(Line(points = {{-72, -44}, {-8, -44}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(concentrationMeasure.q_in, ReninPool.q_out) annotation(Line(points = {{-62, -32}, {-71.2, -32}, {-71.2, -44}, {-72, -44}}, color = {200, 0, 0}, smooth = Smooth.None));
      connect(concentrationMeasure.actualConc, busConnector.Renin) annotation(Line(points = {{-62, -28}, {-77, -28}, {-77, 90}, {-78, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(ReninPool.q_out, Clearance.q_in) annotation(Line(points = {{-72, -44}, {-54, -44}, {-54, -88}, {-26, -88}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(ReninPool.soluteMass, K.u) annotation(Line(points = {{-72, -51.8}, {-72, -59}, {-38.6, -59}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Clearance.desiredFlow, K.y) annotation(Line(points = {{-20, -84}, {-20, -59}, {-31.7, -59}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.Kidney_NephronCount_Total_xNormal, CountEffect.u) annotation(Line(points = {{-78, 90}, {-28.9, 90}, {-28.9, 72}, {36.2, 72}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(hormoneFlowConstant1.y, CountEffect.yBase) annotation(Line(points = {{49.4, 82}, {46, 82}, {46, 74}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.ECFV_Vol, VODIST.u) annotation(Line(points = {{-78, 90}, {-76.59999999999999, 90}, {-76.59999999999999, -2}, {-75.2, -2}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(VODIST.y, ReninPool.SolventVolume) annotation(Line(points = {{-61.4, -2}, {-58, -2}, {-58, -22}, {-90, -22}, {-90, -38}, {-80, -38}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(CountEffect.y, FunctionEffect.yBase) annotation(Line(points = {{46, 70}, {46, 68}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(BaseFraction.y, TGFEffect.yBase) annotation(Line(points = {{2, -8}, {2, -10}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(hormoneFlowConstant.y, BaseFraction.u) annotation(Line(points = {{-11.6, -6}, {-7.8, -6}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(ReninFree.soluteMass, BaseFraction.yBase) annotation(Line(points = {{36, -51.8}, {36, -58}, {18, -58}, {18, 0}, {2, 0}, {2, -4}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Constant.y, ReninFree.SolventVolume) annotation(Line(points = {{45.7, -31}, {44, -31}, {44, -38}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Constant1.y, ReninGranules.SolventVolume) annotation(Line(points = {{92.3, -31}, {94, -31}, {94, -38}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(feedback.y, integrator.u) annotation(Line(points = {{46, 19}, {46, 18}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(integrator.y, feedback.u2) annotation(Line(points = {{46, -5}, {46, -8}, {28, -8}, {28, 28}, {38, 28}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(integrator.y, synthesis.desiredFlow) annotation(Line(points = {{46, -5}, {46, -16}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(secretion.q_in, ReninFree.q_out) annotation(Line(points = {{12, -44}, {36, -44}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(ReninFree.q_out, synthesis.q_out) annotation(Line(points = {{36, -44}, {36, -20}, {40, -20}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(concentrationMeasure.actualConc, ReninPool_PRA) annotation(Line(points = {{-62, -28}, {-92, -28}, {-92, -70}, {-88, -70}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.BetaPool_Effect, betaReceptorsActivityFactor.BetaPool_Effect) annotation(Line(points = {{-78, 90}, {-42, 90}, {-42, 30}, {-11.8, 30}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.BetaBlocade_Effect, betaReceptorsActivityFactor.BetaBlockade_Effect) annotation(Line(points = {{-78, 90}, {-42, 90}, {-42, 24}, {-11.8, 24}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.GangliaKidney_NA, betaReceptorsActivityFactor.GangliaGeneral_NA) annotation(Line(points = {{-78, 90}, {-42, 90}, {-42, 18}, {-11.8, 18}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(Constant2.y, NaEffect.yBase) annotation(Line(points = {{68.3, 71}, {72, 71}, {72, 66}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(NaEffect.y, ANPEffect.yBase) annotation(Line(points = {{72, 62}, {72, 62}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(ANPEffect.y, A2Effect.yBase) annotation(Line(points = {{72, 58}, {72, 58}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(A2Effect.y, FurosemideEffect.yBase) annotation(Line(points = {{72, 54}, {72, 54}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.KidneyFunctionEffect, FunctionEffect.u) annotation(Line(points = {{-78, 90}, {-28, 90}, {-28, 66}, {36.2, 66}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(TGFEffect1.y, feedback.u1) annotation(Line(points = {{46, 42}, {46, 36}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(FurosemideEffect.y, TGFEffect1.u) annotation(Line(points = {{72, 50}, {72, 44}, {55.8, 44}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(ANPEffect.u, busConnector.ANPPool_Log10Conc) annotation(Line(points = {{81.8, 60}, {98, 60}, {98, 90}, {-78, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(A2Effect.u, busConnector.A2Pool_Log10Conc) annotation(Line(points = {{81.8, 56}, {98, 56}, {98, 90}, {-78, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(FurosemideEffect.u, busConnector.FurosemidePool_Loss) annotation(Line(points = {{81.8, 52}, {98, 52}, {98, 90}, {-78, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(TGFEffect.u, FurosemideEffect.y) annotation(Line(points = {{11.8, -12}, {72, -12}, {72, 50}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(TGFEffect.y, SympsEffect.yBase) annotation(Line(points = {{2, -14}, {2, -22}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(SympsEffect.y, secretion.soluteFlow) annotation(Line(points = {{2, -26}, {2, -38}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(betaReceptorsActivityFactor.y, SympsEffect.u) annotation(Line(points = {{-2, 17}, {-2, 6}, {-32, 6}, {-32, -24}, {-7.8, -24}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Constant3.y, betaReceptorsActivityFactor.yBase) annotation(Line(points = {{-5.7, 39}, {-2, 39}, {-2, 31}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(SympsEffect1.y, TGFEffect1.yBase) annotation(Line(points = {{46, 52}, {46, 46}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(FunctionEffect.y, SympsEffect1.yBase) annotation(Line(points = {{46, 64}, {46, 56}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(betaReceptorsActivityFactor.y, SympsEffect1.u) annotation(Line(points = {{-2, 17}, {-2, 6}, {18, 6}, {18, 54}, {36.2, 54}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(NaEffect.u, busConnector.MD_Na) annotation(Line(points = {{81.8, 64}, {98, 64}, {98, 90}, {-78, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(gain1.y, fluxReninFree.soluteFlow) annotation(Line(points = {{65, -32.5}, {66, -34}, {65, -36}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(gain3.y, fluxReninGranules.soluteFlow) annotation(Line(points = {{65, -57.5}, {65, -54}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(fluxReninFree.q_out, ReninGranules.q_out) annotation(Line(points = {{70, -39}, {74, -39}, {74, -44}, {86, -44}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(fluxReninGranules.q_in, ReninGranules.q_out) annotation(Line(points = {{70, -51}, {74, -51}, {74, -44}, {86, -44}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(ReninFree.q_out, fluxReninFree.q_in) annotation(Line(points = {{36, -44}, {48, -44}, {48, -39}, {60, -39}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(ReninFree.q_out, fluxReninGranules.q_out) annotation(Line(points = {{36, -44}, {48, -44}, {48, -51}, {60, -51}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(ReninGranules.soluteMass, gain3.u) annotation(Line(points = {{86, -51.8}, {86, -72}, {64, -72}, {64, -69}, {65, -69}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(ReninFree.soluteMass, gain1.u) annotation(Line(points = {{36, -51.8}, {36, -58}, {58, -58}, {58, -16}, {65, -16}, {65, -21}}, color = {0, 0, 127}, smooth = Smooth.None));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-112, 108}, {122, 86}}, lineColor=  {0, 0, 255}, textString=  "%name")}));
    end Renin;

    model Angiotensine2
      //  extends Library.Interfaces.Tissues.Liver;
      //  extends Library.Interfaces.Tissues.Kidney;
      extends PhysiolibraryOld.Icons.Lungs;
      // outer parameter Real ECF_Vol(final unit="ml");
      PhysiolibraryOld.Blocks.Constant CEBase(k=30.0)
        annotation (Placement(transformation(extent={{-64,22},{-50,36}})));
      PhysiolibraryOld.Factors.SimpleMultiply A2_pG_per_mL
        annotation (Placement(transformation(extent={{-32,0},{-12,20}})));
      PhysiolibraryOld.Factors.SimpleMultiply EndogenousRate
        annotation (Placement(transformation(extent={{-46,10},{-26,30}})));
      PhysiolibraryOld.Blocks.ConcentrationConstant_pg_per_ml
        concentrationConstant_pg_per_ml(k=0.3333)
        annotation (Placement(transformation(extent={{-44,38},{-24,58}})));
      PhysiolibraryOld.Factors.SimpleMultiply PG_TO_PMOL
        annotation (Placement(transformation(extent={{-32,-54},{-12,-34}})));
      PhysiolibraryOld.Blocks.Constant CEBase1(k=0.956)
        "conversion AII from pg to pmol coeficient"
        annotation (Placement(transformation(extent={{-72,-54},{-58,-40}})));
      PhysiolibraryOld.Blocks.Log10AsEffect log10_1
        annotation (Placement(transformation(extent={{-2,-42},{18,-22}})));
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{-88,78},{-68,98}}),
            iconTransformation(extent={{-90,-70},{-70,-50}})));
      PhysiolibraryOld.Interfaces.RealInput_ ReninPool_PRA(unit="GU/ml")
        annotation (Placement(transformation(extent={{-90,4},{-70,24}}),
            iconTransformation(extent={{-100,20},{-60,60}})));
      PhysiolibraryOld.Interfaces.RealOutput_ A2Pool_Log10Conc(quantity=
            "ConcentrationEffect", final unit="log10(pg/ml)") annotation (
          Placement(transformation(extent={{70,-42},{90,-22}}),
            iconTransformation(extent={{80,-60},{120,-20}})));
      PhysiolibraryOld.Interfaces.RealOutput_ Angiotensine2(final unit="pg/ml",
          quantity="Concentration") annotation (Placement(transformation(extent=
               {{-12,-64},{8,-44}}), iconTransformation(extent={{80,-20},{120,
                20}})));
    equation
      connect(concentrationConstant_pg_per_ml.y, A2_pG_per_mL.yBase) annotation(Line(points = {{-23, 48}, {-22, 48}, {-22, 12}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(CEBase1.y, PG_TO_PMOL.u) annotation(Line(points = {{-57.3, -47}, {-44.65, -47}, {-44.65, -44}, {-31.8, -44}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(log10_1.y, busConnector.A2Pool_Log10Conc) annotation(Line(points = {{19, -32}, {60.5, -32}, {60.5, 88}, {-78, 88}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(ReninPool_PRA, EndogenousRate.u) annotation(Line(points = {{-80, 14}, {-64, 14}, {-64, 20}, {-45.8, 20}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(log10_1.y, A2Pool_Log10Conc) annotation(Line(points = {{19, -32}, {80, -32}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(PG_TO_PMOL.y, Angiotensine2) annotation(Line(points = {{-22, -46}, {-22, -54}, {-2, -54}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(log10_1.y, busConnector.A2Pool_Log10Con) annotation(Line(points = {{19, -32}, {58, -32}, {58, 88}, {-78, 88}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(CEBase.y, EndogenousRate.yBase) annotation(Line(points = {{-49.3, 29}, {-36, 29}, {-36, 22}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(EndogenousRate.y, A2_pG_per_mL.u) annotation(Line(points = {{-36, 18}, {-36, 10}, {-31.8, 10}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(A2_pG_per_mL.y, log10_1.u) annotation(Line(points = {{-22, 8}, {-22, -32}, {-4, -32}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(A2_pG_per_mL.y, PG_TO_PMOL.yBase) annotation(Line(points = {{-22, 8}, {-22, -42}}, color = {0, 0, 127}, smooth = Smooth.None));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-128, 102}, {106, 80}}, lineColor=  {0, 0, 255}, textString=  "%name")}));
    end Angiotensine2;

    model Hormones
      //extends Library.Interfaces.BaseModel;
      extends PhysiolibraryOld.Icons.Hormones;
      Aldosterone aldosterone annotation(Placement(transformation(extent = {{20, 72}, {40, 92}})));
      Angiotensine2 angiotensine2 annotation(Placement(transformation(extent = {{-28, 72}, {-8, 92}})));
      Renin renin annotation(Placement(transformation(extent = {{-80, 72}, {-60, 92}})));
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{-98,20},{-78,40}}),
            iconTransformation(extent={{-80,40},{-42,78}})));
      Catechols.Catechols catechols annotation(Placement(transformation(extent = {{20, -14}, {40, 6}})));
      EPO erythropoietin annotation(Placement(transformation(extent = {{-78, -10}, {-58, 10}})));
    equation
      connect(busConnector, aldosterone.busConnector) annotation(Line(points = {{-88, 30}, {16, 30}, {16, 76}, {22, 76}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(busConnector, angiotensine2.busConnector) annotation(Line(points = {{-88, 30}, {-34, 30}, {-34, 76}, {-26, 76}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(busConnector, renin.busConnector) annotation(Line(points = {{-88, 30}, {-84, 30}, {-84, 76}, {-78, 76}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(renin.ReninPool_PRA, angiotensine2.ReninPool_PRA) annotation(Line(points = {{-60, 82}, {-52, 82}, {-52, 86}, {-26, 86}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(angiotensine2.A2Pool_Log10Conc, aldosterone.A2Pool_Log10Conc) annotation(Line(points = {{-8, 78}, {2, 78}, {2, 88}, {22, 88}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector, catechols.busConnector) annotation(Line(points = {{-88, 30}, {16, 30}, {16, -10}, {22, -10}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      connect(busConnector, erythropoietin.busConnector) annotation(Line(points = {{-88, 30}, {-84, 30}, {-84, -6}, {-76, -6}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent = {{-120, -98}, {122, -132}}, lineColor = {0, 0, 255}, textString = "%name")}));
    end Hormones;

    model Leptin
      extends PhysiolibraryOld.Icons.Fat;
      // outer parameter Real ECF_Vol(final unit="ml");
      Modelica.Blocks.Math.Gain gain(k = 0.0119) annotation(Placement(transformation(extent = {{-44, -32}, {-38, -26}})));
      PhysiolibraryOld.ConcentrationFlow.OutputPump clearance
        annotation (Placement(transformation(extent={{-34,-6},{-14,-26}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationCompartment LeptinPool(
          stateName="LeptinPool.Mass", initialSoluteMass=106.978)
        annotation (Placement(transformation(extent={{-66,-16},{-46,4}})));
      PhysiolibraryOld.ConcentrationFlow.InputPump secretion
        annotation (Placement(transformation(extent={{78,-16},{58,4}})));
      PhysiolibraryOld.Blocks.HormoneFlowConstant_nG hormoneFlowConstant_pG(k=
            1.2)
        annotation (Placement(transformation(extent={{80,18},{72,26}})));
      PhysiolibraryOld.Factors.CurveValue AdiposeEffect(data={{0,0.0,0},{3600,
            1.0,8.000000000000001e-005},{100000,6.0,0}})
        annotation (Placement(transformation(extent={{78,0},{58,20}})));
      PhysiolibraryOld.Factors.SimpleMultiply FunctionEffect
        annotation (Placement(transformation(extent={{58,-4},{78,16}})));
      Modelica.Blocks.Math.Gain gain1(k = 0.001) annotation(Placement(transformation(extent = {{-76, 0}, {-72, 4}})));
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{-98,68},{-78,88}}),
            iconTransformation(extent={{-90,-70},{-70,-50}})));
      PhysiolibraryOld.ConcentrationFlow.ConcentrationMeasure
        concentrationMeasure(unitsString="ng/ml") annotation (Placement(
            transformation(
            extent={{-10,-10},{10,10}},
            rotation=0,
            origin={-60,8})));
      PhysiolibraryOld.Interfaces.RealOutput_ Leptin(quantity="Concentration",
          final unit="ng/ml") annotation (Placement(transformation(extent={{-78,
                -60},{-58,-40}}), iconTransformation(extent={{80,-20},{120,20}})));
      Modelica.Blocks.Sources.Constant const(k = 7.44919) annotation(Placement(transformation(extent = {{-86, 32}, {-66, 52}})));
    equation
      connect(LeptinPool.soluteMass, gain.u) annotation(Line(points = {{-56, -13.8}, {-56, -29}, {-44.6, -29}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(gain.y, clearance.desiredFlow) annotation(Line(points = {{-37.7, -29}, {-24, -29}, {-24, -20}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(clearance.q_in, LeptinPool.q_out) annotation(Line(points = {{-30, -16}, {-38, -16}, {-38, -6}, {-56, -6}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(busConnector.FatFunctionEffect, FunctionEffect.u) annotation(Line(points = {{-88, 78}, {12.1, 78}, {12.1, 6}, {58.2, 6}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(AdiposeEffect.y, FunctionEffect.yBase) annotation(Line(points = {{68, 8}, {68, 8}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(secretion.desiredFlow, FunctionEffect.y) annotation(Line(points = {{68, -2}, {68, 4}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(secretion.q_out, LeptinPool.q_out) annotation(Line(points = {{62, -6}, {-56, -6}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(busConnector.ECFV_Vol, gain1.u) annotation(Line(points = {{-88, 78}, {-93.2, 78}, {-93.2, 2}, {-76.40000000000001, 2}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(gain1.y, LeptinPool.SolventVolume) annotation(Line(points = {{-71.8, 2}, {-67.90000000000001, 2}, {-67.90000000000001, 0}, {-64, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(LeptinPool.q_out, concentrationMeasure.q_in) annotation(Line(points = {{-56, -6}, {-54, -6}, {-54, 8}, {-60, 8}}, color = {200, 0, 0}, thickness = 1, smooth = Smooth.None));
      connect(hormoneFlowConstant_pG.y, AdiposeEffect.yBase) annotation(Line(points = {{71.59999999999999, 22}, {68, 22}, {68, 12}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(AdiposeEffect.u, busConnector.LipidDeposits_Mass) annotation(Line(points = {{77.8, 10}, {90, 10}, {90, 78}, {-88, 78}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(concentrationMeasure.actualConc, Leptin) annotation(Line(points = {{-60, 12}, {-60, 20}, {-82, 20}, {-82, -50}, {-68, -50}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(concentrationMeasure.actualConc, busConnector.Leptin) annotation(Line(points = {{-60, 12}, {-60, 78}, {-88, 78}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-100, 80}, {100, 100}}, lineColor=  {0, 0, 255}, textString=  "%name")}));
    end Leptin;
    annotation(Documentation(revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr>
                   </table>
                   </html>", info = "<html>
                   <p>TODO:</p>
                   <p><b><font style=\"font-size: 12pt; \">Release of Vasopressin by Angiotensin II</font></b></p>
                   </html>"), Icon(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics));
  end Hormones;

  package Nerves "Autonimic Nerves"
    extends PhysiolibraryOld.Icons.NervesLib;
    model BaroReceptorInHoursAdaptation
      extends PhysiolibraryOld.Icons.Barroreceptor;
      PhysiolibraryOld.Interfaces.RealInput_ pressure annotation (Placement(
            transformation(extent={{-120,-20},{-80,20}}), iconTransformation(
              extent={{-110,-10},{-90,10}})));
      PhysiolibraryOld.Blocks.Integrator adaptivePressure(
        y_start=AdaptivePressure,
        k=1/(Tau*60*PhysiolibraryOld.SecPerMin),
        stateName="Baroreflex.AdaptedPressure")
        annotation (Placement(transformation(extent={{-22,-10},{-2,10}})));
      Modelica.Blocks.Math.Feedback pressureChange annotation(Placement(transformation(extent = {{-70, -10}, {-50, 10}})));
      PhysiolibraryOld.Curves.Curve pressureChangeOnNA(
        x=PressureChangeOnNA[:, 1],
        y=PressureChangeOnNA[:, 2],
        slope=PressureChangeOnNA[:, 3])
        annotation (Placement(transformation(extent={{30,16},{66,52}})));
      PhysiolibraryOld.Interfaces.RealOutput_ NA
        annotation (Placement(transformation(extent={{80,-20},{120,20}})));
      parameter Real AdaptivePressure(final unit = "mmHg");
      parameter Real Tau(final unit = "h");
      parameter Real PressureChangeOnNA[3, :];
    equation
      connect(pressureChange.u2, adaptivePressure.y) annotation(Line(points = {{-60, -8}, {-60, -22}, {12, -22}, {12, 0}, {-1, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(pressureChange.y, adaptivePressure.u) annotation(Line(points = {{-51, 0}, {-24, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(pressureChangeOnNA.val, NA) annotation(Line(points = {{66.36, 34}, {88, 34}, {88, 0}, {100, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(pressureChange.y, pressureChangeOnNA.u) annotation(Line(points = {{-51, 0}, {-40, 0}, {-40, 34}, {30, 34}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(pressure, pressureChange.u1) annotation(Line(points = {{-100, 0}, {-68, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-122, 130}, {118, 102}}, lineColor=  {0, 0, 0}, fillColor=  {213, 255, 170},
                fillPattern=                                                                                                    FillPattern.Solid, textString=  "%name")}));
    end BaroReceptorInHoursAdaptation;

    model BaroReceptorInDaysAdaptation
      extends PhysiolibraryOld.Icons.Barroreceptor;
      PhysiolibraryOld.Interfaces.RealInput_ pressure annotation (Placement(
            transformation(extent={{-120,-20},{-80,20}}), iconTransformation(
              extent={{-110,-10},{-90,10}})));
      PhysiolibraryOld.Blocks.Integrator adaptivePressure(
        y_start=AdaptivePressure,
        k=1/(Tau*1440*PhysiolibraryOld.SecPerMin),
        stateName="LowPressureReceptors.AdaptedPressure")
        annotation (Placement(transformation(extent={{-20,-10},{0,10}})));
      Modelica.Blocks.Math.Feedback pressureChange annotation(Placement(transformation(extent = {{-70, -10}, {-50, 10}})));
      PhysiolibraryOld.Curves.Curve pressureChangeOnNA(
        x=PressureChangeOnNA[:, 1],
        y=PressureChangeOnNA[:, 2],
        slope=PressureChangeOnNA[:, 3])
        annotation (Placement(transformation(extent={{30,16},{66,52}})));
      PhysiolibraryOld.Interfaces.RealOutput_ NA
        annotation (Placement(transformation(extent={{80,-20},{120,20}})));
      parameter Real AdaptivePressure(final unit = "mmHg");
      parameter Real Tau(final unit = "d");
      parameter Real PressureChangeOnNA[3, :];
    equation
      connect(pressureChange.u2, adaptivePressure.y) annotation(Line(points = {{-60, -8}, {-60, -22}, {12, -22}, {12, 0}, {1, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(pressureChange.y, adaptivePressure.u) annotation(Line(points = {{-51, 0}, {-22, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(pressureChangeOnNA.val, NA) annotation(Line(points = {{66.36, 34}, {88, 34}, {88, 0}, {100, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(pressureChange.y, pressureChangeOnNA.u) annotation(Line(points = {{-51, 0}, {-40, 0}, {-40, 34}, {30, 34}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(pressure, pressureChange.u1) annotation(Line(points = {{-100, 0}, {-68, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-100, 100}, {100, 64}}, lineColor=  {0, 0, 0}, fillColor=  {213, 255, 170},
                fillPattern=                                                                                                    FillPattern.Solid, textString=  "%name")}));
    end BaroReceptorInDaysAdaptation;

    model SympatheticCNS
      extends PhysiolibraryOld.Icons.SympatheticNerves;
      parameter Real BaroEffect[:, 3] = {{0.0, 1.5, 0}, {1.0, 1.0, -0.5}, {2.0, 0.5, 0}};
      parameter Real LowPressureEffect[:, 3] = {{0.0, 1.1, 0}, {1.0, 1.0, -0.1}, {4.0, 0.9, 0}};
      parameter Real FuelEffect[:, 3] = {{0.3, 0.0, 0}, {0.6, 3.0, 0}, {0.8, 0.0, 0}};
      parameter Real A2ConcEffect[:, 3] = {{1.7, 1.0, 0}, {2.3, 1.4, 0}};
      PhysiolibraryOld.Interfaces.RealInput_ CarotidSinusReceptors annotation (
          Placement(transformation(extent={{-100,60},{-60,100}}),
            iconTransformation(extent={{-100,60},{-60,100}})));
      PhysiolibraryOld.Interfaces.RealInput_ LowPressureReceptors
        annotation (Placement(transformation(extent={{-120,20},{-80,60}})));
      PhysiolibraryOld.Curves.Curve baroEffect(
        x=BaroEffect[:, 1],
        y=BaroEffect[:, 2],
        slope=BaroEffect[:, 3])
        annotation (Placement(transformation(extent={{-46,70},{-26,90}})));
      PhysiolibraryOld.Curves.Curve lowPressureEffect(
        x=LowPressureEffect[:, 1],
        y=LowPressureEffect[:, 2],
        slope=LowPressureEffect[:, 3])
        annotation (Placement(transformation(extent={{-46,30},{-26,50}})));
      PhysiolibraryOld.Interfaces.RealInput_ brain_Fuel_FractUseDelay
        annotation (Placement(transformation(extent={{-120,-20},{-80,20}})));
      PhysiolibraryOld.Curves.Curve fuelEffect(
        x=FuelEffect[:, 1],
        y=FuelEffect[:, 2],
        slope=FuelEffect[:, 3])
        annotation (Placement(transformation(extent={{-46,-10},{-26,10}})));
      PhysiolibraryOld.Interfaces.RealInput_ A2Pool_Log10Conc annotation (
          Placement(transformation(extent={{-100,-100},{-60,-60}}),
            iconTransformation(extent={{-100,-100},{-60,-60}})));
      PhysiolibraryOld.Curves.Curve A2Effect(
        x=A2ConcEffect[:, 1],
        y=A2ConcEffect[:, 2],
        slope=A2ConcEffect[:, 3])
        annotation (Placement(transformation(extent={{-46,-90},{-26,-70}})));
      Modelica.Blocks.Math.Product reflexNA annotation(Placement(transformation(extent = {{-2, 54}, {18, 74}})));
      Modelica.Blocks.Math.Product neuralActivity annotation(Placement(transformation(extent = {{56, -10}, {76, 10}})));
      Modelica.Blocks.Math.Sum stimulus(nin = 3) annotation(Placement(transformation(extent = {{28, 8}, {48, 28}})));
      PhysiolibraryOld.Interfaces.RealOutput_ NA(unit="Hz") annotation (
          Placement(transformation(extent={{80,-80},{120,-40}}),
            iconTransformation(extent={{80,-80},{120,-40}})));
      PhysiolibraryOld.Interfaces.RealInput_ ExerciseSymps_TotalEffect
        annotation (Placement(transformation(extent={{-120,-60},{-80,-20}})));
      Modelica.Blocks.Math.Gain gain(k = 1.5) annotation(Placement(transformation(extent = {{84, -4}, {92, 4}})));
      PhysiolibraryOld.Interfaces.RealOutput_ SympsCNS_A2Effect annotation (
          Placement(transformation(extent={{82,18},{122,58}}),
            iconTransformation(extent={{80,20},{120,60}})));
      PhysiolibraryOld.Interfaces.RealOutput_ SympsCNS_BaroEffect annotation (
          Placement(transformation(extent={{60,60},{100,100}}),
            iconTransformation(extent={{60,60},{100,100}})));
    equation
      connect(CarotidSinusReceptors, baroEffect.u) annotation(Line(points = {{-80, 80}, {-46, 80}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(LowPressureReceptors, lowPressureEffect.u) annotation(Line(points = {{-100, 40}, {-46, 40}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(brain_Fuel_FractUseDelay, fuelEffect.u) annotation(Line(points = {{-100, 0}, {-46, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(A2Pool_Log10Conc, A2Effect.u) annotation(Line(points = {{-80, -80}, {-46, -80}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(baroEffect.val, reflexNA.u1) annotation(Line(points = {{-25.8, 80}, {-14, 80}, {-14, 70}, {-4, 70}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(lowPressureEffect.val, reflexNA.u2) annotation(Line(points = {{-25.8, 40}, {-14, 40}, {-14, 58}, {-4, 58}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(A2Effect.val, neuralActivity.u2) annotation(Line(points = {{-25.8, -80}, {44, -80}, {44, -6}, {54, -6}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(fuelEffect.val, stimulus.u[1]) annotation(Line(points = {{-25.8, 0}, {20, 0}, {20, 18}, {26, 18}, {26, 16.6667}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(stimulus.y, neuralActivity.u1) annotation(Line(points = {{49, 18}, {49.5, 18}, {49.5, 6}, {54, 6}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(reflexNA.y, stimulus.u[2]) annotation(Line(points = {{19, 64}, {22, 64}, {22, 18}, {26, 18}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(ExerciseSymps_TotalEffect, stimulus.u[3]) annotation(Line(points = {{-100, -40}, {22, -40}, {22, 19.3333}, {26, 19.3333}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(neuralActivity.y, gain.u) annotation(Line(points = {{77, 0}, {83.2, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(gain.y, NA) annotation(Line(points = {{92.40000000000001, 0}, {96, 0}, {96, -60}, {100, -60}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(baroEffect.val, SympsCNS_BaroEffect) annotation(Line(points = {{-25.8, 80}, {80, 80}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(A2Effect.val, SympsCNS_A2Effect) annotation(Line(points = {{-25.8, -80}, {44, -80}, {44, 38}, {102, 38}}, color = {0, 0, 127}, smooth = Smooth.None));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-160, 198}, {156, 164}}, lineColor=  {0, 0, 0}, fillColor=  {213, 255, 170},
                fillPattern=                                                                                                    FillPattern.Solid, textString=  "%name")}));
    end SympatheticCNS;

    model ExerciseSympathetic
      extends PhysiolibraryOld.Icons.PhysicalExercise;
      parameter Real MotorRadiation_TotalEffect[:, 3] = {{0, 0.0, 0.004}, {500, 2.2, 0.002}, {1000, 2.6, 0}};
      parameter Real PhOnNerveActivity[:, 3] = {{6.5, 5.0, 0}, {6.9, 0.0, 0}};
      PhysiolibraryOld.Curves.Curve SkeletalMuscle_Metaboreflex_NerveActivity(
        x=PhOnNerveActivity[:, 1],
        y=PhOnNerveActivity[:, 2],
        slope=PhOnNerveActivity[:, 3])
        annotation (Placement(transformation(extent={{-54,20},{-34,40}})));
      PhysiolibraryOld.Interfaces.RealInput_ SkeletalMuscle_Ph annotation (
          Placement(transformation(extent={{-136,0},{-96,40}}),
            iconTransformation(extent={{-120,20},{-80,60}})));
      PhysiolibraryOld.Curves.Curve motorRadiation_TotalEffect(
        x=MotorRadiation_TotalEffect[:, 1],
        y=MotorRadiation_TotalEffect[:, 2],
        slope=MotorRadiation_TotalEffect[:, 3])
        annotation (Placement(transformation(extent={{-54,-10},{-34,10}})));
      Modelica.Blocks.Math.Sum totalEffect(nin = 2) annotation(Placement(transformation(extent = {{32, -10}, {52, 10}})));
      Modelica.Blocks.Math.Gain gain(k = 0.32) annotation(Placement(transformation(extent = {{-26, 26}, {-18, 34}})));
      PhysiolibraryOld.Interfaces.RealOutput_ ExerciseSymps_TotalEffect
        annotation (Placement(transformation(extent={{78,-20},{118,20}})));
      PhysiolibraryOld.Interfaces.RealInput_ ExerciseMetabolism_TotalWats
        annotation (Placement(transformation(extent={{-118,-60},{-78,-20}}),
            iconTransformation(extent={{-118,-60},{-78,-20}})));
    equation
      connect(SkeletalMuscle_Ph, SkeletalMuscle_Metaboreflex_NerveActivity.u) annotation(Line(points = {{-116, 20}, {-85, 20}, {-85, 30}, {-54, 30}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(SkeletalMuscle_Metaboreflex_NerveActivity.val, gain.u) annotation(Line(points = {{-33.8, 30}, {-26.8, 30}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(gain.y, totalEffect.u[1]) annotation(Line(points = {{-17.6, 30}, {6, 30}, {6, -1}, {30, -1}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(motorRadiation_TotalEffect.val, totalEffect.u[2]) annotation(Line(points = {{-33.8, 0}, {-1.9, 0}, {-1.9, 1}, {30, 1}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(ExerciseMetabolism_TotalWats, motorRadiation_TotalEffect.u) annotation(Line(points = {{-98, -40}, {-76, -40}, {-76, 0}, {-54, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(totalEffect.y, ExerciseSymps_TotalEffect) annotation(Line(points = {{53, 0}, {98, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-132, 142}, {130, 106}}, lineColor=  {0, 0, 0}, fillColor=  {213, 255, 170},
                fillPattern=                                                                                                    FillPattern.Solid, textString=  "%name")}));
    end ExerciseSympathetic;

    model VagusNerve
      extends PhysiolibraryOld.Icons.NervusVagus;
      parameter Real SympsOnParasymps[:, 3] = {{0.0, 8.0, 0}, {1.5, 2.0, -2.0}, {4.5, 0.0, 0}};
      PhysiolibraryOld.Curves.Curve sympsOnParasymps(
        x=SympsOnParasymps[:, 1],
        y=SympsOnParasymps[:, 2],
        slope=SympsOnParasymps[:, 3])
        annotation (Placement(transformation(extent={{-54,-10},{-34,10}})));
      PhysiolibraryOld.Interfaces.RealOutput_ VagusNerve_NA_Hz
        annotation (Placement(transformation(extent={{78,-20},{118,20}})));
      PhysiolibraryOld.Interfaces.RealInput_ SympsCNS_NA_Hz
        annotation (Placement(transformation(extent={{-120,-20},{-80,20}})));
    equation
      connect(SympsCNS_NA_Hz, sympsOnParasymps.u) annotation(Line(points = {{-100, 0}, {-54, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(sympsOnParasymps.val, VagusNerve_NA_Hz) annotation(Line(points = {{-33.8, 0}, {98, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-104, 136}, {100, 102}}, lineColor=  {0, 0, 0}, fillColor=  {213, 255, 170},
                fillPattern=                                                                                                    FillPattern.Solid, textString=  "%name")}));
    end VagusNerve;

    model SA_Node
      extends PhysiolibraryOld.Icons.SinoatrialNode;
      parameter Real SympatheticEffect[:, 3] = {{0.0, 0, 0}, {1.0, 10, 10}, {5.0, 120, 0}};
      parameter Real ParasympatheticEffect[:, 3] = {{0.0, 0, 0}, {2.0, -20, -8}, {8.0, -40, 0}};
      PhysiolibraryOld.Interfaces.RealInput_ GangliaGeneral_NA
        annotation (Placement(transformation(extent={{-120,-40},{-80,0}})));
      PhysiolibraryOld.Curves.Curve parasympatheticEffect(
        x=ParasympatheticEffect[:, 1],
        y=ParasympatheticEffect[:, 2],
        slope=ParasympatheticEffect[:, 3])
        annotation (Placement(transformation(extent={{-50,-70},{-30,-50}})));
      Modelica.Blocks.Math.Sum rate(nin = 3) annotation(Placement(transformation(extent = {{64, -10}, {84, 10}})));
      PhysiolibraryOld.Interfaces.RealOutput_ Rate
        annotation (Placement(transformation(extent={{78,-20},{118,20}})));
      PhysiolibraryOld.Interfaces.RealInput_ VagusNerve_NA_Hz
        annotation (Placement(transformation(extent={{-120,-80},{-80,-40}})));
      HumMod.Nerves.BetaReceptorsActivityFactor betaReceptorsActivityFactor annotation(Placement(transformation(extent = {{10, 62}, {30, 82}})));
      PhysiolibraryOld.Blocks.Constant Constant(k=1)
        annotation (Placement(transformation(extent={{-2,82},{10,94}})));
      PhysiolibraryOld.Blocks.Constant Constant1(k=82)
        annotation (Placement(transformation(extent={{-6,-10},{14,10}})));
      PhysiolibraryOld.Interfaces.RealInput_ BetaBlockade_Effect
        annotation (Placement(transformation(extent={{-120,0},{-80,40}})));
      PhysiolibraryOld.Interfaces.RealInput_ BetaPool_Effect
        annotation (Placement(transformation(extent={{-120,40},{-80,80}})));
      PhysiolibraryOld.Curves.Curve sympatheticEffect(
        x=SympatheticEffect[:, 1],
        y=SympatheticEffect[:, 2],
        slope=SympatheticEffect[:, 3])
        annotation (Placement(transformation(extent={{26,20},{46,40}})));
    equation
      connect(parasympatheticEffect.val, rate.u[2]) annotation(Line(points = {{-29.8, -60}, {54.1, -60}, {54.1, 1.11022e-016}, {62, 1.11022e-016}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(VagusNerve_NA_Hz, parasympatheticEffect.u) annotation(Line(points = {{-100, -60}, {-50, -60}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(rate.y, Rate) annotation(Line(points = {{85, 0}, {98, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Constant.y, betaReceptorsActivityFactor.yBase) annotation(Line(points = {{10.6, 88}, {20, 88}, {20, 79}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Constant1.y, rate.u[1]) annotation(Line(points = {{15, 0}, {14, 0}, {14, -1.33333}, {62, -1.33333}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(BetaPool_Effect, betaReceptorsActivityFactor.BetaPool_Effect) annotation(Line(points = {{-100, 60}, {-46, 60}, {-46, 78}, {10.2, 78}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(betaReceptorsActivityFactor.BetaBlockade_Effect, BetaBlockade_Effect) annotation(Line(points = {{10.2, 72}, {-40, 72}, {-40, 20}, {-100, 20}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(GangliaGeneral_NA, betaReceptorsActivityFactor.GangliaGeneral_NA) annotation(Line(points = {{-100, -20}, {-30, -20}, {-30, 66}, {10.2, 66}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(betaReceptorsActivityFactor.y, sympatheticEffect.u) annotation(Line(points = {{20, 65}, {20, 30}, {26, 30}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(sympatheticEffect.val, rate.u[3]) annotation(Line(points = {{46.2, 30}, {54, 30}, {54, 1.33333}, {62, 1.33333}}, color = {0, 0, 127}, smooth = Smooth.None));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-102, 134}, {100, 102}}, lineColor=  {0, 0, 0}, fillColor=  {213, 255, 170},
                fillPattern=                                                                                                    FillPattern.Solid, textString=  "%name")}));
    end SA_Node;

    model GangliaKidney
      extends PhysiolibraryOld.Icons.Kidney;
      parameter Real LowPressureEffect[:, 3] = {{0.0, 1.5, 0}, {1.0, 1.0, -0.4}, {4.0, 0.2, 0}};
      parameter Real FuelEffect[:, 3] = {{0.3, 0.0, 0}, {0.6, 3.0, 0}, {0.8, 0.0, 0}};
      PhysiolibraryOld.Interfaces.RealInput_ SympsCNS_BaroEffect annotation (
          Placement(transformation(extent={{-120,-60},{-80,-20}}),
            iconTransformation(extent={{-120,-60},{-80,-20}})));
      PhysiolibraryOld.Interfaces.RealOutput_ NA
        annotation (Placement(transformation(extent={{60,42},{100,82}})));
      PhysiolibraryOld.Interfaces.RealInput_ LowPressureReceptors_NA
        annotation (Placement(transformation(extent={{-120,20},{-80,60}}),
            iconTransformation(extent={{-120,20},{-80,60}})));
      PhysiolibraryOld.Interfaces.RealInput_ brain_Fuel_FractUseDelay
        annotation (Placement(transformation(extent={{-100,60},{-60,100}}),
            iconTransformation(extent={{-100,60},{-60,100}})));
      PhysiolibraryOld.Interfaces.RealInput_ SympsCNS_A2Effect annotation (
          Placement(transformation(extent={{-100,-100},{-60,-60}}),
            iconTransformation(extent={{-100,-100},{-60,-60}})));
      PhysiolibraryOld.Interfaces.RealInput_ ExerciseSymps_TotalEffect
        annotation (Placement(transformation(extent={{-120,-20},{-80,20}}),
            iconTransformation(extent={{-120,-20},{-80,20}})));
      PhysiolibraryOld.Blocks.MultiProduct ReflexNA(nin=2)
        annotation (Placement(transformation(extent={{-12,8},{8,28}})));
      PhysiolibraryOld.Curves.Curve LowPressureEffectCurve(
        x=LowPressureEffect[:, 1],
        y=LowPressureEffect[:, 2],
        slope=LowPressureEffect[:, 3])
        annotation (Placement(transformation(extent={{-66,22},{-30,58}})));
      PhysiolibraryOld.Curves.Curve FuelEffectCurve(
        x=FuelEffect[:, 1],
        y=FuelEffect[:, 2],
        slope=FuelEffect[:, 3])
        annotation (Placement(transformation(extent={{-34,62},{2,98}})));
      Modelica.Blocks.Math.Sum sum1(nin = 3) annotation(Placement(transformation(extent = {{32, 16}, {52, 36}})));
      Modelica.Blocks.Math.Product NeuralActivity annotation(Placement(transformation(extent = {{62, -28}, {82, -8}})));
      Modelica.Blocks.Math.Gain toHz(k = 1.5) annotation(Placement(transformation(extent = {{88, -4}, {96, 4}})));
    equation
      connect(SympsCNS_BaroEffect, ReflexNA.u[1]) annotation(Line(points = {{-100, -40}, {-58, -40}, {-58, 18}, {-14, 18}, {-14, 17}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(LowPressureReceptors_NA, LowPressureEffectCurve.u) annotation(Line(points = {{-100, 40}, {-66, 40}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(LowPressureEffectCurve.val, ReflexNA.u[2]) annotation(Line(points = {{-29.64, 40}, {-16, 40}, {-16, 19}, {-14, 19}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(brain_Fuel_FractUseDelay, FuelEffectCurve.u) annotation(Line(points = {{-80, 80}, {-34, 80}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(ReflexNA.y, sum1.u[1]) annotation(Line(points = {{9, 18}, {18, 18}, {18, 24.6667}, {30, 24.6667}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(ExerciseSymps_TotalEffect, sum1.u[2]) annotation(Line(points = {{-100, 0}, {16, 0}, {16.8848, 25.502}, {30, 26}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(FuelEffectCurve.val, sum1.u[3]) annotation(Line(points = {{2.36, 80}, {16, 80}, {16, 26}, {30, 26}, {30, 27.3333}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(sum1.y, NeuralActivity.u1) annotation(Line(points = {{53, 26}, {56, 26}, {56, -12}, {60, -12}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(SympsCNS_A2Effect, NeuralActivity.u2) annotation(Line(points = {{-80, -80}, {42, -80}, {42, -24}, {60, -24}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(NeuralActivity.y, toHz.u) annotation(Line(points = {{83, -18}, {86, -18}, {86, 0}, {87.2, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(toHz.y, NA) annotation(Line(points = {{96.40000000000001, 0}, {98, 0}, {98, 36}, {68, 36}, {68, 62}, {80, 62}}, color = {0, 0, 127}, smooth = Smooth.None));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-112, 138}, {110, 106}}, lineColor=  {0, 0, 0}, fillColor=  {213, 255, 170},
                fillPattern=                                                                                                    FillPattern.Solid, textString=  "%name"), Ellipse(extent=  {{-106, 104}, {100, -98}}, lineColor=  {0, 0, 0})}));
    end GangliaKidney;

    model BetaReceptorsActivityFactor
      //extends Library.BaseFactor2;
      PhysiolibraryOld.Interfaces.RealInput_ GangliaGeneral_NA(final quantity=
            "Frequency", final unit="Hz") annotation (Placement(transformation(
              extent={{-100,40},{-80,60}}), iconTransformation(extent={{-108,-70},
                {-88,-50}})));
      PhysiolibraryOld.Interfaces.RealInput_ BetaPool_Effect annotation (
          Placement(transformation(extent={{-100,0},{-80,20}}),
            iconTransformation(extent={{-108,50},{-88,70}})));
      PhysiolibraryOld.Interfaces.RealInput_ BetaBlockade_Effect annotation (
          Placement(transformation(extent={{-42,-46},{-22,-26}}),
            iconTransformation(extent={{-108,-10},{-88,10}})));
      PhysiolibraryOld.Interfaces.RealInput_ yBase annotation (Placement(
            transformation(
            extent={{-10,-10},{10,10}},
            rotation=270,
            origin={86,90}), iconTransformation(
            extent={{-10,-10},{10,10}},
            rotation=270,
            origin={0,70})));
      PhysiolibraryOld.Interfaces.RealOutput_ y annotation (Placement(
            transformation(
            extent={{-10,-10},{10,10}},
            rotation=270,
            origin={80,-90}), iconTransformation(
            extent={{-10,-10},{10,10}},
            rotation=270,
            origin={0,-70})));
      parameter Real NEURALK(final quantity = "FrequencyCoefficient", final unit = "1/Hz") = 0.333;
      parameter Real HUMORALK = 0.5;
      parameter Boolean Switch = false;
      parameter Real Setting = 0;
      Modelica.Blocks.Math.Add TotalAgonism(k1 = NEURALK, k2 = HUMORALK) annotation(Placement(transformation(extent = {{-58, 20}, {-38, 40}})));
      Modelica.Blocks.Logical.Switch switch1 annotation(Placement(transformation(extent = {{18, 28}, {38, 48}})));
      PhysiolibraryOld.Blocks.BooleanConstant booleanConstant(k=Switch)
        annotation (Placement(transformation(extent={{-28,38},{-8,58}})));
      PhysiolibraryOld.Blocks.Constant Constant(k=Setting)
        annotation (Placement(transformation(extent={{-30,76},{-10,96}})));
      Modelica.Blocks.Math.Product Activity annotation(Placement(transformation(extent = {{-6, -40}, {14, -20}})));
      Modelica.Blocks.Math.Product SympsEffect annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 270, origin = {80, -66})));
    equation
      connect(Activity.u2, BetaBlockade_Effect) annotation(Line(points = {{-8, -36}, {-32, -36}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Activity.u1, switch1.y) annotation(Line(points = {{-8, -24}, {-20, -24}, {-20, 2}, {62, 2}, {62, 38}, {39, 38}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(switch1.u3, TotalAgonism.y) annotation(Line(points = {{16, 30}, {-37, 30}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(switch1.u2, booleanConstant.y) annotation(Line(points = {{16, 38}, {-2, 38}, {-2, 48}, {-7, 48}}, color = {255, 0, 255}, smooth = Smooth.None));
      connect(switch1.u1, Constant.y) annotation(Line(points = {{16, 46}, {10, 46}, {10, 86}, {-9, 86}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(yBase, SympsEffect.u1) annotation(Line(points = {{86, 90}, {86, -54}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(SympsEffect.y, y) annotation(Line(points = {{80, -77}, {80, -90}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(GangliaGeneral_NA, TotalAgonism.u1) annotation(Line(points = {{-90, 50}, {-70, 50}, {-70, 36}, {-60, 36}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(BetaPool_Effect, TotalAgonism.u2) annotation(Line(points = {{-90, 10}, {-70, 10}, {-70, 24}, {-60, 24}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Activity.y, SympsEffect.u2) annotation(Line(points = {{15, -30}, {74, -30}, {74, -54}}, color = {0, 0, 127}, smooth = Smooth.None));
      annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics = {Rectangle(extent=  {{-100, 70}, {100, -70}}, lineColor=  {112, 143, 0}, fillPattern=  FillPattern.Sphere, fillColor=  {255, 255, 255}), Text(extent=  {{-88, -40}, {100, 48}}, lineColor=  {0, 0, 0}, fillPattern=  FillPattern.Sphere, fillColor=  {85, 255, 170}, textString=  "%name")}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
    end BetaReceptorsActivityFactor;

    model AplhaReceptorsActivityFactor
      //extends Library.BaseFactor2;
      PhysiolibraryOld.Interfaces.RealInput_ GangliaGeneral_NA(final quantity=
            "Frequency", final unit="Hz") annotation (Placement(transformation(
              extent={{-100,40},{-80,60}}), iconTransformation(extent={{-108,-70},
                {-88,-50}})));
      PhysiolibraryOld.Interfaces.RealInput_ AlphaPool_Effect annotation (
          Placement(transformation(extent={{-100,0},{-80,20}}),
            iconTransformation(extent={{-108,50},{-88,70}})));
      PhysiolibraryOld.Interfaces.RealInput_ AlphaBlockade_Effect annotation (
          Placement(transformation(extent={{-42,-46},{-22,-26}}),
            iconTransformation(extent={{-108,-10},{-88,10}})));
      PhysiolibraryOld.Interfaces.RealInput_ yBase annotation (Placement(
            transformation(
            extent={{-10,-10},{10,10}},
            rotation=270,
            origin={86,90}), iconTransformation(
            extent={{-10,-10},{10,10}},
            rotation=270,
            origin={0,70})));
      PhysiolibraryOld.Interfaces.RealOutput_ y annotation (Placement(
            transformation(
            extent={{-10,-10},{10,10}},
            rotation=270,
            origin={80,-90}), iconTransformation(
            extent={{-10,-10},{10,10}},
            rotation=270,
            origin={0,-70})));
      parameter Real[:, 3] data;
      parameter Real NEURALK(final quantity = "FrequencyCoefficient", final unit = "1/Hz") = 0.333;
      parameter Real HUMORALK = 0.5;
      parameter Boolean Switch = false;
      parameter Real Setting = 0;
      Modelica.Blocks.Math.Add TotalAgonism(k1 = NEURALK, k2 = HUMORALK) annotation(Placement(transformation(extent = {{-58, 20}, {-38, 40}})));
      Modelica.Blocks.Logical.Switch switch1 annotation(Placement(transformation(extent = {{18, 28}, {38, 48}})));
      PhysiolibraryOld.Blocks.BooleanConstant booleanConstant(k=Switch)
        annotation (Placement(transformation(extent={{-28,38},{-8,58}})));
      PhysiolibraryOld.Blocks.Constant Constant(k=Setting)
        annotation (Placement(transformation(extent={{-30,76},{-10,96}})));
      PhysiolibraryOld.Curves.Curve SympsOnConductance(
        x=data[:, 1],
        y=data[:, 2],
        slope=data[:, 3])
        annotation (Placement(transformation(extent={{30,-40},{50,-20}})));
      Modelica.Blocks.Math.Product Activity annotation(Placement(transformation(extent = {{-6, -40}, {14, -20}})));
      Modelica.Blocks.Math.Product SympsEffect annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 270, origin = {80, -66})));
    equation
      connect(SympsEffect.u2, SympsOnConductance.val) annotation(Line(points = {{74, -54}, {74, -30}, {50, -30}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(SympsOnConductance.u, Activity.y) annotation(Line(points = {{30, -30}, {15, -30}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Activity.u2, AlphaBlockade_Effect) annotation(Line(points = {{-8, -36}, {-32, -36}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Activity.u1, switch1.y) annotation(Line(points = {{-8, -24}, {-20, -24}, {-20, 2}, {62, 2}, {62, 38}, {39, 38}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(switch1.u3, TotalAgonism.y) annotation(Line(points = {{16, 30}, {-37, 30}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(switch1.u2, booleanConstant.y) annotation(Line(points = {{16, 38}, {-2, 38}, {-2, 48}, {-7, 48}}, color = {255, 0, 255}, smooth = Smooth.None));
      connect(switch1.u1, Constant.y) annotation(Line(points = {{16, 46}, {10, 46}, {10, 86}, {-9, 86}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(yBase, SympsEffect.u1) annotation(Line(points = {{86, 90}, {86, -54}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(SympsEffect.y, y) annotation(Line(points = {{80, -77}, {80, -90}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(GangliaGeneral_NA, TotalAgonism.u1) annotation(Line(points = {{-90, 50}, {-70, 50}, {-70, 36}, {-60, 36}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(AlphaPool_Effect, TotalAgonism.u2) annotation(Line(points = {{-90, 10}, {-70, 10}, {-70, 24}, {-60, 24}}, color = {0, 0, 127}, smooth = Smooth.None));
      annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Rectangle(extent=  {{-100, 70}, {100, -70}}, lineColor=  {112, 143, 0},
                fillPattern=                                                                                                    FillPattern.Sphere, fillColor=  {255, 255, 255}), Text(extent=  {{-88, -40}, {100, 48}}, lineColor=  {0, 0, 0},
                fillPattern=                                                                                                    FillPattern.Sphere, fillColor=  {85, 255, 170}, textString=  "%name")}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
    end AplhaReceptorsActivityFactor;

    model Pituitary
      extends PhysiolibraryOld.Icons.Hypophysis;
      parameter Real BaroreflexOnBaroEffectData[:, 3] = {{0.0, 1.5, 0}, {1.0, 1.0, -0.5}, {2.0, 0.5, 0}};
      PhysiolibraryOld.Curves.Curve BaroreflexOnBaroEffect(
        x=BaroreflexOnBaroEffectData[:, 1],
        y=BaroreflexOnBaroEffectData[:, 2],
        slope=BaroreflexOnBaroEffectData[:, 3])
        annotation (Placement(transformation(extent={{-54,-10},{-34,10}})));
      PhysiolibraryOld.Interfaces.RealOutput_ BaroEffect
        annotation (Placement(transformation(extent={{78,-20},{118,20}})));
      PhysiolibraryOld.Interfaces.RealInput_ Baroreflex_NA
        annotation (Placement(transformation(extent={{-120,-20},{-80,20}})));
      Modelica.Blocks.Math.Feedback sub annotation(Placement(transformation(extent = {{-18, -10}, {2, 10}})));
      PhysiolibraryOld.Blocks.Constant Constant(k=1)
        annotation (Placement(transformation(extent={{-22,-20},{-14,-12}})));
      Modelica.Blocks.Math.Add add annotation(Placement(transformation(extent = {{46, -10}, {66, 10}})));
      Modelica.Blocks.Math.Product product annotation(Placement(transformation(extent = {{12, 2}, {32, 22}})));
      PhysiolibraryOld.Blocks.Constant BaroSensitivity(k=1)
        annotation (Placement(transformation(extent={{-12,30},{-4,38}})));
    equation
      connect(Baroreflex_NA, BaroreflexOnBaroEffect.u) annotation(Line(points = {{-100, 0}, {-54, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(BaroreflexOnBaroEffect.val, sub.u1) annotation(Line(points = {{-33.8, 0}, {-16, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Constant.y, sub.u2) annotation(Line(points = {{-13.6, -16}, {-8, -16}, {-8, -8}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(add.y, BaroEffect) annotation(Line(points = {{67, 0}, {98, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Constant.y, add.u2) annotation(Line(points = {{-13.6, -16}, {16, -16}, {16, -6}, {44, -6}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(product.y, add.u1) annotation(Line(points = {{33, 12}, {38, 12}, {38, 6}, {44, 6}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(sub.y, product.u2) annotation(Line(points = {{1, 0}, {6, 0}, {6, 6}, {10, 6}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(BaroSensitivity.y, product.u1) annotation(Line(points = {{-3.6, 34}, {4, 34}, {4, 18}, {10, 18}}, color = {0, 0, 127}, smooth = Smooth.None));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent=  {{-110, 128}, {110, 102}}, lineColor=  {0, 0, 0}, fillColor=  {213, 255, 170},
                fillPattern=                                                                                                    FillPattern.Solid, textString=  "%name")}));
    end Pituitary;

    model Hypothalamus
      PhysiolibraryOld.Interfaces.RealInput_ BrainFunctionEffect
        annotation (Placement(transformation(extent={{-120,40},{-80,80}})));
      PhysiolibraryOld.Interfaces.RealOutput_ HypothalamusSkinFlow_NA
        annotation (Placement(transformation(extent={{80,-40},{120,0}})));
      PhysiolibraryOld.Interfaces.RealInput_ HeatCore_Temp
        annotation (Placement(transformation(extent={{-120,-20},{-80,20}})));
      PhysiolibraryOld.Factors.CurveValue TemperatureEffect_(data={{-2.0,0.0,0},
            {0.0,1.0,1.8},{2.0,4.0,0}})
        annotation (Placement(transformation(extent={{-52,-24},{-32,-4}})));
      Modelica.Blocks.Math.Feedback feedback annotation(Placement(transformation(extent = {{6, -6}, {-6, 6}}, rotation = 180, origin = {-60, -14})));
      PhysiolibraryOld.Blocks.TemperatureConstant temperatureConstant(k=37)
        annotation (Placement(transformation(extent={{-44,-6},{-52,2}})));
      PhysiolibraryOld.Factors.CurveValue SkinTempOffset(data={{24,0.0,0},{32,-1.0,
            0}})
        annotation (Placement(transformation(extent={{-62,-62},{-42,-42}})));
      PhysiolibraryOld.Interfaces.RealInput_ HeatSkin_Temp
        annotation (Placement(transformation(extent={{-120,-60},{-80,-20}})));
      PhysiolibraryOld.Blocks.TemperatureConstant temperatureConstant1(k=37)
        annotation (Placement(transformation(extent={{-40,-46},{-48,-38}})));
      Modelica.Blocks.Math.Feedback feedback1 annotation(Placement(transformation(extent = {{6, -6}, {-6, 6}}, rotation = 180, origin = {-52, -80})));
      PhysiolibraryOld.Curves.Curve NerveActivity(
        x={-2,0},
        y={4,0},
        slope={0,0})
        annotation (Placement(transformation(extent={{-32,-90},{-12,-70}})));
      PhysiolibraryOld.Factors.SplineDelayByDay
        HypothalamusShiveringAcclimation(
        Tau=7,
        data={{20,0.3,0},{28,0.0,-0.04},{39,-0.3,0}},
        integrator(y_start=0),
        stateName="HypothalamusShiveringAcclimation.Offset")
        annotation (Placement(transformation(extent={{-62,-72},{-42,-52}})));
      PhysiolibraryOld.Interfaces.RealOutput_ HypothalamusShivering_NA
        annotation (Placement(transformation(extent={{80,-100},{120,-60}})));
      PhysiolibraryOld.Interfaces.RealOutput_ HypothalamusSweating_NA
        annotation (Placement(transformation(extent={{80,20},{120,60}})));
      PhysiolibraryOld.Curves.Curve NerveActivity1(
        slope={0,0},
        x={0,2},
        y={0,4})
        annotation (Placement(transformation(extent={{64,30},{84,50}})));
      Modelica.Blocks.Math.Feedback feedback2 annotation(Placement(transformation(extent = {{6, -6}, {-6, 6}}, rotation = 180, origin = {50, 40})));
      Modelica.Blocks.Math.Sum SetPoint(nin = 3) annotation(Placement(transformation(extent = {{40, 70}, {48, 78}})));
      PhysiolibraryOld.Blocks.TemperatureConstant temperatureConstant2(k=37)
        annotation (Placement(transformation(extent={{24,80},{32,88}})));
      PhysiolibraryOld.Curves.Curve SkinTempOffset_Sweating(
        slope={0,0},
        x={25,35},
        y={1,0})
        annotation (Placement(transformation(extent={{-2,52},{18,72}})));
      PhysiolibraryOld.Factors.SplineDelayByDay
        HypothalamusSweatingAcclimation1(
        data={{20,0.3,0},{28,0.0,-0.04},{39,-0.3,0}},
        integrator(y_start=0),
        stateName="HypothalamusSweatingAcclimation.Offset",
        Tau=7) annotation (Placement(transformation(extent={{-2,70},{18,90}})));
      PhysiolibraryOld.Blocks.Constant Constant(k=1)
        annotation (Placement(transformation(extent={{-2,84},{6,92}})));
    equation
      connect(TemperatureEffect_.u, feedback.y) annotation(Line(points = {{-51.8, -14}, {-54.6, -14}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(feedback.u2, temperatureConstant.y) annotation(Line(points = {{-60, -9.199999999999999}, {-60, -2}, {-52.4, -2}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(TemperatureEffect_.yBase, BrainFunctionEffect) annotation(Line(points = {{-42, -12}, {-42, 60}, {-100, 60}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(TemperatureEffect_.y, HypothalamusSkinFlow_NA) annotation(Line(points = {{-42, -16}, {-42, -20}, {100, -20}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(HeatCore_Temp, feedback.u1) annotation(Line(points = {{-100, 0}, {-72, 0}, {-72, -14}, {-64.8, -14}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(HeatSkin_Temp, SkinTempOffset.u) annotation(Line(points = {{-100, -40}, {-68, -40}, {-68, -52}, {-61.8, -52}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(temperatureConstant1.y, SkinTempOffset.yBase) annotation(Line(points = {{-48.4, -42}, {-52, -42}, {-52, -50}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(HeatCore_Temp, feedback1.u1) annotation(Line(points = {{-100, 0}, {-72, 0}, {-72, -80}, {-56.8, -80}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(feedback1.y, NerveActivity.u) annotation(Line(points = {{-46.6, -80}, {-32, -80}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(HeatSkin_Temp, HypothalamusShiveringAcclimation.u) annotation(Line(points = {{-100, -40}, {-68, -40}, {-68, -62}, {-61.8, -62}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(SkinTempOffset.y, HypothalamusShiveringAcclimation.yBase) annotation(Line(points = {{-52, -54}, {-52, -60}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(NerveActivity.val, HypothalamusShivering_NA) annotation(Line(points = {{-11.8, -80}, {100, -80}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(NerveActivity1.val, HypothalamusSweating_NA) annotation(Line(points = {{84.2, 40}, {100, 40}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(feedback2.u1, HeatCore_Temp) annotation(Line(points = {{45.2, 40}, {-72, 40}, {-72, 0}, {-100, 0}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(feedback2.y, NerveActivity1.u) annotation(Line(points = {{55.4, 40}, {64, 40}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(SetPoint.y, feedback2.u2) annotation(Line(points = {{48.4, 74}, {50, 74}, {50, 44.8}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(temperatureConstant2.y, SetPoint.u[1]) annotation(Line(points = {{32.4, 84}, {34, 84}, {34, 73.4667}, {39.2, 73.4667}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(SkinTempOffset_Sweating.val, SetPoint.u[2]) annotation(Line(points = {{18.2, 62}, {36, 62}, {36, 74}, {39.2, 74}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(HeatSkin_Temp, SkinTempOffset_Sweating.u) annotation(Line(points = {{-100, -40}, {-68, -40}, {-68, -34}, {-12, -34}, {-12, 62}, {-2, 62}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(HypothalamusSweatingAcclimation1.y, SetPoint.u[3]) annotation(Line(points = {{8, 78}, {8, 74.5333}, {39.2, 74.5333}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(HeatSkin_Temp, HypothalamusSweatingAcclimation1.u) annotation(Line(points = {{-100, -40}, {-68, -40}, {-68, -34}, {-12, -34}, {-12, 80}, {-1.8, 80}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Constant.y, HypothalamusSweatingAcclimation1.yBase) annotation(Line(points = {{6.4, 88}, {8, 88}, {8, 82}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(SetPoint.y, feedback1.u2) annotation(Line(points = {{48.4, 74}, {60, 74}, {60, -68}, {-52, -68}, {-52, -75.2}}, color = {0, 0, 127}, smooth = Smooth.None));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics));
    end Hypothalamus;

    model Nerves
      // extends Library.Interfaces.BaseModel;
      extends PhysiolibraryOld.Icons.Nerves;
      Modelica.Blocks.Math.Add avePressure(k1 = 0.5, k2 = 0.5) annotation(Placement(transformation(extent = {{-64, -28}, {-52, -16}})));
      BaroReceptorInDaysAdaptation lowPressureReceptors(PressureChangeOnNA = {{-4.0, 0.0, 0}, {0.0, 1.0, 0.3}, {12.0, 4.0, 0}}, AdaptivePressure = 6, Tau = 30) annotation(Placement(transformation(extent = {{-14, -14}, {14, 14}}, rotation = 0, origin = {-32, -22})));
      BaroReceptorInHoursAdaptation Baroreflex(Tau = 10, PressureChangeOnNA = {{-50.0, 0.0, 0}, {0.0, 1.0, 0.02}, {50.0, 2.0, 0}}, AdaptivePressure = 96.86790000000001) annotation(Placement(transformation(extent = {{9, 9}, {-9, -9}}, rotation = 180, origin = {-43, 45})));
      ExerciseSympathetic exercise annotation(Placement(transformation(extent = {{-62, -78}, {-42, -58}})));
      SympatheticCNS sympatheticCNS annotation(Placement(transformation(extent = {{-2, -86}, {18, -66}})));
      VagusNerve vagusNerve annotation(Placement(transformation(extent = {{46, -98}, {66, -78}})));
      PhysiolibraryOld.Blocks.Constant const38(k=1)
        annotation (Placement(transformation(extent={{-24,-68},{-18,-62}})));
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{-80,80},{-60,100}}),
            iconTransformation(extent={{-100,60},{-60,100}})));
      GangliaKidney gangliaKidney annotation(Placement(transformation(extent = {{38, -16}, {58, 4}})));
      Modelica.Blocks.Math.Gain AdrenalNerve(k = 0.667)
        "from Hz to normal activity"                                                 annotation(Placement(transformation(extent = {{52, -36}, {60, -28}})));
      PhysiolibraryOld.Blocks.Constant Constant(k=1)
        annotation (Placement(transformation(extent={{62,-16},{70,-8}})));
      PhysiolibraryOld.Blocks.Constant KidneyAlpha_PT_NA(k=1)
        annotation (Placement(transformation(extent={{62,2},{70,10}})));
      Pituitary pituitary annotation(Placement(transformation(extent = {{44, 34}, {64, 54}})));
    equation
      connect(avePressure.y, lowPressureReceptors.pressure) annotation(Line(points = {{-51.4, -22}, {-46, -22}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(sympatheticCNS.ExerciseSymps_TotalEffect, exercise.ExerciseSymps_TotalEffect) annotation(Line(points = {{-2, -80}, {-30, -80}, {-30, -68}, {-42.2, -68}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(sympatheticCNS.brain_Fuel_FractUseDelay, const38.y) annotation(Line(points = {{-2, -76}, {-8, -76}, {-8, -65}, {-17.7, -65}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(vagusNerve.SympsCNS_NA_Hz, sympatheticCNS.NA) annotation(Line(points = {{46, -88}, {30, -88}, {30, -82}, {18, -82}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(sympatheticCNS.NA, busConnector.GangliaGeneral_NA) annotation(Line(points = {{18, -82}, {30, -82}, {30, 98}, {-70, 98}, {-70, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(lowPressureReceptors.NA, sympatheticCNS.LowPressureReceptors) annotation(Line(points = {{-18, -22}, {-12, -22}, {-12, -72}, {-2, -72}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Baroreflex.NA, sympatheticCNS.CarotidSinusReceptors) annotation(Line(points = {{-34, 45}, {-8, 45}, {-8, -68}, {0, -68}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.A2Pool_Log10Con, sympatheticCNS.A2Pool_Log10Conc) annotation(Line(points = {{-70, 90}, {-88, 90}, {-88, -88}, {-26, -88}, {-26, -84}, {0, -84}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.CarotidSinusArteryPressure, Baroreflex.pressure) annotation(Line(points = {{-70, 90}, {-88, 90}, {-88, 45}, {-52, 45}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(exercise.ExerciseSymps_TotalEffect, gangliaKidney.ExerciseSymps_TotalEffect) annotation(Line(points = {{-42.2, -68}, {-30, -68}, {-30, -38}, {22, -38}, {22, -6}, {38, -6}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(lowPressureReceptors.NA, gangliaKidney.LowPressureReceptors_NA) annotation(Line(points = {{-18, -22}, {-12, -22}, {-12, -2}, {38, -2}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.brain_Fuel_FractUseDelay, gangliaKidney.brain_Fuel_FractUseDelay) annotation(Line(points = {{-70, 90}, {-88, 90}, {-88, 2}, {40, 2}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(gangliaKidney.NA, busConnector.GangliaKidney_NA) annotation(Line(points = {{56, 0.2}, {100, 0.2}, {100, 98}, {-70, 98}, {-70, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(sympatheticCNS.SympsCNS_BaroEffect, gangliaKidney.SympsCNS_BaroEffect) annotation(Line(points = {{16, -68}, {24, -68}, {24, -10}, {38, -10}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(sympatheticCNS.SympsCNS_A2Effect, gangliaKidney.SympsCNS_A2Effect) annotation(Line(points = {{18, -72}, {26, -72}, {26, -14}, {40, -14}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(busConnector.ExerciseMetabolism_TotalWatts, exercise.ExerciseMetabolism_TotalWats) annotation(Line(points = {{-70, 90}, {-88, 90}, {-88, -72}, {-61.8, -72}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(sympatheticCNS.NA, AdrenalNerve.u) annotation(Line(points = {{18, -82}, {36, -82}, {36, -32}, {51.2, -32}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(AdrenalNerve.y, busConnector.AdrenalNerve_NA) annotation(Line(points = {{60.4, -32}, {100, -32}, {100, 98}, {-88, 98}, {-88, 90}, {-70, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(Constant.y, busConnector.Kidney_Alpha_NA) annotation(Line(points = {{70.40000000000001, -12}, {100, -12}, {100, 98}, {-88, 98}, {-88, 90}, {-70, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(KidneyAlpha_PT_NA.y, busConnector.KidneyAlpha_PT_NA) annotation(Line(points = {{70.40000000000001, 6}, {100, 6}, {100, 98}, {-88, 98}, {-88, 90}, {-70, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(Baroreflex.NA, pituitary.Baroreflex_NA) annotation(Line(points = {{-34, 45}, {-8, 45}, {-8, 44}, {44, 44}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(pituitary.BaroEffect, busConnector.SympsCNS_PituitaryNA) annotation(Line(points = {{63.8, 44}, {100, 44}, {100, 98}, {-88, 98}, {-88, 90}, {-70, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(busConnector.skeletalMuscle_pH_intracellular, exercise.SkeletalMuscle_Ph) annotation(Line(points = {{-70, 90}, {-88, 90}, {-88, -64}, {-62, -64}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.rightAtrium_TMP, avePressure.u1) annotation(Line(points = {{-70, 90}, {-88, 90}, {-88, -18}, {-74, -18}, {-65.2, -18.4}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(busConnector.leftAtrium_TMP, avePressure.u2) annotation(Line(points = {{-70, 90}, {-88, 90}, {-88, -25.6}, {-65.2, -25.6}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(vagusNerve.VagusNerve_NA_Hz, busConnector.VagusNerve_NA_Hz) annotation(Line(points = {{65.8, -88}, {100, -88}, {100, 90}, {-70, 90}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent = {{-120, -70}, {122, -104}}, lineColor = {0, 0, 255}, textString = "%name")}));
    end Nerves;
    annotation(Documentation(revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr>
                   </table>
                   </html>"), Icon(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics));
  end Nerves;

  package Setup "Environment Influences"
    extends PhysiolibraryOld.Icons.SetupLib;
    model Setup_variables
      extends PhysiolibraryOld.Icons.Setup;
      replaceable class Variable = PhysiolibraryOld.Utilities.ConstantFromFile;
      PhysiolibraryOld.Interfaces.BusConnector busConnector annotation (
          Placement(transformation(extent={{-8,-36},{12,-16}}),
            iconTransformation(extent={{60,40},{100,80}})));
      Variable AirSupplyInspiredAirPressure(
        varName="AirSupply-InspiredAir.Pressure",
        varValue=760.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-80,-154},{-74,-148}})));
      Variable Anesthesia_VascularConductance(
        varName="Anesthesia.VascularConductance",
        varValue=1.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-80,-144},{-74,-138}})));
      Variable AnesthesiaTidalVolume(
        varName="Anesthesia.TidalVolume",
        varValue=1.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-80,-134},{-74,-128}})));
      Variable BarometerPressure(
        varName="Barometer.Pressure",
        varValue=760.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-80,-124},{-74,-118}})));
      Variable CarotidSinusHeight(
        varName="Hydrostatics.CarotidCM",
        varValue=0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-80,-94},{-74,-88}})));
      Variable DialyzerActivity_Cl_Flux(
        varName="DialyzerActivity.Cl-Flux",
        varValue=0.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-80,-84},{-74,-78}})));
      Variable DialyzerActivity_K_Flux(
        varName="DialyzerActivity.K+Flux",
        varValue=0.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-80,-74},{-74,-68}})));
      Variable DialyzerActivity_Na_Flux(
        varName="DialyzerActivity.Na+Flux",
        varValue=0.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-80,-64},{-74,-58}})));
      Variable DietGoalH2O_DegK(
        varName="DietGoalH2O.DegK",
        varValue=294.261111111111,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-80,-54},{-74,-48}})));
      Variable DietIntakeElectrolytes_Cl(
        varName="DietIntakeElectrolytes.Cl-_mEq/Min",
        varValue=0.13910967422831,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-80,-44},{-74,-38}})));
      Variable DietIntakeElectrolytes_K(
        varName="DietIntakeElectrolytes.K+_mEq/Min",
        varValue=0.0486883859799086,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-80,-34},{-74,-28}})));
      Variable DietIntakeElectrolytes_Na(
        varName="DietIntakeElectrolytes.Na+_mEq/Min",
        varValue=0.125198706805479,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-80,-24},{-74,-18}})));
      Variable DietIntakeElectrolytes_PO4(
        varName="DietIntakeElectrolytes.PO4--mEq/Min",
        varValue=0.0230576,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-80,-14},{-74,-8}})));
      Variable DietIntakeElectrolytes_SO4(
        varName="DietIntakeElectrolytes.SO4--mEq/Min",
        varValue=0.0347774185570776,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-80,-4},{-74,2}})));
      Variable Exercise_Metabolism_ContractionRate(
        varName="Exercise-Metabolism.ContractionRate",
        varValue=0.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-80,16},{-74,22}})));
      Variable Exercise_Metabolism_MotionWatts(
        varName="Exercise-Metabolism.MotionWatts",
        varValue=0.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-80,26},{-74,32}})));
      Variable Exercise_MusclePump_Effect(
        varName="Exercise-MusclePump.Effect",
        varValue=1.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-80,36},{-74,42}})));
      Variable ExerciseMetabolism_MotionCals(
        varName="Exercise-Metabolism.MotionCals",
        varValue=55.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-80,46},{-74,52}})));
      Variable ExerciseMetabolism_TotalWatts(
        varName="Exercise-Metabolism.TotalWatts",
        varValue=0.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-80,56},{-74,62}})));
      Variable FurosemidePool_Furosemide_conc(
        varName="FurosemidePool.[Furosemide]",
        varValue=0.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-80,66},{-74,72}})));
      Variable FurosemidePool_Loss(
        varName="FurosemidePool.Loss",
        varValue=0.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-80,76},{-74,82}})));
      Variable Gravity_Gz(
        varName="Gravity.Gz",
        varValue=1.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-80,86},{-74,92}})));
      Variable GILumenDiarrhea_KLoss(
        varName="GILumenDiarrhea.K+Loss",
        varValue=0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-80,96},{-74,102}})));
      Variable GILumenDiarrhea_NaLoss(
        varName="GILumenDiarrhea.Na+Loss",
        varValue=0.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-80,106},{-74,112}})));
      Variable GILumenVomitus_ClLoss(
        varName="GILumenVomitus.Cl-Loss",
        varValue=0.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-80,116},{-74,122}})));
      Variable Hemorrhage_ClRate(
        varName="Hemorrhage.ClRate",
        varValue=0.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{68,16},{74,22}})));
      Variable Hemorrhage_KRate(
        varName="Hemorrhage.KRate",
        varValue=0.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{68,28},{74,34}})));
      Variable Hemorrhage_NaRate(
        varName="Hemorrhage.NaRate",
        varValue=0.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{72,-168},{78,-162}})));
      Variable Hemorrhage_PlasmaRate(
        varName="Hemorrhage.PlasmaRate",
        varValue=0.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{72,-158},{78,-152}})));
      Variable Hemorrhage_ProteinRate(
        varName="Hemorrhage.ProteinRate",
        varValue=0.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{72,-148},{78,-142}})));
      Variable Hemorrhage_RBCRate(
        varName="Hemorrhage.RBCRate",
        varValue=0.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{72,-138},{78,-132}})));
      Variable IVDrip_ClRate(
        varName="IVDrip.ClRate",
        varValue=0.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{72,-128},{78,-122}})));
      Variable IVDrip_H2ORate(
        varName="IVDrip.H2ORate",
        varValue=0.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{72,-118},{78,-112}})));
      Variable IVDrip_KRate(
        varName="IVDrip.KRate",
        varValue=0.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{72,-108},{78,-102}})));
      Variable IVDrip_NaRate(
        varName="IVDrip.NaRate",
        varValue=0.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{72,-98},{78,-92}})));
      Variable Kidney_NephronCount_Filtering_xNormal(
        varName="Kidney-NephronCount.Filtering(xNormal)",
        varValue=1.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{72,-88},{78,-82}})));
      Variable Kidney_NephronCount_Total_xNormal(
        varName="Kidney-NephronCount.Total(xNormal)",
        varValue=1.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{72,-78},{78,-72}})));
      Variable LegMusclePump_Effect(
        varName="LegMusclePump.Effect",
        varValue=1.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{72,-68},{78,-62}})));
      Variable LowerTorsoArtyHeight(
        varName="Hydrostatics.LowerTorsoCM",
        varValue=0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{72,-58},{78,-52}})));
      Variable LowerTorsoVeinHeight(
        varName="Hydrostatics.LowerTorsoCM",
        varValue=0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{72,-48},{78,-42}})));
      Variable pCO(
        varName="pCO",
        varValue=0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{72,-28},{78,-22}})));
      Variable Pericardium_Pressure(
        varName="Pericardium-Cavity.Pressure",
        varValue=-3.34522126058954,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{72,-18},{78,-12}})));
      Variable skeletalMuscle_SizeMass(
        varName="SkeletalMuscle-Size.Mass",
        varValue=27400.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{72,-8},{78,-2}})));
      Variable skinSizeMass(
        varName="Skin-Size.Mass",
        varValue=2244.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{72,2},{78,8}})));
      Variable Status_Posture(
        varName="Status.Posture",
        varValue=5.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{70,42},{76,48}})));
      Variable ThiazidePool_Thiazide_conc(
        varName="ThiazidePool.[Thiazide]",
        varValue=0.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{72,62},{78,68}})));
      Variable Thorax_AvePressure(
        varName="Thorax.AvePressure",
        varValue=-4.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{72,72},{78,78}})));
      Variable Thorax_LungInflation(
        varName="Thorax.LungInflation",
        varValue=1.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{72,82},{78,88}})));
      Variable Transfusion_ClRate(
        varName="Transfusion.ClRate",
        varValue=0.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{72,92},{78,98}})));
      Variable Transfusion_KRate(
        varName="Transfusion.KRate",
        varValue=0.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{72,102},{78,108}})));
      Variable Transfusion_NaRate(
        varName="Transfusion.NaRate",
        varValue=0.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{72,112},{78,118}})));
      Variable Transfusion_PlasmaRate(
        varName="Transfusion.PlasmaRate",
        varValue=0.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{72,122},{78,128}})));
      Variable Transfusion_ProteinRate(
        varName="Transfusion.ProteinRate",
        varValue=0.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{72,132},{78,138}})));
      Variable Transfusion_RBCRate(
        varName="Transfusion.RBCRate",
        varValue=0.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{72,142},{78,148}})));
      Variable WeightCore(
        varName="Weight.Core",
        varValue=41757.328756,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{72,152},{78,158}})));
      Variable IVDrip_ProteinRate(
        varName="IVDrip.ProteinRate",
        varValue=0.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-90,-40},{-84,-34}})));
      Variable AmbientTemperature(
        varName="AmbientTemperature.Temp(C)",
        varValue=22.2222222222222,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-94,10},{-88,16}})));
      Variable EnvironmentRelativeHumidity(
        varName="EnvironmentRelativeHumidity",
        varValue=0.7,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-102,-12},{-96,-6}})));
      Variable DietIntakeH2O_Rate(
        varName="DietIntakeH2O.Rate(mL/Min)",
        varValue=1.489407,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-102,-20},{-96,-14}})));
      Variable DialyzerActivity_UltrafiltrationRate(
        varName="DialyzerActivity.UltrafiltrationRate",
        varValue=0.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-134,0},{-122,12}})));
      Variable Hemorrhage_PlasmaRate1(
        varName="Hemorrhage.H2ORate",
        varValue=0.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-132,18},{-120,30}})));
      Variable Transfusion_PlasmaRate1(
        varName="Transfusion.H2ORate",
        varValue=0.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-130,30},{-120,40}})));
      Variable GILumenVomitus_H2OTarget(
        varName="GILumenVomitus.H2OTarget",
        varValue=0.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-128,-76},{-116,-64}})));
      Variable GILumenDiarrhea_H2OTarget(
        varName="GILumenDiarrhea.H2OTarget",
        varValue=0.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-126,-66},{-114,-54}})));
      Variable Wind_MPH(
        varName="Wind.MPH",
        varValue=0.0,
        initType=PhysiolibraryOld.Utilities.Init.NoInit)
        annotation (Placement(transformation(extent={{-46,6},{-40,12}})));
    equation
      connect(Gravity_Gz.y, busConnector.Gravity_Gz) annotation(Line(points = {{-73.7, 89}, {2, 89}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(BarometerPressure.y, busConnector.BarometerPressure) annotation(Line(points = {{-73.7, -121}, {2, -120}, {4, -120}, {4, -26}, {2, -26}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(AirSupplyInspiredAirPressure.y, busConnector.AirSupplyInspiredAirPressure) annotation(Line(points = {{-73.7, -151}, {4, -154}, {4, -26}, {2, -26}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(pCO.y, busConnector.pCO) annotation(Line(points = {{78.3, -25}, {2, -28}, {2, -26}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None), Text(string = "%first", index = -1, extent = {{-6, 3}, {-6, 3}}));
      connect(IVDrip_NaRate.y, busConnector.IVDrip_NaRate) annotation(Line(points = {{78.3, -95}, {2, -95}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Transfusion_NaRate.y, busConnector.Transfusion_NaRate) annotation(Line(points = {{78.3, 115}, {2, 115}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Hemorrhage_NaRate.y, busConnector.Hemorrhage_NaRate) annotation(Line(points = {{78.3, -165}, {2, -165}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(DialyzerActivity_Na_Flux.y, busConnector.DialyzerActivity_Na_Flux) annotation(Line(points = {{-73.7, -61}, {2, -61}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(DietIntakeElectrolytes_Na.y, busConnector.DietIntakeElectrolytes_Na) annotation(Line(points = {{-73.7, -21}, {2, -21}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(GILumenDiarrhea_NaLoss.y, busConnector.GILumenDiarrhea_NaLoss) annotation(Line(points = {{-73.7, 109}, {2, 109}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(IVDrip_KRate.y, busConnector.IVDrip_KRate) annotation(Line(points = {{78.3, -105}, {2, -105}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Transfusion_KRate.y, busConnector.Transfusion_KRate) annotation(Line(points = {{78.3, 105}, {2, 105}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Hemorrhage_KRate.y, busConnector.Hemorrhage_KRate) annotation(Line(points = {{74.3, 31}, {2, 31}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(DialyzerActivity_K_Flux.y, busConnector.DialyzerActivity_K_Flux) annotation(Line(points = {{-73.7, -71}, {2, -71}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(DietIntakeElectrolytes_K.y, busConnector.DietIntakeElectrolytes_K) annotation(Line(points = {{-73.7, -31}, {2, -31}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(GILumenDiarrhea_KLoss.y, busConnector.GILumenDiarrhea_KLoss) annotation(Line(points = {{-73.7, 99}, {2, 99}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(IVDrip_ClRate.y, busConnector.IVDrip_ClRate) annotation(Line(points = {{78.3, -125}, {2, -125}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Transfusion_ClRate.y, busConnector.Transfusion_ClRate) annotation(Line(points = {{78.3, 95}, {2, 95}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(Hemorrhage_ClRate.y, busConnector.Hemorrhage_ClRate) annotation(Line(points = {{74.3, 19}, {2, 19}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(DialyzerActivity_Cl_Flux.y, busConnector.DialyzerActivity_Cl_Flux) annotation(Line(points = {{-73.7, -81}, {2, -81}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(DietIntakeElectrolytes_Cl.y, busConnector.DietIntakeElectrolytes_Cl) annotation(Line(points = {{-73.7, -41}, {2, -41}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(GILumenVomitus_ClLoss.y, busConnector.GILumenVomitus_ClLoss) annotation(Line(points = {{-73.7, 119}, {2, 119}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(DietIntakeElectrolytes_PO4.y, busConnector.DietIntakeElectrolytes_PO4) annotation(Line(points = {{-73.7, -11}, {6, -11}, {6, -26}, {2, -26}}, color = {0, 0, 127}, thickness = 0.5, smooth = Smooth.None));
      connect(DietIntakeElectrolytes_SO4.y, busConnector.DietIntakeElectrolytes_SO4) annotation(Line(points = {{-73.7, -1}, {2, -1}, {2, -26}}, color = {0, 0, 127}, thickness = 0.5, smooth = Smooth.None));
      connect(DietGoalH2O_DegK.y, busConnector.DietGoalH2O_DegK) annotation(Line(points = {{-73.7, -51}, {-2, 28}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(Exercise_MusclePump_Effect.y, busConnector.Exercise_MusclePump_Effect) annotation(Line(points = {{-73.7, 39}, {-2, 39}, {-2, -26}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(Exercise_Metabolism_ContractionRate.y, busConnector.Exercise_Metabolism_ContractionRate) annotation(Line(points = {{-73.7, 19}, {-2, 19}, {-2, -26}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(Exercise_Metabolism_MotionWatts.y, busConnector.Exercise_Metabolism_MotionWatts) annotation(Line(points = {{-73.7, 29}, {-2, 29}, {-2, -26}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(LegMusclePump_Effect.y, busConnector.LegMusclePump_Effect) annotation(Line(points = {{78.3, -65}, {-7.85, -65}, {-7.85, -26}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(ExerciseMetabolism_MotionCals.y, busConnector.ExerciseMetabolism_MotionCals) annotation(Line(points = {{-73.7, 49}, {-2, 49}, {-2, -26}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(ExerciseMetabolism_TotalWatts.y, busConnector.ExerciseMetabolism_TotalWatts) annotation(Line(points = {{-73.7, 59}, {-2, 59}, {-2, -26}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(LowerTorsoArtyHeight.y, busConnector.LowerTorsoArtyHeight) annotation(Line(points = {{78.3, -55}, {-6, -55}, {-6, -26}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(LowerTorsoVeinHeight.y, busConnector.LowerTorsoVeinHeight) annotation(Line(points = {{78.3, -45}, {-6, -45}, {-6, -26}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(CarotidSinusHeight.y, busConnector.CarotidSinusHeight) annotation(Line(points = {{-73.7, -91}, {0, -91}, {0, -26}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(Status_Posture.y, busConnector.Status_Posture) annotation(Line(points = {{76.3, 45}, {4.15, 45}, {4.15, -26}, {2, -26}}, color = {0, 0, 255}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(FurosemidePool_Furosemide_conc.y, busConnector.FurosemidePool_Furosemide_conc) annotation(Line(points = {{-73.7, 69}, {8, 69}, {8, -26}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(ThiazidePool_Thiazide_conc.y, busConnector.ThiazidePool_Thiazide_conc) annotation(Line(points = {{78.3, 65}, {-2, 65}, {-2, -26}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(FurosemidePool_Loss.y, busConnector.FurosemidePool_Loss) annotation(Line(points = {{-73.7, 79}, {2, 79}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(Hemorrhage_ProteinRate.y, busConnector.Hemorrhage_ProteinRate) annotation(Line(points = {{78.3, -145}, {78.3, -163.5}, {2, -163.5}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(Transfusion_ProteinRate.y, busConnector.Transfusion_ProteinRate) annotation(Line(points = {{78.3, 135}, {78.3, -24.5}, {2, -24.5}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(IVDrip_H2ORate.y, busConnector.IVDrip_H2ORate) annotation(Line(points = {{78.3, -115}, {0.15, -115}, {0.15, -26}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(Transfusion_PlasmaRate.y, busConnector.Transfusion_PlasmaRate) annotation(Line(points = {{78.3, 125}, {2, 125}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(Hemorrhage_PlasmaRate.y, busConnector.Hemorrhage_PlasmaRate) annotation(Line(points = {{78.3, -155}, {2, -155}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(Hemorrhage_RBCRate.y, busConnector.Hemorrhage_RBCRate) annotation(Line(points = {{78.3, -135}, {2, -135}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(Transfusion_RBCRate.y, busConnector.Transfusion_RBCRate) annotation(Line(points = {{78.3, 145}, {2, 145}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(Pericardium_Pressure.y, busConnector.Pericardium_Pressure) annotation(Line(points = {{78.3, -15}, {2, -15}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(Thorax_AvePressure.y, busConnector.Thorax_AvePressure) annotation(Line(points = {{78.3, 75}, {2, 75}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(Thorax_LungInflation.y, busConnector.Thorax_LungInflation) annotation(Line(points = {{78.3, 85}, {2, 85}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(Kidney_NephronCount_Total_xNormal.y, busConnector.Kidney_NephronCount_Total_xNormal) annotation(Line(points = {{78.3, -75}, {6, -75}, {6, -26}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(Kidney_NephronCount_Filtering_xNormal.y, busConnector.Kidney_NephronCount_Filtering_xNormal) annotation(Line(points = {{78.3, -85}, {2, -85}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(AnesthesiaTidalVolume.y, busConnector.AnesthesiaTidalVolume) annotation(Line(points = {{-73.7, -131}, {2, -131}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(Anesthesia_VascularConductance.y, busConnector.Anesthesia_VascularConductance) annotation(Line(points = {{-73.7, -141}, {2, -141}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(skeletalMuscle_SizeMass.y, busConnector.skeletalMuscle_SizeMass) annotation(Line(points = {{78.3, -5}, {2, -5}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(skinSizeMass.y, busConnector.skinSizeMass) annotation(Line(points = {{78.3, 5}, {2, 5}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(WeightCore.y, busConnector.WeightCore) annotation(Line(points = {{78.3, 155}, {2, 155}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(IVDrip_ProteinRate.y, busConnector.IVDripProteinRate) annotation(Line(points = {{-83.7, -37}, {2, -37}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(AmbientTemperature.y, busConnector.AmbientTemperature) annotation(Line(points = {{-87.7, 13}, {2, -24}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(EnvironmentRelativeHumidity.y, busConnector.EnvironmentRelativeHumidity) annotation(Line(points = {{-95.7, -9}, {-2, -28}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(DietIntakeH2O_Rate.y, busConnector.DietIntakeH2O_Rate) annotation(Line(points = {{-95.7, -17}, {2, -17}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(DialyzerActivity_UltrafiltrationRate.y, busConnector.DialyzerActivity_UltrafiltrationRate) annotation(Line(points = {{-121.4, 6}, {-110, 6}, {-110, 56}, {2, 56}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(Hemorrhage_PlasmaRate1.y, busConnector.Hemorrhage_H2ORate) annotation(Line(points = {{-119.4, 24}, {-116, 24}, {-116, 56}, {-178, 56}, {-178, -26}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(Transfusion_PlasmaRate1.y, busConnector.Transfusion_H2ORate) annotation(Line(points = {{-119.5, 35}, {-118, 35}, {-118, 56}, {-178, 56}, {-178, -26}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(GILumenDiarrhea_H2OTarget.y, busConnector.GILumenDiarrhea_H2OTarget) annotation(Line(points = {{-113.4, -60}, {-2, -60}, {-2, -26}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(GILumenVomitus_H2OTarget.y, busConnector.GILumenVomitus_H2OTarget) annotation(Line(points = {{-115.4, -70}, {0, -70}, {0, -26}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      connect(Wind_MPH.y, busConnector.Wind_MPH) annotation(Line(points = {{-39.7, 9}, {2, 9}, {2, -26}}, color = {0, 0, 127}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{6, 3}, {6, 3}}));
      annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent = {{-120, -42}, {122, -76}}, lineColor = {0, 0, 255}, textString = "%name")}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
    end Setup_variables;
    annotation(Documentation(revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr>
                   </table>
                   </html>"), Icon(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics));
  end Setup;

  package Status "Fitness Status of Tissue Structures and Functionality"
    extends PhysiolibraryOld.Icons.StatusLib;
    model TissuesFitness
      //extends Library.Interfaces.BaseModel;
      extends PhysiolibraryOld.Icons.Status;
      tissues.SkeletalMuscle skeletalMuscle annotation(Placement(transformation(extent = {{-80, 64}, {-60, 84}})));
      tissues.Bone bone annotation(Placement(transformation(extent = {{-80, 32}, {-60, 52}})));
      tissues.Fat fat annotation(Placement(transformation(extent = {{-80, -58}, {-60, -38}})));
      tissues.Brain brain annotation(Placement(transformation(extent = {{0, 30}, {20, 50}})));
      tissues.RightHeart rightHeart annotation(Placement(transformation(extent = {{0, -90}, {20, -70}})));
      tissues.RespiratoryMuscle respiratoryMuscle annotation(Placement(transformation(extent = {{-80, -28}, {-60, -8}})));
      tissues.OtherTissue otherTissue annotation(Placement(transformation(extent = {{-80, 2}, {-60, 22}})));
      tissues.Liver liver annotation(Placement(transformation(extent = {{0, 64}, {20, 84}})));
      tissues.LeftHeart leftHeart annotation(Placement(transformation(extent = {{0, -60}, {20, -40}})));
      tissues.Kidney kidney annotation(Placement(transformation(extent = {{0, -30}, {20, -10}})));
      tissues.GITract GITract annotation(Placement(transformation(extent = {{0, -2}, {20, 18}})));
      PhysiolibraryOld.Interfaces.BusConnector busConnector
        annotation (Placement(transformation(extent={{-108,72},{-68,112}})));
      tissues.Skin skin annotation(Placement(transformation(extent = {{-80, -88}, {-60, -68}})));
      PatientStatus patientStatus annotation(Placement(transformation(extent = {{74, 16}, {94, 36}})));
    equation
      connect(bone.pH_intracellular, busConnector.bone_pH_intracellular) annotation(Line(points = {{-61, 50}, {-20, 50}, {-20, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(brain.pH_intracellular, busConnector.brain_pH_intracellular) annotation(Line(points = {{19, 48}, {46, 48}, {46, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(fat.pH_intracellular, busConnector.fat_pH_intracellular) annotation(Line(points = {{-61, -40}, {-20, -40}, {-20, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(GITract.pH_intracellular, busConnector.GITract_pH_intracellular) annotation(Line(points = {{19, 16}, {46, 16}, {46, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(kidney.pH_intracellular, busConnector.kidney_pH_intracellular) annotation(Line(points = {{19, -12}, {46, -12}, {46, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(leftHeart.pH_intracellular, busConnector.leftHeart_pH_intracellular) annotation(Line(points = {{19, -42}, {46, -42}, {46, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(liver.pH_intracellular, busConnector.liver_pH_intracellular) annotation(Line(points = {{19, 82}, {46, 82}, {46, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(otherTissue.pH_intracellular, busConnector.otherTissue_pH_intracellular) annotation(Line(points = {{-61, 20}, {-20, 20}, {-20, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(respiratoryMuscle.pH_intracellular, busConnector.respiratoryMuscle_pH_intracellular) annotation(Line(points = {{-61, -10}, {-20, -10}, {-20, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(rightHeart.pH_intracellular, busConnector.rightHeart_pH_intracellular) annotation(Line(points = {{19, -72}, {46, -72}, {46, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(skin.pH_intracellular, busConnector.skin_pH_intracellular) annotation(Line(points = {{-61, -70}, {-20, -70}, {-20, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(skeletalMuscle.pH_intracellular, busConnector.skeletalMuscle_pH_intracellular) annotation(Line(points = {{-61, 82}, {-20.5, 82}, {-20.5, 92}, {-88, 92}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(bone.T, busConnector.bone_T) annotation(Line(points = {{-61, 46}, {-20, 46}, {-20, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(brain.T, busConnector.brain_T) annotation(Line(points = {{19, 44}, {46, 44}, {46, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(fat.T, busConnector.fat_T) annotation(Line(points = {{-61, -44}, {-20, -44}, {-20, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(GITract.T, busConnector.GITract_T) annotation(Line(points = {{19, 12}, {46, 12}, {46, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(kidney.T, busConnector.kidney_T) annotation(Line(points = {{19, -16}, {46, -16}, {46, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(leftHeart.T, busConnector.leftHeart_T) annotation(Line(points = {{19, -46}, {46, -46}, {46, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(liver.T, busConnector.liver_T) annotation(Line(points = {{19, 78}, {46, 78}, {46, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(otherTissue.T, busConnector.otherTissue_T) annotation(Line(points = {{-61, 16}, {-20, 16}, {-20, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(respiratoryMuscle.T, busConnector.respiratoryMuscle_T) annotation(Line(points = {{-61, -14}, {-20, -14}, {-20, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(rightHeart.T, busConnector.rightHeart_T) annotation(Line(points = {{19, -76}, {46, -76}, {46, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(skin.T, busConnector.skin_T) annotation(Line(points = {{-61, -74}, {-20, -74}, {-20, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(skeletalMuscle.T, busConnector.skeletalMuscle_T) annotation(Line(points = {{-61, 78}, {-20.5, 78}, {-20.5, 92}, {-88, 92}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(bone.Fuel_FractUseDelay, busConnector.bone_Fuel_FractUseDelay) annotation(Line(points = {{-61, 42}, {-20, 42}, {-20, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(brain.Fuel_FractUseDelay, busConnector.brain_Fuel_FractUseDelay) annotation(Line(points = {{19, 40}, {46, 40}, {46, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(fat.Fuel_FractUseDelay, busConnector.fat_Fuel_FractUseDelay) annotation(Line(points = {{-61, -48}, {-20, -48}, {-20, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(GITract.Fuel_FractUseDelay, busConnector.GITract_Fuel_FractUseDelay) annotation(Line(points = {{19, 8}, {46, 8}, {46, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(kidney.Fuel_FractUseDelay, busConnector.kidney_Fuel_FractUseDelay) annotation(Line(points = {{19, -20}, {46, -20}, {46, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(leftHeart.Fuel_FractUseDelay, busConnector.leftHeart_Fuel_FractUseDelay) annotation(Line(points = {{19, -50}, {46, -50}, {46, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(liver.Fuel_FractUseDelay, busConnector.liver_Fuel_FractUseDelay) annotation(Line(points = {{19, 74}, {46, 74}, {46, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(otherTissue.Fuel_FractUseDelay, busConnector.otherTissue_Fuel_FractUseDelay) annotation(Line(points = {{-61, 12}, {-20, 12}, {-20, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(respiratoryMuscle.Fuel_FractUseDelay, busConnector.respiratoryMuscle_Fuel_FractUseDelay) annotation(Line(points = {{-61, -18}, {-20, -18}, {-20, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(rightHeart.Fuel_FractUseDelay, busConnector.rightHeart_Fuel_FractUseDelay) annotation(Line(points = {{19, -80}, {46, -80}, {46, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(skin.Fuel_FractUseDelay, busConnector.skin_Fuel_FractUseDelay) annotation(Line(points = {{-61, -78}, {-20, -78}, {-20, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(skeletalMuscle.Fuel_FractUseDelay, busConnector.skeletalMuscle_Fuel_FractUseDelay) annotation(Line(points = {{-61, 74}, {-20.5, 74}, {-20.5, 92}, {-88, 92}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(bone.CellProtein_Mass, busConnector.CellProtein_Mass) annotation(Line(points = {{-61, 34}, {-20, 34}, {-20, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(brain.CellProtein_Mass, busConnector.CellProtein_Mass) annotation(Line(points = {{19, 32}, {46, 32}, {46, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(fat.CellProtein_Mass, busConnector.CellProtein_Mass) annotation(Line(points = {{-61, -56}, {-20, -56}, {-20, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(GITract.CellProtein_Mass, busConnector.CellProtein_Mass) annotation(Line(points = {{19, 0}, {46, 0}, {46, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(kidney.CellProtein_Mass, busConnector.CellProtein_Mass) annotation(Line(points = {{19, -28}, {46, -28}, {46, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(leftHeart.CellProtein_Mass, busConnector.CellProtein_Mass) annotation(Line(points = {{19, -58}, {46, -58}, {46, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(liver.CellProtein_Mass, busConnector.CellProtein_Mass) annotation(Line(points = {{19, 66}, {46, 66}, {46, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(otherTissue.CellProtein_Mass, busConnector.CellProtein_Mass) annotation(Line(points = {{-61, 4}, {-20, 4}, {-20, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(respiratoryMuscle.CellProtein_Mass, busConnector.CellProtein_Mass) annotation(Line(points = {{-61, -26}, {-20, -26}, {-20, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(rightHeart.CellProtein_Mass, busConnector.CellProtein_Mass) annotation(Line(points = {{19, -88}, {46, -88}, {46, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(skin.CellProtein_Mass, busConnector.CellProtein_Mass) annotation(Line(points = {{-61, -86}, {-20, -86}, {-20, 92}, {-88, 92}}, color = {0, 127, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(skeletalMuscle.CellProtein_Mass, busConnector.CellProtein_Mass) annotation(Line(points = {{-61, 66}, {-20.5, 66}, {-20.5, 92}, {-88, 92}}, color = {127, 0, 0}, smooth = Smooth.None), Text(string = "%second", index = 1, extent = {{5, 2}, {5, 2}}));
      connect(bone.StructureEffect, busConnector.bone_StructureEffect) annotation(Line(points = {{-68, 30}, {-20, 30}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(brain.StructureEffect, busConnector.brain_StructureEffect) annotation(Line(points = {{12, 28}, {-20, 28}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(fat.StructureEffect, busConnector.fat_StructureEffect) annotation(Line(points = {{-68, -60}, {-20, -60}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(GITract.StructureEffect, busConnector.GITract_StructureEffect) annotation(Line(points = {{12, -4}, {-20, -4}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(kidney.StructureEffect, busConnector.kidney_StructureEffect) annotation(Line(points = {{12, -32}, {-20, -32}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(leftHeart.StructureEffect, busConnector.leftHeart_StructureEffect) annotation(Line(points = {{12, -62}, {-20, -62}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(liver.StructureEffect, busConnector.liver_StructureEffect) annotation(Line(points = {{12, 62}, {-20, 62}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(otherTissue.StructureEffect, busConnector.otherTissue_StructureEffect) annotation(Line(points = {{-68, 0}, {-20, 0}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(rightHeart.StructureEffect, busConnector.rightHeart_StructureEffect) annotation(Line(points = {{12, -92}, {-20, -92}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(respiratoryMuscle.StructureEffect, busConnector.respiratoryMuscle_StructureEffect) annotation(Line(points = {{-68, -30}, {-20, -30}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(skin.StructureEffect, busConnector.skin_StructureEffect) annotation(Line(points = {{-68, -90}, {-20, -90}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(skeletalMuscle.StructureEffect, busConnector.skeletalMuscle_StructureEffect) annotation(Line(points = {{-68, 62}, {-20, 62}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(bone.StructureEffect, busConnector.Bone_StructureEffect) annotation(Line(points = {{-68, 30}, {-20, 30}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(brain.StructureEffect, busConnector.Brain_StructureEffect) annotation(Line(points = {{12, 28}, {-20, 28}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(fat.StructureEffect, busConnector.Fat_StructureEffect) annotation(Line(points = {{-68, -60}, {-20, -60}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(kidney.StructureEffect, busConnector.Kidney_StructureEffect) annotation(Line(points = {{12, -32}, {-20, -32}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(leftHeart.StructureEffect, busConnector.LeftHeart_StructureEffect) annotation(Line(points = {{12, -62}, {-20, -62}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(liver.StructureEffect, busConnector.Liver_StructureEffect) annotation(Line(points = {{12, 62}, {-20, 62}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(otherTissue.StructureEffect, busConnector.OtherTissue_StructureEffect) annotation(Line(points = {{-68, 0}, {-20, 0}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(rightHeart.StructureEffect, busConnector.RightHeart_StructureEffect) annotation(Line(points = {{12, -92}, {-20, -92}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(respiratoryMuscle.StructureEffect, busConnector.RespiratoryMuscle_StructureEffect) annotation(Line(points = {{-68, -30}, {-20, -30}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(skin.StructureEffect, busConnector.Skin_StructureEffect) annotation(Line(points = {{-68, -90}, {-20, -90}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(skeletalMuscle.StructureEffect, busConnector.SkeletalMuscle_StructureEffect) annotation(Line(points = {{-68, 62}, {-20, 62}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(bone.FunctionEffect, busConnector.bone_FunctionEffect) annotation(Line(points = {{-72, 30}, {-20, 30}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(brain.FunctionEffect, busConnector.brain_FunctionEffect) annotation(Line(points = {{8, 28}, {-20, 28}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(fat.FunctionEffect, busConnector.fat_FunctionEffect) annotation(Line(points = {{-72, -60}, {-20, -60}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(GITract.FunctionEffect, busConnector.GITract_FunctionEffect) annotation(Line(points = {{8, -4}, {-20, -4}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(kidney.FunctionEffect, busConnector.kidney_FunctionEffect) annotation(Line(points = {{8, -32}, {-20, -32}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(leftHeart.FunctionEffect, busConnector.leftHeart_FunctionEffect) annotation(Line(points = {{8, -62}, {-20, -62}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(liver.FunctionEffect, busConnector.liver_FunctionEffect) annotation(Line(points = {{8, 62}, {-20, 62}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(otherTissue.FunctionEffect, busConnector.otherTissue_FunctionEffect) annotation(Line(points = {{-72, 0}, {-20, 0}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(rightHeart.FunctionEffect, busConnector.rightHeart_FunctionEffect) annotation(Line(points = {{8, -92}, {-20, -92}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(respiratoryMuscle.FunctionEffect, busConnector.respiratoryMuscle_FunctionEffect) annotation(Line(points = {{-72, -30}, {-20, -30}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(skin.FunctionEffect, busConnector.skin_FunctionEffect) annotation(Line(points = {{-72, -90}, {-20, -90}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(skeletalMuscle.FunctionEffect, busConnector.skeletalMuscle_FunctionEffect) annotation(Line(points = {{-72, 62}, {-20, 62}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(bone.FunctionEffect, busConnector.BoneFunctionEffect) annotation(Line(points = {{-72, 30}, {-20, 30}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(brain.FunctionEffect, busConnector.BrainFunctionEffect) annotation(Line(points = {{8, 28}, {-20, 28}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(fat.FunctionEffect, busConnector.FatFunctionEffect) annotation(Line(points = {{-72, -60}, {-20, -60}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(GITract.FunctionEffect, busConnector.GITractFunctionEffect) annotation(Line(points = {{8, -4}, {-20, -4}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(kidney.FunctionEffect, busConnector.KidneyFunctionEffect) annotation(Line(points = {{8, -32}, {-20, -32}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(leftHeart.FunctionEffect, busConnector.LeftHeartFunctionEffect) annotation(Line(points = {{8, -62}, {-20, -62}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(liver.FunctionEffect, busConnector.LiverFunctionEffect) annotation(Line(points = {{8, 62}, {-20, 62}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(otherTissue.FunctionEffect, busConnector.OtherTissueFunctionEffect) annotation(Line(points = {{-72, 0}, {-20, 0}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(rightHeart.FunctionEffect, busConnector.RightHeartFunctionEffect) annotation(Line(points = {{8, -92}, {-20, -92}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(respiratoryMuscle.FunctionEffect, busConnector.RespiratoryMuscleFunctionEffect) annotation(Line(points = {{-72, -30}, {-20, -30}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(skin.FunctionEffect, busConnector.SkinFunctionEffect) annotation(Line(points = {{-72, -90}, {-20, -90}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(skeletalMuscle.FunctionEffect, busConnector.SkeletalMuscleFunctionEffect) annotation(Line(points = {{-72, 62}, {-20, 62}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(bone.FunctionFailed, busConnector.Bone_Function_Failed) annotation(Line(points = {{-64, 30}, {-20, 30}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(brain.FunctionFailed, busConnector.Brain_Function_Failed) annotation(Line(points = {{16, 28}, {-20, 28}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(GITract.FunctionFailed, busConnector.GITract_Function_Failed) annotation(Line(points = {{16, -4}, {-20, -4}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(fat.FunctionFailed, busConnector.Fat_Function_Failed) annotation(Line(points = {{-64, -60}, {-20, -60}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(kidney.FunctionFailed, busConnector.Kidney_Function_Failed) annotation(Line(points = {{16, -32}, {-20, -32}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(leftHeart.FunctionFailed, busConnector.LeftHeart_Function_Failed) annotation(Line(points = {{16, -62}, {-20, -62}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(liver.FunctionFailed, busConnector.Liver_Function_Failed) annotation(Line(points = {{16, 62}, {-20, 62}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(otherTissue.FunctionFailed, busConnector.OtherTissue_Function_Failed) annotation(Line(points = {{-64, 0}, {-20, 0}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(rightHeart.FunctionFailed, busConnector.RightHeart_Function_Failed) annotation(Line(points = {{16, -92}, {-20, -92}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(respiratoryMuscle.FunctionFailed, busConnector.RespiratoryMuscle_Function_Failed) annotation(Line(points = {{-64, -30}, {-20, -30}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(skin.FunctionFailed, busConnector.Skin_Function_Failed) annotation(Line(points = {{-64, -90}, {-20, -90}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(skeletalMuscle.FunctionFailed, busConnector.SkeletalMuscle_Function_Failed) annotation(Line(points = {{-64, 62}, {-20, 62}, {-20, 92}, {-88, 92}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(brain.FunctionEffect, patientStatus.BrainFunctionEffect) annotation(Line(points = {{8, 28}, {8, 26}, {74, 26}}, color = {0, 0, 127}, smooth = Smooth.None));
      annotation(Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics={  Text(extent = {{-152, -102}, {150, -138}}, lineColor = {0, 0, 255}, fillColor = {255, 255, 255},
                fillPattern =                                                                                                   FillPattern.Solid, textString = "%name")}), Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Documentation(info = "<html>
                   <p>BE_interstitial is base excess in the interstitium of the tissue. The standard value is 0, when strong acid concentration increase, then BE value decrease with the same concentration. </p>
                   <p>Meaning might be interpreted like what amount of hydrogen iont must be added to sollution if the end poit of titration will be pH=7.4 and pCO2=5.3kPa.</p>
                   <p>For any tissue can be simplified with difference of lactate concentration from its normal value.</p>
                   </html>", revisions = "<html>
                   <p>Marek Matejak, 24.12.2009</p>
                   </html>"));
    end TissuesFitness;

    model Failed
      parameter Real effectAtFailing = 0.2;
      parameter Real effectAtRevitaling = 0.4;
      PhysiolibraryOld.Interfaces.RealInput_ FunctionEffect annotation (
          Placement(transformation(extent={{-118,-20},{-78,20}}),
            iconTransformation(extent={{-120,-20},{-80,20}})));
      PhysiolibraryOld.Interfaces.BooleanOutput Failed annotation (Placement(
            transformation(extent={{80,-20},{120,20}}), iconTransformation(
              extent={{80,-20},{120,20}})));
      Boolean a(start = false);
      Boolean b(start = true);
      Boolean c(start = false);
      //initial equation
      //  c=false;
    equation
      a = FunctionEffect < effectAtFailing;
      b = FunctionEffect > effectAtRevitaling;
      c = pre(Failed);
      Failed = a or c and not b;
      annotation(Diagram(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics));
    end Failed;

    model PatientStatus
      extends PhysiolibraryOld.Icons.StatusNormal;
      Normal normal annotation(Placement(transformation(extent = {{-66, 34}, {-46, 54}})));
      Confused confused(nOut = 2, nIn = 2) annotation(Placement(transformation(extent = {{-24, 34}, {-4, 54}})));
      Modelica.StateGraph.TransitionWithSignal worse1 "He's like confused. 
                                                                                                                                     "
                                                                                                            annotation(Placement(transformation(extent = {{-44, 34}, {-24, 54}})));
      Modelica.StateGraph.TransitionWithSignal better "Now he's feeling better. 
                                                                                                                                     "
                                                                                                            annotation(Placement(transformation(extent = {{-24, 84}, {-44, 64}})));
      Impaired impaired(nIn = 2, nOut = 2) annotation(Placement(transformation(extent = {{28, 34}, {48, 54}})));
      Comatose comatose(nIn = 2, nOut = 2) annotation(Placement(transformation(extent = {{88, -52}, {68, -32}})));
      NotBreathing notBreathing(nOut = 2, nIn = 3) annotation(Placement(transformation(extent = {{44, -52}, {24, -32}})));
      MayBeDead mayBeDead(nOut = 2) annotation(Placement(transformation(extent = {{-12, -52}, {-32, -32}})));
      IsReallyDead isReallyDead annotation(Placement(transformation(extent = {{-64, -52}, {-84, -32}})));
      PhysiolibraryOld.Interfaces.RealInput_ BrainFunctionEffect annotation (
          Placement(transformation(extent={{-104,86},{-94,96}}),
            iconTransformation(extent={{-120,-20},{-80,20}})));
      Modelica.Blocks.Logical.LessEqualThreshold lessEqualThreshold(threshold = 0.8) annotation(Placement(transformation(extent = {{-4, -4}, {4, 4}}, rotation = 90, origin = {-34, 24})));
      Modelica.Blocks.Logical.LessEqualThreshold lessEqualThreshold1(threshold = 0.6) annotation(Placement(transformation(extent = {{-4, -4}, {4, 4}}, rotation = 90, origin = {14, 24})));
      Modelica.StateGraph.TransitionWithSignal worse2 "He can't talk wery well ... 
                                                                                                                                     "
                                                                                                            annotation(Placement(transformation(extent = {{4, 34}, {24, 54}})));
      Modelica.Blocks.Logical.LessEqualThreshold lessEqualThreshold2(threshold = 0.4) annotation(Placement(transformation(extent = {{-4, -4}, {4, 4}}, rotation = 90, origin = {62, 24})));
      Modelica.StateGraph.TransitionWithSignal worse3 "Your patient is not conscious! 
                                                                                                                                     "
                                                                                                            annotation(Placement(transformation(extent = {{52, 34}, {72, 54}})));
      Modelica.StateGraph.TransitionWithSignal worse4 "Your patient is not conscious! 
                                                                                                                                     "
                                                                                                            annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 180, origin = {60, -42})));
      Modelica.Blocks.Logical.LessEqualThreshold lessEqualThreshold3(threshold = 0.2) annotation(Placement(transformation(extent = {{-4, -4}, {4, 4}}, rotation = 270, origin = {60, -22})));
      Modelica.Blocks.Logical.LessEqualThreshold lessEqualThreshold4(threshold = 0.1) annotation(Placement(transformation(extent = {{-4, -4}, {4, 4}}, rotation = 270, origin = {6, -22})));
      Modelica.StateGraph.TransitionWithSignal worse5 "Your patient is not conscious! 
                                                                                                                                     "
                                                                                                            annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 180, origin = {6, -42})));
      Modelica.Blocks.Logical.LessEqualThreshold lessEqualThreshold5(threshold = 0) annotation(Placement(transformation(extent = {{-4, -4}, {4, 4}}, rotation = 270, origin = {-50, -22})));
      Modelica.StateGraph.TransitionWithSignal worse6 "Your patient is not conscious! 
                                                                                                                                     "
                                                                                                            annotation(Placement(transformation(extent = {{-10, -10}, {10, 10}}, rotation = 180, origin = {-50, -42})));
      Modelica.StateGraph.TransitionWithSignal better2 "Your patient seems to be conscious again. 
                                                                                                                                     "
                                                                                                            annotation(Placement(transformation(extent = {{72, 84}, {52, 64}})));
      Modelica.StateGraph.TransitionWithSignal better3 "Your patient is breathing again. 
                                                                                                                                     "
                                                                                                            annotation(Placement(transformation(extent = {{52, -82}, {72, -62}})));
      Modelica.StateGraph.TransitionWithSignal better4
        "Wait. Your patient is not dead! "                                                annotation(Placement(transformation(extent = {{-4, -82}, {16, -62}})));
      Modelica.Blocks.Logical.GreaterEqualThreshold lessEqualThreshold6(threshold = 0.2) annotation(Placement(transformation(extent = {{-4, -4}, {4, 4}}, rotation = 90, origin = {6, -92})));
      Modelica.Blocks.Logical.GreaterEqualThreshold lessEqualThreshold7(threshold = 0.4) annotation(Placement(transformation(extent = {{-4, -4}, {4, 4}}, rotation = 90, origin = {62, -92})));
      Modelica.Blocks.Logical.GreaterEqualThreshold lessEqualThreshold8(threshold = 0.6) annotation(Placement(transformation(extent = {{-4, -4}, {4, 4}}, rotation = 270, origin = {62, 94})));
      Modelica.Blocks.Logical.GreaterEqualThreshold lessEqualThreshold9(threshold = 0.95) annotation(Placement(transformation(extent = {{-4, -4}, {4, 4}}, rotation = 270, origin = {-34, 94})));
      Modelica.StateGraph.TransitionWithSignal better5
        "Wait. Your patient is not dead!"                                                annotation(Placement(transformation(extent = {{-60, -82}, {-40, -62}})));
      Modelica.Blocks.Logical.GreaterEqualThreshold lessEqualThreshold10(threshold = 0.2) annotation(Placement(transformation(extent = {{-4, -4}, {4, 4}}, rotation = 90, origin = {-50, -90})));
      PhysiolibraryOld.Interfaces.BooleanOutput IS_NORMAL annotation (Placement(
            transformation(extent={{-54,22},{-44,32}}), iconTransformation(
              extent={{100,100},{140,140}})));
      PhysiolibraryOld.Interfaces.BooleanOutput IS_CONFUSED annotation (
          Placement(transformation(extent={{-10,22},{0,32}}),
            iconTransformation(extent={{100,60},{140,100}})));
      PhysiolibraryOld.Interfaces.BooleanOutput IS_IMPAIRED annotation (
          Placement(transformation(extent={{42,22},{52,32}}),
            iconTransformation(extent={{100,20},{140,60}})));
      PhysiolibraryOld.Interfaces.BooleanOutput IS_COMATOUS annotation (
          Placement(transformation(extent={{80,-64},{90,-54}}),
            iconTransformation(extent={{100,-20},{140,20}})));
      PhysiolibraryOld.Interfaces.BooleanOutput IS_NOT_BREATHING annotation (
          Placement(transformation(extent={{30,-64},{40,-54}}),
            iconTransformation(extent={{100,-60},{140,-20}})));
      PhysiolibraryOld.Interfaces.BooleanOutput IS_MAY_BE_DEAD annotation (
          Placement(transformation(extent={{-24,-64},{-14,-54}}),
            iconTransformation(extent={{100,-100},{140,-60}})));
      PhysiolibraryOld.Interfaces.BooleanOutput IS_REALLY_DEAD annotation (
          Placement(transformation(extent={{-78,-64},{-68,-54}}),
            iconTransformation(extent={{100,-140},{140,-100}})));
      Modelica.StateGraph.TransitionWithSignal better1 "Your patient seems to be conscious again. 
                                                                                                                                     "
                                                                                                            annotation(Placement(transformation(extent = {{24, 84}, {4, 64}})));
      Modelica.Blocks.Logical.GreaterEqualThreshold lessEqualThreshold11(threshold = 0.8) annotation(Placement(transformation(extent = {{-4, -4}, {4, 4}}, rotation = 270, origin = {14, 94})));
    equation
      connect(normal.outPort[1], worse1.inPort) annotation(Line(points = {{-45.5, 44}, {-38, 44}}, color = {0, 0, 0}, smooth = Smooth.None));
      connect(worse1.outPort, confused.inPort[1]) annotation(Line(points = {{-32.5, 44}, {-28.75, 44}, {-28.75, 44.5}, {-25, 44.5}}, color = {0, 0, 0}, smooth = Smooth.None));
      connect(better.outPort, normal.inPort[1]) annotation(Line(points = {{-35.5, 74}, {-76, 74}, {-76, 44}, {-67, 44}}, color = {0, 0, 0}, smooth = Smooth.None));
      connect(lessEqualThreshold.y, worse1.condition) annotation(Line(points = {{-34, 28.4}, {-34, 32}}, color = {255, 0, 255}, smooth = Smooth.None));
      connect(BrainFunctionEffect, lessEqualThreshold.u) annotation(Line(points = {{-99, 91}, {-90, 91}, {-90, 19.2}, {-34, 19.2}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(BrainFunctionEffect, lessEqualThreshold1.u) annotation(Line(points = {{-99, 91}, {-90, 91}, {-90, 19.2}, {14, 19.2}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(lessEqualThreshold1.y, worse2.condition) annotation(Line(points = {{14, 28.4}, {14, 32}}, color = {255, 0, 255}, smooth = Smooth.None));
      connect(confused.outPort[1], worse2.inPort) annotation(Line(points = {{-3.5, 44.25}, {3.25, 44.25}, {3.25, 44}, {10, 44}}, color = {0, 0, 0}, smooth = Smooth.None));
      connect(worse2.outPort, impaired.inPort[1]) annotation(Line(points = {{15.5, 44}, {21.25, 44}, {21.25, 44.5}, {27, 44.5}}, color = {0, 0, 0}, smooth = Smooth.None));
      connect(BrainFunctionEffect, lessEqualThreshold2.u) annotation(Line(points = {{-99, 91}, {-90, 91}, {-90, 19.2}, {62, 19.2}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(lessEqualThreshold2.y, worse3.condition) annotation(Line(points = {{62, 28.4}, {62, 32}}, color = {255, 0, 255}, smooth = Smooth.None));
      connect(impaired.outPort[1], worse3.inPort) annotation(Line(points = {{48.5, 44.25}, {53.25, 44.25}, {53.25, 44}, {58, 44}}, color = {0, 0, 0}, smooth = Smooth.None));
      connect(worse3.outPort, comatose.inPort[1]) annotation(Line(points = {{63.5, 44}, {96, 44}, {96, -41.5}, {89, -41.5}}, color = {0, 0, 0}, smooth = Smooth.None));
      connect(lessEqualThreshold3.y, worse4.condition) annotation(Line(points = {{60, -26.4}, {60, -30}}, color = {255, 0, 255}, smooth = Smooth.None));
      connect(BrainFunctionEffect, lessEqualThreshold3.u) annotation(Line(points = {{-99, 91}, {-90, 91}, {-90, -17.2}, {60, -17.2}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(lessEqualThreshold4.y, worse5.condition) annotation(Line(points = {{6, -26.4}, {6, -27.3}, {6, -27.3}, {6, -28.2}, {6, -30}, {6, -30}}, color = {255, 0, 255}, smooth = Smooth.None));
      connect(lessEqualThreshold5.y, worse6.condition) annotation(Line(points = {{-50, -26.4}, {-50, -30}}, color = {255, 0, 255}, smooth = Smooth.None));
      connect(BrainFunctionEffect, lessEqualThreshold4.u) annotation(Line(points = {{-99, 91}, {-90, 91}, {-90, -17.2}, {6, -17.2}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(BrainFunctionEffect, lessEqualThreshold5.u) annotation(Line(points = {{-99, 91}, {-90, 91}, {-90, -17.2}, {-50, -17.2}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(notBreathing.outPort[1], worse5.inPort) annotation(Line(points = {{23.5, -41.75}, {10.75, -41.75}, {10.75, -42}, {10, -42}}, color = {0, 0, 0}, smooth = Smooth.None));
      connect(worse5.outPort, mayBeDead.inPort[1]) annotation(Line(points = {{4.5, -42}, {-11, -42}}, color = {0, 0, 0}, smooth = Smooth.None));
      connect(mayBeDead.outPort[1], worse6.inPort) annotation(Line(points = {{-32.5, -41.75}, {-45.25, -41.75}, {-45.25, -42}, {-46, -42}}, color = {0, 0, 0}, smooth = Smooth.None));
      connect(worse6.outPort, isReallyDead.inPort[1]) annotation(Line(points = {{-51.5, -42}, {-63, -42}}, color = {0, 0, 0}, smooth = Smooth.None));
      connect(lessEqualThreshold6.y, better4.condition) annotation(Line(points = {{6, -87.59999999999999}, {6, -84}}, color = {255, 0, 255}, smooth = Smooth.None));
      connect(mayBeDead.outPort[2], better4.inPort) annotation(Line(points = {{-32.5, -42.25}, {-36, -42.25}, {-36, -72}, {2, -72}}, color = {0, 0, 0}, smooth = Smooth.None));
      connect(better4.outPort, notBreathing.inPort[2]) annotation(Line(points = {{7.5, -72}, {14, -72}, {14, -64}, {48, -64}, {48, -42}, {45, -42}}, color = {0, 0, 0}, smooth = Smooth.None));
      connect(BrainFunctionEffect, lessEqualThreshold6.u) annotation(Line(points = {{-99, 91}, {-90, 91}, {-90, -96.8}, {6, -96.8}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(BrainFunctionEffect, lessEqualThreshold7.u) annotation(Line(points = {{-99, 91}, {-90, 91}, {-90, -96.8}, {62, -96.8}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(lessEqualThreshold7.y, better3.condition) annotation(Line(points = {{62, -87.59999999999999}, {62, -84}}, color = {255, 0, 255}, smooth = Smooth.None));
      connect(notBreathing.outPort[2], better3.inPort) annotation(Line(points = {{23.5, -42.25}, {22, -42.25}, {22, -72}, {58, -72}}, color = {0, 0, 0}, smooth = Smooth.None));
      connect(better3.outPort, comatose.inPort[2]) annotation(Line(points = {{63.5, -72}, {70, -72}, {70, -64}, {96, -64}, {96, -42.5}, {89, -42.5}}, color = {0, 0, 0}, smooth = Smooth.None));
      connect(comatose.outPort[2], better2.inPort) annotation(Line(points = {{67.5, -42.25}, {66, -42.25}, {66, 0}, {82, 0}, {82, 74}, {66, 74}}, color = {0, 0, 0}, smooth = Smooth.None));
      connect(better2.outPort, impaired.inPort[2]) annotation(Line(points = {{60.5, 74}, {22, 74}, {22, 43.5}, {27, 43.5}}, color = {0, 0, 0}, smooth = Smooth.None));
      connect(lessEqualThreshold8.y, better2.condition) annotation(Line(points = {{62, 89.59999999999999}, {62, 86}}, color = {255, 0, 255}, smooth = Smooth.None));
      connect(lessEqualThreshold8.u, BrainFunctionEffect) annotation(Line(points = {{62, 98.8}, {-90, 98.8}, {-90, 91}, {-99, 91}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(better.condition, lessEqualThreshold9.y) annotation(Line(points = {{-34, 86}, {-34, 89.59999999999999}}, color = {255, 0, 255}, smooth = Smooth.None));
      connect(BrainFunctionEffect, lessEqualThreshold9.u) annotation(Line(points = {{-99, 91}, {-90, 91}, {-90, 98.8}, {-34, 98.8}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(normal.active, IS_NORMAL) annotation(Line(points = {{-56, 33}, {-56, 27}, {-49, 27}}, color = {255, 0, 255}, smooth = Smooth.None));
      connect(confused.active, IS_CONFUSED) annotation(Line(points = {{-14, 33}, {-14, 27}, {-5, 27}}, color = {255, 0, 255}, smooth = Smooth.None));
      connect(impaired.active, IS_IMPAIRED) annotation(Line(points = {{38, 33}, {38, 27}, {47, 27}}, color = {255, 0, 255}, smooth = Smooth.None));
      connect(comatose.active, IS_COMATOUS) annotation(Line(points = {{78, -53}, {78, -59}, {85, -59}}, color = {255, 0, 255}, smooth = Smooth.None));
      connect(notBreathing.active, IS_NOT_BREATHING) annotation(Line(points = {{34, -53}, {34, -59}, {35, -59}}, color = {255, 0, 255}, smooth = Smooth.None));
      connect(IS_MAY_BE_DEAD, mayBeDead.active) annotation(Line(points = {{-19, -59}, {-22, -59}, {-22, -53}}, color = {255, 0, 255}, smooth = Smooth.None));
      connect(isReallyDead.active, IS_REALLY_DEAD) annotation(Line(points = {{-74, -53}, {-74, -59}, {-73, -59}}, color = {255, 0, 255}, smooth = Smooth.None));
      connect(better5.condition, lessEqualThreshold10.y) annotation(Line(points = {{-50, -84}, {-50, -85.59999999999999}}, color = {255, 0, 255}, smooth = Smooth.None));
      connect(BrainFunctionEffect, lessEqualThreshold10.u) annotation(Line(points = {{-99, 91}, {-90, 91}, {-90, -96}, {-50, -96}, {-50, -94.8}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(comatose.outPort[1], worse4.inPort) annotation(Line(points = {{67.5, -41.75}, {65.75, -41.75}, {65.75, -42}, {64, -42}}, color = {0, 0, 0}, smooth = Smooth.None));
      connect(worse4.outPort, notBreathing.inPort[1]) annotation(Line(points = {{58.5, -42}, {59.75, -42}, {59.75, -41.3333}, {45, -41.3333}}, color = {0, 0, 0}, smooth = Smooth.None));
      connect(confused.outPort[2], better.inPort) annotation(Line(points = {{-3.5, 43.75}, {0, 43.75}, {0, 74}, {-30, 74}}, color = {0, 0, 0}, smooth = Smooth.None));
      connect(better5.outPort, notBreathing.inPort[3]) annotation(Line(points = {{-48.5, -72}, {-44, -72}, {-44, -64}, {48, -64}, {48, -42.6667}, {45, -42.6667}}, color = {0, 0, 0}, smooth = Smooth.None));
      connect(isReallyDead.outPort[1], better5.inPort) annotation(Line(points = {{-84.5, -42}, {-86, -42}, {-86, -72}, {-54, -72}}, color = {0, 0, 0}, smooth = Smooth.None));
      connect(lessEqualThreshold11.y, better1.condition) annotation(Line(points = {{14, 89.59999999999999}, {14, 86}}, color = {255, 0, 255}, smooth = Smooth.None));
      connect(lessEqualThreshold11.u, BrainFunctionEffect) annotation(Line(points = {{14, 98.8}, {-90, 98.8}, {-90, 91}, {-99, 91}}, color = {0, 0, 127}, smooth = Smooth.None));
      connect(impaired.outPort[2], better1.inPort) annotation(Line(points = {{48.5, 43.75}, {52, 43.75}, {52, 74}, {18, 74}}, color = {0, 0, 0}, smooth = Smooth.None));
      connect(better1.outPort, confused.inPort[2]) annotation(Line(points = {{12.5, 74}, {-25, 74}, {-25, 43.5}}, color = {0, 0, 0}, smooth = Smooth.None));
      annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics));
    end PatientStatus;

    block Normal
      extends Modelica.StateGraph.InitialStepWithSignal;
      extends PhysiolibraryOld.Icons.StatusNormal;
      annotation(Icon(graphics));
    end Normal;

    block Confused
      extends Modelica.StateGraph.StepWithSignal;
      extends PhysiolibraryOld.Icons.StatusConfused;
      annotation(Icon(graphics));
    end Confused;

    block Impaired
      extends Modelica.StateGraph.StepWithSignal;
      extends PhysiolibraryOld.Icons.StatusImpaired;
      annotation(Icon(graphics));
    end Impaired;

    block Comatose
      extends Modelica.StateGraph.StepWithSignal;
      extends PhysiolibraryOld.Icons.StatusComatose;
      annotation(Icon(graphics));
    end Comatose;

    block NotBreathing
      extends Modelica.StateGraph.StepWithSignal;
      extends PhysiolibraryOld.Icons.StatusNotBreathing;
      annotation(Icon(graphics));
    end NotBreathing;

    block MayBeDead
      extends Modelica.StateGraph.StepWithSignal;
      extends PhysiolibraryOld.Icons.StatusMayBeDead;
      annotation(Icon(graphics));
    end MayBeDead;

    block IsReallyDead
      extends Modelica.StateGraph.StepWithSignal;
      extends PhysiolibraryOld.Icons.StatusIsReallyDead;
      annotation(Icon(graphics));
    end IsReallyDead;

    package tissues
      model TissueFitness
        PhysiolibraryOld.Interfaces.RealOutput_ FunctionEffect annotation (
            Placement(transformation(extent={{56,-14},{68,-2}}),
              iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=270,
              origin={-20,-120})));
        PhysiolibraryOld.Interfaces.RealOutput_ StructureEffect annotation (
            Placement(transformation(extent={{-8,-34},{8,-18}}),
              iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=270,
              origin={20,-120})));
        PhysiolibraryOld.Interfaces.RealInput_ pH_intracellular annotation (
            Placement(transformation(extent={{-84,42},{-72,54}}),
              iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=180,
              origin={90,80})));
        PhysiolibraryOld.Interfaces.RealInput_ T(final unit="degC")
          "tissue temperature" annotation (Placement(transformation(extent={{-104,
                  66},{-92,78}}), iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=180,
              origin={90,40})));
        PhysiolibraryOld.Interfaces.RealInput_ Fuel_FractUseDelay annotation (
            Placement(transformation(extent={{-96,54},{-84,66}}),
              iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=180,
              origin={90,0})));
        PhysiolibraryOld.Interfaces.RealInput_ CellProtein_Mass(final unit="g")
          annotation (Placement(transformation(extent={{-2,30},{8,40}}),
              iconTransformation(
              extent={{-10,-10},{10,10}},
              rotation=180,
              origin={90,-80})));
        PhysiolibraryOld.Factors.CurveValue PhOnStructure(data={{6.5,0.1,0},{
              6.6,0.0,0}})
          annotation (Placement(transformation(extent={{-64,14},{-44,36}})));
        PhysiolibraryOld.Factors.CurveValue FuelOnStructure(data={{0.5,0.05,0},
              {0.8,0.0,0}})
          annotation (Placement(transformation(extent={{-64,0},{-44,20}})));
        PhysiolibraryOld.Factors.CurveValue TemperatureOnStructure(data={{44.0,
              0.0,0},{46.0,0.05,0}})
          annotation (Placement(transformation(extent={{-64,-14},{-44,6}})));
        PhysiolibraryOld.Blocks.Constant Constant(k=1)
          annotation (Placement(transformation(extent={{-66,30},{-58,38}})));
        Modelica.Blocks.Math.Feedback feedback annotation(Placement(transformation(extent = {{-64, -16}, {-44, -36}})));
        Modelica.Blocks.Continuous.Integrator integrator(y_start=1, k=1/
              PhysiolibraryOld.SecPerMin)
          annotation (Placement(transformation(extent={{-38,-36},{-18,-16}})));
        PhysiolibraryOld.Factors.CurveValue PhOnFunction(data={{6.6,0.0,0},{6.7,
              1.0,0}})
          annotation (Placement(transformation(extent={{20,38},{40,58}})));
        PhysiolibraryOld.Factors.CurveValue ProteinOnFunction(data={{3000.0,0.0,
              0},{5200.0,1.0,0}})
          annotation (Placement(transformation(extent={{20,24},{40,46}})));
        PhysiolibraryOld.Factors.CurveValue FuelOnFunction(data={{0.0,0.0,0},{
              0.9,1.0,0}})
          annotation (Placement(transformation(extent={{20,50},{40,70}})));
        PhysiolibraryOld.Factors.CurveValue TemperatureOnFunction(data={{10,0.0,
              0},{37,1.0,0.12},{40,1.5,0},{46,0.0,0}})
          annotation (Placement(transformation(extent={{20,62},{40,82}})));
        PhysiolibraryOld.Blocks.Constant Constant1(k=1)
          annotation (Placement(transformation(extent={{20,78},{28,86}})));
        PhysiolibraryOld.Factors.SimpleMultiply StructureEff
          annotation (Placement(transformation(extent={{20,10},{40,30}})));
        Failed failed annotation(Placement(transformation(extent = {{44, -70}, {64, -50}})));
        PhysiolibraryOld.Interfaces.BooleanOutput FunctionFailed annotation (
            Placement(transformation(extent={{76,-66},{88,-54}}),
              iconTransformation(
              extent={{-20,-20},{20,20}},
              rotation=270,
              origin={60,-120})));
        PhysiolibraryOld.Blocks.Constant Constant2(k=0)
          annotation (Placement(transformation(extent={{-86,-30},{-78,-22}})));
      equation
        connect(PhOnStructure.u, pH_intracellular) annotation(Line(points = {{-63.8, 25}, {-70, 26}, {-70, 48}, {-78, 48}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(FuelOnStructure.u, Fuel_FractUseDelay) annotation(Line(points = {{-63.8, 10}, {-82, 10}, {-82, 60}, {-90, 60}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(TemperatureOnStructure.u, T) annotation(Line(points = {{-63.8, -4}, {-92, -4}, {-92, 72}, {-98, 72}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(PhOnStructure.y, FuelOnStructure.yBase) annotation(Line(points = {{-54, 22.8}, {-54, 12}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(FuelOnStructure.y, TemperatureOnStructure.yBase) annotation(Line(points = {{-54, 8}, {-54, -2}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Constant.y, PhOnStructure.yBase) annotation(Line(points = {{-57.6, 34}, {-54, 34}, {-54, 27.2}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(TemperatureOnStructure.y, feedback.u2) annotation(Line(points = {{-54, -6}, {-54, -18}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(feedback.y, integrator.u) annotation(Line(points = {{-45, -26}, {-40, -26}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(integrator.y, StructureEffect) annotation(Line(points = {{-17, -26}, {0, -26}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(pH_intracellular, PhOnFunction.u) annotation(Line(points = {{-78, 48}, {20.2, 48}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(CellProtein_Mass, ProteinOnFunction.u) annotation(Line(points = {{3, 35}, {20.2, 35}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Fuel_FractUseDelay, FuelOnFunction.u) annotation(Line(points = {{-90, 60}, {20.2, 60}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(T, TemperatureOnFunction.u) annotation(Line(points = {{-98, 72}, {20.2, 72}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(TemperatureOnFunction.y, FuelOnFunction.yBase) annotation(Line(points = {{30, 70}, {30, 62}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(FuelOnFunction.y, PhOnFunction.yBase) annotation(Line(points = {{30, 58}, {30, 50}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(PhOnFunction.y, ProteinOnFunction.yBase) annotation(Line(points = {{30, 46}, {30, 37.2}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(Constant1.y, TemperatureOnFunction.yBase) annotation(Line(points = {{28.4, 82}, {30, 82}, {30, 74}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(integrator.y, StructureEff.u) annotation(Line(points = {{-17, -26}, {-12, -26}, {-12, 20}, {20.2, 20}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(ProteinOnFunction.y, StructureEff.yBase) annotation(Line(points = {{30, 32.8}, {30, 22}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(StructureEff.y, FunctionEffect) annotation(Line(points = {{30, 18}, {30, -8}, {62, -8}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(StructureEff.y, failed.FunctionEffect) annotation(Line(points = {{30, 18}, {30, -60}, {44, -60}}, color = {0, 0, 127}, smooth = Smooth.None));
        connect(failed.Failed, FunctionFailed) annotation(Line(points = {{64, -60}, {82, -60}}, color = {255, 0, 255}, smooth = Smooth.None));
        connect(Constant2.y, feedback.u1) annotation(Line(points = {{-77.59999999999999, -26}, {-62, -26}}, color = {0, 0, 127}, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Icon(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics = {Rectangle(extent=  {{-100, 100}, {100, -100}}, lineColor=  {0, 0, 255})}));
      end TissueFitness;

      model SkeletalMuscle
        extends TissueFitness;
        extends PhysiolibraryOld.Icons.SkeletalMuscle;
      end SkeletalMuscle;

      model Bone
        extends TissueFitness;
        extends PhysiolibraryOld.Icons.Bone;
      end Bone;

      model OtherTissue
        extends TissueFitness;
        extends PhysiolibraryOld.Icons.OtherTissue;
      end OtherTissue;

      model RespiratoryMuscle
        extends TissueFitness;
        extends PhysiolibraryOld.Icons.RespiratoryMuscle;
      end RespiratoryMuscle;

      model Fat
        extends TissueFitness;
        extends PhysiolibraryOld.Icons.Fat;
      end Fat;

      model Skin
        extends TissueFitness(TemperatureOnFunction(data = {{10.0, 0.0, 0}, {29.5, 1.0, 0.12}, {40.0, 1.5, 0}, {46.0, 0.0, 0}}));
        extends PhysiolibraryOld.Icons.Skin;
      end Skin;

      model Liver
        extends TissueFitness;
        extends PhysiolibraryOld.Icons.Liver;
      end Liver;

      model Brain
        extends TissueFitness;
        extends PhysiolibraryOld.Icons.Brain;
      end Brain;

      model GITract
        extends TissueFitness;
        extends PhysiolibraryOld.Icons.GITract;
      end GITract;

      model Kidney
        extends TissueFitness;
        extends PhysiolibraryOld.Icons.Kidney;
      end Kidney;

      model LeftHeart
        extends TissueFitness;
        extends PhysiolibraryOld.Icons.LeftHeart;
      end LeftHeart;

      model RightHeart
        extends TissueFitness;
        extends PhysiolibraryOld.Icons.RightHeart;
      end RightHeart;
    end tissues;
    annotation(Documentation(revisions = "<html>
                   <table>
                   <tr>
                   <td>Author:</td>
                   <td>Marek Matejak</td>
                   </tr>
                   <tr>
                   <td>Copyright:</td>
                   <td>In public domains</td>
                   </tr>
                   <tr>
                   <td>By:</td>
                   <td>Charles University, Prague</td>
                   </tr>
                   <tr>
                   <td>Date of:</td>
                   <td>2009</td>
                   </tr>
                   <tr>
                   <td>References:</td>
                   <td>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</td>
                   </tr>
                   </table>
                   </html>"), Icon(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics));
  end Status;

  package Main
    package test
      model HumMod_GolemEdition2 "Main model"
        import HumMod;
        extends PhysiolibraryOld.Icons.Golem;
        HumMod.CardioVascular.CVS_Dynamic cardioVascularSystem annotation(Placement(transformation(extent = {{58, 74}, {78, 96}})));
        HumMod.Metabolism.NutrientsAndMetabolism nutrientsAndMetabolism annotation(Placement(transformation(extent = {{-90, 66}, {-70, 86}})));
        HumMod.Electrolytes.Electrolytes electrolytes annotation(Placement(transformation(extent = {{74, -28}, {94, -8}})));
        HumMod.Hormones.Hormones hormones annotation(Placement(transformation(extent = {{40, 12}, {60, 32}})));
        HumMod.Nerves.Nerves nerves annotation(Placement(transformation(extent = {{74, 44}, {94, 64}})));
        HumMod.Setup.Setup_variables setup annotation(Placement(transformation(extent = {{-16, -100}, {4, -80}})));
        HumMod.Water.Water2 water annotation(Placement(transformation(extent = {{-86, 0}, {-66, 20}})));
        HumMod.Proteins.Proteins proteins annotation(Placement(transformation(extent = {{-48, -22}, {-28, -2}})));
        HumMod.Status.TissuesFitness status annotation(Placement(transformation(extent = {{42, -74}, {62, -54}})));
        HumMod.Gases.Gases gases annotation(Placement(transformation(extent = {{-76, -60}, {-56, -40}})));
        //(oxygen(tissuesO2(skeletalMuscleO2(O2Tissue(pO2(start = 5.43), sO2CO(start = 0.367), a(start = 0.518))))))
        HumMod.Heat.Heat2 heat annotation(Placement(transformation(extent = {{-28, 36}, {-48, 56}})));
      equation
        connect(setup.busConnector, hormones.busConnector) annotation(Line(points = {{2, -84}, {2, 27.9}, {43.9, 27.9}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(setup.busConnector, proteins.busConnector) annotation(Line(points = {{2, -84}, {2, -3.7}, {-31.7, -3.7}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(setup.busConnector, cardioVascularSystem.busConnector) annotation(Line(points = {{2, -84}, {2, 93.8}, {60, 93.8}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(setup.busConnector, nutrientsAndMetabolism.busConnector) annotation(Line(points = {{2, -84}, {2, 84}, {-72, 84}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(setup.busConnector, water.busConnector) annotation(Line(points = {{2, -84}, {2, 17}, {-69, 17}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(setup.busConnector, nerves.busConnector) annotation(Line(points = {{2, -84}, {2, 62}, {76, 62}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(status.busConnector, setup.busConnector) annotation(Line(points = {{43.2, -54.8}, {2, -54.8}, {2, -84}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(electrolytes.busConnector, setup.busConnector) annotation(Line(points = {{74, -14}, {2, -14}, {2, -84}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(gases.busConnector, setup.busConnector) annotation(Line(points = {{-58, -42}, {2, -42}, {2, -84}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        connect(heat.busConnector, setup.busConnector) annotation(Line(points = {{-28.6, 55.6}, {2, 55.6}, {2, -84}}, color = {0, 0, 255}, thickness = 0.5, smooth = Smooth.None));
        annotation(Diagram(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), Documentation(info = "<html>
                        <p><h4><font color=\"#008000\">QHP Golem Edition</font></h4></p>
                        <p>Signal bus connect all submodels with their signal inputs/outputs variables.</p>
                        </html>", revisions = "<html>
                        <table cellspacing=\"2\" cellpadding=\"0\" border=\"0\"><tr>
                        <td><p>Author:</p></td>
                        <td><p>Marek Matejak</p></td>
                        </tr>
                        <tr>
                        <td><p>Copyright:</p></td>
                        <td><p>In public domains</p></td>
                        </tr>
                        <tr>
                        <td><p>By:</p></td>
                        <td><p>Charles University, Prague</p></td>
                        </tr>
                        <tr>
                        <td><p>Date of:</p></td>
                        <td><p>2013</p></td>
                        </tr>
                        <tr>
                        <td><p>References:</p></td>
                        <td><p>Tom Coleman: HumMod v1.6, University of Mississippi Medical Center</p></td>
                        </tr>
                        <tr>
                        <td></td>
                        <td><p><br/><br/>Siggaard Andersen: OSA (2005), University of Copenhagen</p></td>
                        </tr>
                        <tr>
                        <td></td>
                        <td><p><br/><br/>Noriaki Ikeda: A model of overall regulation of body fluids (1979), Kitasato University</p></td>
                        </tr>
                        </table>
                        </html>"), Icon(coordinateSystem(preserveAspectRatio = true, extent = {{-100, -100}, {100, 100}}), graphics), experimentSetupOutput, Commands(file = "view.mos" "view"), experiment(StartTime = 0, StopTime = 2592000.0, Tolerance = 0.01, Interval = 60));
      end HumMod_GolemEdition2;
    end test;
  end Main;
  annotation(uses(Modelica(version="3.2.1")), Documentation(revisions = "<html>
                   <table cellspacing=\"2\" cellpadding=\"0\" border=\"0\"><tr>
                   <td><p>Author:</p></td>
                   <td><p>Marek Matejak</p></td>
                   </tr>
                   <tr>
                   <td><p>Copyright:</p></td>
                   <td><p>In public domains</p></td>
                   </tr>
                   <tr>
                   <td><p>By:</p></td>
                   <td><p>Charles University, Prague</p></td>
                   </tr>
                   <tr>
                   <td><p>Date of:</p></td>
                   <td><p>2009-2013</p></td>
                   </tr>
                   <tr>
                   <td><p>References:</p></td>
                   <td><p>Tom Coleman: QHP 2008 beta 3, University of Mississippi Medical Center</p></td>
                   </tr>
                   <tr>
                   <td></td>
                   <td><p><br/><br/><br/><br/>Siggaard Andersen: OSA (2005), University of Copenhagen</p></td>
                   </tr>
                   <tr>
                   <td></td>
                   <td><p><br/><br/><br/><br/>Noriaki Ikeda: A model of overall regulation of body fluids (1979), Kitasato University</p></td>
                   </tr>
                   </table>
                   </html>"), Icon(coordinateSystem(preserveAspectRatio = false, extent = {{-100, -100}, {100, 100}}), graphics));
end HumMod;
